245
test verifi assert enabl noth sinc ignor assertionerror follow-up lucene-3501
improv memori consumpt merg docvalu sortedbyt variant current sortedbyt load memori merg could potenti trap instead load heap memori merg sort valu much smaller memori without load valu ram
decompound base compoundwordtokenfilterbas use custom attribut compoundwordtokenfilterbase.settoken method call clearattribut reset default token attribut term posit flag etc result custom attribut lose valu comment clearattribut seem trick fail testcompoundwordtokenfilt tests..
add set iwc optim idv indic cpu ram respectivli spinnoff lucene-3496 see much better perform requir bit packedint round 8/16/32/64 add option iwc default round ie ram faster lookup
booleanscor limit number prohibit claus today 's limit 32 use separ bit mask claus n't understand think prohibit claus share singl boolean/bit match prohibit claus set bit doc collect n't need prohibit claus dedic bit also use mask requir claus code comment alway use bs2 requir claus re-en code think least certain case suspect 'd faster bs2 mani case think cutov int count instead bit mask limit requir claus sent booleanscor also separ clean thing booleanscor embed scorer method nextdoc docid advanc score throw uoe pre-alloc bucket instead lazili per-sub-collect
add simplefraglistbuild constructor margin paramet simplefraglistbuild would benefit addit constructor take margin current margin defin constant implement fraglistbuild differ margin one choic copi past simplefraglistbuild new class must place org.apache.lucene.search.vectorhighlight packag due access package-protect field class chang made precondit check constructor 's fragchars probabl alter ensur 's less max 1 margin*3 allow margin 0
possibl slowdown indexing/merg 3.x vs trunk open issu pursu possibl slowdown marc sturles uncov
fix pulsingcodec reus enum pulsingcodec current doesnt alway reus enum could lead behavior like lucene-3515 problem sometim return wrap enum time return pulsingenum depend upon whether term puls use fact enum allow attribut keep reus inform reus step term
add sort-by-term docvalu two sort byte type docvalu bytes_var_sort bytes_fixed_sort index type ca n't yet sort ad fieldcompar like termordvalcompar except pull doc valu instead small diff eg doc valu never null valu see lucene-3504
blockjoincollector allow retriev group one blockjoinqueri spinoff mark harwood 's email subject blockjoin concern dev list 's fine use multipl nest join singl queri blockjoincollector let retriev top group current alway return null first queri 's group retriev silli bug
nrt reader n't chang indexreader.openifchang return null hit failur testsearchermanag note n't alway fail noformat ant test -dtestcase=testsearchermanag -dtestmethod=testsearchermanag -dtests.seed=459ac99a4256789c -29b8a7f52497c3b4:145ae632ae9e1ecf noformat trip assert insid searcherlifetimemanager.record two differ indexsearch instanc differ ir instanc share version happen iw.getread alway return new reader even chang think fix separ found deadlock testsearchermanager.testintermediateclos test get serialmergeschedul need merg second commit
upgrad icu jar 4.8.1.1 remov lucenetestcas hack bug fix releas fix problem icu java7 http //bugs.icu-project.org/trac/ticket/8734
termsfilter.getdocidset context npe miss field context contain field term call termsfilter.getdocidset atomicreadercontext context nullpointerexcept thrown due check null term get iter
add direct packedints.read impl read direct disk get spinoff lucene-3518 direct packedints.read impl could use instead randomaccessreaderiter
preflex codec return wrong term use empti field name spinoff lucene-3473 standalon test termsenum return bogus extra empty-term assum post didnt tri caus checkindex test lucene-3473 fail 4 term instead 3
implement getdist directspellchecker.internal_levenshtein directspellchecker.internal_levenshtein current full-fledg implement stringdist full implement need solr 's spellcheckcomponent.finishstag also would help tri take advic given lia 2nd ed section sect8.5.3
testnrtmanag hang n't check 3.x yet encount one run test
creat empti field empti term lead invalid index spinoff lucene-3526 creat new field get illegalargumentexcept field 's ctor name valu empti ton way index empti term empti field exampl initi make garbag .setvalu via tokenstream assert enabl trip assert assert fix trunk lucene-3526 n't assert enabl creat corrupt index test term freq prox error term docfreq=1 num doc seen 0 num doc delet 0
remov deprec method compoundtokenfilt
improv cachingwrapperfilt option also cach acceptdoc ident livedoc spinoff lucene-1536 issu remov differ cach mode complet alway appli acceptdoc use bitsfiltereddocidset.wrap cach contain raw docidset without deletions/acceptdoc indexread seldom reopen might perform could acceptdocs==ir.livedoc docidset could also cach livedoc appli
nuke spanfilt cachingspanfilt mayb move sandbox spanfilt ineffici oom easili n't scale creat larg list object everi match also filter delet doc pain talk grant eurocon also fact cach still broken 3.x fix trunk assum nobodi use let 's nuke also wrong packag standard statement die spanfilt die
backport filteredquery/indexsearch chang 3.x remov filter logic indexsearch deleg filteredqueri spinoff lucene-1536 simplifi code indexsearch longer filter instead wrap queri filteredqueri non-nul filter given conjunct code would exist filteredqueri make easier maintain current implement differ 3.x trunk use optim indexsearch variant addit simplifi in-ord conjunct code issu backport chang without random access bit
move perfieldcodecwrapp codec packag perfieldcodecwrapp codec hardwir lucen 's codec current except preflex/3.x case let choos format post list per-field think move codec packag start rote refactor
indexformattooold/newexc tri includ filenam directori possibl spinoff http //markmail.org/thread/t6s7nn3ve765nojc throw old/new exc tri includ full path offend file possibl
3.x branch start 3.4 indexformattoooldexcept backport error messag modifi 3.x 3.x branch start 3.4 indexformattoooldexcept backport error messag modifi 3.x bq version lucen support index creat releas 3.0 later 3.x must bq version lucen support index creat releas 1.9 later index 1.9 throw except read segmentinfo lucene-3255
remov indexinput.copybuf look realli broken/danger instanc variabl happen clone copybyt instead make array insid method protect ill list 3.x backward break section sinc technic backward break
standardquerypars ignor oper token queri term standard queri parser use default queri oper queri claus creat token queri parser instead actual oper sourc term exampl code standardquerypars parser new standardquerypars new standardanalyz version.lucene_34 parser.setdefaultoper operator.or system.out.println booleanqueri parser.pars _delet true titl –|¾© f code yield +_delet true titl –| titl ¾© former core queri parser actual yield +_delet true titl –| titl ¾© seem like bug look test seem n't test kind queri standard queri parser test
iw nrtiscurr retrun true chang del queue buffereddeletestream yet spinnoff solr-2861 sinc delet queue necessarili appli entir request chanc chang delet queue yet buffer delet prevent nrt reader reopen show problemat code code index java/org/apache/lucene/index/indexwriter.java java/org/apache/lucene/index/indexwriter.java revis 1195214 +++ java/org/apache/lucene/index/indexwriter.java work copi -4074,7 +4074,7 synchron boolean nrtiscurr segmentinfo info //system.out.println iw.nrtiscurr infos.vers segmentinfos.vers docwriter.anychang buffereddeletesstream.ani ensureopen return infos.vers segmentinfos.vers docwriter.anychang buffereddeletesstream.ani return infos.vers segmentinfos.vers docwriter.anychang docwriter.deletequeue.anychang code
charsref append broken trunk 3.x current impl append charsref broken overrid actual content rather append use mani place especi solr might broken
remov documentbuild interfac facet modul facet modul contain interfac call documentbuild contain singl method build document 's builder api use compani standard differ modul popul document object ve includ facet contribut thing compil code chang possibl 's time cleanup 'd like start interfac peopl think interfac use resid core n't mind move otherwis let 's remov code one impl facet modul categorydocumentbuild certain without interfac 's o.a.l packag inappropri imo 's move core o.a.l.docu peopl see problem pleas speak chang post patch short
yet anoth race iw nrtiscurr iw nrtiscurr look like code synchron boolean nrtiscurr segmentinfo info ensureopen return infos.vers segmentinfos.vers docwriter.anychang buffereddeletesstream.ani code version chang checkpoint iw docwrit chang doc ram delet delqueu buffereddelet contain frozen del packag delqueu yet happen 1. decrement numdocsinram dwpt doafterflush execut dwpt flush checkpoint 2. freez delet empti delqueu put flushqueu maintain order mean yet buffereddeletestream bottom line window could see iw nrtiscurr return true check within particular window phew 100 sure reason latest failur solr-2861 log look like could happen random hit low valu maxbuffereddoc maxbuffereddeleteterm absolut possibl
taxonomyreader/writ lucene* implement facet modul contain two interfac taxonomywrit taxonomyread two implement lucene* ve never actual implement two taxonomywriters/read 'm sure interfac use anymor therefor 'd like propos either follow remov interfac remov lucen part implement class end tw/tr impl keep interfac renam lucene* impl directory* whatev 'd like make impls/interfac impl also twophasecommit prefer
tweak appendingcodec write segments_n compat normal lucen easi improv lucene-3490 current appendingcodec write differ segments_n format write checksum commit n't configur codecprovid correct indexread get read past eof propos fix stuff lucene-3490 branch besid realli need no-op preparecommit still write final checksum good thing
add support distribut stat bug way sinc broke temporarili way distribut idf etc new api right sim ask searcher docfreq term wast danger usual alreadi seek 'd term alreadi collect raw stuff situat docfreq abl implement distribut score new sim model use lucen 's stat
make directorytaxonomywrit 's indexwrit member privat directorytaxonomywrit protect indexwrit member far tell two reason protect openindexwrit method let open iw e.g custom indexwriterconfig protect closeindexwrit hook let close iw open previous one fix trivial imo modifi method return iw call code set dtw 's indexwrit member elimin closeiw dtw alreadi protect closeresourc let clean resourc ve alloc think 's enough ll post patch short
spellcheck take indexwriterconfig deprec old method look lucene-3490 realiz way specifi codec spellcheck use follow current method indexdictionari dictionari dict caus optim indexdictionari dictionari dict int mergefactori int rammb caus optim indexdictionari dictionari dict int mergefactor int rammb boolean optim way specifi indexwriterconfig addit n't like sever ctor forc optim tricki way even though like along think add indexdictionari dictionari dict indexwriterconfig config boolean optim either deprec ctor 3.x nuke trunk least add warn one optim
searchermanag nrtmanag packag didnt even know nrtmanag still around .index packag wherea searchermanag .search packag separ n't like stuff hard core lucen would bad stuff ad core suspect lot peopl issu stuff see http //www.lucidimagination.com/search/document/37964e5f0e5d733b exampl worst case combin mistak tri manag stuff mmap unmap total lack error detect search close reader lucene-3439 mess
remov indexsearcher.docfreq/maxdoc point mark solr-1632 longer use score system ve ad new stat lucen method indexsearch make sens confus peopl upgrad subclass indexsearch provid distribut stat find use lucene-3555 correct api think remov 4.0
stop store termsenum closeablethreadloc insid term instanc sugar method terms.java docfreq totaltermfreq doc docsandposit use save thread-priv termsenum lookup app send mani thread lucen and/or mani segment add lot ram especi codec impl hold onto stuff also term close method close closeablethreadloc must call fail place save enum caus recent oom testnrtmanag testnrtmanager.testnrtmanag -seed 2aa27e1aec20c4a2 -4a5a5ecf46837d0 -7c4f651f1f0b75d7 -mult 3 -night realli share enum holdov lucen queri would share state ie save termstat first pass use later pull enum get docfreq etc. 's help anymor use gobb ram 'd like remov
testpagedbyt failur ant test -dtestcase=testpagedbyt -dtestmethod=testdatainputoutput -dtests.seed=268db1f3329b70d:3125365bc9c56c90:116e02aa4a70ec2f -dtests.multiplier=5
parametr h1 h2 dfr normal h1 h2 parameter-fre line origin article|http //citeseer.ist.psu.edu/viewdoc/summari doi=10.1.1.101.742 thesis|http //theses.gla.ac.uk/1570/ h2 accept c paramet information-bas models|http //dl.acm.org/citation.cfm id=1835490 h1 also accept c paramet
nuke indexsearch directori indexsearch suppos cheap wrapper around reader sometim sometim n't think confus tangl heavyweight lightweight object sometim hous reader must close case
multiindexdocvalu pretend merg sort sourc night build hit failur noformat ant test-cor -dtestcase=testsort -dtestmethod=testreversesort -dtests.seed=791b126576b0cfab -48895c7243ecc5d0:743c683d1c9f7768 -dtests.multiplier=3 -dargs= -dfile.encoding=iso8859-1 junit testcas testreversesort org.apache.lucene.search.testsort caus error junit expect cegia acegi junit org.apache.lucene.search.testsort.assertmatch testsort.java:1248 junit org.apache.lucene.search.testsort.assertmatch testsort.java:1216 junit org.apache.lucene.search.testsort.testreversesort testsort.java:759 junit org.apache.lucene.util.lucenetestcas 3 1.evalu lucenetestcase.java:523 junit org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:149 junit org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:51 noformat 's happen test reverse-sort string field docvalu test gotten slowmultireaderwrapp commit fix test avoid test case need better fix under bug multiindexdocvalu merg sort sourc think yet somehow 's pretend test three sub bytes_fixed_sort type typepromot happili claim merg bytes_fixed_sort think multiindexdocvalu return null sort sourc case
taxonomyreader.refresh broken replac logic reopen follow ir.reopen pattern recreat taxonomi index tr 's assumpt categori ad hold anymor result call tr.refresh incorrect best usual throw aioob
add constant newer java version constants.class remov outdat one prepar lucene-3235 add constant quick detect java6 java7 constants.java also deprec remov outdat histor java version
field name wrong store field term vector merg good news bug exist trunk bad news it time creat accid lucene-2881 good news strike fair rare segmentmerg sometim incorrect think bulk-copi tvs/store field field number n't map name across segment think happen addindex index pre-trunk segment sm fals think bulk-merg last field number field name across segment
testbackwardscompat need term u+e000 u+ffff chang sort order 4.0 sophist backward compat e.g surrog danc n't test testbackwardscompat exampl noth handl case term vector
renam expungedelet similar optim expungedelet mislead name alreadi problem user list tieredmergepolici n't expung delet also think expung wrong word expung make seem like wrangl delet kick parti fast
testsort testparallelmultisort reproduc seed failur trunk r1202157 code junit testsuit org.apache.lucene.search.testsort junit test run 1 failur 1 error 0 time elaps 0.978 sec junit junit standard error junit note reproduc ant test -dtestcase=testsort -dtestmethod=testparallelmultisort -dtests.seed=-2996f3e0f5d118c2:32c8e62dd9611f63:7a90f44586ae8263 -dargs= -dfile.encoding=utf-8 junit warn test method testparallelmultisort left thread run thread pool-1-thread-1,5 main junit warn test method testparallelmultisort left thread run thread pool-1-thread-2,5 main junit warn test method testparallelmultisort left thread run thread pool-1-thread-3,5 main junit note test param codec=lucene40 short=lucene40 minblocksize=98 maxblocksize=214 contents=postingsformat name=mocksep byte=postingsformat name=simpletext int=pulsing40 freqcutoff=4 minblocksize=58 maxblocksize=186 string=postingsformat name=nestedpuls i18n=lucene40 minblocksize=98 maxblocksize=214 long=postingsformat name=memori double=pulsing40 freqcutoff=4 minblocksize=58 maxblocksize=186 parser=mockvariableintblock baseblocksize=88 float=lucene40 minblocksize=98 maxblocksize=214 custom=postingsformat name=mockrandom sim=randomsimilarityprovid querynorm=fals coord=fals short=bm25 k1=1.2 b=0.75 tracer=dfr ne b2 byte=dfr ne b3 800.0 contents=ib ll-lz 0.3 int=dfr n bz 0.3 string=ib ll-d3 800.0 i18n=dfr gb2 double=dfr ne b2 long=dfr gb1 parser=dfr gl2 float=bm25 k1=1.2 b=0.75 custom=dfr ne z 0.3 locale=ga_i timezone=america/louisvill junit note test run jvm junit testsort junit note linux 3.0.6-gentoo amd64/sun microsystem inc. 1.6.0_29 64-bit /cpus=8 threads=4 free=78022136 total=125632512 junit junit testcas testparallelmultisort org.apache.lucene.search.testsort fail junit expect zj jz junit junit.framework.assertionfailederror expect zj jz junit org.apache.lucene.search.testsort.assertmatch testsort.java:1245 junit org.apache.lucene.search.testsort.assertmatch testsort.java:1216 junit org.apache.lucene.search.testsort.runmultisort testsort.java:1202 junit org.apache.lucene.search.testsort.testparallelmultisort testsort.java:855 junit org.apache.lucene.util.lucenetestcas 3 1.evalu lucenetestcase.java:523 junit org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:149 junit org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:51 junit junit junit test org.apache.lucene.search.testsort fail code
directorytaxonomywrit throw proper except close dirtaxowrit may throw random except npe alreadi close depend api call closed/rollback detect front alreadi close throw alreadyclosedexcept also lucene-3573 doron point problem dtw.rollback call close rather refreshread fix well issu
4.0 postingsread n't obey disi contract tri refactor notic funki thing go codec one problem docidsetiter say follow noformat return follow ul li -1 link no_more_doc link nextdoc link advanc int call yet noformat 4.0 docs/docsandpositionsenum n't actual e.g return 0 instead reli scorer cover inconsist scorer actual reli upon behavior exampl look reqexclscorer.tononexclud call docid exclud part call nextdoc need either fix enum chang enum extend docidsetiter redefin actual contract enum chang docidsetiter someth els fix enum return -1 uniniti kinda suck one sum document delta
numericutils.floattosortableint/doubletosortablelong sort certain nan rang correct numericrangequeri produc wrong result nan half-open rang current implement floattosortableint account differ nan rang may result nan sort -infin +infin default java order nan infin possibl fix make nan canon quiet nan code canonic nan rang assum check faster v v fals fpu n't distinguish differ flavor nan see http //en.wikipedia.org/wiki/nan guess java n't matter much anyway v 0x7fffffff 0x7f800000 appli logic canon quiet nan return 0x7fc00000 0x80000000 code n't commit n't know much exist stuff reli nobodi keep differ nan index know
benchmark test alway fail window directori remov seem bug recent introduc idea 's wrong attach log file reproduc everytim
bulk post codec privat lucene-2723 lot work done speed lucen 's bulk post read api upsid could specifi thing like dont care frequenc data front made thing like multitermquery- filter consum don't care freq faster unrel bulk separ patch lucene-2929 buffers standardcodec increas 128 increas perform termqueri unrel serious downsides/nocommit api hairi tri one-size-fits-al made consum code crazi api could realli special codec e.g could never take advantag e.g doc freq align api forc codec implement delta encod thing like document posit total codec want encod codec might use delta encod use api posit theoret would super complic doubt ever perform maintain regress advanc probabl api forc linear scan thru remain buffer refil think cleaner approach let codec whatev want implement disi contract let codec freedom implement whatev compression/buff want best perform keep consum simpl codec use delta encod want defer last possibl minut decod time that busi mayb codec n't want buffer
choos specif directori implement run checkindex main possibl choos specif directori implement use checkindex process run main addit main paramet fact 'm experienc problem mmapdirectori work big segment fail attempt play maxchunks decid switch anoth fsdirectori implement need main also consid use fileswitchdirectori 'm will contribut could pleas let know thought
tri harder prevent sigsegv clone mmapindexinput unmap mmap byte buffer disallow jdk risk sigsegv access map byte buffer unmap current prevent main indexinput set buffer null npe somebodi tri access under buffer recent fix also stupid curbuf lucene-3200 set null big problem clone indexinput general close still contain refer unmap bytebuff lead sigsegv easili patch mike lucene-3439 prevent lucen 3.5 still 100 safe use non-volatil patch fix remain issu also set buffer clone null origin close trick record weak refer clone creat close togeth origin use concurrenthashmap weakrefer mmapindexinput store logic borrow weakhashmap cleanup gced refer use referencequeu respin 3.5 mayb also get
bytesref copi short miss length set store short type integ bytesref bytesref miss length set caus storag size zero continu option bytesref
add filter return document without valu field situat would use filter simpli return document either least one valu certain field n't someth like box ad seem straight forward
backport fieldcachetermsfilt code duplic remov 3.x trunk alreadi clean fieldcachetermsfilt duplic code fieldcacherangefilt issu simpli backport
refactor fieldcacherangefilter.fieldcachedocidset separ class fix danger matchdoc throw aioob requir followup lucene-3593 fieldcacherangefilter.fieldcachedocidset class strang requir abstract matchdoc throw aioob docid maxdoc check done caller especi trunk e.g fieldcachetermsfilt seem alway throw except correct getord method array termsindex cach also 3.x filter correct respect delet fieldcach base reopen reader use issu refactor fix bug move docid check iter
directorytaxonomywrit extens abl set intern index writer config attribut info stream current protect openindexwrit directori directori openmod openmod provid access iwc creat extens must reimplement method complet order set e.f. info stream intern index writer came user question taxonomi index debug |http //lucene.472066.n3.nabble.com/taxonomy-indexer-debug-td3533341.html
improv infostream class trunk consist logging-framework like slf4j/log4j/commons-log followup thread shai erea java-dev lao|http //lucene.472066.n3.nabble.com/indexwriter-infostream-is-final-td3537485.html alreadi discuss robert one thing miss current iw check infostream =null pass messag method *may* ignor requir case enabl disabl dynam unfortun construct messag heavi wast resourc would like add anoth method class abstract boolean isen also implement would replac null check iw method default config iw would chang use nooutputinfostream return fals ignor messag simpl logger wrapper e.g log4j slf4j could look like ignor compon could enabl code java loger log yourloggingframework.getlogg indexwriter.class public void messag string compon string messag log.debug compon messag public boolean isen string compon return log.isdebugen code use could enable/dis log live e.g log4j manag consol app server enabling/dis indexwriter.class log chang realli simpl printstreaminfostream return true alway maby make dynam enable/dis allow shai 's request infostream.getdefault never null never set null instead default singleton nooutputinfostream return fals isen compon null check infostream replac infostream.iseanbl compon possibl alway null slowdown 's like collections.emptylist instead stupid null check
haversin broken misdocu distanceutils.haversin code way erron base document order paramet paramet defin x1 y1 x2 y2 radius i.e lon lat order code implement algorithm howev mean x y transpos mean suppli argument lat lon y x order get correct behavior turn caller method fyi found bug sinc inherit code lsp lucene-spatial-playground suppli paramet accord document order appar n't
blockjoinqueri advanc fail assert case singl parent child segment blockjoinqueri fail assert advanc call segment singl parent child call parentbits.prevsetbit parenttarget 1 caus -1 return assert fail though valid remov assert fix problem sinc nextdoc handl proper also n't understand assert parenttarget 0 comment parent must one child n't realli reason add constraint far tell call nextdoc case
testiwondiskful unreferenc file failur note reproduc ant test -dtestcase=testindexwriterondiskful -dtestmethod=testadddocumentondiskful -dtests.seed=aff9b14dd518cfb:4d2f112726e2947f -2b03094a43a947e -dtests.multiplier=3 -dargs= -dfile.encoding=iso8859-1 reproduc time
add join queri lucen solr psuedo join queri think also avail lucen
revisit segments.gen sleep lucene-3601 work chang intent crash un-fsync file test ensur call sync file think would nice alway fix test pass super-slow sometim corrupt unsync segments.gen caus sis.read take 500ms time checkindex reason twice seem wrong workaround test partial crash avoid corrupt segments.gen want creat issu discuss sleeping/non-fsync segments.gen guess possibl someon could hit slow
make indexread realli read-on lucen 4.0 chang api complet lucen 4.0 also free remov read-writ access commit indexread code hairi buggi investig robert mike today work segmentread level forget flush directoryread better realli make indexread readon current indexread thing like delete/undelet document done indexwrit use deletebyqueri chang norm bad idea general remov norm replac docvalu obsolet alreadi chang docvalu also done use indexwrit trunk readi
multifields.getuniquefieldcount broken return terms.siz term lazy-init wrong return 0 simplest fix would return -1
booleanfilt chang behavior 3.5 longer act minimum match set 1 chang lucene-3446 caus chang behavior booleanfilt use work minimum match claus 1 compar bq lingo claus match claus ignor exampl must claus one use return exampl singl must claus claus claus match anyth match anyth match whatev must claus match fix simpl iter claus aggreg bitset null return null
remov _x.fnx current store global per-seg field number- name map _x.fnx howev n't actual save us perform e.g indexwrit 's init sinc lucene-2984 load fieldinfo anyway comput file ifd etc that hasprox/hasvector addit past global file like share doc store caus us problem recent fix bug relat file lucene-3601 final troubl backward compat difficult handl global file codec mechan
make easier run test2bterm current test2bterm ignor annot mean way run test edit file coupl option fix add main invok via command line outsid test framework add new annot mark slow week someth like test target ignor slow whatev default also turn
graduat appendingcodec contrib/misc test pass codec least mayb n't test two-phas commit stuff well n't requir special client side configur anymor work set indexwrit go work compound file format n't think need live contrib anymor
trunk switch omitnorm index get corrumpt norm file document 1 bodi norms=tru titl norms=tru document 2 bodi norms=fals titl norms=tru see bodi first time normswriterperfield get initi fieldinfo save away say norms=tru howev flush time dont check write norm happili anyway segmentread read norm later skip bodi sinc omit norm ask norm titl instead return bogus bodi norm assert segmentread plan read whole .nrm file expos bug
filterindexread overrid indexread method filterindexread overrid indexread method ve hit error lucene-3573 fix thought write simpl test assert fir overrid method ir filter method n't think overrid test simpl attach current fail method code getrefcount incref tryincref decref reopen reopen reopen reopen clone numdeleteddoc document setnorm setnorm termposit deletedocu deletedocu undeleteal getindexcommit getuniquetermcount getterminfosindexdivisor code n't yet fix anyth fir spot method think overrid deleg pleas comment
switch appendingcodec use append blocktre current still use block term fix gap index
separ indexdocvalu interfac implement current o.a.l.index.valu contain abstract api lucene40 's current implement think move implement underneath lucene40codec leav abstract api exampl simpletext might differ implement might make int8 implement underneath preflexcodec support norm
segmentreader.getfieldnam ignor fieldoption.doc_valu use getfieldnam api segmentmerg merg someth n't segmentread e.g filterindexread look use filterindexread call addindex reader docvalu simpli drop dont think enough note field docvalu either right need also set type correct merg field info would impli instead fieldoption.docvalu need fieldopt valuetyp correct updat type look fi.update/setdocvalu n't look like type-promot anyway
throw except multi-sortedsourc instead return null spinoff lucene-3623 current addindex fir similar get npe deep within codec merg think npe confus look like bug clearer except would improv
fieldvaluefitl expos field use fieldvaluefitl expos field use current hide entir
make pkindexsplitt multipassindexsplitt work per segment spinoff lucene-3624 docvaluesw merger throw except iw.addindex slowmultireaderwrapp string-index like docvalu provid assortedsourc
corruptindexexcept index failur occur segment file creation byte written fsdirectory.createoutput use randomaccessfil work system default fsdirectory.open creat niofsdirectori createoutput call segments_* file crash occur randomaccessfil creation file system show segments_* file exist zero byte byte written file subsequ indexwrit proceed difficulti know clear empti segments_* file none file delet happen segment file open byte read determin format version initi propos patch file attach
cut norm docvalu sinc ir fulli r/o norm insid codec cut use idv impl write norm lucene-3606 ideas|http //issues.apache.org/jira/browse/lucene-3606 focusedcommentid=13160559 page=com.atlassian.jira.plugin.system.issuetabpanel comment-tabpanel comment-13160559 could implement
multiread parallelread accid overrid doopenifchang boolean readon doopenifchang boolean doclon found ad deprec rw access lucene-3606 base class defin doopenifchang boolean readon multiread parallelread overrid method signatur doopenifchang doclon miss overrid make consum call ir.openifchang boolean readon wrong thing instead get uoe like unimpl doopenifchang method mr pr easi fix renam hide intern reopen method like directoryread
remov write access segmentread possibl move separ class indexwriter/buffereddeletes/ lucene-3606 finish todo segmentread still contain package-priv delet logic includ crazi copyonwrit validdoc bit would good segmentread itsself could read-on like indexread two possibl simpl one subclass segmentread make rwsegmentread use indexwriter/buffereddeletes/ directoryread use read-on segmentread would move todo separ class 's reopen/clon method would alway creat ro-segmentread nrt remov write commit stuff segmentread complet move indexwrit 's readerpool must readerpool delet need not-chang view index snapshot unfortun code complic real experi intern indexwrit want lucene-3606 separ code segmentread mark todo mayb mike mccandless help
remov code duplic multireader/directoryread make everyth insid final make indexread readon lucene-3606 need complet differ directoryread multiread current code heavi code duplic violat final pattern differ reopen thing like iscurrent/getdirectory/ issu clean introduc hidden package-priv base class handl reopen incref/decref differ directoryread final field basemultiread multiread directoryread final directoryread static factori public ctor anymor
remov old static main method core random static main method think rare use remov indexread utf32toutf8 english indexread main let list extract sub-fil cfs think move new tool contrib/misc
allow set arbitrari object perfrundata perfrundata use intermediari object perfruntask like set indexreader/writ good allow set arbitrari object e.g creat one task use anoth recent exampl enhanc benchmark packag follow addit facet modul add taxoreader/writ propos add hashmap string object custom perftask set /get propos move ir/iw/tr/tw etc map howev peopl think well
make possibl use searchermanag distribut stat lucene-3555 ad explicit stat method indexsearch must subclass overrid e.g popul distribut stat also imposs searchermanag one idea make factori method similar indexsearch instead n't need subclass overrid initi searcherwarm except current lot hair warm prime exampl searcher differ mean reader clean otherwis let make nrt/searchermanag subclass way return custom indexsearch
make indexreader.decref call refcount.decrementandget instead getanddecr indexreader.decref code code final int rc refcount.getanddecr rc 1 code think clearer written like code final int rc refcount.decrementandget rc 0 code 's simpl chang make read code least imo easier post patch short
indexreader.docu alway return doc store field load slow index document contain huge field generat digest document huge field unnecessari load field interest part field offset inform indexread alway return whole field content afterward custom storedfieldsread got repeat load
add test case support shard search new test case help stress test api support shard
remov indexsearcher.clos never heavi sinc pass ir is.clos truli no-op think remov
multiread propag readerfinishedlisten clones/reopen reader work refactor multireader/directoryread trunk found multiread correct pass readerfinishedlisten clone reopen reader
edgengram creat invalid offset user report caus highlight throw error
improv filteredqueri shortcut wrap matchalldocsqueri sinc rewrit lucen trunk deleg filter logic filteredqueri simpli wrap indexsearcher.wrapfilt short circuit improv queri execut common use case pass matchalldocsqueri queri indexsearch filter under hit collect stupid slow matchalldocsqueri simpli increment docid check acceptdoc filter spars big wast patch chang filteredquery.rewrit short circuit return constantscorequeri queri matchalldoc
problem ir 's readerfinishedlisten two major problem 1 listen api realli appli indexread exampl segmentread dont fire close segmentcoreread wrong segmentcoreread *not* indexread furthermor regist top-level reader get event anyth reader tree sometim unless segmentread mention doesnt work correct 2 furthermor listen pass along viral fashion clone reopen mean exampl tri listen reader nrt search accumul reader listen potenti keep refer old indexread order deal 1 listen must keep refer ir regist check that *really* one discuss fix 1 creat patch 2 short commit plain wrong
remov unnecessari array wrap call vararg method vararg method caller n't wrap arg array
throw except fieldcach non-atom reader lucen 4.0 go lot effort prevent slow use non-atom reader directoryreader/multiread etc throw except n't tri access post docvalu api per-seg etc biggest trap still easi fall n't fieldcach think throw except forc user either chang code use slowmultireaderwrapp
docvalu merg associ lead differ result depend upon merg execut recent crank testduelingcodec actual test docvalu previous n't test test simpl index random content 2 differ indexwrit allow use differ codec differ indexwriterconfig assert index equal sometim alway bytes_fixed_deref type end one reader zero-fil byte doc document reader docvalu
speed segementdocsenum make friend jit optim sinc move bulk read codec ie make bulk read codec privat lucene-3584 seen perform regression|http //people.apache.org/~mikemccand/lucenebench/term.html differ cpus tri optim implement make elig runtim optim tri make loop jit friend move branch minim member access loop use final member possibl special two common case without livedoc attach patch benchmark result minut
move o.a.l.index.codec o.a.l.codec packag name get pretti long e.g org.apache.lucene.index.codecs.lucene40.values.xxxxyyyy think move codec packag wo n't caus anyon troubl
lucen search scall ve notic thousand search singl thread averag time quit low i.e millisecond ad concurr search exact search averag time increas drastic ve profil search class found whole lucen block org.apache.lucene.index.segmentcorereaders.gettermsread org.apache.lucene.util.virtualmethod public synchron int getimplementationdist org.apache.lucene.util.attributesourcew.getattributeinterfac caus search time increas millisecond 2 second 500 concurr search memori index note index updat refresh method call stage question need synchron must non-lock solut basic caus lucen ok singl thread applic disastr concurr implement ll experi remov synchron method class
indexread 's add/removecloselisten use concurrenthashmap synchron set use-cas concurrenthashmap mani thread read less write structur funni reader close use synchron hashset complex chm make joke
nrtcachingdir invalid assert file name written twice normal lucen write-onc except segments.gen file nrtcachingdir never cach test testdoc testcrash write file n't think nrtcachingdir assert think createoutput remov old file present also found fix possibl concurr issu one thread sync time indexwrit n't ever today past
indexwrit hit non-ioexcept indexexist leak write.lock rest iw 's ctor care indexreader.indexexist catch ioexcept return fals problem occur except test unsupportedoperationexcept imagin other possibl tri e.g read segment file think need move ir.exist stuff insid tri final
move delet codec lucene-3631 easier think n't look much ll play around bit glanc segmentread bit livedoc instead bitvector address todo iw-us ctor segmentread n't take parent exist core need type minim mutablebit similar subinterfac bit bitvector mayb fixed/openbitset could implement bitvector becom impl detail move codec mayb share base class split 3.x/4.x rather condit backward think invertal use indexwrit instead defin codec interfac say give new mutablebit default set redund internally-consist check checklivecount done codec impl instead segmentread plain text impl simpletext
extend levenshteinautomata support transposit primit edit would nice improv spell correct current transposit count 2 edit mean user directspellcheck must use larger valu n e.g 2 instead 1 larger prioriti queue size plus sort re-rank anoth distanc measur good result instead integr chapter 7 http //citeseerx.ist.psu.edu/viewdoc/summari doi=10.1.1.16.652 build altern dfa transposit singl edit http //en.wikipedia.org/wiki/damerau e2 80 93levenshtein_dist accord benchmark origin paper perform levt look similar lev support moman https //bitbucket.org/jpbarrette/moman/ thank jean-philipp barrette-lapierr
make weightedspantermextractor extens handl custom queri implemen current custom queri subclass queri direct ca n't use queryscor highlight sinc explicit instanceof check case possibl rewrit queri pass highlight obtain primit queri howev usecas possibl ie origin index avail machin highlight result still use highlight copi bunch code due visibl issu class think make extens minor effort allow usecas without massiv code duplic
offset issu multiword synonym report list strang offset fstsynonym case multiword synonym workaround suggest use older synonym impl bug differ way
add typetokenfilt would conveni typetokenfilt filter token type either exclud includ list might stupid thing provid peopl use lucen direct would use later expos solr lucene-back search solut
indexcommit.equ bug indexcommit.equ check equal directori version n't check imho import generat number look like commit realli identifi combin directori segments_xxx mean generat number 's directoryreader.open check bug lead unexpect behavior chang commit userdata get two commit declar equal version differ generat number idea situat treat dozen refer indexcommit.equ across lucen surfac fix trivial either add gen number equal use gen number instead version howev 's puzzl two would ever get sync alway suppos sync mayb n't need mayb generat version suffici
support sortedsourc multidocvalu multidocvalu n't support sort variant ie sortedsourc throw unsupportedoperationexcept forc user work per segment consist support sortedsourc also wrap docvalu mdv
remov old byte norm api indexread followup lucene-3628 remov api use docvalu everywher allow norm arbitrari size futur byte
testaddindex fail norm file found ant test-cor -dtestcase=testaddindex -dtestmethod=testaddindexeswithrollback -dtests.seed=2f55291b308dc34b -4d72bfad34f3f357:4bc5ec894269c041 -dargs= -dfile.encoding=utf-8 -dtests.iter=100 fail 4 5 time 100
replac indexreader.getfieldnam indexreader.getfieldinfo
except consist o.a.l.stor minor improv alway use eofexcept eof alway includ inputstream know filenam etc use filenotfoundexcept consist cfs sub-fil found
fst.byte2 save fix 2 byte vint current write byte1 singl byte byte2/4 vint think 's confus also fst new kuromoji analyz lucene-3305 write 2 byte instead shrank fst ran faster presum valu 16384 128 separ whole input_typ confus realli 's declar allow rang charact input alphabet thing use write/readlabel method well confus sugar method builder sure fix yet 's simpl chang chang fst binari format user w/ fsts rebuild fst mark experiment
add deprec transit api document/field think 4.0 deprec transit api field new field field.store.xxx field.index.yyi like combin would predefin fieldtyp use behind scene use deprec ctor sure would n't total backward binari compat field.java must noth think would elimin big hurdl peopl want check 4.x
add offset post d penum think explor make start/end offset first-class attr post api fix index index post make term vector access cleaner jump hoop w/ non-first-class offset attr also enabl effici highlight without term vector reanalyz app index offset post
add top-down version blockjoinqueri today blockjoinqueri join child docid parent docid eg work well product parent mani skus child search revers bjq also use case eg say index song child within album parent want search present song album involv field album queri case want wrap parent queri album join child document space
enhancementspayloaditerator.getcategorydata categoryenhanc problemat usag object.equ enhancementspayloaditer intern list categori enhancemnet getcategorydata categoryenhanc lookup given categoryenhanc list order make sure lookup work categoryenhanc must overrid object.equ object
allow similar encod norm singl byte lucene-3628 cut norm docvalu remov long stand limit norm singl byte yet still need expos function similar write encod norm differ format
jflex-bas htmlstripcharfilt replac jflex-bas htmlstripcharfilt replac would perform easier understand maintain
documentswrit block flush applydelet take forev memori releas documentswrit safeti check appli delet delet consum much ram prevent too-frequ flush long tail tini segment enter applyalldelet essenti lock iw buffereddelet fine sinc usual n't take long n't keep dwpts index yet take long time semgent flush subsequ publish iw take lock ticket queue iw prevent thread append ticketqueu done actual flush segment concurr free ram essenti ok block iw lock keep concurr flush execut appli delet thread block tri execut maybemerg segment flush n't pile subsequ memori actual allow dwpt flush sinc actual tri get rid memori ran accid due code bug use delet queri instead term document thread dump show problem noformat applic worker thread prio=10 tid=0x00007fdda0238000 nid=0x3256 wait monitor entri 0x00007fddad3c2000 java.lang.thread.st block object monitor org.apache.lucene.index.documentswriter.doflush documentswriter.java:424 wait lock 0x00007fddb74ff990 org.apache.lucene.index.documentswrit ticketqueu org.apache.lucene.index.documentswriter.postupd documentswriter.java:320 org.apache.lucene.index.documentswriter.updatedocu documentswriter.java:393 org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1484 org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1456 org.apache.solr.update.directupdatehandler2.adddoc directupdatehandler2.java:160 applic worker thread prio=10 tid=0x00007fdda0236000 nid=0x3255 wait monitor entri 0x00007fddad4c3000 java.lang.thread.st block object monitor org.apache.lucene.index.indexwriter.updatependingmerg indexwriter.java:1854 wait lock 0x00007fddb74fe350 org.apache.solr.update.solrindexwrit org.apache.lucene.index.indexwriter.maybemerg indexwriter.java:1848 org.apache.lucene.index.indexwriter.maybemerg indexwriter.java:1843 org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1493 org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1456 org.apache.solr.update.directupdatehandler2.adddoc directupdatehandler2.java:160 applic worker thread prio=10 tid=0x00007fdda0234000 nid=0x3254 wait monitor entri 0x00007fddad5c4000 java.lang.thread.st block object monitor org.apache.lucene.index.indexwriter.updatependingmerg indexwriter.java:1854 wait lock 0x00007fddb74fe350 org.apache.solr.update.solrindexwrit org.apache.lucene.index.indexwriter.maybemerg indexwriter.java:1848 org.apache.lucene.index.indexwriter.maybemerg indexwriter.java:1843 org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1493 org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1456 org.apache.solr.update.directupdatehandler2.adddoc directupdatehandler2.java:160 applic worker thread prio=10 tid=0x00007fdda0232000 nid=0x3253 wait monitor entri 0x00007fddad6c5000 java.lang.thread.st block object monitor org.apache.lucene.index.documentswriter.doflush documentswriter.java:424 wait lock 0x00007fddb74ff990 org.apache.lucene.index.documentswrit ticketqueu org.apache.lucene.index.documentswriter.postupd documentswriter.java:320 org.apache.lucene.index.documentswriter.updatedocu documentswriter.java:393 org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1484 org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1456 org.apache.solr.update.directupdatehandler2.adddoc directupdatehandler2.java:160 applic worker thread prio=10 tid=0x00007fdda0230800 nid=0x3252 wait monitor entri 0x00007fddad7c6000 java.lang.thread.st block object monitor org.apache.lucene.index.indexwriter.updatependingmerg indexwriter.java:1854 wait lock 0x00007fddb74fe350 org.apache.solr.update.solrindexwrit org.apache.lucene.index.indexwriter.maybemerg indexwriter.java:1848 org.apache.lucene.index.indexwriter.maybemerg indexwriter.java:1843 org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1493 org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1456 org.apache.solr.update.directupdatehandler2.adddoc directupdatehandler2.java:160 applic worker thread prio=10 tid=0x00007fdda022e800 nid=0x3251 runnabl 0x00007fddad8c6000 java.lang.thread.st runnabl java.nio.bits.copytoarray bits.java:715 java.nio.directbytebuffer.get directbytebuffer.java:233 org.apache.lucene.store.mmapdirectori mmapindexinput.readbyt mmapdirectory.java:319 org.apache.lucene.index.codecs.blocktreetermsread fieldread segmenttermsenum frame.loadblock blocktreetermsreader.java:2283 org.apache.lucene.index.codecs.blocktreetermsread fieldread segmenttermsenum.seekexact blocktreetermsreader.java:1600 org.apache.lucene.util.termcontext.build termcontext.java:97 org.apache.lucene.search.termquery.createweight termquery.java:180 org.apache.lucene.search.booleanqueri booleanweight. init booleanquery.java:186 org.apache.lucene.search.booleanquery.createweight booleanquery.java:423 org.apache.lucene.search.indexsearcher.createnormalizedweight indexsearcher.java:583 org.apache.lucene.search.querywrapperfilter.getdocidset querywrapperfilter.java:55 org.apache.lucene.index.buffereddeletesstream.applyquerydelet buffereddeletesstream.java:431 org.apache.lucene.index.buffereddeletesstream.applydelet buffereddeletesstream.java:268 lock 0x00007fddb751e1e8 org.apache.lucene.index.buffereddeletesstream org.apache.lucene.index.indexwriter.applyalldelet indexwriter.java:2852 lock 0x00007fddb74fe350 org.apache.solr.update.solrindexwrit org.apache.lucene.index.documentswriter.applyalldelet documentswriter.java:188 org.apache.lucene.index.documentswriter.doflush documentswriter.java:470 org.apache.lucene.index.documentswriter.postupd documentswriter.java:320 org.apache.lucene.index.documentswriter.updatedocu documentswriter.java:393 org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1484 org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1456 org.apache.solr.update.directupdatehandler2.adddoc directupdatehandler2.java:160 applic worker thread prio=10 tid=0x00007fdda022d800 nid=0x3250 wait monitor entri 0x00007fddad9c8000 java.lang.thread.st block object monitor org.apache.lucene.index.documentswriter.doflush documentswriter.java:424 wait lock 0x00007fddb74ff990 org.apache.lucene.index.documentswrit ticketqueu org.apache.lucene.index.documentswriter.postupd documentswriter.java:320 org.apache.lucene.index.documentswriter.updatedocu documentswriter.java:393 org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1484 org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1456 org.apache.solr.update.directupdatehandler2.adddoc directupdatehandler2.java:160 applic worker thread prio=10 tid=0x00007fdda022d000 nid=0x324f wait monitor entri 0x00007fddadac9000 java.lang.thread.st block object monitor org.apache.lucene.index.indexwriter.usecompoundfil indexwriter.java:2274 wait lock 0x00007fddb74fe350 org.apache.solr.update.solrindexwrit org.apache.lucene.index.indexwriter.prepareflushedseg indexwriter.java:2156 org.apache.lucene.index.documentswriter.publishflushedseg documentswriter.java:526 org.apache.lucene.index.documentswriter.finishflush documentswriter.java:506 org.apache.lucene.index.documentswriter.applyflushticket documentswriter.java:483 lock 0x00007fddb74ff990 org.apache.lucene.index.documentswrit ticketqueu org.apache.lucene.index.documentswriter.doflush documentswriter.java:449 org.apache.lucene.index.documentswriter.postupd documentswriter.java:320 org.apache.lucene.index.documentswriter.updatedocu documentswriter.java:393 org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1484 org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1456 org.apache.solr.update.directupdatehandler2.adddoc directupdatehandler2.java:160 noformat
add test implement documentswriterperthreadpool current one impl documentswriterperthreadpool add make sure interfac suffici beef test test 'm work random impl select lock state random
docvaluesfield overload setint/setfloat etc see descript lucene-3687 general avoid primit type give uniqu name think instead setint byte setint short setint int setint long setfloat float setfloat doubl setbyt byte setshort short setint int setlong long setfloat float setdoubl doubl
fst builder method need fix document improv type safeti confus way fst builder 4 add method get assert error happen assert disabl use wrong one refer 3 fst input type byte1 byte byte2 char byte4 int builder add method signatur add bytesref add char int offset int len add charsequ add intsref certain method work certain fst input type map one think exampl would think char-bas fst use add char add charsequ case add method actual work int-bas fst use codepointat extract codepoint instead use add intsref char-bas one worst use wrong one get assert error 'm sure happen assert disabl mayb ultim solut parameter fst 's generic input fst input output requir bytesref/charsref/intsref paramet could add might clean fstenum would longer need inputoutput class mayb could use map.entri input output someth think document improv still notic add bytesref javadoc work byte1 think still work even want pursu document fix
fastvectorhighlight simpleboundaryscann work well highlight begin text simpleboundaryscann still break text base charact provid highlight text end scan begin text highlight case use start text offset
fastvectorhighlight add multi valu separ space end highlight text fvh add addit multi valu separ end highlight text
option support naist-jdic kuromoji altern dictionari somewhat larger ~25 support build.xml user want build result jar file 500kb larger
fst api sync trunk/3.x look like offend lucene-3030 sure everyth general use chang public api e.g specifi freezetail super-scari builder ctor among thing mayb sync 3.x
directorytaxonomyreader.refresh misbehav ref count directorytaxonomyread use intern indexread order track refer count howev call refresh reopen intern indexread point previous refer count get lost sinc new indexread 's refcount 1 solut track refer count dtr wrote simpl unit test expos bug attach patch short
deadlock testindexwriterexcept junit 2012-01-18 18:18:16 junit full thread dump java hotspot tm 64-bit server vm 19.1-b02 mix mode junit junit index 3 prio=10 tid=0x0000000041b9b800 nid=0x6291 wait monitor entri 0x00007f7e8868f000 junit java.lang.thread.st block object monitor junit org.apache.lucene.index.documentswriterflushqueue.innerpurg documentswriterflushqueue.java:118 junit wait lock 0x00000000e40ff2a8 org.apache.lucene.index.documentswriterflushqueu junit org.apache.lucene.index.documentswriterflushqueue.trypurg documentswriterflushqueue.java:141 junit org.apache.lucene.index.documentswriter.doflush documentswriter.java:439 junit org.apache.lucene.index.documentswriter.postupd documentswriter.java:317 junit org.apache.lucene.index.documentswriter.updatedocu documentswriter.java:390 junit org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1534 junit org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1506 junit org.apache.lucene.index.testindexwriterexcept indexerthread.run testindexwriterexceptions.java:187 junit junit index 2 prio=10 tid=0x0000000041b9b000 nid=0x6290 wait condit 0x00007f7e8838c000 junit java.lang.thread.st wait park junit sun.misc.unsafe.park nativ method junit park wait 0x00000000e4103100 org.apache.lucene.index.documentswriterstallcontrol sync junit java.util.concurrent.locks.locksupport.park locksupport.java:158 junit java.util.concurrent.locks.abstractqueuedsynchronizer.parkandcheckinterrupt abstractqueuedsynchronizer.java:811 junit java.util.concurrent.locks.abstractqueuedsynchronizer.doacquireshar abstractqueuedsynchronizer.java:941 junit java.util.concurrent.locks.abstractqueuedsynchronizer.acquireshar abstractqueuedsynchronizer.java:1261 junit org.apache.lucene.index.documentswriterstallcontrol.waitifstal documentswriterstallcontrol.java:115 junit org.apache.lucene.index.documentswriterflushcontrol.waitifstal documentswriterflushcontrol.java:591 junit org.apache.lucene.index.documentswriter.preupd documentswriter.java:302 junit org.apache.lucene.index.documentswriter.updatedocu documentswriter.java:362 junit org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1534 junit org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1506 junit org.apache.lucene.index.testindexwriterexcept indexerthread.run testindexwriterexceptions.java:187 junit junit index 1 prio=10 tid=0x0000000042500000 nid=0x628f wait monitor entri 0x00007f7e8858e000 junit java.lang.thread.st block object monitor junit org.apache.lucene.index.documentswriterflushqueue.addseg documentswriterflushqueue.java:84 junit wait lock 0x00000000e40ff2a8 org.apache.lucene.index.documentswriterflushqueu junit org.apache.lucene.index.documentswriter.doflush documentswriter.java:424 junit org.apache.lucene.index.documentswriter.postupd documentswriter.java:317 junit org.apache.lucene.index.documentswriter.updatedocu documentswriter.java:390 junit org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1534 junit org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1506 junit org.apache.lucene.index.testindexwriterexcept indexerthread.run testindexwriterexceptions.java:187 junit junit index 0 prio=10 tid=0x0000000041508000 nid=0x628d wait condit 0x00007f7e8848d000 junit java.lang.thread.st wait park junit sun.misc.unsafe.park nativ method junit park wait 0x00000000e414b408 java.util.concurrent.locks.reentrantlock nonfairsync junit java.util.concurrent.locks.locksupport.park locksupport.java:158 junit java.util.concurrent.locks.abstractqueuedsynchronizer.parkandcheckinterrupt abstractqueuedsynchronizer.java:811 junit java.util.concurrent.locks.abstractqueuedsynchronizer.acquirequeu abstractqueuedsynchronizer.java:842 junit java.util.concurrent.locks.abstractqueuedsynchronizer.acquir abstractqueuedsynchronizer.java:1178 junit java.util.concurrent.locks.reentrantlock nonfairsync.lock reentrantlock.java:186 junit java.util.concurrent.locks.reentrantlock.lock reentrantlock.java:262 junit org.apache.lucene.index.documentswriterflushqueue.forcepurg documentswriterflushqueue.java:130 junit org.apache.lucene.index.documentswriterflushqueue.adddeletesandpurg documentswriterflushqueue.java:50 junit lock 0x00000000e40ff2a8 org.apache.lucene.index.documentswriterflushqueu junit org.apache.lucene.index.documentswriter.applyalldelet documentswriter.java:179 junit org.apache.lucene.index.documentswriter.doflush documentswriter.java:460 junit org.apache.lucene.index.documentswriter.postupd documentswriter.java:317 junit org.apache.lucene.index.documentswriter.updatedocu documentswriter.java:390 junit org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1534 junit org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1506 junit org.apache.lucene.index.testindexwriterexcept indexerthread.run testindexwriterexceptions.java:187 junit junit low memori detector daemon prio=10 tid=0x00007f7e84025800 nid=0x6003 runnabl 0x0000000000000000 junit java.lang.thread.st runnabl junit junit compilerthread1 daemon prio=10 tid=0x00007f7e84022800 nid=0x6002 wait condit 0x0000000000000000 junit java.lang.thread.st runnabl junit junit compilerthread0 daemon prio=10 tid=0x00007f7e8401f800 nid=0x6001 wait condit 0x0000000000000000 junit java.lang.thread.st runnabl junit junit signal dispatch daemon prio=10 tid=0x00007f7e8401d800 nid=0x6000 wait condit 0x0000000000000000 junit java.lang.thread.st runnabl junit junit final daemon prio=10 tid=0x00007f7e84001000 nid=0x5ffa object.wait 0x00007f7e8961b000 junit java.lang.thread.st wait object monitor junit java.lang.object.wait nativ method junit wait 0x00000000e2ece380 java.lang.ref.referencequeu lock junit java.lang.ref.referencequeue.remov referencequeue.java:118 junit lock 0x00000000e2ece380 java.lang.ref.referencequeu lock junit java.lang.ref.referencequeue.remov referencequeue.java:134 junit java.lang.ref.fin finalizerthread.run finalizer.java:159 junit junit refer handler daemon prio=10 tid=0x000000004101e000 nid=0x5ff9 object.wait 0x00007f7e8971c000 junit java.lang.thread.st wait object monitor junit java.lang.object.wait nativ method junit wait 0x00000000e2ece318 java.lang.ref.refer lock junit java.lang.object.wait object.java:485 junit java.lang.ref.refer referencehandler.run reference.java:116 junit lock 0x00000000e2ece318 java.lang.ref.refer lock junit junit main prio=10 tid=0x0000000040fb2000 nid=0x5fe2 object.wait 0x00007f7e8ecc1000 junit java.lang.thread.st wait object monitor junit java.lang.object.wait nativ method junit wait 0x00000000e4105080 org.apache.lucene.index.testindexwriterexcept indexerthread junit java.lang.thread.join thread.java:1186 junit lock 0x00000000e4105080 org.apache.lucene.index.testindexwriterexcept indexerthread junit java.lang.thread.join thread.java:1239 junit org.apache.lucene.index.testindexwriterexceptions.testrandomexceptionsthread testindexwriterexceptions.java:286 junit sun.reflect.nativemethodaccessorimpl.invoke0 nativ method junit sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:39 junit sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:25 junit java.lang.reflect.method.invok method.java:597 junit org.junit.runners.model.frameworkmethod 1.runreflectivecal frameworkmethod.java:44 junit org.junit.internal.runners.model.reflectivecallable.run reflectivecallable.java:15 junit org.junit.runners.model.frameworkmethod.invokeexplos frameworkmethod.java:41 junit org.junit.internal.runners.statements.invokemethod.evalu invokemethod.java:20 junit org.junit.rules.testwatchman 1.evalu testwatchman.java:48 junit org.apache.lucene.util.lucenetestcas 3 1.evalu lucenetestcase.java:528 junit org.junit.internal.runners.statements.runbefores.evalu runbefores.java:28 junit org.junit.internal.runners.statements.runafters.evalu runafters.java:31 junit org.junit.runners.blockjunit4classrunner.runchild blockjunit4classrunner.java:76 junit org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:165 junit org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:57 junit org.junit.runners.parentrunn 3.run parentrunner.java:193 junit org.junit.runners.parentrunn 1.schedul parentrunner.java:52 junit org.junit.runners.parentrunner.runchildren parentrunner.java:191 junit org.junit.runners.parentrunner.access 000 parentrunner.java:42 junit org.junit.runners.parentrunn 2.evalu parentrunner.java:184 junit org.junit.internal.runners.statements.runbefores.evalu runbefores.java:28 junit org.junit.internal.runners.statements.runafters.evalu runafters.java:31 junit org.junit.runners.parentrunner.run parentrunner.java:236 junit junit.framework.junit4testadapter.run junit4testadapter.java:39 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.run junittestrunner.java:420 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.launch junittestrunner.java:911 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.main junittestrunner.java:743 junit junit vm thread prio=10 tid=0x0000000041017800 nid=0x5fef runnabl junit junit gc task thread 0 parallelgc prio=10 tid=0x0000000040fc5000 nid=0x5fe3 runnabl junit junit gc task thread 1 parallelgc prio=10 tid=0x0000000040fc7000 nid=0x5fe4 runnabl junit junit gc task thread 2 parallelgc prio=10 tid=0x0000000040fc9000 nid=0x5fe5 runnabl junit junit gc task thread 3 parallelgc prio=10 tid=0x0000000040fca800 nid=0x5fe6 runnabl junit junit gc task thread 4 parallelgc prio=10 tid=0x0000000040fcc800 nid=0x5fe7 runnabl junit junit gc task thread 5 parallelgc prio=10 tid=0x0000000040fce800 nid=0x5fe8 runnabl junit junit gc task thread 6 parallelgc prio=10 tid=0x0000000040fd0000 nid=0x5fe9 runnabl junit junit gc task thread 7 parallelgc prio=10 tid=0x0000000040fd2000 nid=0x5fea runnabl junit junit vm period task thread prio=10 tid=0x00007f7e84030000 nid=0x6004 wait condit junit junit jni global refer 1578 junit junit junit found one java-level deadlock junit junit index 3 junit wait lock monitor 0x0000000041477498 object 0x00000000e40ff2a8 org.apache.lucene.index.documentswriterflushqueu junit held index 0 junit index 0 junit wait ownabl synchron 0x00000000e414b408 java.util.concurrent.locks.reentrantlock nonfairsync junit held index 3 junit junit java stack inform thread list junit junit index 3 junit org.apache.lucene.index.documentswriterflushqueue.innerpurg documentswriterflushqueue.java:118 junit wait lock 0x00000000e40ff2a8 org.apache.lucene.index.documentswriterflushqueu junit org.apache.lucene.index.documentswriterflushqueue.trypurg documentswriterflushqueue.java:141 junit org.apache.lucene.index.documentswriter.doflush documentswriter.java:439 junit org.apache.lucene.index.documentswriter.postupd documentswriter.java:317 junit org.apache.lucene.index.documentswriter.updatedocu documentswriter.java:390 junit org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1534 junit org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1506 junit org.apache.lucene.index.testindexwriterexcept indexerthread.run testindexwriterexceptions.java:187 junit index 0 junit sun.misc.unsafe.park nativ method junit park wait 0x00000000e414b408 java.util.concurrent.locks.reentrantlock nonfairsync junit java.util.concurrent.locks.locksupport.park locksupport.java:158 junit java.util.concurrent.locks.abstractqueuedsynchronizer.parkandcheckinterrupt abstractqueuedsynchronizer.java:811 junit java.util.concurrent.locks.abstractqueuedsynchronizer.acquirequeu abstractqueuedsynchronizer.java:842 junit java.util.concurrent.locks.abstractqueuedsynchronizer.acquir abstractqueuedsynchronizer.java:1178 junit java.util.concurrent.locks.reentrantlock nonfairsync.lock reentrantlock.java:186 junit java.util.concurrent.locks.reentrantlock.lock reentrantlock.java:262 junit org.apache.lucene.index.documentswriterflushqueue.forcepurg documentswriterflushqueue.java:130 junit org.apache.lucene.index.documentswriterflushqueue.adddeletesandpurg documentswriterflushqueue.java:50 junit lock 0x00000000e40ff2a8 org.apache.lucene.index.documentswriterflushqueu junit org.apache.lucene.index.documentswriter.applyalldelet documentswriter.java:179 junit org.apache.lucene.index.documentswriter.doflush documentswriter.java:460 junit org.apache.lucene.index.documentswriter.postupd documentswriter.java:317 junit org.apache.lucene.index.documentswriter.updatedocu documentswriter.java:390 junit org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1534 junit org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1506 junit org.apache.lucene.index.testindexwriterexcept indexerthread.run testindexwriterexceptions.java:187 junit junit found 1 deadlock junit junit heap junit psyounggen total 67136k use 4647k 0x00000000f5560000 0x00000000fbc60000 0x0000000100000000 junit eden space 65792k 5 use 0x00000000f5560000,0x00000000f58a5e10,0x00000000f95a0000 junit space 1344k 96 use 0x00000000f9740000,0x00000000f98840a0,0x00000000f9890000 junit space 19840k 0 use 0x00000000fa900000,0x00000000fa900000,0x00000000fbc60000 junit psoldgen total 171392k use 66868k 0x00000000e0000000 0x00000000ea760000 0x00000000f5560000 junit object space 171392k 39 use 0x00000000e0000000,0x00000000e414d080,0x00000000ea760000 junit pspermgen total 21248k use 14733k 0x00000000dae00000 0x00000000dc2c0000 0x00000000e0000000 junit object space 21248k 69 use 0x00000000dae00000,0x00000000dbc635a8,0x00000000dc2c0000 junit
add offset lucene40 post lucene-3684 ad support indexoptions.docs_and_freqs_and_positions_and_offset simpletext implement think implement 4.0 codec start lucene40postingsformat
add lucene3x privat segmentinfosformat implemen still n't lucene3x preflex version segment info format need releas 4.0
codec post api finishdoc inconsist finishdoc say noformat call done ad posit payload doc call field omit term freq posit public abstract void finishdoc throw ioexcept noformat confus field omit posit call wrong merg call alway even freq+posit omit think fix javadoc fix freqproxtermswrit alway call finish
norm read fail filenotfound except case ca n't get bottom alway add fileexist check back noformat junit testsuit org.apache.lucene.index.testindexwriterexcept junit testcas testrandomexceptionsthread org.apache.lucene.index.testindexwriterexcept caus error junit sub-fil id _nrm.cfs found filename=_19_nrm.cf file .fdt .fnm .per .fdx junit java.io.filenotfoundexcept sub-fil id _nrm.cfs found filename=_19_nrm.cf file .fdt .fnm .per .fdx junit org.apache.lucene.store.compoundfiledirectory.createslic compoundfiledirectory.java:313 junit org.apache.lucene.store.compoundfiledirectory. init compoundfiledirectory.java:65 junit org.apache.lucene.codecs.lucene40.lucene40docvaluesproducer. init lucene40docvaluesproducer.java:48 junit org.apache.lucene.codecs.lucene40.lucene40normsformat lucene40normsdocvaluesproducer. init lucene40normsformat.java:70 junit org.apache.lucene.codecs.lucene40.lucene40normsformat.docsproduc lucene40normsformat.java:49 junit org.apache.lucene.codecs.lucene40.lucene40normsformat.docsproduc lucene40normsformat.java:62 junit org.apache.lucene.index.segmentcorereaders. init segmentcorereaders.java:122 junit org.apache.lucene.index.segmentreader. init segmentreader.java:54 junit org.apache.lucene.index.directoryread 1.dobodi directoryreader.java:65 junit org.apache.lucene.index.segmentinfo findsegmentsfile.run segmentinfos.java:660 junit org.apache.lucene.index.directoryreader.open directoryreader.java:55 junit org.apache.lucene.index.indexreader.open indexreader.java:242 junit org.apache.lucene.index.testindexwriterexceptions.testrandomexceptionsthread testindexwriterexceptions.java:304 junit org.apache.lucene.util.lucenetestcas 3 1.evalu lucenetestcase.java:530 junit org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:165 junit org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:57 junit junit junit test run 22 failur 0 error 1 time elaps 3.439 sec junit junit standard error junit note reproduc ant test -dtestcase=testindexwriterexcept -dtestmethod=testrandomexceptionsthread -dtests.seed=-4ea45cb40d17460b -459bfb455a2351b9:1abd8f0f3a0611b9 -dargs= -dfile.encoding=utf-8 junit note test param codec=lucene40 field=mockvariableintblock baseblocksize=31 id=postingsformat name=nestedpuls content=pulsing40 freqcutoff=2 minblocksize=58 maxblocksize=186 contents=mockvariableintblock baseblocksize=31 content1=mockvariableintblock baseblocksize=31 content2=postingsformat name=mocksep content4=pulsing40 freqcutoff=2 minblocksize=58 maxblocksize=186 content5=mockfixedintblock blocksize=964 content6=postingsformat name=memori content7=postingsformat name=mockrandom crash=postingsformat name=nestedpuls subid=postingsformat name=nestedpuls sim=randomsimilarityprovid querynorm=fals coord=tru other=dfr gb3 800.0 contents=ib spl-l3 800.0 content=dfr gl3 800.0 id=dfr f l1 field=ib ll-dz 0.3 content1=dfr ne bz 0.3 content2=dfr n 3 800.0 content3=dfr gz 0.3 content4=dfr ne b2 content5=ib ll-l3 800.0 content6=ib spl-d2 crash=dfr f 3 800.0 content7=dfr f b3 800.0 subid=ib ll-l1 locale=de_ch timezone=canada/saskatchewan junit note test run jvm junit testassert testnumerictokenstream testsimpleattributeimpl testimperson testpulsingreus testdocu testaddindex testatomicupd testbyteslic testcheckindex testconcurrentmergeschedul testconsistentfieldnumb testcrashcausescorruptindex testdoccount testdocumentwrit testflex testforcemergeforev testindexinput testindexread testindexwriterconfig testindexwriterexcept junit note linux 3.0.0-14-gener amd64/sun microsystem inc. 1.6.0_24 64-bit /cpus=8 threads=1 free=186661872 total=245104640 noformat
small sentinelintset caus infinit loop resiz small initi size =4 caus set rehash soon enough thus go infinit loop search tabl open space
remov unus untest method readerutil also veeeeeri ineffect readerutil contain two method nowher use even test addit implement useless list- array copi ineffect docstart calcul binari search later instead direct return reader scan sure realli work expect readerutil lucene.intern remov 3.x trunk altern useless array copi docstart handl remov test ad code java public static indexread subread int doc indexread reader public static indexread subread indexread reader int subindex code
testindexwriterondiskfull.testaddindexondiskful fail java.lang.illegalstateexcept cfs pend open file noformat testsuit org.apache.lucene.index.testindexwriterondiskful junit testcas testaddindexondiskful org.apache.lucene.index.testindexwriterondiskful caus error junit cfs pend open file junit java.lang.illegalstateexcept cfs pend open file junit org.apache.lucene.store.compoundfilewriter.clos compoundfilewriter.java:162 junit org.apache.lucene.store.compoundfiledirectory.clos compoundfiledirectory.java:206 junit org.apache.lucene.index.indexwriter.createcompoundfil indexwriter.java:4099 junit org.apache.lucene.index.indexwriter.mergemiddl indexwriter.java:3661 junit org.apache.lucene.index.indexwriter.merg indexwriter.java:3260 junit org.apache.lucene.index.serialmergescheduler.merg serialmergescheduler.java:37 junit org.apache.lucene.index.indexwriter.maybemerg indexwriter.java:1902 junit org.apache.lucene.index.indexwriter.forcemerg indexwriter.java:1716 junit org.apache.lucene.index.indexwriter.forcemerg indexwriter.java:1670 junit org.apache.lucene.index.testindexwriterondiskfull.testaddindexondiskful testindexwriterondiskfull.java:304 junit org.apache.lucene.util.lucenetestcas 3 1.evalu lucenetestcase.java:529 junit org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:165 junit org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:57 junit junit junit test run 4 failur 0 error 1 time elaps 31.96 sec junit junit standard error junit note reproduc ant test -dtestcase=testindexwriterondiskful -dtestmethod=testaddindexondiskful -dtests.seed=-7dd066d256827211:127c018cbf5b0975:20481cd18a7d8b6 -dtests.multiplier=3 -dtests.nightly=tru -dargs= -dfile.encoding=iso8859-1 junit note test param codec=simpletext sim=randomsimilarityprovid querynorm=tru coord=fals field=dfr gb1 id=dfr f l1 content=ib spl-d3 800.0 f=dfr g2 locale=de_at timezone=america/cambridge_bay junit note test run jvm junit testassert testsearchfordupl testmockanalyz testdocvalu testperfieldpostingsformat testdocu testaddindex testconcurrentmergeschedul testcrashcausescorruptindex testdoccount testdocumentswriterdeletequeu testfieldinfo testfilterindexread testflex testindexinput testindexwrit testindexwritermergepolici testindexwritermerg testindexwriternrtiscurr testindexwriterondiskful junit note freebsd 8.2-releas amd64/sun microsystem inc. 1.6.0 64-bit /cpus=16 threads=1 free=39156976 total=180748288 noformat
add suggest use shortest path/wfst instead bucket current fst suggest realli fsa quantiz weight bucket e.g singl byte put front word make fast lose granular suggest late question rais build lucen 's fst positiveintoutput behav tropic semir wfst word complet word instead travers min output node find shortest path best suggest highest score mean wouldnt need quantiz weight might make oper e.g ad fuzzi match etc lot easier
add fake charfilt basetokenstreamtestcas find offset bug recent lot issu fix broken offset would nice improv test coverag test work across board especi charfilt basetokenstreamtestcase.checkrandomdata sometim pass analyz reader wrap mockcharfilt one patch sometim doubl charact analyz call correctoffset incorrect offset math lucene-3642 etc eventu creat offset test fail test bug found 2 real bug icutoken call correctoffset end thaiwordfilt incorrect offset math
samplingwrappertest failur certain test seed build https //builds.apache.org/job/lucene-solr-tests-only-trunk/12231/ 1 test fail regress org.apache.lucene.facet.search.samplingwrappertest.testcountusingsamp error messag result stack trace org.apache.lucene.facet.facettestbas notsameresulterror result org.apache.lucene.facet.facettestbase.assertsameresult facettestbase.java:333 org.apache.lucene.facet.search.sampling.basesampletesttopk.assertsampl basesampletesttopk.java:104 org.apache.lucene.facet.search.sampling.basesampletesttopk.testcountusingsamp basesampletesttopk.java:82 org.apache.lucene.util.lucenetestcas 3 1.evalu lucenetestcase.java:529 org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:165 org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:57 note reproduc ant test -dtestcase=samplingwrappertest -dtestmethod=testcountusingsamp -dtests.seed=4a5994491f79fc80 -18509d134c89c159 -34f6ecbb32e930f7 -dtests.multiplier=3 -dargs= -dfile.encoding=utf-8 note test param codec=lucene40 facets=postingsformat name=mockrandom full_path =postingsformat name=mocksep content=pulsing40 freqcutoff=19 minblocksize=65 maxblocksize=209 payload =postingsformat name=lucene40withord sim=randomsimilarityprovid querynorm=tru coord=tru facets=lm jelinek-merc 0.700000 content=dfr n b3 800.0 locale=bg timezone=asia/manila
fvh slow perform larg queri chang hashset arraylist flatqueri lucene-3019 result signific slowdown e-discoveri queri upgrad 3.4.0 3.5.0 queri sometim contain ten thousand term result major portion execut time queri spent flatqueries.contain sourcequeri method call
oom testbeidermorsefilter.testrandom oom' lot see like real bug ant test -dtestcase=testbeidermorsefilt -dtestmethod=testrandom -dtests.seed=2e18f456e714be89:310bba5e8404100d -3bd11277c22f4591 -dtests.multiplier=3 -dargs= -dfile.encoding=iso8859-1
charfilt invok solr solr trunk *all* charfilt non-funct sinc lucene-3396 commit r1175297 25 sept 2011 yonik 's fix today r1235810 solr 3.x affect charfilt work along
make similarities/term/collectionstat take long 2b doc note yonik andrzej solr-1632 would use distribut score also add sugar method add make easier sum
remov fieldmaskingspanqueri fix score lucen 4.0 ad new score mechan fieldmaskingspanqueri serious problem lie field term sometim result total bogus statist case singl term totaltermfreq exceed sumtotaltermfreq entir field sinc lie lie could result nan/inf/neg score except divid zero problem statist imposs bogus
simpletext sumtotaltermfreq wrong posit omit ant test -dtestcase=testomitposit -dtestmethod=testbas -dtests.seed=-6c9bd4a6197b9463 -71d0d11bc2db9a15:697690b3dff2369 -dargs= -dfile.encoding=utf-8 junit java.lang.assertionerror sumtotaltermfreq=0 sumdocfreq=400 junit org.apache.lucene.search.collectionstatistics. init collectionstatistics.java:38 assert fail posit field post imposs memori think simpletext calcul sumtotaltermfreq one fli read posit text file case write stat explicit
add option pack fst build fsts produc builder shrunk will spend highish transient ram builder today tri hard use much ram option tweak ram usag exchang somewhat lager fst even build immens fsts app afford highish transient ram get smaller net fst think offer pack
default kuromojianalyz use search mode kuromoji support option segment text way suitabl search prevent long compound noun index term general how segment import depend applic see http //nlp.stanford.edu/pubs/acl-wmt08-cws.pdf studi chines current algorithm punish cost base paramet search_mode_penalti search_mode_length etc long run kanji question separ futur issu use idea come paramet continu static-fin configur pos also play role algorithm can/should refin exact decompound token best place tokenfilt tokenfilt one idea would also preserv origin index term overlap e.g abcd ab cd abcd posinc=0 understand tend help noun compound languag idf origin term boost exact compound match tokenfilt provid segment enough context proper either way think start turn default like easi win
fix assertions/check use file.length use getfilepoint came thread get runtimeexcept flush fdx size mismatch index http //www.lucidimagination.com/search/document/a8db01a220f0a126 trunk side effect codec refactor assert push codec finish close check getfilepoint instead comput check lucen part instead fals trip directori metadata stale think fix checks/assert 3.x
better handl file inside/outsid cfs codec sinc norm delet move codec lucene-3606 lucene-3661 never realli proper address issu codec.fil work consid file alway store outsid cfs lucene-3606 ad hack lucene-3661 clean hack littl bit still hack current logic segmentinfo.fil code clearcach compoundfil n't call codec.fil hardcod cfs extens etc els codec.fil alway add file store outsid cfs regardless cfs set codec.separatefil shareddocstor hardcod share doc store extens etc code also various codec method take directori paramet inconsist directori case cfs part index cfs directori other delet separ norm wonder instead could restructur segmentinfo.fil logic code clearcach codec.fil code codec instead respons instead codec.fil logic default would compoundfil thing lucene3x codec would shareddocstor thing part codec want put stuff alway outsid cfs e.g lucene3x separ norm delet could use segmentinfo.dir directori paramet case cfs would alway consist cfsdirectori n't total test work definit cleanup either way think would good step tri clean simplifi
allow use fst hold term data docvalues.bytes_*_sort
improv kuromoji search mode segmentation/decompound kuromoji segment mode search use heurist promot addit segment long candid token get decompound effect heurist improv patch come
creat analysis/uima modul uima base tokenizers/analyz discuss solr-3013 uima tokenizers/analyz refactor separ modul modules/analysis/uima use plain lucen solr/contrib/uima contain relat factori
allow customizing/subclass directoryread directoryread final static factori method possibl subclass way problem main solr solr access directori indexcommit therefor work abstract indexread anymor chang e.g handl reopen irfactori also version commit current possibl implement irfactori return someth els hand possibl wrap directoryread compositeread handl filter collect base inform subread reopen hook done make directoryread abstract let directoryreader.open return intern hidden class standarddirectoryread similar relatinship indexread hidden directoryread past directoryread final implement method like get document store field global docfreq statist allow hook doopenifchang also limit segmentread child atomicread fine allow user creat e.g directory-bas parallelread see lucene-3736 support reopen partial commit
fix payloadprocessorprovid longer use directori lookup instead atomicread payloadprocessorprovid broken api fix current trunk mimic old behaviour 100 payloadprocessorprovid api return payloadprocessor base atomicread instanc get merg atomicread longer know directori resid could e.g filterindexread memoryindex select directori longer possibl current code lucen trunk mimic old behavior instanceof segmentread check ask dirprovid someth els merg payload process support chang old api could kept backward compat move instanceof check conveni class dirpayloadprocessorprovid extend payloadprocessorprovid
parallelread atom renam parallelatomicread also add parallelcompositeread requir logdocmergepolici ident subread structur plan move subread ctor builder-lik api first build reader-set call build renam parallelread parallelatomicread add parallelcompositeread builder api take compositereader-set check align docstart ident subread parallelatomicread
consist negat vint/vlong today write/readvint allow negat int encod decod correct horribl ineffici 5 byte howev read/writevlong fail trip assert 'd prefer vint/vlong trip assert ever tri write negat number 's bad trappi today unfortun sometim reli assert sinc begin could avoid ca n't add assert today think least fix readvlong handl negat long quiet spend 9 byte even trappi
mockcharfilt offset correct wrong fake charfilt use basetokenstreamtestcas occasion doubl charact correct offset use find bug analysi compon would fail otherwis charfilt correctoffset actual wrong harmless test today still wrong
synfilt n't set offset output hang end input token syn rule x y input output a/x y y 's offset right set 0/0
lucenetestcas 's uncaught except handler check assumptionviolatedexcept trigger test failur single-thread test lucenetestcas trigger test failur assumptionviolatedexcept 's occur multi-thread test
add support type whitelist typetokenfilt usual use case typetokenfilt allow set token type list allow type instead filter one 'm attach patch add usewhitelist option
need stopword stoptag list default japanes configur stopword stoptag list japanes need develop test integr lucen
suggest.fst.sort.buffers automat fail freememori follow op dev thread fstcompletiontest failur least 0.5mb ram buffer need http //markmail.org/message/d7ugfo5xof4h5jeh
englishpossessivefilt work unicod right singl quotat mark current englishpossessivefilt use englishanalyz remov possess use '\ charact plus 's 's common system german insert unicod \u2019 right singl quotat mark instead remov process utf-8 text propos chang englishpossesivefilt support \u2019 altern '\
similarity.java javadoc simplif 4.0 part ad addit score system lucen made lower-level similar exist stuff becam e.g tfidfsimilar extend howev alway feel bad complex introduc though feel excus difficult challeng order tri mitig also expos easier api similaritybas top make assumpt trade perform tri provid someth consum e.g experi still cleanup thing low-level api fix outdat document shoot better/clear name etc
move preflexrw lucene3x packag current lot thing made public lucene3x codec mark internal/experimental/deprec lot test codec preflexrw subclass think move packag call package-priv
chang atomicreadercontext.leav return itsself leav simplifi code remov otherwis unneed readerutil method document indexreadercontext.leav state return conveni leav node context top-level direct got indexread otherwis return null correct atomicreadercontext return null alway make consist conveni method simpli return itsself leav atom context make util method readerutil.leav obsolet simplifi code
cleanup dr.getcurrentversion/dr.getuserdata/dr.getindexcommit .getuserdata spinoff ryan 's dev thread dr.getcommituserdata vs dr.getindexcommit .getuserdata method confusing/dup right
general searchermanag 'd like general searchermanag class manag instanc certain type interfac reason today searchermanag know handl indexsearch instanc searchermanag manag pair indexsearch taxonomyread pair recent concurr bug fix searchermanag realiz need appli version well led think ca n't sm version generic enough version lucen 's benefit way see searchermanag divid two part 1 part manag logic acquire/release/maybereopen i.e. ensureopen protect concurr stuff etc 2 part handl indexsearch searchertaxopair 'm think ll interfac incref/decref/tryincref/mayberefresh make searchermanag generic class handl interfac post patch initi idea continu
upgrad junit 4.10 refactor state-machin detect setup/teardown call chain lucen solr use junit 4.7 suggest move forward upgrad junit 4.10 provid sever infrastructur chang serializ descript object class-level rule various tweak junit 4.10 also chang fix depend look order before/ hook rule appli make old state-machin lucenetestcas fail order chang rewrot state machin use differ think simpler although uwe may disagre mechan hook method setup/ teardown still empti top level serv detect whether subclass chain super.setup/teardown proper overrid anyth long term would love get rid public setup/teardown method make privat overriden even seen subclass requir chang runner
remov oal.util.mapbackedset java 6 offser collections.newsetfrommap easi search replac job 3.x still need class java 5 collections.newsetfrommap
trappi ignorecas behavior stopfilter/ignorecas spinoff lucene-3751 code code stopword /code instanc link chararrayset true code makestopset /code use construct set direct use code ignorecas /code ignor sinc code chararrayset /code direct control case sensit code realli confus trappi need chang someth
remove/deprec token 's default ctor work new token accident forgot call super input super.reset input reset method meant correctoffset call silent no-op trappi fortun awesom basetokenstreamtestcas caught hit failur offset fact correct one minim thing sound like robert may reason ca n't add assert input null tokenizer.correctoffset noformat index lucene/core/src/java/org/apache/lucene/analysis/tokenizer.java lucene/core/src/java/org/apache/lucene/analysis/tokenizer.java revis 1242316 +++ lucene/core/src/java/org/apache/lucene/analysis/tokenizer.java work copi -82,6 +82,7 see charstream correctoffset protect final int correctoffset int currentoff assert input null subclass fail call super reader super.reset reader return input instanceof charstream charstream input .correctoffset currentoff currentoff noformat best would remov default ctor leav input null
explor stream viterbi search kuromoji ve play idea chang kuromoji viterbi search 2 pass intersect backtrac instead 4 pass break sentenc intersect score backtrac much work progress 'm get current state 's got ton nocommit n't proper handl user dict extend mode yet etc one thing 'm play add doubl backtrac long compound token ie instead penal token shorter token pick leav score unchang backtrac take penalti use threshold 2nd best segment
simplifi nrtmanag nrtmanag hairi applydelet separ pass ctor pass maybereopen pass getsearchermanag etc think instead pass ctor case need delet other make two nrtmanag less effici today simpler think also enabl nrtmanag subclass thingymanag lucene-3761
renam filterindexread filteratomicread class renam consist new name
renam remain test new indexread class hierarchi
small improv dwptthreadpool work anoth issu clean dwtpthreadpool littl fix name issu fix todo patch come soon
nrtmanag n't expos privat searchermanag spinoff lucene-3769 actual obtain indexsearch nrtmanag 's 2-step process must .getsearchermanag .acquir return searchermanag trappi app incorrect call maybereopen privat searchermanag instead nrtmanager.maybereopen unexpect caus thread block forev wait necessari gen becom visibl hard debug n't like creat trappi api hope lucene-3761 fix nrtmanag longer expos privat sm instead subclass referencemanaag altern addit mayb factor new interfac searcherprovid someth acquir releas method nrtmanag referencemanager/sm impl keep nrtmanag 's sm privat
creat group conveni class current group modul mani collector class lot differ option per class think would good idea grouputil anoth name conveni class think could builder mani option sort sortwithingroup groupoffset groupcount implement term/dv/funct group
expos filteredtermsenum mtq mtq getenum protect order access need o.a.l.search packag relev snip mail list discuss noformat getenum protect intend call *only* subclass 's idea behind protect method also access class packag 's java bug featur problem mtq rewritemethod separ *class* *not subclass* mtq method call java bug call packag theoret public otherwis call getenum anoth cleaner fix would add protect final method rewritemethod call method mtq anyth subclass rewritemethod get enum insid rewritemethod class correct way handl deleg mtq intern noformat
benchmark pars highlight-vs-vector-highlight.alg 3.x new test testperftasksparse.testparseexampl ad lucene-3768 guarante .alg file conf/ directori actual pars highlight-vs-vector-highlight.alg pars 3.x numberformatexcept howev work fine trunk .alg exact case noformat junit standard error junit java.lang.numberformatexcept input string maxfrag 3.0 field bodi junit sun.misc.floatingdecimal.readjavaformatstr floatingdecimal.java:1222 junit java.lang.float.parsefloat float.java:422 junit org.apache.lucene.benchmark.bytask.tasks.searchtravtask.setparam searchtravtask.java:76 junit org.apache.lucene.benchmark.bytask.tasks.searchtravretvectorhighlighttask.setparam searchtravretvectorhighlighttask.java:124 junit org.apache.lucene.benchmark.bytask.utils.algorithm. init algorithm.java:112 junit org.apache.lucene.benchmark.bytask.testperftasksparse.testparseexampl testperftasksparse.java:132 noformat
directorytaxonomywrit lose index_create_tim properti caus dirtaxoreader.refresh fals succeed fail dirtaxowrit set createtim null put commit data 's wrong one call commit map twice second time n't record creation time also ctor index exist openmod creat creation time properti read wrote coupl unit test assert modifi dirtaxowrit alway record creation time everi commit 's safe way upload patch short
replac spatial contrib modul lsp 's spatial-lucen modul propos lucen 's spatial contrib modul replac spatial-lucen modul within lucen spatial playground lsp lsp develop approxim 1 year david smiley ryan mckinley chris male feel readi lsp http //code.google.com/p/lucene-spatial-playground/ spatial-lucen modul intuit svn/trunk/spatial-lucene/ ll add comment prevent issu descript long
disallow setboost stringfield throw except boost set norm omit occasion user confus index-tim boost appli norms-omit field silent discard boost reason absurd part 4.0 make stringfield call setboost noth complain reason remov stringfield total opinion
reader wrap reader n't prevent usag subread close recent trunk test got problem org.apache.lucene.index.testreaderclosed.test fail inner reader close wrap outer one still open fix issu partial slowcompositereaderwrapp parallelatomicread fail cool thing test follow test open directoryread creat searcher close reader execut search issu reader close search run test use ltc.newsearch wrap=tru random wrap pass reader slowcomposit parallelread close origin inner reader close detect excut search caus sigsegv mmap use problem slow* parallel* field instanc that kept aliv reader itsself close child reader close wrap reader know still use field instanc deleg inner reader step ensureopen check done caus failur first fix done slow parallel call ensureopen subread request field work fine wrap two time parallelatomicread slowcompositereaderwrapp standarddirectoryread segments_1:3 nrt _0 4.0 c42 one solut would make ensureopen also check subread would volatil check way often n total number subread m number hierarch level n^m current n*m fine propos solv close subread hood parent reader use readerclosedlisten whenev composit slow reader wrap anoth reader regist interest readerclos event subread forc close e.g program error crazi test automat close parent also fix 3.x similar problem need investig
generifi fst shortestpath take compar sure cost 5-10 perform wfstsuggest mayb optim someth mayb big deal us general could pretti power e.g need store custom stuff suggest could use pairoutput whatev possibl might need shortestpath cool thing least want patch n't test pairoutput ve test e.g floatoutput thing work fine tri minim generic violat 1 creat generic array
group collector comput group facet count spinoff issu solr-2898
cleanup suggest api current suggest api especi termfreqiter n't play nice bytesref paradigm use lucen java iter pattern n't use get work termsenum bytesref etc tri clean api step step move bytesref includ lookup class interfac
remov unus benchmark depend benchmark huge number jar file lib/ even differ version lib use e.g solr worst thing n't even use commons-collect unus commons-beanutil unus commons-log unus commons-digets unus
correct copy-past victim comment correct doc-com fieldsproduc copy-past victim fieldsconsum consum replac produc one word chang avoid confus safe commit
filtereddocidset handl case inner set iter null docidset iter allow return null use filtereddocidset null return inner set filtereddocidsetiter fail sinc allow null pass fix simpl return null filtereddocidset iter method iter null
testindexwriternrtiscurr failur found jenkin https //builds.apache.org/job/lucene-solr-tests-only-trunk/12492/ make comput busi e.g run test anoth checkout ant test-cor -dtests.iter=100 -dtestcase=testindexwriternrtiscurr -dtestmethod=testiscurrentwiththread -dtests.seed=-78f6fa16b849cf27:382126da79c1e146 -d2cdec79e86e1b3 -dtests.multiplier=3 -dargs= -dfile.encoding=iso8859-1 take tri till pop noformat junit-sequenti junit testsuit org.apache.lucene.index.testindexwriternrtiscurr junit test run 100 failur 1 error 1 time elaps 277.818 sec junit junit standard output junit warn use -dtests.iter=n n 1 test support option junit may crash fail bug junit junit standard error junit note reproduc ant test -dtestcase=testindexwriternrtiscurr -dtestmethod=testiscurrentwiththread -dtests.seed=-78f6fa16b849cf27:382126da79c1e146 -d2cdec79e86e1b3 -dtests.multiplier=3 -dargs= -dfile.encoding=iso8859-1 junit follow except thrown thread junit thread lucen merg thread 17 junit org.apache.lucene.index.mergepolici mergeexcept java.lang.assertionerror junit org.apache.lucene.index.concurrentmergescheduler.handlemergeexcept concurrentmergescheduler.java:520 junit org.apache.lucene.index.concurrentmergeschedul mergethread.run concurrentmergescheduler.java:480 junit caus java.lang.assertionerror junit org.apache.lucene.index.indexwrit readersandlivedocs.initwritablelivedoc indexwriter.java:580 junit org.apache.lucene.index.indexwriter.commitmergeddelet indexwriter.java:3061 junit org.apache.lucene.index.indexwriter.commitmerg indexwriter.java:3137 junit org.apache.lucene.index.indexwriter.mergemiddl indexwriter.java:3718 junit org.apache.lucene.index.indexwriter.merg indexwriter.java:3257 junit org.apache.lucene.index.concurrentmergescheduler.domerg concurrentmergescheduler.java:382 junit org.apache.lucene.index.concurrentmergeschedul mergethread.run concurrentmergescheduler.java:451 junit note reproduc ant test -dtestcase=testindexwriternrtiscurr -dtestmethod=testiscurrentwiththread -dtests.seed=-78f6fa16b849cf27:382126da79c1e146 -d2cdec79e86e1b3 -dtests.multiplier=3 -dargs= -dfile.encoding=iso8859-1 junit note reproduc ant test -dtestcase=testindexwriternrtiscurr -dtestmethod=testiscurrentwiththread -dtests.seed=-78f6fa16b849cf27:382126da79c1e146 -d2cdec79e86e1b3 -dtests.multiplier=3 -dargs= -dfile.encoding=iso8859-1 junit note test param codec=lucene40 id=mockfixedintblock blocksize=525 sim=defaultsimilar locale=es_pi timezone=africa/luanda junit note test run jvm junit testindexwriternrtiscurr junit note linux 3.0.0-14-gener amd64/sun microsystem inc. 1.6.0_24 64-bit /cpus=8 threads=1 free=74907448 total=255787008 junit junit testcas testiscurrentwiththread org.apache.lucene.index.testindexwriternrtiscurr fail junit info=_qx 4.0 c1/1 n't live junit junit.framework.assertionfailederror info=_qx 4.0 c1/1 n't live junit org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:165 junit org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:57 junit org.apache.lucene.index.indexwrit readerpool.infoisl indexwriter.java:663 junit org.apache.lucene.index.indexwrit readerpool.dropal indexwriter.java:717 junit org.apache.lucene.index.indexwriter.closeintern indexwriter.java:1136 junit org.apache.lucene.index.indexwriter.clos indexwriter.java:1069 junit org.apache.lucene.index.indexwriter.clos indexwriter.java:1033 junit org.apache.lucene.index.testindexwriternrtiscurrent.testiscurrentwiththread testindexwriternrtiscurrent.java:68 junit org.apache.lucene.util.lucenetestcas subclasssetupteardownrul 1.evalu lucenetestcase.java:707 junit org.apache.lucene.util.lucenetestcas internalsetupteardownrul 1.evalu lucenetestcase.java:606 junit org.apache.lucene.util.lucenetestcas testresultinterceptorrul 1.evalu lucenetestcase.java:511 junit org.apache.lucene.util.lucenetestcas rememberthreadrul 1.evalu lucenetestcase.java:569 junit junit junit testcas testiscurrentwiththread org.apache.lucene.index.testindexwriternrtiscurr caus error junit java.lang.assertionerror thread threw uncaught except junit java.lang.runtimeexcept java.lang.assertionerror thread threw uncaught except junit org.apache.lucene.util.lucenetestcase.teardownintern lucenetestcase.java:780 junit org.apache.lucene.util.lucenetestcase.access 1000 lucenetestcase.java:138 junit org.apache.lucene.util.lucenetestcas internalsetupteardownrul 1.evalu lucenetestcase.java:607 junit org.apache.lucene.util.lucenetestcas testresultinterceptorrul 1.evalu lucenetestcase.java:511 junit org.apache.lucene.util.lucenetestcas rememberthreadrul 1.evalu lucenetestcase.java:569 junit org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:165 junit org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:57 junit org.apache.lucene.util.lucenetestcase.checkuncaughtexceptionsaft lucenetestcase.java:808 junit org.apache.lucene.util.lucenetestcase.teardownintern lucenetestcase.java:752 junit junit junit test org.apache.lucene.index.testindexwriternrtiscurr fail build fail noformat
wrong trail index calcul patternreplacecharfilt reimplement patternreplacecharfilt pass random test use throw except previous simplifi code drop boundari charact full input buffer pattern match
inner class filteratomicread trunk filterindexread 3.x overrid method filter issu add miss check filterread test also check overridden method enum implement inner class similar check ad shai erea
add field-filt filteratomicread 4.0 parallelread better test ltc.maybewrapread addit filter contrib/misc horizont filter doc-id atomicread would good vertic field add implement test-framework stay contrib/misc ltc need maybewrapread ltc use filteratomicread construct parallelatomicread two mayb fieldfilteratomicread
termordval/docvaluescompar much work comparebottom logic fall back by-valu comparison bottom slot current reader silli bottom slot differ reader mean tie-break case possibl sinc current reader n't bottom valu incom ord equal bottom ord alway return x 0 ad new random string sort test case testsort also renam docvalues.sortedsource.getbyvalu getordbyvalu clean whitespac
make term offset work memoryindex fix logic retriev term offset docsandpositionsenum memoryindex allow subclass access
pass null fieldnam memoryfield term memoryindex throw npe found queri memoryindex use regexpqueri wrap spanmultitermquerywrapp regexp n't match anyth index get rewritten empti spanorqueri null field valu trigger npe
mergethread throw uncheck except tostr caus near thread-dump routin fail effect obscur origin problem think return string alway possibl indic under writer close someth
closeablethreadloc work well tomcat thread pool track larg memori leak effect leak anyway caus analyz user closeablethreadloc closeablethreadlocal.hardref hold refer thread object key problem free refer set method snowballanalyz call set use new thread problem scenario follow server experi spike usag say robot whatev mani thread creat referenc closeablethreadlocal.hardref server quiesc let mani thread expir normal smaller adequ thread pool closeablethreadlocal.set may call snowballanalyz via analyz _long_ time purg code never call thread along thread local storag lucen relat never clean think call purg code get set would avoid problem potenti expens perhap use weakhashmap instead hashmap may also help weakhashmap purg get set might effici way clean thread get set might expens map.keyset iter current work around share snowballanalyz instanc among http searcher thread open close one everi request thank matt
lucenetestcas check modif system properti fail test chang detect revert state system properti suit cleanup suit
basetokenstreamtestcas fail tokenstream start posinc=0 meaningless tokenstream start posinc=0 also caus problem hairi index lucene-1255 lucene-1542 make senseless tokenstream add check fix furthermor bug exist removing-filt enablepositionincrements=fals think option use shouldnt mean allow broken tokenstream mean n't add gap remov token enablepositionincrements=fals caus ts start positionincrement=0 shouldnt restructur tokenstream e.g move synonym top differ word add hole
fix rawtyp warn java 7 compil java 7 chang warn littl bit java 6 knew uncheck warn type appli type generic violat like miss generic raw type java 7 still know uncheck emit warn call realli uncheck declar variables/field construct instanc without type param emit rawtyp warn chang caus java 7 compil emit lot rawtyp warn java 6 silent easi fix suppr warn type suppresswarn uncheck rawtyp place chang easi provid patch later
testterminfosreaderindex fail alway reproduc alway fail branch use reproduc string git clone depth 1 -b rr git github.com dweiss/lucene_solr.git noformat junit4 run org.apache.lucene.codecs.lucene3x.testterminfosreaderindex junit4 failur 0.04s j0 testterminfosreaderindex.testseekenum junit4 throwabl 1 java.lang.assertionerror expect field9 z91ob3wozm6d junit4 __randomizedtesting.seedinfo.se c7597dfbbe0b3d7d c6d9cedd0700aaff :0 junit4 org.junit.assert.fail assert.java:93 junit4 org.junit.assert.failnotequ assert.java:647 junit4 org.junit.assert.assertequ assert.java:128 junit4 org.junit.assert.assertequ assert.java:147 junit4 org.apache.lucene.codecs.lucene3x.testterminfosreaderindex.testseekenum testterminfosreaderindex.java:137 junit4 sun.reflect.nativemethodaccessorimpl.invoke0 nativ method junit4 sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:39 junit4 sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:25 junit4 java.lang.reflect.method.invok method.java:597 junit4 com.carrotsearch.randomizedtesting.randomizedrunner.invok randomizedrunner.java:1766 junit4 com.carrotsearch.randomizedtesting.randomizedrunner.access 1000 randomizedrunner.java:141 junit4 com.carrotsearch.randomizedtesting.randomizedrunn 6.evalu randomizedrunner.java:728 junit4 com.carrotsearch.randomizedtesting.randomizedrunn 7.evalu randomizedrunner.java:789 junit4 com.carrotsearch.randomizedtesting.randomizedrunn 8.evalu randomizedrunner.java:803 junit4 org.apache.lucene.util.lucenetestcas subclasssetupteardownrul 1.evalu lucenetestcase.java:744 junit4 org.apache.lucene.util.lucenetestcas internalsetupteardownrul 1.evalu lucenetestcase.java:636 junit4 org.apache.lucene.util.systempropertiesinvariantrul 1.evalu systempropertiesinvariantrule.java:22 junit4 org.apache.lucene.util.lucenetestcas testresultinterceptorrul 1.evalu lucenetestcase.java:550 junit4 org.apache.lucene.util.lucenetestcas rememberthreadrul 1.evalu lucenetestcase.java:600 junit4 com.carrotsearch.randomizedtesting.randomizedrunner.runsingletest randomizedrunner.java:735 junit4 com.carrotsearch.randomizedtesting.randomizedrunner.access 600 randomizedrunner.java:141 junit4 com.carrotsearch.randomizedtesting.randomizedrunn 3 1.run randomizedrunner.java:586 junit4 com.carrotsearch.randomizedtesting.randomizedrunn 3.evalu randomizedrunner.java:605 junit4 com.carrotsearch.randomizedtesting.randomizedrunn 4.evalu randomizedrunner.java:641 junit4 com.carrotsearch.randomizedtesting.randomizedrunn 5.evalu randomizedrunner.java:652 junit4 org.apache.lucene.util.systempropertiesinvariantrul 1.evalu systempropertiesinvariantrule.java:22 junit4 com.carrotsearch.randomizedtesting.randomizedrunner.runsuit randomizedrunner.java:533 junit4 com.carrotsearch.randomizedtesting.randomizedrunner.access 400 randomizedrunner.java:141 junit4 com.carrotsearch.randomizedtesting.randomizedrunn 2.run randomizedrunner.java:479 junit4 junit4 2 note reproduc ant test -dtests.filter=*.testterminfosreaderindex -dtests.filter.method=testseekenum -drt.seed=c7597dfbbe0b3d7d -dargs= -dfile.encoding=utf-8 junit4 2 junit4 afterclass output junit4 2 note test param codec=append sim=defaultsimilar locale=en timezone=atlantic/stanley junit4 2 note test run jvm junit4 2 testlock testfileswitchdirectori testwildcardrandom testversioncompar testtermdocperf testbitvector testparalleltermenum testsimplesearchequival testnumericrangequery64 testsort testiscurr testtoken testintblockcodec testdocumentswriterdeletequeu testpagedbyt testthreadedforcemerg testomittf testsegmenttermenum testindexwriterconfig testcheckindex testtermvectorswrit testnumerictokenstream testsearchaft testregexpqueri inbeforeclass inafterclass intestmethod nonstringproperti testindexwritermergepolici testvirtualmethod testfieldcach testsurrog testsegmenttermdoc testmultivaluednumericrangequeri testbasicoper testcodec testdatesort testpositivescoresonlycollector testbooleanqueri testindexinput testminim testnumericrangequery32 testboolean2 testsloppyphrasequeri testnodeletionpolici testfieldcachetermsfilt testrandomstoredfield testdocboost testtransactionrollback testunicodeutil testindexwriterlockreleas testutf32toutf8 testfixedbitset testdoublebarrellrucach testtimelimitingcollector testspanfirstqueri testdirectori testspansadvanced2 testconcurrentmergeschedul testindexwriterexcept testdocvalu testcustomnorm testfieldvaluefilt testtermvector testterminfosreaderindex junit4 2 note linux 2.6.32-38-server amd64/sun microsystem inc. 1.6.0_20 64-bit /cpus=4 threads=1 free=100102360 total=243859456 junit4 2 noformat
renam basemultiread class basecompositeread make public current abstract directoryread multiread parallelcompositeread extend packag privat class user want implement composit reader abl subclass pkg-privat class implement lot abstract method use implement fact multiread shallow subclass implement correct close refcount make public renam generic problem type paramet r correct display javadoc solv
teststressnrt failur reproduc build server log reproduc least two machin noformat junit standard error junit note reproduc ant test -dtestcase=teststressnrt -dtestmethod=test -dtests.seed=69468941c1bbf693:19e66d58475da929:69e9d2f81769b6d0 -dargs= -dfile.encoding=utf-8 junit note test param codec=lucene3x sim=randomsimilarityprovid querynorm=tru coord=fals locale=ro timezone=etc/gmt+1 junit note test run jvm junit teststressnrt junit note linux 3.0.0-16-gener amd64/sun microsystem inc. 1.6.0_27 64-bit /cpus=2 threads=1 free=74960064 total=135987200 junit junit testcas test org.apache.lucene.index.teststressnrt caus error junit mockdirectorywrapp close still open file _ng.cfs=8 junit java.lang.runtimeexcept mockdirectorywrapp close still open file _ng.cfs=8 junit org.apache.lucene.store.mockdirectorywrapper.clos mockdirectorywrapper.java:555 junit org.apache.lucene.index.teststressnrt.test teststressnrt.java:385 junit org.apache.lucene.util.lucenetestcas subclasssetupteardownrul 1.evalu lucenetestcase.java:743 junit org.apache.lucene.util.lucenetestcas internalsetupteardownrul 1.evalu lucenetestcase.java:639 junit org.apache.lucene.util.systempropertiesinvariantrul 1.evalu systempropertiesinvariantrule.java:22 junit org.apache.lucene.util.lucenetestcas testresultinterceptorrul 1.evalu lucenetestcase.java:538 junit org.apache.lucene.util.lucenetestcas rememberthreadrul 1.evalu lucenetestcase.java:600 junit org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:164 junit org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:57 junit org.apache.lucene.util.storeclassnamerul 1.evalu storeclassnamerule.java:21 junit org.apache.lucene.util.systempropertiesinvariantrul 1.evalu systempropertiesinvariantrule.java:22 junit caus java.lang.runtimeexcept unclos indexinput _ng.cfs junit org.apache.lucene.store.mockdirectorywrapper.addfilehandl mockdirectorywrapper.java:479 junit org.apache.lucene.store.mockdirectorywrapp 1.openslic mockdirectorywrapper.java:777 junit org.apache.lucene.store.compoundfiledirectory.openinput compoundfiledirectory.java:221 junit org.apache.lucene.codecs.lucene3x.terminfosreader. init terminfosreader.java:112 junit org.apache.lucene.codecs.lucene3x.lucene3xfields. init lucene3xfields.java:84 junit org.apache.lucene.codecs.lucene3x.preflexrwpostingsformat 1. init preflexrwpostingsformat.java:51 junit org.apache.lucene.codecs.lucene3x.preflexrwpostingsformat.fieldsproduc preflexrwpostingsformat.java:51 junit org.apache.lucene.index.segmentcorereaders. init segmentcorereaders.java:108 junit org.apache.lucene.index.segmentreader. init segmentreader.java:51 junit org.apache.lucene.index.indexwrit readersandlivedocs.getmergeread indexwriter.java:521 junit org.apache.lucene.index.indexwriter.mergemiddl indexwriter.java:3587 junit org.apache.lucene.index.indexwriter.merg indexwriter.java:3257 junit org.apache.lucene.index.concurrentmergescheduler.domerg concurrentmergescheduler.java:382 junit org.apache.lucene.index.concurrentmergeschedul mergethread.run concurrentmergescheduler.java:451 junit junit junit test org.apache.lucene.index.teststressnrt fail noformat
creat docvalu base group facet collector creat docvalu base group facet collector current term base collector implement lucene-3802
except thread beforeclass/etc fail test lot test creat index beforeclass method except thrown anoth thread wo n't fail test e.g test pass code public class testexc extend lucenetestcas beforeclass public static void beforeclass new thread public void run throw new runtimeexcept boo .start public void test code uncaught except handler setup/teardown
nuke/clean atomicreader.hasnorm implement alreadi return fieldinfo tell normvalu also tell want keep think final implement requir filterread etc nuke realli need 3 way thing
3.x index wrong normtyp set fieldinfo 3.x codec claim singl byte norm bytes_var_straight fieldinfo norm implement type fixed_ints_8
docvalues.typ docvalues.gettyp make method easier find clear side effect occas ve look getter miss name
support offset memorypost realli add sep puls one
ramusageestimator.num_bytes_array_head constant incorrect ramusageestimator.num_bytes_array_head comput like num_bytes_object_head num_bytes_int num_bytes_object_ref num_bytes_object_ref part includ least accord page http //www.javamex.com/tutorials/memory/array_memory_usage.shtml quot single-dimens array singl object expect array usual object header howev object head 12 byte accommod four-byt array length come actual array data might expect consist number element multipli number byte requir one element depend type memori usag one element 4 byte object refer quot wrote sizeof string impl wonder peopl feel includ helper method rue static stateless method 's perfect 's room improv 'm sure code comput approxim size string object note object also referenc anoth object add link ramusageestim num_bytes_object_ref result method public static int sizeof string str return 2 str.length 6 char addit safe array align 3 ramusageestimator.num_bytes_int string maintain 3 integ ramusageestimator.num_bytes_array_head char array ramusageestimator.num_bytes_object_head string object code peopl 'd like also add sizeof int byte long doubl string
varderefbytesimpl doc valu prefix length may fall across two page varderefbytesimpl doc valu encod uniqu byte prefix 1 2 byte first follow byte use pagedbytes.fillslicewithprefix rather use pagedbytes.copyusinglengthprefix problem write invalid 2 byte prefix span two block ie last byte block n first byte block n+1 fillslicewithprefix wo n't decod correct
stack trace fail test mess ant 1.7.x
index chang lost call preparecommit close suppos call commit call preparecommit forget call close preparecommit without call commit chang done preparecommit silent lost includ adding/delet doc also complet merg spinoff java-us thread lot .cfs compound file index directori tim bogaert think fix iw.clos throw illegalstateexcept preparecommit call match call commit
bogus posit creat corrumpt index pretti common positionincr overflow happen realli easili peopl write analyz n't clearattribut use case happen perhap still 3.x didnt check iw would throw except couldnt find code check wrote test make corrumpt index
testindexwriterexcept fail reproduc noformat ant test -dtestcase=testindexwriterexcept -dtestmethod=testillegalposit -dtests.seed=-228094d3d2f35cf2 -496e33eec9bbd57c:36a1c54f4e1bb32 -dargs= -dfile.encoding=utf-8 junit junit.framework.assertionfailederror position=-2 lastposition=0 junit org.apache.lucene.codecs.lucene40.lucene40postingswriter.addposit lucene40postingswriter.java:215 junit org.apache.lucene.index.freqproxtermswriterperfield.flush freqproxtermswriterperfield.java:519 junit org.apache.lucene.index.freqproxtermswriter.flush freqproxtermswriter.java:92 junit org.apache.lucene.index.termshash.flush termshash.java:117 junit org.apache.lucene.index.docinverter.flush docinverter.java:53 junit org.apache.lucene.index.docfieldprocessor.flush docfieldprocessor.java:81 junit org.apache.lucene.index.documentswriterperthread.flush documentswriterperthread.java:475 junit org.apache.lucene.index.documentswriter.doflush documentswriter.java:422 junit org.apache.lucene.index.documentswriter.flushallthread documentswriter.java:553 junit org.apache.lucene.index.indexwriter.doflush indexwriter.java:2640 junit org.apache.lucene.index.indexwriter.flush indexwriter.java:2616 junit org.apache.lucene.index.indexwriter.closeintern indexwriter.java:851 junit org.apache.lucene.index.indexwriter.clos indexwriter.java:810 junit org.apache.lucene.index.indexwriter.clos indexwriter.java:774 junit org.apache.lucene.index.testindexwriterexceptions.testillegalposit testindexwriterexceptions.java:1517 junit sun.reflect.nativemethodaccessorimpl.invoke0 nativ method junit sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:39 junit sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:25 junit java.lang.reflect.method.invok method.java:597 junit org.junit.runners.model.frameworkmethod 1.runreflectivecal frameworkmethod.java:45 junit org.junit.internal.runners.model.reflectivecallable.run reflectivecallable.java:15 junit org.junit.runners.model.frameworkmethod.invokeexplos frameworkmethod.java:42 junit org.junit.internal.runners.statements.invokemethod.evalu invokemethod.java:20 junit org.junit.internal.runners.statements.runbefores.evalu runbefores.java:28 junit org.junit.internal.runners.statements.runafters.evalu runafters.java:30 junit org.apache.lucene.util.lucenetestcas subclasssetupteardownrul 1.evalu lucenetestcase.java:729 junit org.apache.lucene.util.lucenetestcas internalsetupteardownrul 1.evalu lucenetestcase.java:645 junit org.apache.lucene.util.systempropertiesinvariantrul 1.evalu systempropertiesinvariantrule.java:22 junit org.apache.lucene.util.lucenetestcas testresultinterceptorrul 1.evalu lucenetestcase.java:556 junit org.apache.lucene.util.uncaughtexceptionsrul 1.evalu uncaughtexceptionsrule.java:51 junit org.apache.lucene.util.lucenetestcas rememberthreadrul 1.evalu lucenetestcase.java:618 junit org.junit.rules.runrules.evalu runrules.java:18 junit org.junit.runners.parentrunner.runleaf parentrunner.java:263 junit org.junit.runners.blockjunit4classrunner.runchild blockjunit4classrunner.java:68 junit org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:164 junit org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:57 junit org.junit.runners.parentrunn 3.run parentrunner.java:231 junit org.junit.runners.parentrunn 1.schedul parentrunner.java:60 junit org.junit.runners.parentrunner.runchildren parentrunner.java:229 junit org.junit.runners.parentrunner.access 000 parentrunner.java:50 junit org.junit.runners.parentrunn 2.evalu parentrunner.java:222 junit org.junit.internal.runners.statements.runbefores.evalu runbefores.java:28 junit org.junit.internal.runners.statements.runafters.evalu runafters.java:30 junit org.apache.lucene.util.uncaughtexceptionsrul 1.evalu uncaughtexceptionsrule.java:51 junit org.apache.lucene.util.storeclassnamerul 1.evalu storeclassnamerule.java:21 junit org.apache.lucene.util.systempropertiesinvariantrul 1.evalu systempropertiesinvariantrule.java:22 junit org.junit.rules.runrules.evalu runrules.java:18 junit org.junit.runners.parentrunner.run parentrunner.java:300 junit junit.framework.junit4testadapter.run junit4testadapter.java:39 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.run junittestrunner.java:518 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.launch junittestrunner.java:1052 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.main junittestrunner.java:906 junit noformat
fix posit corrumpt 4.0 codec spinoff lucene-3876 codec invalid assert wrong shift oper etc posit exceed integer.max_value/2 also payload produc corrumpt index strang error easiest way trigger bug sometim add payload test lucene-3876
uax29urlemailtoken fail recogn email mailto scheme prepend report kai g¨¹lzau solr-user|http //markmail.org/message/n32kji3okqm2c5qn uax29urlemailtoken seem split wrong place noformat mailto test example.org noformat noformat mailto test noformat noformat example.org noformat workaround use code xml charfilt class= solr.patternreplacecharfilterfactori pattern= mailto replacement= mailto code
creat uax29urlemailanalyz standard analyz recogn url email analyz contain compon standardanalyz except token uax29urlemailtoken instead standardtoken
analysi irish add analysi irish stemmer generat snowbal stemmer ve sent martin porter say ad week
memoryindex memori estim tostr inconsist getmemorys lucene-3867 commit minor problem memoryindex 's estim patch fix also add verbos test output ram need memoryindex vs. ramdirectori interest ramdirectori alway take accord estim even buffer overhead 2/3 memoryindex exclud indexread
remove/uncommit segmentingtokenizerbas ad class lucene-3305 support analyz like kuromoji kuromoji longer need lucene-3767 noth use think uncommit releas svn n't forget add back want refactor someth like thai smartcn use
make basetokenstreamtestcas bit evil throw except reader token stop consum token sometim spoon-fe char reader
get random-seed/reproduce-with test fail anoth thread see https //builds.apache.org/job/lucene-solr-tests-only-trunk/12822/consol exampl least affect 4.0 mayb 3.x
chartoken bug larg document initi found hudson addit test ad lucene-3894 current reproduc see lucene-3895 easi reproduc simpl single-thread case testduelinganalyz
kuromojitoken fail larg doc shove largeish random doc trigger assert like noformat junit caus java.lang.assertionerror backpos=4100 vs lastbacktracepos=5120 junit org.apache.lucene.analysis.kuromoji.kuromojitokenizer.backtrac kuromojitokenizer.java:907 junit org.apache.lucene.analysis.kuromoji.kuromojitokenizer.pars kuromojitokenizer.java:756 junit org.apache.lucene.analysis.kuromoji.kuromojitokenizer.incrementtoken kuromojitokenizer.java:403 junit org.apache.lucene.analysis.basetokenstreamtestcase.checkrandomdata basetokenstreamtestcase.java:404 noformat get seed ll commit test case ignor
possibl synonymfilt bug hudson fail see https //builds.apache.org/job/lucene-trunk/1867/consoletext seed
evil mockdirectorywrapper.checkindexonclos mockdirectorywrapp check index test creat close exist problem logic use determin index exist could mask real bug e.g segment file corrumpt code directoryreader.indexexist evil stuff like crash _testutil.checkindex code refer directoryreader.indexexist code tri new segmentinfo .read directori return true catch ioexcept ioe return fals code segment file problem silent checkindex
add katakana stem filter better deal certain katakana spell variant mani japanes katakana word end long sound sometim option exampl ¥Ñ©`¥Æ¥£©` ¥Ñ©`¥Æ¥£ perfect valid parti similar ¥»¥ó¥¿©` ¥»¥ó¥¿ variant center well ¥µ©`¥Ð©` ¥µ©`¥Ð server 'm propos add katakana stemmer remov long sound term longer configur length 's also possibl add variant synonym think stem prefer rank point view
javadoc ugli generat java7 java7 chang javadoc look much nicer involv differ css style lucen overrid css stylesheet+prettify.css combin java5/6 stylesheet googl prettifi problem java7 total differ style generat javadoc java7 like stylesheet solut might make stylesheet7+prettify.css condition properti ant base java version
similar javadoc look ugli creat java7 's javadoc caption use illustr formula tabl jdk 5/6 tabl center nice java7 's javadoc think due css style chang tabl center instead stretch think need center tabl differ techniqu look http //people.apache.org/~rmuir/java7-style-javadocs/org/apache/lucene/search/similarity.html see mean note javadoc tfidfsimilarity.java trunk
basetokenstreamtestcas test analyz real-ish content alreadi linefiledoc pull content generat europarl wikipedia think sometim btstc test analyz well
allow specifi -dbootclasspath javac/javadoc compile/javadoc actual target jre librari even newer compil
test fail sometim testmethod reproduc null exampl recent fail https //builds.apache.org/job/lucene-3.x/680/ would better popul -dtestmethod anyth
move kuromoji analysis.ja introduc japanese* name lucene/solr 3.6 4.0 get out-of-the-box japanes languag support kuromojianalyz kuromojitoken various filter filter current live org.apache.lucene.analysis.kuromoji 'm propos move kuromoji new japanes packag org.apache.lucene.analysis.ja line languag organ part also think renam kuromojianalyz japaneseanalyz etc align name convent make clear analyz japanes much like name kuromoji think japanes fit potenti issu see 'd like rais get feedback end-us japan elsewher use lucene-gosen could issu upgrad sinc lucene-gosen fact releas analyz org.apache.lucene.analysis.ja namespac 'd name clash believ user freedom choos whichev japanes analyz filter etc 'd like use n't want propos name chang creat unnecessari problem user think name propos fit lucene/solr releas
improv basetokenstreamtestcas random string generat analysi test use mocktoken split whitespac rare generat string mani token think tri generat realist test string
htmlstripcharfilt produc invalid final offset night build found boil small test case n't requir big line file doc
add japanes filter replac term attribut read koji robert work lucene-3888 allow spell-check similar match use differ word surfac form approach use languag japanes surfac form form 'd like use similar match differ japanes 's use use read probabl normal