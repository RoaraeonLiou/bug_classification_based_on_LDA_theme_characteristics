2198
document.field return store field document.field return store field index store confus 's isstor method n't make much sens actual field return field document.add new field even one store sound confus ll attach small program demonstr either fix field alway return document
patch germananalyz fail silent n't close file mention develop list german analyz assum empti list stopword stopword file n't found ll attach patch make throw ioexcept instead also patch make sure file reader close
patch usag feedback indexfil demo small patch add usag output demo call without paramet make littl bit friendlier beginn
patch npe java.io.tmpdir exist org.apache.lucene.store.fsdirectori lucene-1.3-fin line 170-171 file tmpdir new file system.getproperti java.io.tmpdir file tmpdir.list directori specifi properti java.io.tmpdir exist null pointer except thrown perhap check see directori exist order n't use directori know exist e.g /temp directori directori creat earlier creat method
lucen requir ant 1.6 latest version cvs april 3rd build ant 1.6 intent build.txt updat 's error get ant 1.5 build fail file /users/skybrian/remote-cvs/jakarta-lucene/build.xml:11 unexpect element tstamp
fileinputstream never close htmlparser htmlparser.java contain code public htmlparser file file throw filenotfoundexcept new fileinputstream file fileinputstream close close method 's guarante garbag collect run n't know fix without chang api take fileinputstream instead file call must first thing constructor i.e creat stream call close stream
patch order spanqueri slop fail cvs 7 april 2004 order spanqueri slop 1 queri w1 w2 w3 document w1 w3 w2 w3 fail match w1 w2 w3
patch field.tostr could help org.apache.lucene.document.field.tostr default use object.tostr sensibl field e.g isstor isindex istoken field make debug slight difficult realli need pleas find past possibl altern print field human consumpt public final string tostr stringbuff result new stringbuff isstor isindex istoken result.append text els result.append keyword els xxx warn token index result.append unindex els isindex istoken result.append unstor els result.append unstoreduntoken els result.append nonsense_unstoredunindex result.append result.append name result.append readervalu null result.append readervalue.tostr els result.append stringvalu result.append return result.tostr nb im work cvs head
addindex unexpect close index seem 1.4rc2 call indexwriter.addindex indexread close provid indexread 1.3-final happen code use addindex merg new inform index call close indexread crash alreadi close except attach test code work 1.3 1.4rc2 would help intent chang behavior need document thank
patch new method document.remov 's patch add remov method document class +test case use convert class return lucen document object need make chang object case want index pdf file save blob databas file need save temporari file file name given pdf convert class pdf convert save name temporari file name file name n't make sens code need remov filenam field re-add time column primari id possibl attach patch
inconsist behaviour sort field relat document stringsortedhitqueu generatesortindex seem mistak termenum valu indic sort field entri index case search match result arrayindexoutofbound except thrown sortvalu line 177 stringsortedhitqueu generatesortindex creat term array zero length fieldord contain 0 document would seem help generatesortindex catch lack document sort field b reserv term 0 special valu document match sort field valu ie chang current implement add 1 index chang term 0 ensur sort untag document first last applic id much prefer solut b allow much smaller index make search use sort valu less brittl that best communic skill muster could chang current code someth like privat final int generatesortindex throw ioexcept final int retarray new int reader.maxdoc final string mterm new string reader.maxdoc 1 guess length retarray.length 0 termdoc termdoc reader.termdoc chang valu control document without sort field come first last mterm 0 xxxxxxxxx chang int 1 current term number xxxxxxxxxxxxx chang tri term term enumerator.term term.field field break store term text expect one term per document mterms.length throw new runtimeexcept term document field +field+ mterm term.text store document use term termdocs.seek enumer termdocs.next retarray termdocs.doc t++ enumerator.next final termdocs.clos less term document trim dead array space mterms.length term new string system.arraycopi mterm 0 term 0 els term mterm return retarray quick look integersortedhitqueu would seem possibl thing mayb creat integ wrapper object hope made sort sens im familiar code lucen terminolog seem like use approach id glad generat patch clean version thank sam
patch better lock obtain time error messag attach patch print complet path name lock file simplifi debug 's actual wish wiki
patch remov unus variabl seem 'm person unus variabl warn turn eclips patch remov unus variabl import search packag n't introduc chang function review anyway might case variabl *should* use bug
patch filteredtermenum code cleanup filteredtermenum 's constructor take two paramet n't use patch chang thus make code easier readabl mayb old constructor kept deprec 'm sure version seem cleaner
classcastexcept multiread see origin messag sure bugzilla pleas oti p.s line 274 line 273 cvs head rasik pandey rasik.pandey ajlsm.com wrote howdi except thrown 1.4rc3 need test case one java.lang.classcastexcept org.apache.lucene.index.multitermenum. init multireader.java:274 org.apache.lucene.index.multireader.term multireader.java:187 regard rbp unsubscrib e-mail lucene-dev-unsubscrib jakarta.apache.org addit command e-mail lucene-dev-help jakarta.apache.org unsubscrib e-mail lucene-dev-unsubscrib jakarta.apache.org addit command e-mail lucene-dev-help jakarta.apache.org
patch document typo small patch fix typo chang first sentenc one use javadoc kind summari someth use jakarta lucen api divid sever packag
encod germananalyzer.java germanstemmer.java n't utf-8 pylucen gcj/swig base python integr java lucen would good java sourc file n't use encod utf-8 window system without iconv support general compil code gcj java sourc text anoth encod utf-8 difficult imposs chang encod file iconv -f iso-8859-1 -t utf-8 germananalyzer.java germananalyzer.java.utf-8 iconv -f iso-8859-1 -t utf-8 germanstemmer.java germanstemmer.java.utf-8
patch binari store field provid binari field type use store byte array lucen index use varieti applic compress text storag imag storag basi implement type storag e.g integ float etc base discuss lucene-dev list start http //marc.theaimsgroup.com/ l=lucene-dev m=108455161204687 w=2 direct base design flesh http //marc.theaimsgroup.com/ l=lucene-dev m=108456898230542 w=2 patch includ updat code unit test includ patch sent lucene-dev list
search sort fail document miss valu test version lucene-1.4-rc2 call question indexsearcher.search queri queri filter filter int ndoc sort sort descript 'm make call search sort field case 'm sort date document result set hit miss valu sort field entir call throw uncaught except sort process result return undesir result prospect patch problem outsid search class ugli e.g tri patch index actual critic function applic thank address -dan
ca n't build lucen 06/13/2004 cvs jdk 1.5.0 root shilo jakarta-lucen /usr/local/ant/bin/ build buildfil build.xml build fail target build exist project total time 1 second root shilo jakarta-lucen /usr/local/ant/bin/ buildfil build.xml init mkdir creat dir /usr/src/jakarta-lucene/build mkdir creat dir /usr/src/jakarta-lucene/dist compile-cor mkdir creat dir /usr/src/jakarta-lucene/build/classes/java javac compil 160 sourc file /usr/src/jakarta- lucene/build/classes/java javac /usr/src/jakarta- lucene/src/java/org/apache/lucene/index/filterindexreader.java:42 releas 1.5 enum keyword may use identifi javac tri -sourc 1.4 lower use enum identifi javac public void seek termenum enum throw ioexcept in.seek enum javac javac /usr/src/jakarta- lucene/src/java/org/apache/lucene/index/filterindexreader.java:42 releas 1.5 enum keyword may use identifi javac tri -sourc 1.4 lower use enum identifi javac public void seek termenum enum throw ioexcept in.seek enum javac javac /usr/src/jakarta- lucene/src/java/org/apache/lucene/index/segmenttermdocs.java:55 releas 1.5 enum keyword may use identifi javac tri -sourc 1.4 lower use enum identifi javac public void seek termenum enum throw ioexcept javac javac /usr/src/jakarta- lucene/src/java/org/apache/lucene/index/segmenttermdocs.java:59 releas 1.5 enum keyword may use identifi javac tri -sourc 1.4 lower use enum identifi javac enum instanceof segmenttermenum segmenttermenum enum .fieldinfo parent.fieldinfo optim case javac javac /usr/src/jakarta- lucene/src/java/org/apache/lucene/index/segmenttermdocs.java:59 releas 1.5 enum keyword may use identifi javac tri -sourc 1.4 lower use enum identifi javac enum instanceof segmenttermenum segmenttermenum enum .fieldinfo parent.fieldinfo optim case javac javac /usr/src/jakarta- lucene/src/java/org/apache/lucene/index/segmenttermdocs.java:60 releas 1.5 enum keyword may use identifi javac tri -sourc 1.4 lower use enum identifi javac ti segmenttermenum enum .terminfo javac javac /usr/src/jakarta- lucene/src/java/org/apache/lucene/index/segmenttermdocs.java:62 releas 1.5 enum keyword may use identifi javac tri -sourc 1.4 lower use enum identifi javac ti parent.tis.get enum.term javac javac /usr/src/jakarta- lucene/src/java/org/apache/lucene/index/terminfosreader.java:63 releas 1.5 enum keyword may use identifi javac tri -sourc 1.4 lower use enum identifi javac segmenttermenum enum segmenttermenum enumerators.get javac javac /usr/src/jakarta- lucene/src/java/org/apache/lucene/index/terminfosreader.java:64 releas 1.5 enum keyword may use identifi javac tri -sourc 1.4 lower use enum identifi javac enum null javac javac /usr/src/jakarta- lucene/src/java/org/apache/lucene/index/terminfosreader.java:65 enum type must local javac enum term javac javac /usr/src/jakarta- lucene/src/java/org/apache/lucene/index/terminfosreader.java:65 identifi expect javac enum term javac javac /usr/src/jakarta- lucene/src/java/org/apache/lucene/index/terminfosreader.java:65 expect javac enum term javac javac /usr/src/jakarta- lucene/src/java/org/apache/lucene/index/terminfosreader.java:66 identifi expect javac enumerators.set enum javac javac /usr/src/jakarta- lucene/src/java/org/apache/lucene/index/terminfosreader.java:66 expect javac enumerators.set enum javac javac /usr/src/jakarta- lucene/src/java/org/apache/lucene/index/terminfosreader.java:66 identifi expect javac enumerators.set enum javac javac /usr/src/jakarta- lucene/src/java/org/apache/lucene/index/terminfosreader.java:66 expect javac enumerators.set enum javac javac /usr/src/jakarta- lucene/src/java/org/apache/lucene/index/terminfosreader.java:68 illeg start type javac return enum javac javac /usr/src/jakarta- lucene/src/java/org/apache/lucene/index/terminfosreader.java:68 releas 1.5 enum keyword may use identifi javac tri -sourc 1.4 lower use enum identifi javac return enum javac javac /usr/src/jakarta- lucene/src/java/org/apache/lucene/index/terminfosreader.java:75 illeg start express javac privat final void readindex throw ioexcept javac javac /usr/src/jakarta- lucene/src/java/org/apache/lucene/index/terminfosreader.java:199 expect javac javac javac /usr/src/jakarta- lucene/src/java/org/apache/lucene/index/terminfosreader.java:200 expect javac javac 21 error build fail /usr/src/jakarta-lucene/build.xml:140 compil fail see compil error output detail total time 4 second root shilo jakarta-lucen
version 1.3 report ioexcept re-creat index version lucen 1.3 final error report re- initi index creat previous java.io.ioexcept could n't delet _26a.f1 problem disappear re-start jvm file may lock index writer action problem appear version 1.2
patch error germanstemmer.java v 1.11 germanstemmer.java v 1.11 lucene-1.4-fin ?? end word replac ss
typo faq found follow typo faq http //lucene.sourceforge.net/cgi- bin/faq/faqmanager.cgi lucen 8 lucen work java applic felxibl applciat
patch fix compil error sandbox 's patch fix compil problem sandbox/analyz start short 1.4 releas deprec warn also fix test chang n't use analyz chang trivial enough n't break anyth could someon appli patch also fix frenchanalyz 's chang file n't manag make clean diff encod problem
patch import cleanup patch remov useless import get less warn eclips
patch cleaner api field.text current four method name field.text method name similar method signatur everyon think conveni method thing behav differ one take reader n't store data one take string know document 's still nice api method behav differ diffent name attach patch deprec two old method add two new one name field.storedtext think much easier understand programm 's point-of-view help avoid bug
bug form n't list latest version
nullpointerexcept compoundfileread hello got nullpointerexcept lucene-class compoundfileread java.lang.nullpointerexcept org.apache.lucene.index.compoundfilereader. init compoundfilereader.java:94 org.apache.lucene.index.segmentreader. init segmentreader.java:97 org.apache.lucene.index.indexwriter.mergeseg indexwriter.java:466 org.apache.lucene.index.indexwriter.flushramseg indexwriter.java:426 org.apache.lucene.index.indexwriter.clos indexwriter.java:236 lucen work fine day nullpointerexcept occur corrupt complet index reason nullpointerexcept follow code lucen sourc file compoundfilereader.java public compoundfileread directori dir string name throw ioexcept boolean success fals tri stream dir.openfil name read directori init file success true final success tri stream.clos catch ioexcept e io-method-cal dir.openfil throw ioexept variabl stream remain null valu statement stream.clos final claus caus nullpointerexcept would suggest chang code stream.clos stream null stream.clos lot reason io-oper like dir.openfil could throw ioexcept guarante io except never occur therefor better handl io except correct issu similar bug 29774 except recommand easi way solv problem
lucen search poor cpu util 4-cpu machin notic class org.apache.lucene.index.fieldinfo use privat class member vector bynumb hashtabl bynam synchron object thus result unessesari lock chang vector bynumb arraylist bynumb hashtabl bynam hashmap bynam synchron object abl get 110 improv perform number search per second sampl block thread thread-32 daemon prio=1 tid=0x082334c0 nid=0xa66 wait monitor entri 4f385000..4f38687c java.util.vector.elementat vector.java:430 wait lock 0x452b93a8 java.util.vector org.apache.lucene.index.fieldinfos.fieldinfo fieldinfos.java:155 org.apache.lucene.index.fieldinfos.fieldnam fieldinfos.java:151 org.apache.lucene.index.segmenttermenum.readterm segmenttermenum.java:149 org.apache.lucene.index.segmenttermenum.next segmenttermenum.java:115 org.apache.lucene.index.terminfosreader.scanenum terminfosreader.java:143 org.apache.lucene.index.terminfosreader.get terminfosreader.java:137 org.apache.lucene.index.segmenttermdocs.seek segmenttermdocs.java:51 org.apache.lucene.index.indexreader.termdoc indexreader.java:364 org.apache.lucene.search.termqueri termweight.scor termquery.java:59 org.apache.lucene.search.booleanqueri booleanweight.scor booleanquery.java:165 org.apache.lucene.search.booleanqueri booleanweight.scor booleanquery.java:165 org.apache.lucene.search.indexsearcher.search indexsearcher.java:154 gov.gsa.search.searcherbypageandsortedfield.search searcherbypageandsortedfield.java:317 gov.gsa.search.searcherbypageandsortedfield.search searcherbypageandsortedfield.java:203 gov.gsa.search.grants.searchgrants.searchbypageandsortedfield searchgrants.java:308 gov.gsa.search.grants.searchservlet.searchbyindex searchservlet.java:1541 gov.gsa.search.grants.searchservlet.getresult searchservlet.java:1325 gov.gsa.search.grants.searchservlet.doget searchservlet.java:500 javax.servlet.http.httpservlet.servic httpservlet.java:740 javax.servlet.http.httpservlet.servic httpservlet.java:853 org.apache.catalina.core.applicationfilterchain.internaldofilt applicationfilterchain.java:247 org.apache.catalina.core.applicationfilterchain.dofilt applicationfilterchain.java:193 org.apache.catalina.core.standardwrappervalve.invok standardwrappervalve.java:256 org.apache.catalina.core.standardpipelin standardpipelinevalvecontext.invokenext standardpipeline.java:643 org.apache.catalina.core.standardpipeline.invok standardpipeline.java:480 org.apache.catalina.core.containerbase.invok containerbase.java:995 org.apache.catalina.core.standardcontextvalve.invok standardcontextvalve.java:191 org.apache.catalina.core.standardpipelin standardpipelinevalvecontext.invokenext standardpipeline.java:643 org.apache.catalina.core.standardpipeline.invok standardpipeline.java:480 org.apache.catalina.core.containerbase.invok containerbase.java:995 org.apache.catalina.core.standardcontext.invok standardcontext.java:2415 org.apache.catalina.core.standardhostvalve.invok standardhostvalve.java:180 org.apache.catalina.core.standardpipelin standardpipelinevalvecontext.invokenext standardpipeline.java:643 org.apache.catalina.valves.errordispatchervalve.invok errordispatchervalve.java:171 org.apache.catalina.core.standardpipelin standardpipelinevalvecontext.invokenext standardpipeline.java:641 org.apache.catalina.valves.errorreportvalve.invok errorreportvalve.java:172 org.apache.catalina.core.standardpipelin standardpipelinevalvecontext.invokenext standardpipeline.java:641 org.apache.catalina.core.standardpipeline.invok standardpipeline.java:480 org.apache.catalina.core.containerbase.invok containerbase.java:995 org.apache.catalina.core.standardenginevalve.invok standardenginevalve.java:174 org.apache.catalina.core.standardpipelin standardpipelinevalvecontext.invokenext standardpipeline.java:643 org.apache.catalina.core.standardpipeline.invok standardpipeline.java:480 org.apache.catalina.core.containerbase.invok containerbase.java:995 org.apache.coyote.tomcat4.coyoteadapter.servic coyoteadapter.java:223 org.apache.jk.server.jkcoyotehandler.invok jkcoyotehandler.java:261 org.apache.jk.common.handlerrequest.invok handlerrequest.java:360 org.apache.jk.common.channelsocket.invok channelsocket.java:604 org.apache.jk.common.channelsocket.processconnect channelsocket.java:562 org.apache.jk.common.socketconnection.runit channelsocket.java:679 org.apache.tomcat.util.threads.threadpool controlrunnable.run threadpool.java:619 java.lang.thread.run thread.java:534
patch setindexinterv indexwrit follow discuss doug see http //article.gmane.org/gmane.comp.jakarta.lucene.devel/5804 patch add setindexinterv indexwrit patch add also getdirectori method indexwrit modifi segmentmerg indexwrit terminfoswrit patch pass test comments/critic welcom julien
fieldcacheimpl cach get rebuilt everi time fieldcacheimpl use weakhashmap store cach object sinc refer cach get releas everi time
patch make getter sortfield field org.apache.lucene.search.sort 'm collector would like use sort object within collector sortfield field access outsid lucen 's packag pleas consid make public getfield method sort object use implement
confus code line line 81 termscor target doc pointer could replac readabl doc pointer target sorri nit pick
patch add stopfilt ignorecas option want abil ignor case stop filter case n't want lower case pass stop filter b/c may need case preserv analysi stream yet don't need stopword n't want appli stopword filter twice
demo deletefil n't delet file path name appear delet term fail delet last document contain term uniqu match mean ca n't remov individu document code attempt remov document specif path slight modifi version demo code directori directori fsdirectory.getdirectori index fals indexread reader indexreader.open directori term term new term path arg 0 path pass via command line arg int delet reader.delet term reader.clos directory.clos system.out.println delet delet document contain term execut alway return delet 0 document contain path enter indexreader.java delet public final int delet term term throw ioexcept termdoc doc termdoc term doc null return 0 int n 0 tri docs.next delet docs.doc n++ final docs.clos return n appear docs.next alway return fals one doc henc delet never call 0 alway return assum also mean multipl match last doc delet either test modifi code follow boolean true tri docs.next delet docs.doc n++ docs.next final docs.clos work expect least attempt delet singl document index succeed wherea previous
javadoc scorer.java termscorer.java javadoc scorer.java termscorer.java also chang build.xml use packag access javadoc target caus minor error javadoc messag compoundfilereader.java fieldinfos.java also fix patch post earlier weight.java broken javadoc link also includ attach patch 5 file cvs top directori 28 juli 2004 depend packag access need termscorer.java might chang declar termscor public class prefer use javadoc packag access build.xml chang java code use packag access javadoc show undocu class eg doc page search packag might encourag folk write javadoc regard paul
patch problem sort logic token field set sortfield text field get token fieldcacheimpl use term sort sort especi one word field think much logic sort field 's string valu sort field token store way ll get correct sort order
patch termvectorread termvectorwrit termvectorreader.clos close stream condit excpet catch rememb thrown stream close unnecessari variabl assign remov code fix typo termvectorread termvectorwrit
patch htmlparser n't pars hexadecim charact refer recent inherit project ex-colleagu use lucen particular html parser ve found made amend parser allow pars decod hexadecim charact refer depend report bug someon might point correct wrong n't seem abl attach fair trivial patch initi bug report case ve fail find instruct generat diff file right format even though 'm sure ve seen somewher
segmentreader.hasseparatenorm alway return fals loop method look like int 0 0 i++ guess 0 replac result.length
patch improv javadoc maxclausecount discuss lucene-dev queri lot term use lot unus buffer space termdoc term document
patch remov synchron code termvectorsread oti latest last patch get rid synchron code termvectorsread includ least 3 file termvectorsreader.diff segmentreader.diff new junit test case testmultithreadtermvectors.java patch generat current cvs version termvectorsread segmentread lucen relat junit test pass fine best regard bernhard
patch demo html parser corrupt foreign charact use html parser pars english nl document eclips post lucen 1.2 regress parser charact come reader obtain getread corrupt charact encod use default machin encod go correct exampl pars chines document english machin result charact except english word corrupt
patch remov equal intern compar conjunctionscor written equal method use doc java.util.compar equal singl arg compar compar anoth one hard ever use patch follow
patch store binari field compress hi promis enhanc binari field patch option compress attach includ necessari diff base latest version cvs also small junit test case test core function binari field compress base implement binari field patch reli found patch 29370 exist unit test pass fine test binari field compress 'm creat index 2700 plain text file avg 6kb per file store file content within index without use compress test creat use indexfil class demo distribut set index store content without compress took 60 sec final index size 21 mb run test switch compress time index increas 75 sec final index size shrink 13 mb less plain text file self need file system 15 mb hope patch help peopl deal huge index want store 300 byte per document display well form summari regard bernhard
occur incomplet implement remot use occur implement readresolv creat problem parallelmultisearch y
memori leak sort post send two day lucen user 's list bug seem someth common bug 30628 bug close invalid 'm send test code everyon tri code singular n't say sens reopen index show reopen leak memori index fill pseudo-r data n't signific process index creation well problem must field cach code use sort affect version lucen 1.4.1 cvs 1.5-rc1-dev code surviv first iter run java -xmx5m lucen 1.4-final end regulari import org.apache.lucene.analysis.standard.standardanalyz import org.apache.lucene.document.docu import org.apache.lucene.document.field import org.apache.lucene.index.indexread import org.apache.lucene.index.indexwrit import org.apache.lucene.index.term import org.apache.lucene.search.hit import org.apache.lucene.search.indexsearch import org.apache.lucene.search.search import org.apache.lucene.search.sort import org.apache.lucene.search.sortfield import org.apache.lucene.search.termqueri import org.apache.lucene.store.directori import org.apache.lucene.store.ramdirectori import java.io.ioexcept import java.text.simpledateformat import java.util.calendar import java.util.d run test lucen 1.4.1 -xmx5m public class reopentest privat static long mem_last 0 public static void main string arg throw ioexcept directori directori create_index int 1 100 i++ system.err.println loop index version indexread getcurrentvers directori search_index directori add_to_index directori privat static void add_to_index directori directori int throw ioexcept indexwrit writer new indexwrit directori new standardanalyz fals simpledateformat df new simpledateformat yyyy-mm-dd document doc new document doc.add field.keyword date df.format new date system.currenttimemilli doc.add field.keyword id cd string.valueof doc.add field.text text tohl neni text writer.adddocu doc system.err.println index size writer.doccount writer.clos privat static void search_index directori directori throw ioexcept indexread reader indexreader.open directori searcher searcher new indexsearch reader print_mem search 1 sortfield field new sortfield 2 field 0 new sortfield date sortfield.str true field 1 new sortfield id sortfield.str fals sort sort new sort field termqueri queri new termqueri new term text text 5\ print_mem search 2 hit hit searcher.search queri sort print_mem search 3 int 0 hits.length i++ document doc hits.doc system.out.println doc doc.tostr print_mem search 4 searcher.clos reader.clos privat static void print_mem string log long mem_fre runtime.getruntim .freememori long mem_tot runtime.getruntim .totalmemori long mem_max runtime.getruntim .maxmemori long delta mem_last mem_fre -1 system.out.println log delta delta free mem_fre use mem_total-mem_fre total mem_tot max mem_max mem_last mem_fre privat static directori create_index throw ioexcept print_mem creat 1 directori directori new ramdirectori calendar c calendar.getinst simpledateformat df new simpledateformat yyyy-mm-dd indexwrit writer new indexwrit directori new standardanalyz true int 0 365 15 i++ document doc new document doc.add field.keyword date df.format new date c.gettimeinmilli doc.add field.keyword id ab string.valueof doc.add field.text text tohl je text writer.adddocu doc doc new document doc.add field.keyword date df.format new date c.gettimeinmilli doc.add field.keyword id ef string.valueof doc.add field.text text je tohl text writer.adddocu doc c.add calendar.day_of_year 1 writer.optim system.err.println index size writer.doccount writer.clos print_mem creat 2 return directori
sort produc duplic run code except thrown believ n't correct behaviour duplic cours index id hit uniqu without sort lucen version 1.4-final 1.4.1 cvs 1.5-rc1-dev import org.apache.lucene.analysis.standard.standardanalyz import org.apache.lucene.document.docu import org.apache.lucene.document.field import org.apache.lucene.index.indexread import org.apache.lucene.index.indexwrit import org.apache.lucene.queryparser.parseexcept import org.apache.lucene.queryparser.querypars import org.apache.lucene.search.hit import org.apache.lucene.search.indexsearch import org.apache.lucene.search.queri import org.apache.lucene.search.search import org.apache.lucene.search.sort import org.apache.lucene.search.sortfield import org.apache.lucene.store.directori import org.apache.lucene.store.ramdirectori import java.io.ioexcept import java.util.hashset import java.util.linkedlist import java.util.listiter import java.util.set run test lucen 1.4 final 1.4.1 public class duplicitytest public static void main string arg throw ioexcept parseexcept directori directori create_index search_index directori privat static void search_index directori directori throw ioexcept parseexcept indexread reader indexreader.open directori searcher searcher new indexsearch reader sort sort new sort new sortfield co sortfield.int fals queri q queryparser.pars sword text new standardanalyz find_dupl searcher.search q sort find_dupl searcher.search q sort use sort searcher.clos reader.clos privat static void find_dupl hit hit string messag throw ioexcept system.out.println messag hit size hits.length set set new hashset int 0 hits.length i++ system.out.println hits.id hits.doc .tostr integ id new integ hits.id set.contain id set.add id els throw new runtimeexcept duplic found index id id system.out.println duplic found privat static linkedlist word static word new linkedlist words.add word words.add sword words.add dwarf words.add whale words.add male privat static directori create_index throw ioexcept directori directori new ramdirectori listiter e_words1 words.listiter listiter e_words2 words.listiter words.siz indexwrit writer new indexwrit directori new standardanalyz true int co 1 int 0 300 i++ e_words1.hasnext e_words1 words.listiter e_words1.hasnext string word1 string e_words1.next e_words2.hasprevi e_words2 words.listiter words.siz e_words2.hasprevi string word2 string e_words2.previ document doc new document doc.add field.keyword co string.valueof co doc.add field.text text word1 word2 writer.adddocu doc 20 0 co++ writer.optim system.err.println index size writer.doccount writer.clos return directori
patch javadoc improv minor fix javadoc improv scorer.java weight.java also fix recent chang introduc minor warn build javadoc add small comment similarity.java individu patch attach
david spencer spell checker improv hy develop spellcheck base david spencer code dsc flexibl structur index inspir dsc 3-4 gram word gram3 gram4 3start 4start 3end 4end transposit index dictonari n't freq field like dsc version 's independ user index add word becom sever field sever index exampl file list word suggestsimilar method return list suggest word sort levenshtein distanc optionali popular word specif field user index list restrict word present specif field user index see test case hope code put lucen sandbox nicola maisonneuv
patch better support gcj compil order workaround http //gcc.gnu.org/bugzilla/show_bug.cgi id=15411 attach patch necessari
patch better support gcj compil two method indexreader.java call delet reserv keyword c++ method caus troubl gcj implement clever workaround renam delet os x dynam linker n't pick-up attach patch renam delet int deletedocu int delet term deletedocu term deprec delet method request doug cut
patch public static member class termvectorswrit hi look implement termvectorswrit ll find bunch public static final member visibl could reduc protect n't see reason public class protect member final valu may somebodi could check either commit enlighten thx bernhard
patch fsdirectori creat method delet file hi current implement fsdirectory.cr silent delet file even empti directori within index directori set new index creat option enabl lucen n't care delet file index directori belong lucen n't think real bug pain somebodi whant store privat inform lucen index directori e.g configur file therefor implement filefilt know intern lucen file extens file would never get touch creat new index current patch enhanc fsdirectori n't think need make avail directori class chang 's depend class regard bernhard
patch comment correct mmapdirectory.java comment end wrong line last chang
disjunctionscor disjunct scorer match minimum nr doc provid skipto use skipto subscor score method abstract disjunctionscor implement disjunctionsumscor exampl
patch multisearch problem similarity.docfreq multisearch invok subsearch subsearch docfreq access similarity.docfreq caus idf 's comput local index rather global caus rank across multipl indic equival rank across entir global collect attach file figur attach provid potenti partial solut proper fix simpl test case rankingtest provid daniel naber chang 1 searcher add topmostsearch field getter setter record outermost searcher default 2 multisearch pass topmostsearch creat subsearch 3 indexsearch call query.weight everywher topmostsearch instead 4 queri provid default implement query.combin multisearch work queri problem possibl problem see 1 address issu remotesearch remotesearch searcher due lack multipl inherit java query.weight requir searcher perhap query.weight chang take searchabl requir chang mani place suspect would break app 2 may place topmostsearch use instead 3 default implement query.combin guess part work termqueri 's fragil default implement hide bug caus queri inadvert omit precis query.combin method 4 prior comment query.combin indic whoever wrote fulli awar problem probabl anoth usag mind whole issu may daniel 's usag test case 's appar probabl n't understand someth
patch fuzzytermenum optim refactor took look see could improv saw speed improv 20 40 make coupl chang patch http //www.hagerfamily.com/patches/fuzzytermenumoptimizepatch.txt patch base head cvs tree oct 22 2004 chang sinc word discard edit distanc word certain threshold updat distanc algorithm abort time calcul determin best possibl outcom edit distanc algorithm threshold sourc code great explan also reduc amount float point math reduc amount potenti space array take first dimens remov potenti divid 0 error one term empti string fix bug illegalargumentexcept thrown class somehow initi wrong instead look argument behavior almost ident except similar set 0.0 guarante minimum similar result saw biggest improv longer word make sens long word bridgetown saw 60 improv biggest improv word farthest away median length word index short word 1-3 charact saw 30 improv medium word saw 10 improv 5-7 charact improv prefix set 0
nullpointerexc index empti field term vector mark harwood mention user 's list run attach code ll get except except thread main java.lang.nullpointerexcept org.apache.lucene.index.termvectorsreader.clon termvectorsreader.java:303 org.apache.lucene.index.segmentreader.gettermvectorsread segmentreader.java:473 org.apache.lucene.index.segmentreader.gettermfreqvector segmentreader.java:507 org.apache.lucene.index.segmentmerger.mergevector segmentmerger.java:204 org.apache.lucene.index.segmentmerger.merg segmentmerger.java:94 org.apache.lucene.index.indexwriter.mergeseg indexwriter.java:618 org.apache.lucene.index.indexwriter.flushramseg indexwriter.java:571 org.apache.lucene.index.indexwriter.clos indexwriter.java:339 tvbug.main tvbug.java:16
patch refactor spanscor refactor common code next skipto remov depend score valu next skipto pass current test speed current version ad minim javadoc iirc discuss depend next skipto score valu n't rememb conclus case depend stay adapt refactor code
index writer constructor flag unclear annoy certain case would n't make sens constructor indexwrit alway creat index n't exist boolean paramet clear instead creat instead javadoc indexwrit public indexwrit directori d analyz boolean creat throw ioexcept construct indexwrit index d. text analyz creat true new empti index creat d replac index alreadi paramet d index directori analyz use creat true creat index overwrit exist one fals append exist index throw ioexcept directori read/written exist creat fals would indexwrit public indexwrit directori d analyz boolean clear throw ioexcept construct indexwrit index d. text analyz clear true index exist locat d eras new empti index creat d. paramet d index directori analyz use clear true overwrit exist one fals append exist index throw ioexcept directori read/written exist current behavior kind annoy app never clear exist index alway append want creat set fals start brand new index chang creat flag keep throw except guess write code check index actual content yet n't chang flag fli
patch multipl wildcard end search pattern return incorrect hit problem search ca hit includ cat ca etc user want 4 letter word start ca card cash return happen multipl end search pattern solut check word match search pattern end still left case match return fals attach patch code generat use diff wildcardtermenum.org 2004-05-11 11:42:10.000000000 -0400 +++ wildcardtermenum.java 2004-11-08 14:35:14.823610500 -0500 -132,6 +132,10 els //to prevent cat match ca wildchar wildcard_char return fals look next charact wildcardsearchpos++
patch indexsearcher.search queri filter ndoc accept zero ndoc caus npe ht.top .score lateron root caus bug test case took time track would necessari attach patch patch throw illegalargumentexcept non posit ndoc current test pass patch appli regard paul
patch queryparser.setoper int made typesaf default_operator_and querypars call setoper queryparser.and look okay compil 's correct ll attach patch use typesaf enum avoid problem 's also getoper method chang name new method get/setdefaultoper n't like seem way avoid compil error peopl switch new version lucen okay commit
document error filteredtermenum point http //nagoya.apache.org/eyebrowse/readmsg listname=lucene-us jakarta.apache.org msgno=11034 document filteredtermenum.term wrong say return current term enumer initi invalid valid next call first time implement constructor two deriv class fuzzytermenum wildcardtermenum alreadi initi object point first match call next access term leav first match suggest replac second sentanc someth like return null term match term enumer check wildcardtermenum one might add note doc constructor fuzzytermenum wildcardtermenum point first element enumer
patch mention rangefilt javadoc maxclausecount
patch lock disabl indexwriter.clos throw nullpointerexcept lock disabl via set system properti disablelucenelock true indexwrit throw nullpointerexcept close reason attempt call writelock.releas fail writelock null correct check case releas trivial patch attach
system properti doc list lockdir instead lockdir system properti document page state lock file directori set system properti org.apache.lucene.lockdir howev implement org.apache.lucene.store.fsdirectori line 56 properti name actual org.apache.lucene.lockdir lower case d lockdir recommend chang document match code
patch loos first match document booleanqueri patch fix loos first match document booleanqueri booleanclause.occur.should ad anoth booleanqueri
patch multifieldquerypars booleanqueri provid adequ support queri across multipl field attach test case demonstr problem provid fix 1 use custom similar elimin tf idf effect isol test 2 creat two document doc1 doc2 two field titl descript doc1 eleph titl eleph descript doc2 eleph titl albino descript 3 express queri albino eleph field problem a. multifieldquerypars wo n't recogn either document contain term due way expand queri across field b express queri titl albino descript albino titl eleph descript eleph score document equival sinc match two queri term 4 comparison maxdisjunctionqueri method expand queri across field use notat repres booleanqueri repres maxdisjunctionqueri albino eleph expand titl albino descript albino titl eleph descript eleph recogn doc2 term match doc1 1 term match score doc2 doc1 refin note actual expans albino queri use titl albino descript albino ~0.1 titl eleph descript eleph ~0.1 caus score maxdisjunctionqueri score highest score mdq subclaus plus 0.1 time sum score mdq subclaus thus doc1 get credit also eleph descript 1/10 much doc2 get cover anoth queri term descript doc3 eleph titl albino eleph descript actual refin expans get highest score wherea pure max without 0.1 would get score doc2 real app tf 's idf 's also come play cours affect either way i.e. mitig fundament problem exacerb
org.apache.lucene.analysis.cn.chinesetoken miss offset decrement appar chinesetoken offset decrement like bufferindex charact other_lett direct affect startoffset endoffset valu critic highlight work correct highlight mark match text base offset valu
patch new method expungedelet ad indexwrit make use docid lucen need way compact docid segment remov hole creat delet way call indexwriter.optim heavi call case index larg small number delet doc call optim practic need new method expungedelet find segment delet document merg segment implement method discuss oti submit patch n't see attach patch accord patch guidlein email lucen mail list thank -john n't see place
indexwriter.addindex result java.lang.outofmemoryerror 'm re-open bug log previous previous bug report disappear issu indexwriter.addindex result java.lang.outofmemoryerror larg merg write ve merg success repetit i.e keep repeat merg success index size grown success rate steadili declin ve reach point merg fail 100 time ca n't merg test indic threshold ~30gb p4/800mb vm 6 index repeat test mani differ machin machin depend repeat test use local attach storag devic storag depend worth believ except occur entir optim process call implicit merg say time appear correct amount byte written new index possibl decoupl merg optim process code snippet follow send class file 120gb data set let know want code sampl directori sourc new directori paths.length directori dest fsdirectory.getdirectori path true indexwrit writer new indexwrit dest new termanalyz stopwords.search_map true writer.addindex sourc writer.clos
fuzzi queri score issu queri automat produc multipl term wildcard rang prefix fuzzi etc current suffer two problem 1 score match document signific smaller term queri volum term introduc match queri foo~ 0.1 wherea match queri foo 1 2 rarer form expand term favour common form idf use fuzzi queri exampl rare mis- spell typic appear result common correct spell attach patch correct issu identifi 1 overrid similarity.coord counteract downplay score introduc expand term 2 take idf factor common form expand term basi score expand term
patch use filter bit next skipto filteredqueri improv perform filteredqueri call score document pass filter pass current test filteredqueri test adapted/extend
night build/javadoc sandbox n't someth think crucial sinc ve lucene-us mail list less 2 month ve seen sever peopl post question ask find document modul avail sandbox answer cours usual download sourc build javadoc sinc keep come figur 'd suggest set night build whole sandbox includ javadoc noth els cut number question think may also ad benefit size user base experi peopl tend will download/instal someth tri ve read doc onlin
testcas standardanalyz per discuss lucene-us 'm attach unit test standardanalyz wrote test read comment standardtokenizer.jj grammar someon familiar grammar intent review test
combin booleanqueri phraseprefixqueri provok unsupportedoperationexcept booleanqueri includ phraseprefixqueri caus except thrown booleanscor skipto search execut java.lang.unsupportedoperationexcept org.apache.lucene.search.booleanscorer.skipto booleanscorer.java:189 org.apache.lucene.search.conjunctionscorer.donext conjunctionscorer.java:53 org.apache.lucene.search.conjunctionscorer.next conjunctionscorer.java:48 org.apache.lucene.search.scorer.scor scorer.java:37 org.apache.lucene.search.indexsearcher.search indexsearcher.java:92 org.apache.lucene.search.hits.getmoredoc hits.java:64 org.apache.lucene.search.hits. init hits.java:43 org.apache.lucene.search.searcher.search searcher.java:33 org.apache.lucene.search.searcher.search searcher.java:27 non-lucen code problem appear phraseprefixqueri optim booleanqueri contain one term howev createweight method scorer instead rewrit method queri thus bypass boolean typecheck booleanqueri decid whether use conjunctionscor booleanscor eventu result uoe
date encod limit remov current limit date encod lucen think 's date preserv lexicograf order i.e one date preced anoth date encod valu keep order know difficult integr exist version way remov limit date millisecond encod unsign valu prefix indic posit negat valu detail use hex encod prefix 8216 p 8217 8216 n 8217 posit negat valu got follow result valu -10000 encod nffffffffffffd8f0 -100 nffffffffffffff9c 0 p0000000000000000 100 p0000000000000064 10000 p0000000000002710 preserv order valu encod also hex encod replac character.max_radix encod part code work final static char digit 0 1 2 3 4 5 6 7 8 9 b c 'd e f g h j k l 'm n o p q r 's 't u v w x y z' char prefix time 0 prefix p els prefix n char char new char date_len 1 int index date_len time 0 int b int time 0x0f char index digit b time time 4 index 0 char index 0 char 0 prefix return new string char
patch highlight deleg output escap formatt patch jakarta-lucene-sandbox/contributions/highlight cvs version 3rd februari 2005 patch allow highlight formatt control escap non highlight text well highlight match text exampl formatt highlight match text use xml/html tag work fine plain text contain charact need escap html output i.e howev guarante formatt control method highlight exampl html could form markup also respons escap rest output patch add method encodetext string formatt interfac break chang method call highlight text pass formatt 's highlightterm method simplehtmlformatt public static method perform simpl html escap call htmlencod simplehtmlformatt gradientformatt spangradientformatt updat implement encodetext method call htmlencod method escap output exist formatt maintain exact behaviour appli patch would need implement encodetext method return argument valu without modif e.g public string encodetext string originaltext return originaltext
deprec constructor booleanclaus set new state nick burch report lucene-us patch follow regard paul elschot
weird booleanqueri behavior 's simpl or-connect queri file delet c thank c exist queri hit 1 document follow *same* queri parenthesi result noth file delet c thank c exist anoth combin must file delet +c product +c optim hit 1 document file delet +c product +c optim hit 1 document
patch disabl coord generat booleanqueri 's patch disabl similiarty.coord score automat generat boolean queri coord score factor appropri claus independ specifi user usual appropri claus generat automat e.g. fuzzi wildcard rang queri match automat generat queri current penal match term
patch javadoc correct scorer.java
fileformats.xml n't document compound file stream current version lucen generat segment compound file stream format file fileformat document descript format file
document tii tis file seem sync code document .tii file fileformats.xml seem sync actual code terminfosreader.java specif doc terminfosindex file seem leav sever field read file readindex method well specif re read segmenttermenum constructor get idea
counter field segment file document fileformats.xml counter field current segment file format document
javadoc weight doug 's repli 21 feb 2005 bug 31841
patch nullpointerexcept use nest spanorqueri spannotqueri overview descript 'm use span queri class lucen generat higher score search result search term closer togeth certain situat want exclud term span attempt exclud one term get error exampl queri 'm use brighton tourism -pier -content construct queri object tostr version spannot spannear content brighton content tourism 10 fals spanor content pier content road step reproduc 1 construct spannearqueri must least one term least two make sens 2 construct spanorqueri contain two term 3 construct spannotqueri includ first queri object exclud second spanorqueri 4 execut search actual result null pointer except thrown generat score within search stack trace java.lang.nullpointerexcept org.apache.lucene.search.spans.spanorqueri 1.doc spanorquery.java:174 org.apache.lucene.search.spans.spannotqueri 1.next spannotquery.java:75 org.apache.lucene.search.spans.spanscorer.next spanscorer.java:50 org.apache.lucene.search.scorer.scor scorer.java:37 org.apache.lucene.search.indexsearcher.search indexsearcher.java:92 org.apache.lucene.search.hits.getmoredoc hits.java:64 org.apache.lucene.search.hits. init hits.java:43 org.apache.lucene.search.searcher.search searcher.java:33 org.apache.lucene.search.searcher.search searcher.java:27 com.runtimecollective.search.lucenesearch.search lucenesearch.java:362 expect resut execut search result first search term near queri close togeth without second term queri appear
lock bug org.apache.lucene.store.lock line 57 lucene_1_4_fin branch ++sleepcount maxsleepcount incorrect sleepcount increment compar caus throw except wait least 1 inter chang instead sleepcount++ maxsleepcount self-contain simpl fix submit patch thank -john
fixm src/test/org/apache/lucene/indextest.java index src/test/org/apache/lucene/indextest.java src/test/org/apache/lucene/indextest.java revis 155945 +++ src/test/org/apache/lucene/indextest.java work copi -27,8 +27,7 public static void main string arg tri date start new date fixm og 's hard-cod dir indexwrit writer new indexwrit f \\test new simpleanalyz indexwrit writer new indexwrit file.createtempfil lucenetest idx new simpleanalyz true writer.setmergefactor 20
arrayindexoutofboundsexcept use multifieldquerypars get follow except except thread main java.lang.arrayindexoutofboundsexcept -1 java.util.vector.elementat vector.java:434 org.apache.lucene.queryparser.queryparser.addclaus queryparser.java:181 org.apache.lucene.queryparser.queryparser.queri queryparser.java:529 org.apache.lucene.queryparser.queryparser.pars queryparser.java:108 org.apache.lucene.queryparser.queryparser.pars queryparser.java:87 org.apache.lucene.queryparser.multifieldqueryparser.pars multifieldqueryparser.java:77 idx.mquery.main mquery.java:64 use queri and like bla blo 5 field one field token return token queri togeth trigger except
patch add term index interv accessor possibl folk set index interv use write index
test compil error lucenc test fail follow error latest revis svn compile-test mkdir creat dir /opt/lucene/lucene/build/classes/test javac compil 79 sourc file /opt/lucene/lucene/build/classes/test javac /opt/lucene/lucene/src/test/org/apache/lucene/index/terminfostest.java:89 resolv symbol javac symbol constructor terminfoswrit org.apache.lucene.store.directori java.lang.str org.apache.lucene.index.fieldinfo javac locat class org.apache.lucene.index.terminfoswrit javac terminfoswrit writer new terminfoswrit store word fis see terminfoswrit chang two day back add anoth argument interv constructor mail list lucen seem respond send email subscrib bounc back also see mail march 2nd archiv either user dev list use bug databas inform test failur submit simpl patch use valu 128 default terminfoswrit class interv test case
fieldsortedhitqueue.lessthan final final seem provid littl benefit take away abil special method need forc custom lucen remov final
patch extens binari field allow fix byte buffer simpl patch support store binari valu index effici new field constructor accept length argument allow fix byte reus across multipl call argument differ size companion chang fieldswrit use length store and/or compress field one remain case document intent direct accessor length binari field provid document field field 's creat fieldread never specifi length usual case field 's read document seem less confus user n't believ upward incompat introduc e.g. possibl get larger byte actual hold valu document sinc byte valu possibl without patch anyway compress case still ineffici much copi hard see lucen much better howev applic compress extern pass reus compression-output buffer binari valu 'm repres substantiali alloc save store larg document bodi compress lucen index two patch file attach creat svn 3/17/05
patch perform improv disjunctionsumscor recent profil new booleanscorer2 show quit bit cpu time spent advanceaftercurr method disjunctionscor priorityqueu scorer use patch reduc intern overhead disjunctionscor 70 current one ie 30 save cpu time also reduc number call subscor measur get necessari special priorityqueu scorer add move code fragment disjunctionscor special queue
subscrib hello sent email lucene-dev-subscrib jakarta.apache.org alway return fail lucene-dev-subscrib jakarta.apache.org sorri mailbox name 5.1.1 pleas help subscrib
surround queri languag copi post year ago whole thing herebi licenc apach licenc 2.0 copyright 2005 apach softwar foundat inclus lucen sandbox perhap need least follow adapt renam packag name org.surround somewher org.apache.lucen move sourc file correspond directori although use identifi sncf place 'm associ french railroad like tgv regard paul elschot
use lucen unsign applet due java secur restrict lucen sourc file call system.getproperti perform coupl oper within static initi assum full java 2 permiss prevent lucen use unsign applet embed browser page sinc default secur permiss applet prohibit read properti would suggest wrap initi properti try/catch block mean coupl properti would need made non-fin case getter setter method might desir allow applet programm chang properti valu runtim variabl public static could chang direct without accessor problem occur ship 1.4.3 version well latest 07-apr-2005 sourc code fetch cvs current file affect org.apache.lucene.index.indexwrit org.apache.lucene.index.segmentread org.apache.lucene.search.booleanqueri org.apache.lucene.store.fsdirectori modifi version file suggest chang plus simpl test applet associ file demonstr situat sampl applet launch browser either double-click file local put web server launch http url soon figur attach bug report ll p.s topic came august 2004 lucen dev mail list far tell yet resolv
booleanqueri assum everyth els implement skipto skipto seem option function scorer class booleanscor n't implement booleanquery.scor test subclaus use instanceof booleanqueri determin use conjunctionscor requir skipto function mean new query/scor n't implement skipto get troubl includ booleanqueri skipto realli option way tell scorer queri generic manner option 1 boolean scorer.hasskipto method 2 boolean query.hasskipto method 3 remov scorer.skipto public interfac scorerskipto boolean skipto int doc scorer may implement
rangequeri add equal hashcod method 'm attach patch equal hashcod implement rangequery.java new unit test testrangequery.java per recent messag lucene-us mail list subject rangequeri n't overrid equal hashcod intent patch follow
unmatch right parenthes truncat queri queri processor truncat queri right parenthes unmatch e.g secret illeg access confidenti result parseexcept instead run secret illeg
sort field n't exist 's possibl search field n't exist ll get 0 hit ll get except tri sort field valu except termenum.term null throw new runtimeexcept term field field ll attach chang suggest yonik seeley remov except also if-condit incomplet anyway current except alway thrown termenum .term might well null point term differ field alreadi
patch ant macro javadoc javadocs-intern remov duplic introduc build.xml javadocs-intern build target ad regard paul elschot
gcj build fail jdk 1.5 build.xml n't specifi target vm version use jdk 1.5 mean compil .class file automat made 1.5 java.lang.stringbuild insidi use string concaten gcj n't seem includ class yet get gcj build die tri read class file step reproduc 1 instal sun jdk 1.5 java compil 2 check lucen svn 3 ant gcj expect behavior build lucen .class file .jar jdk compil compil .a gcj actual behavior gcj build fail complain unabl find java.lang.stringbuild suggest fix ad source= 1.3 target= 1.3 javac task seem take care patch attach addit note use lucen svn gcj pull gcc cvs circa 2005-04-19 ant 1.6.2
gcj makefil hardcod compil command src/gcj/makefil hardcod command name gcj gcjh g++ make difficult compil particular version gcj multipl instal suffix eg gcj-4.0 step reproduc 1 configur compil instal gcc/gcj someth like program-suffix=-4.0 2. cd ~/src/lucen ant gcj expect result somehow abl specifi compil actual result ca n't find gcj execut wors run wrong version suggest fix common variabl name like cc forc c compil allow builder overrid compil command use set option environ variabl gcj etc patch attach addit info build lucen svn 2005-04-19
contribut effici sort datefield/datetool encod timestamp long valu hello tim promis sort function long valu includ attach file patchtestsort.txt contain diff info modif testsort.java class org.apache.lucene.search.zip contain three new class file effici sort long field valu encod timestamp field valu long valu let know question regard rus
new greek analyz lucen would like contribut greek analyz lucen base exist russian analyz featur common greek charact set unicod iso-8859-7 windows-1253 collect common greek stop word convers charact diacrit accent diaeresi lower case filter well handl special charact small final sigma charact set use rfc 1947 greek charact encod electron mail messag refer incorpor analyz luke well use success recent project compani eb ltd. hope find use addit project
contribut high-perform single-docu main memori apach lucen fulltext search index contribut high-perform single-docu main memori apach lucen fulltext search index ll tri attach file hope comment proceed
constantscorerangequeri fix mani claus except constantscorequeri wrap filter repres set document return constant score document set constantscorerangequeri implement rangequeri work number term rang rewrit constantscorequeri wrap rangefilt still need unit test class test work fine in-hous current test reli much applic specif code code review weight implement 'm unsur got score normal stuff right explain implement note requir java 1.4 bitset.nextsetbit
rang queri work lower case term perform rang queri return result term lower case return result term mix case collect term alpha beta delta gamma use standardanalyz index search queri alpha gamma return four term perform queri alpha gamma result return appear lowercasefilt part standardanalyz work proper search term ve use luke peek collect term lower case collect 'm fair new lucen hope 'm make common mistak
patch n't delet file index directori index creation mani peopl use lucen index part file system chanc day mix index directori document directori n't bad current lucen delet *all* file index directori creat paramat pass indexwrit true thus delet document mix paramet ll attach patch fix object
rev 169301 wrong directori name build.xml build.xml mention non-exist directori contrib/wordnet/ read contrib/wordnet line 418. result svn diff correct work version build.xml build.xml revis 169301 +++ build.xml work copi -415,7 +415,7 todo find dynam way includ multipl sourc root packageset dir= src/java packageset dir= contrib/analyzers/src/java packageset dir= contrib/wordnet/src/java packageset dir= contrib/wordnet/src/java packageset dir= contrib/highlighter/src/java packageset dir= contrib/similarity/src/java packageset dir= contrib/spellchecker/src/java
contrib main memori base synonymmap synonymtokenfilt contrib main memori base synonymmap synonymtokenfilt appli svn trunk well 1.4.3
patch indexwriter.maybemergeseg take lot cpu resourc note believ situat 1.4.3 svn head analysi use hprof util show index creation mani document highlight cpu spend larg portion 's time indexwriter.maybemergeseg seem wast compar valuabl cpu intens oper token etc use follow test snippet retriev row db creat index analyz new standardanalyz writer new indexwrit indexdir true writer.setmergefactor 1000 writer.setmaxbuffereddoc 10000 writer.setusecompoundfil fals connect drivermanager.getconnect jdbc inetdae7 tower.aconex.com database= somedb secret squirrel string sql select userid userfirstnam userlastnam email userx log.info sql= sql statement statement connection.createstat statement.setfetchs 5000 log.info execut sql resultset rs statement.executequeri sql log.info resultset retriev int row 0 log.info index user long begin system.currenttimemilli rs.next int userid rs.getint 1 string firstnam rs.getstr 2 string lastnam rs.getstr 3 string email rs.getstr 4 string fullnam firstnam lastnam document doc new document doc.add field.keyword userid userid+ doc.add field.keyword firstnam firstname.tolowercas doc.add field.keyword lastnam lastname.tolowercas doc.add field.text name fullname.tolowercas doc.add field.keyword email email.tolowercas writer.adddocu doc row++ row 100 ==0 log.info row index doubl end system.currenttimemilli doubl diff end-begin /1000 doubl rate row/diff log.info rate +rate 1.5ghz powerbook 1.5gb ram 5400 rpm drive cpu max end get rate index 490-515 documents/second run 10 time success appli simpl patch indexwrit see attach short defer call maybemergeseg call everi 2000 time arbitrari figur appear get new rate 945-970 documents/second use luke look insid index creat 2 appear differ number document number term 'm suggest one appli patch 'm highlight differ perform sort chang give use lucen index 4 million construct document record speed index process best interest one consid amount cpu time spent maybemergeseg initi index creation 4 million document think one could see would ideal tri speed area least move bottleneck io woul appreci anyon take moment comment
matchalldocsqueri return document would nice type queri return document index
patch field method use classcast check instead instanceof slow sure lucen histor need work older jvm 's modern jvm 's instanceof much quicker field.stringvalu .readervalu .binaryvalu method use classcastexcept check use follow test-b class see instanceof mile quicker packag com.aconex.index public class classcastexceptiontest privat static final long iter 100000 param arg public static void main string arg runclasscasttest 1 warm runclasscasttest 2 runinstanceofcheck 1 runinstanceofcheck 2 privat static void runinstanceofcheck int run long start system.currenttimemilli object foo new foo int 0 iter i++ string test foo instanceof string system.out.println string never print long end system.currenttimemilli long diff end start system.out.println instanceof check run run diff ms privat static void runclasscasttest int run long start system.currenttimemilli object foo new foo int 0 iter i++ string test tri test string foo catch classcastexcept c ignor long end system.currenttimemilli long diff end start system.out.println classcast check run run diff ms privat static final class foo result run 1 classcast check run 1 1660ms classcast check run 2 1374ms instanceof check run 1 8ms instanceof check run 2 4ms run 2 classcast check run 1 1280ms classcast check run 2 1344ms instanceof check run 1 7ms instanceof check run 2 2ms run 3 classcast check run 1 1347ms classcast check run 2 1250ms instanceof check run 1 7ms instanceof check run 2 2ms could explain document field scale wors lot document lot field effect exacerb
inconsist score spantermqueri booleanqueri spantermqueri ad booleanqueri incorrect result return run lucen 1.9 rc1 window xp test case sever test index 4 ident document two termqueri use booleanqueri score look like 4 hit search two term queri id:1 score:0.54932046 id:2 score:0.54932046 id:3 score:0.54932046 id:4 score:0.54932046 notic correct set score document two spanqueri use booleanqueri score look like 2 hit search two span queri id:1 score:0.3884282 id:4 score:0.1942141 notic return two document instead four two return differ score believ error score algorithm make two document show
coordconstrainedbooleanqueri querypars support attach 2 new class 1 coordconstrainedbooleanqueri boolean queri match specifi number contain claus match exampl use might queri return list book 2 peopl list peopl co-author eg lucen action would match erik hatcher oti gospodneti 263 mark harwood doug cut minrequiredoverlap 2 oti erik wrote book java develop ant would match 1 element list erik select 2 customqueryparserexampl customis querypars allow definit coordconstrainedbooleanqueri solut mis use fieldnam pass paramet custom queri
parallelread crash tri merg new index parallelread caus nullpointerexcept org.apache.lucene.index.parallelread paralleltermpositions.seek parallelreader.java:318 tri merg new index see test case sampl output svn diff index src/test/org/apache/lucene/index/testparallelreader.java src/test/org/apache/lucene/index/testparallelreader.java revis 179785 +++ src/test/org/apache/lucene/index/testparallelreader.java work copi -57,6 +57,13 public void testmerg throw except directori dir new ramdirectori indexwrit w new indexwrit dir new standardanalyz true w.addindex new indexread indexsearch parallel .getindexread w.close privat void querytest queri queri throw ioexcept hit parallelhit parallel.search queri hit singlehit single.search queri ant -dtestcase=testparallelread test buildfil build.xml test mkdir creat dir /users/skirsch/text/lectures/da/thirdparty/lucene-trunk/build/test junit testsuit org.apache.lucene.index.testparallelread junit test run 2 failur 0 error 1 time elaps 1.993 sec junit testcas testmerg org.apache.lucene.index.testparallelread caus error junit null junit java.lang.nullpointerexcept junit org.apache.lucene.index.parallelread paralleltermpositions.seek parallelreader.java:318 junit org.apache.lucene.index.parallelread paralleltermdocs.seek parallelreader.java:294 junit org.apache.lucene.index.segmentmerger.appendpost segmentmerger.java:325 junit org.apache.lucene.index.segmentmerger.mergeterminfo segmentmerger.java:296 junit org.apache.lucene.index.segmentmerger.mergeterminfo segmentmerger.java:270 junit org.apache.lucene.index.segmentmerger.mergeterm segmentmerger.java:234 junit org.apache.lucene.index.segmentmerger.merg segmentmerger.java:96 junit org.apache.lucene.index.indexwriter.addindex indexwriter.java:596 junit org.apache.lucene.index.testparallelreader.testmerg testparallelreader.java:63 junit sun.reflect.nativemethodaccessorimpl.invoke0 nativ method junit sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:39 junit sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:25 junit test org.apache.lucene.index.testparallelread fail build fail /users/skirsch/text/lectures/da/thirdparty/lucene-trunk/common-build.xml:188 test fail total time 16 second
wordlistloader.java abl read stopword reader wordlistload abl read stopword reader would exampl allow stopword list store resourc jar file lucen applic diff attach
ngramfilt construct n-gram tokenstream filter construct n-gram token combin fix size sometim call shingl token stream filter set start offset end offset posit increment highlight phrase queri work posit increment 1 input stream replac filler token token termtext endoffset startoffset 0 output n-gram posit increment 1 input stream usual caus remov token eg stopword stream filter use circularfifobuff unboundedfifobuff apach commons-collect filter test case analyz attach
patch fix gcj target ve modifi makefil compil gcj-4.0 involv fix core_obj macro match generat jar file well exclud fieldcacheimpl use .java sourc gcj problem anonym inner class guess also chang behaviour fieldinfos.fieldinfo int depend catch indexoutofboundsexcept except ve modifi test bound first return -1 case help gcj sinc build -fno-bounds-check compil gcj=gcj-4.0 gcjh=gcjh-4.0 gplusplus=g++-4.0 ant clean gcj patch follow
crash queri index use multipl term posit file multipletermpositions.java line 201 function skipto int refer sourc current download lucen site lucen v. 1.4.3 function peek return null top also retrun null check far understand function doc call null-object result nullpointerexcept switch specifi line one _termpositionsqueue.peek null target _termpositionsqueue.peek .doc got rid crash
sort miss string field last sortcomparatorsourc string field order document sort field miss document field revers default lucen implement concept first-pass implement done chris hostett
patch bitsetqueri fastprefixqueri fastwildcardqueri fastquerypars fastprefixqueri fastwildcardqueri rewrit bitsetqueri instead or' booleanqueri 's bitsetqueri contain bitset desgin document includ search result bitsetqueri use multisearch
patch booleanscorer2 arrayindexoutofboundsexcept altern nearspan erik 's post java-dev java caus java.lang.arrayindexoutofboundsexcept 4 java org.apache.lucene.search.booleanscorer2 coordinator.coordfactor booleanscorer2.java:54 java org.apache.lucene.search.booleanscorer2.scor booleanscorer2.java:292 answer probabl nrmatcher increas often score call score
merg error add index indexoutofboundsexcept ve batch-build index ve build coupl hundr index total around 150 million record happen 's probabl imposs reproduc anyway build index around 9.6 million record toward end got java.lang.indexoutofboundsexcept index 54 size 24 java.util.arraylist.rangecheck arraylist.java:547 java.util.arraylist.get arraylist.java:322 org.apache.lucene.index.fieldinfos.fieldinfo fieldinfos.java:155 org.apache.lucene.index.fieldinfos.fieldnam fieldinfos.java:151 org.apache.lucene.index.segmenttermenum.readterm segmenttermenum.java :149 org.apache.lucene.index.segmenttermenum.next segmenttermenum.java:115 org.apache.lucene.index.segmentmergeinfo.next segmentmergeinfo.java:52 org.apache.lucene.index.segmentmerger.mergeterminfo segmentmerger.java:294 org.apache.lucene.index.segmentmerger.mergeterm segmentmerger.java:254 org.apache.lucene.index.segmentmerger.merg segmentmerger.java:93 org.apache.lucene.index.indexwriter.mergeseg indexwriter.java:487 org.apache.lucene.index.indexwriter.maybemergeseg indexwriter.java:458 org.apache.lucene.index.indexwriter.adddocu indexwriter.java:310 org.apache.lucene.index.indexwriter.adddocu indexwriter.java:294
patch contribut querypars pass wildcard prefix queri analyz lucen built-in querypars class analyz prefix wildcard queri attach subclass pass queri analyz well
refactor fieldsortedhitqueu much duplic code 's 40loc duplic fielddocsortedhitqueu :lessthan handl revers sort would readabl actual someth like ymmv field.getrevers c -c
numer rang search larg valu set set enhanc build numer sort cach introduc tim jone provid integ float point rang search numer rang far larg implement via current term rang rewrit mechan 'm new apach tri find attach sourc file chang consider
thread pool implement parallel queri compon replac parallelmultiqueri run thread pool queue instead start thread everi queri execut perform better
littl improv simplehtmlencod simplehtmlencod could improv slight charact code 128 encod charact entiti reason encod know encod use respons therefor safer encod charact beyond ascii charact entiti necessari modif simplehtmlencod default c 128 result.append c els result.append .append int c .append
reduc buffer size termdoc java-dev friday 09 septemb 2005 00:34 doug cut wrote paul elschot wrote suppos one case mani term use queri would easili possibl make buffer size term iter depend number document iter mani term occur document could nice win total buffer size mani term case would difficult look segmenttermdocs.java buffer may alloc parent 's stream first clone clone wo n't alloc buffer sourc n't buffer alloc yet noth perform i/o direct parent 's freqstream practic buffer alloc first read perform clone tri delay buffer alloc bufferedindexinput use clone method public object clone bufferedindexinput clone bufferedindexinput super.clon clone.buff null clone.bufferlength 0 clone.bufferposit 0 clone.bufferstart getfilepoint return clone term document iter seem empti queri test case give result exampl testdemo testboolean2 far see delay work n't idea end quot java-dev doug repli glanc clone method look good without delay buffer alloc reduc buffer size termdoc implement easili
raminputstream ramoutputstream without buffer java-dev doug 's repli 12 sep 2005 delay buffer alloc bufferedindexinput paul elschot wrote notic ramindexinput extend bufferedindexinput data buffer alreadi anoth layer buffer good reason 's histor avoid either bufferedindexinput api would need modifi permit subclass suppli buffer b raminputstream could subclass indexinput direct use buffer latter would probabl simpler end quot made version b raminputstream use raminputstream testtermvectorsread fail fail test
make fieldsortedhitqueu public current util advanc search api sort result use handi fieldsortedhitqueu suggest make class public facilit use ca n't think reason
issu lucene-352 close patch appli current trunk see http //issues.apache.org/jira/browse/lucene-352 thank make jira easier notic lucen java project preselect regard paul elschot
patch bufferedindexoutput optim writebyt method creat patch optim writebyt metod public void writebyt byte b int length throw ioexcept bufferposit 0 flush buffer flush length buffer_s flushbuff b length bufferstart += length els int pos 0 int size pos length length pos buffer_s size length pos els size buffer_s system.arraycopi b pos buffer 0 size pos += size flushbuff buffer size bufferstart += size much faster know index help much copi file indexstor big improv 400 faster old implement patch test 300mb data ant test sucessfuli finish error
patch terminfosread segmenttermenum memori except ve experienc terribl memori problem product search server run lucen 1.4.3 live app regular open new index releas old indexread garbag collect appear memori leak org.apache.lucene.index.terminfosreader.java certain condit possibl relat jvm version although ve person observ linux jvm 1.4.2_06 1.5.0_03 suno jvm 1.4.1 threadloc member variabl enumer n't get garbage-collect terminfosread object gc-ed look code terminfosreader.java 's reason _shouldn't_ gc-ed presum ve seen suggest elsewher could bug garbag collector jvms ve seen problem briefli discuss particular follow url http //java2.5341.com/msg/85821.html patch doug recommend includ lucene-1.4.3 n't work particular circumst doug 's patch clear threadloc variabl thread run final knowledg java break 'm sure thread actual run final situat terminfosread potenti use one thread mean doug 's patch _doesn't_ allow affect jvms correct collect garbag ve devis simpl patch observ linux jvms 1.4.2_06 1.5.0_03 fix problem kieran ps thank daniel naber point jira/lucen -19,6 +19,7 import java.io.ioexcept import org.apache.lucene.store.directori +import java.util.hasht store monoton increas set term terminfo pair directori pair access either term ordin posit -29,7 +30,7 privat string segment privat fieldinfo fieldinfo privat threadloc enumer new threadloc privat final hashtabl enumeratorsbythread new hashtabl privat segmenttermenum origenum privat long size -60,10 +61,10 privat segmenttermenum getenum segmenttermenum termenum segmenttermenum enumerators.get segmenttermenum termenum segmenttermenum enumeratorsbythread.get thread.currentthread termenum null termenum term enumerators.set termenum enumeratorsbythread.put thread.currentthread termenum return termenum -195,5 +196,15 public segmenttermenum term term term throw ioexcept get term return segmenttermenum getenum .clone jvms might troubl gc-ing enumeratorsbythread protect void final throw throwabl tri make sure gc clear enumeratorsbythread.clear final super.fin terminfosreader.java full sourc packag org.apache.lucene.index copyright 2004 apach softwar foundat licens apach licens version 2.0 licens may use file except complianc licens may obtain copi licens http //www.apache.org/licenses/license-2.0 unless requir applic law agre write softwar distribut licens distribut basi without warranti condit kind either express impli see licens specif languag govern permiss limit licens import java.io.ioexcept import org.apache.lucene.store.directori import java.util.hasht store monoton increas set term terminfo pair directori pair access either term ordin posit set final class terminfosread privat directori directori privat string segment privat fieldinfo fieldinfo privat final hashtabl enumeratorsbythread new hashtabl privat segmenttermenum origenum privat long size terminfosread directori dir string seg fieldinfo fis throw ioexcept directori dir segment seg fieldinfo fis origenum new segmenttermenum directory.openfil segment .tis fieldinfo fals size origenum.s readindex public int getskipinterv return origenum.skipinterv final void close throw ioexcept origenum null origenum.clos return number term/valu pair set final long size return size privat segmenttermenum getenum segmenttermenum termenum segmenttermenum enumeratorsbythread.get thread.currentthread termenum null termenum term enumeratorsbythread.put thread.currentthread termenum return termenum term indexterm null terminfo indexinfo long indexpoint privat final void readindex throw ioexcept segmenttermenum indexenum new segmenttermenum directory.openfil segment .tii fieldinfo true tri int indexs int indexenum.s indexterm new term indexs indexinfo new terminfo indexs indexpoint new long indexs int 0 indexenum.next i++ indexterm indexenum.term indexinfo indexenum.terminfo indexpoint indexenum.indexpoint final indexenum.clos return offset greatest index entri less equal term privat final int getindexoffset term term throw ioexcept int lo 0 binari search indexterm int hi indexterms.length 1 hi lo int mid lo hi 1 int delta term.compareto indexterm mid delta 0 hi mid 1 els delta 0 lo mid 1 els return mid return hi privat final void seekenum int indexoffset throw ioexcept getenum .seek indexpoint indexoffset indexoffset getenum .indexinterv 1 indexterm indexoffset indexinfo indexoffset return terminfo term set null terminfo get term term throw ioexcept size 0 return null optim sequenti access first tri scan cach enum w/o seek segmenttermenum enumer getenum enumerator.term null term past current enumerator.prev null term.compareto enumerator.prev 0 || term.compareto enumerator.term 0 int enumoffset int enumerator.position/enumerator.indexinterv +1 indexterms.length enumoffset end block || term.compareto indexterm enumoffset 0 return scanenum term need seek random-access must seek seekenum getindexoffset term return scanenum term scan within block match term privat final terminfo scanenum term term throw ioexcept segmenttermenum enumer getenum term.compareto enumerator.term 0 enumerator.next enumerator.term null term.compareto enumerator.term 0 return enumerator.terminfo els return null return nth term set final term get int posit throw ioexcept size 0 return null segmenttermenum enumer getenum enumer null enumerator.term null posit enumerator.posit posit enumerator.posit enumerator.indexinterv return scanenum posit avoid seek seekenum posit enumerator.indexinterv must seek return scanenum posit privat final term scanenum int posit throw ioexcept segmenttermenum enumer getenum enumerator.posit posit enumerator.next return null return enumerator.term return posit term set -1 final long getposit term term throw ioexcept size 0 return -1 int indexoffset getindexoffset term seekenum indexoffset segmenttermenum enumer getenum term.compareto enumerator.term 0 enumerator.next term.compareto enumerator.term 0 return enumerator.posit els return -1 return enumer term terminfo set public segmenttermenum term return segmenttermenum origenum.clon return enumer term start name term public segmenttermenum term term term throw ioexcept get term return segmenttermenum getenum .clone jvms might troubl gc-ing enumeratorsbythread protect void final throw throwabl tri make sure gc clear enumeratorsbythread.clear final super.fin
snowballfilt lose token posit offset snowballfilt n't set token posit increment thus default 1 also affetc snowballanalyz sinc use snowballfilt
add token.settermtext remov final token class friend class 's packag 1 add settermtext 2 remov final class tostr 3 add clone support 1 tokenfilt packag token abl thing like t.termtext t.termtext.tolowercas effici import less error prone without abil chang *only* term text new token must creat one must rememb set properti correct exact issu caus bug http //issues.apache.org/jira/browse/lucene-437 support 2 remov final allow one subclass token n't see perform impact remov final go detail want subclass token anyon interest support 3 support synonym tokenfilt one need make two token one arg support 1 esp import instanc subclass token
filter need hashcod equal filter need implement hashcod equal esp sinc certain queri type contain filter filteredqueri constantscorequeri
filteredqueri getfilt unless packag ca n't access filter filteredqueri getfilt method ad
intpars floatpars unus fieldcacheimpl fieldcacheimpl n't use intpars floatpars pars valu
testindexmodifier.testindexwiththread valid recent start play trunk svn notic intermit testindexmodifier.testindexwiththread revis 292010 would fail basic premis test seem 3 pair indexthread instanc start parallel pair use instanc indexmodifi concurr random add/delete/optim singl fsdirectori index test consid success sum additions-delet record pair thread equal final doccount indexmodifi instanc use pair thread freeli admit 'm 100 familiar code indexmodifi glanc basic premis seem method indexwrit call open need close indexread first need b method indexread call open need close indexwrit first need 'm understnad correct see reason assum test pass seem like could plenti scenerio number additions-delet doccount trivial exampl think 1 first indexthread instanc chanc run add document optim indexthread ever open directori 2 subsequ pair indexthread instanc open indexmodifi instanc document delet 3 indexthread instanc 2 noth add document pair indexthread garunte record differnet number addit doccount return indexmodifi miss someth test remov
conjunctionscor tune-up recent ran load test latest code lucen use new booleanscor notic conjunctionscor crunch object especi sort part skipto call turn link list array sort array convert array back link list process score engin 'm sure anyon els experienc larg index 4 million item issu heavili nest queri anyway decid chang link list array use first last marker simul link list scale much better load test java gargbag collector less umm virul
standardtoken lose korean charact use standardanalyz exp standardtoken korean text stream standardtoken ignor korean charact definit cjk token standardtokenizer.jj javacc file n't enough rang cover korean syllabl describ unicod charact map patch add one line 0xac00~0xd7af korean syllabl rang standardtokenizer.jj code
search.funct 1 score base field valu 2 simpl score customiz functionqueri return score base field 's valu 's ordin valu functionfactori subclass defin detail function current linearfloatfunct line specifi slope intercept field valu typic obtain fieldvaluesourcefactori implement includ floatfieldsourc intfieldsourc ordfieldsourc
make ant -projecthelp show javadoc doc target well ad descript target javadoc doc make ant show execut ant -projecthelp
option norm applic mani index field norm caus memori problem index queri patch make norm option per-field basi way term vector option per-field overview chang field.omitnorm default fals backward compat lucen file format chang fieldinfos.fieldbit bit omitnorm indexreader.hasnorm method merg segment includ norm norm includ method get norm return equival 1.0f array backward compat patch design backward compat current unit test pass w/o modif requir compat old index sinc default omitnorms=fals compat older/custom subclass indexread sinc default hasnorm provid compat older/custom user indexread weight/scorer/explain sinc norm array produc demand even norm store patch accept direct accept perform score could improv assum 1.0f hasnorm field ==fals
nullpointerexcept temporari directori readabl custom report error caus java.lang.nullpointerexcept org.apache.lucene.store.fsdirectory.cr fsdirectory.java:200 org.apache.lucene.store.fsdirectory.getdirectori fsdirectory.java:144 org.apache.lucene.store.fsdirectory.getdirectori fsdirectory.java:117 org.apache.lucene.index.indexwriter. init indexwriter.java:205 com.atlassian.jira.util.luceneutils.getindexwrit luceneutils.java:46 com.atlassian.jira.issue.index.defaultindexmanager.getindexwrit defaultindexmanager.java:568 com.atlassian.jira.issue.index.defaultindexmanager.indexissuesandcom defaultindexmanager.java:287 59 occur lock directori unread eg tomcat set java.io.tmpdir temp/ permiss broken attach
matchalldocsqueri n't honor boost querynorm matchalldocsqueri n't pay attent either 's boost lucen 's queri normal factor
booleanqueri explain boost==0 booleanweight.explain use return score subweight determin claus match requir claus boost==0 return score zero explain entir booleanweight simpli explan 0.0f match requir 'm sure correct fix n't think done base score alon sinc n't scorer work perhap need new method boolean explain.match return true match regardless score may relat problem even boost zero sometim nice know *why* particular queri fail match would mean longer explan mayb includ non match explain
prefixqueri miss equal method prefixqueri inherit java.lang.object 's object default equal method make hard test work prefixfilt task requir equal work proerpli insert set etc. equal method similar say ident except class cast equal termqueri
use multisearch parallelmultisearch chang sort order use multipl sort criteria first criterium indic differ use field exist given document special rule appli see code sort 0 integ float field null string sort other work correct lucen 1.4.3 trunk long use singl indexsearch except perhap special case see bug report like lucene-374 howev multisearch parallelmultisearch result separ indexsearch merg error occur bug locat fielddocsortedhitqueu even demonstr pass singl indexsearch multisearch testcas patch follow
lazili creat segmentmergeinfo.docmap sinc creat docmap expens 's use segment merg search defer creation request segmentmergeinfo also use multitermenum term enumer multiread termenum use queri prefixqueri rangequeri wildcardqueri well rangefilt datefilt sort first time fill fieldcach perform result simpl singl field index 555,555 document 1000 random delet queri 1000 time prefixqueri match singl document perform patch index time 121,656 ms queri time 58,812 ms perform patch index time 121,000 ms queri time 598 ms 100 fold increas queri perform lucen unit test pass
fieldsread regard offset posit flag creat field fieldsread look storetermvector flag fieldinfo true field.termvector.y use paramet check storeoffsetwithtermvector storepositionwithtermvector set field.termvector.with_offset with_posit with_positions_offset use appropri
duplic hit miss hit sort search use searcher subclass indexsearch get differ result set besid order cours problem occurr searcher wrap parallel multisearch index small number hit return un unsort sort search ident hit referenc differ document closer look result set reveal sort search return duplic hit creat test case lucen 1.4.3 well head releas problem show number duplic bee bigger head realeas test case written packag org.apache.lucene.search messag describ problem written consol order see hint assert comment dont't confus junit report error sorri bee novic user bug tracker n't see mean attach test case screen let 's see
hashcod improv would nice queri class implement hashcod equal enabl use key cach
standardtoken split korean word separ charact standardtoken split korean word inth separ charact token exampl one korean word mean hello standardanalyz separ five token
bad normal sort search return topdoc fieldsortedhitqueue.maxscor maintain lessthan method never get call singl document ad queue ve check test testsort.testtopdocsscor final assert comment
surround test code incompat *test pattern test target attach follow renam booleanquerytest booleanquerytst renam exceptionquerytest exceptionquerytst patch remaind test code use renam class
use float.floattorawintbit float.floattointbit copi email float.floattorawintbit java1.4 give raw float bit without normal like int* floatvar would c sinc n't normal nan valu 's faster hope optim simpl inlin machin instruct jvm pentium4 use floattorawintbit 5 time fast floattointbit realli add someth like similarity.floattobyt encod norm especi use way compress array float queri time suggest doug
searchable.java info deprec tag refer search weight etc version e.g javadoc void search queri queri filter filter hitcollector result state deprec use search queri filter hitcollector instead instead deprec use search weight filter hitcollector instead
parallel- multisearch use sort object chang score exampl hit hits=multisearcher.search queri return differ score document hit hits=multisearcher.search queri sort.relev multisearch parallelmultisearch document return order score second case seem order inspect explan object show score ok 's bug normal score document highest score score 1.0 document score divid highest score assum highest score 1.0 howev multisearch parallelmultisearch normal factor appli *per index* merg result togeth merg ok though exampl use hit hits=multisearcher.search queri sort.relev multisearch two subsearch first document score 1.0 next document subsearch decreas score first document subsearch howev score 1.0 appli sort object less visibl post testcas demonstr problem suggest patch solv moment
refactor slight extens regex test code
gcj ant target n't work window order fix made two chang realli simpl first ad org/apache/lucene/store/gcjindexinput.cc code use window memory-map i/o instead unix mmap rearrang link order makefil order avoid unresolv symbol error also build repeat instruct make ignor return code mkdir command window fail directori alreadi exist 'm attach two patch correspond chang pleas note patch appli gcj target still work linux patch appli clean current svn head
ramdirectori directori dir boolean closedir constructor use memori ineffici recent found ramdirectori directori dir boolean closedir constructor use memori ineffici file sourc index read entir intro memori singl byte array thrown away want load 200m optim compound format index memori faster search give jvm least 400mb memori limit larger index issu ve attach patch solv problem
booleanqueri add public method return number claus queri booleanqueri add public method getclausescount return number claus queri current way get claus count 1 int clausescount booleanquery.getclaus .length
cjk char list seem charact list cjk section standardtokenizer.jj quit complet follow complet list cjk non-alphabet \u1100 \u11ff \u3040 \u30ff \u3130 \u318f \u31f0 \u31ff \u3300 \u337f \u3400 \u4dbf \u4e00 \u9fff \uac00 \ud7a3 \uf900 \ufaff \uff65 \uffdc
multireader.numdoc incorrect undeleteal call multireader.undeleteal clear cach numdoc valu subsequ numdoc call return wrong valu delet document index follow patch fix bug add test show issu index src/test/org/apache/lucene/index/testmultireader.java src/test/org/apache/lucene/index/testmultireader.java revis 354923 +++ src/test/org/apache/lucene/index/testmultireader.java work copi -69,6 +69,18 asserttru vector null testsegmentreader.checknorm reader public void testundeleteal throw ioexcept sis.read dir multiread reader new multiread dir sis fals reader asserttru reader null assertequ 2 reader.numdoc reader.delet 0 assertequ 1 reader.numdoc reader.undeleteal assertequ 2 reader.numdoc public void testtermvector multiread reader new multiread dir sis fals reader index src/java/org/apache/lucene/index/multireader.java src/java/org/apache/lucene/index/multireader.java revis 354923 +++ src/java/org/apache/lucene/index/multireader.java work copi -122,6 +122,7 int 0 subreaders.length i++ subread .undeleteal hasdelet fals numdoc -1 invalid cach privat int readerindex int n find reader doc n
indexreader.getcurrentvers iscurr use commit lock race condit one machin check current version index anoth want updat segment file indexwriter.clos java.io.ioexcept delet segment org.apache.lucene.store.fsdirectory.renamefil fsdirectory.java:213 org.apache.lucene.index.segmentinfos.writ segmentinfos.java:90 org.apache.lucene.index.indexwrit 3.dobodi indexwriter.java:503 org.apache.lucene.store.lock with.run lock.java:109 org.apache.lucene.index.indexwriter.mergeseg indexwriter.java:501 org.apache.lucene.index.indexwriter.flushramseg indexwriter.java:440 org.apache.lucene.index.indexwriter.clos indexwriter.java:242 window platform read content file disallow delet file use lucen maintain index +-700.000 document one server add document server handl search search server poll index version regular check reopen indexsearch everi two day averag indexwriter.clos fail delet previous segment file even though hold commit lock reason probabl search server read segment file check version without use commit lock
je directori implement ve creat port dbdirectori je
queryparser.getfieldqueri string string n't set default slop multiphrasequeri seem oversight call mph.setslop phraseslop queryparser.getfieldqueri string string result case default slop valu doesnt get set right sometim see tri amend testmultianalyz demonstr problem discov grammer apar alway call getfieldqueri string string int even ~slop specifi text pars case pass default specifi clarifi n't comfirm detail read grammer/cod 's ve deduc base observ test problem n't entir obvious unless subclass querypars tri call getfieldqueri string string direct case overridden getfieldqueri string string call super.getfieldqueri string string wrap result disjunctionmaxqueri n't care support ~slop syntax care default slop n't get lucki way querypars getfieldqueri string string int n't get back someth could call setslop default valu got javacc generat code descript may make much sens hopeful test patch 'm attach fix also patch fair trivial disclaim n't javacc instal test patch manual make chang queryparser.java commit someon javacc regen java file confirm jj chang n't weird bug
indexwriter.mergeseg hold commit lock clean happen indexwriter.addindex indexread reader commit lock obtain whenev index structure/vers read written kept short period possibl write lock need make sure one indexwrit indexread instanc updat index multipl indexread cours use index search list file delet store file delet read written indexwrit instanc hold write lock 's need commit lock updat product system delet obsolet segment file mergeseg happen occasion take sever second commit lock block searcher machin updat indexread instanc even standalon machin time updat segment file 3ms time delet obsolet segment 30ms
core test depend demo code testdoc.java test file depend demo filedocu code us n't keep demo code around download break build patch along short
ad doc larg binari field 5mb caus oom regardless heap size report georg washington messag java-us lucene.apache.org subect store larg text binari sourc document index memori usag arround 2006-01-21 seem problem ad doc contain realli larg field ll attach test case moment note regardless big make heap size regardless valu set min_mb start tri make document contain 5mb data add 9 roll die 's output code attach moment junit testsuit org.apache.lucene.document.testbigbinari junit test run 1 failur 0 error 1 time elaps 78.656 sec junit standard output junit note directori clean automat junit dir /tmp/org.apache.lucene.document.testbigbinary.97856146.100iters.4mb junit iter complet 100 junit totalbyt alloc 419430400 junit note directori clean automat junit dir /tmp/org.apache.lucene.document.testbigbinary.97856146.100iters.5mb junit iter complet 9 junit totalbyt alloc 52428800 junit junit testcas testbigbinaryfield org.apache.lucene.document.testbigbinari caus error junit java heap space junit java.lang.outofmemoryerror java heap space junit test org.apache.lucene.document.testbigbinari fail
allow qp subclass support wildcard queri lead would useful user logic prevent querypars creat wildcardqueri lead wildcard charact move grammer base impliment getwildcardqueri may overridden subclass without need modifiy grammer direct
javacc 4.0 fail generat queryparser.java generat java sourc querypars via ant task javacc-querypars subvers trunk updat jan. 25 2006 javacc 4.0 give follow error javacc-querypars javacc java compil compil version 4.0 parser generat javacc type javacc argument help javacc read file /src/java/org/apache/lucene/queryparser/queryparser.jj javacc org.javacc.parser.parseexcept encount line 754 column 3 javacc expect one javacc string_liter javacc javacc javacc detect 1 error 0 warn build fail
datetool need use utc correct collat local timezon europe/london time sun 30 oct 2005 00:00:00 +0000 exact one hour later convert 200530010000 datetools.datetostr minut resolut linux date command use see date date sun 30 oct 2005 00:00:00 +0000 sun oct 30 01:00:00 bst 2005 date date sun 30 oct 2005 01:00:00 +0000 sun oct 30 01:00:00 gmt 2005 time 1am morn one dst forc n't cours actual differ time cours date store index implicit timezon inform get problem clock go back end summer also problem cross timezon databas creat california use pari time go bad skew 's nine hour time differ year
night build archiv contain java sourc code lucen news section overview page item 's link 26 januari 2006 night build avail http //cvs.apache.org/dist/lucene/java/nightly/ goe directori sever 1.9m file none src/java tree
analyz prevent overload search servic queri common term larg index analyz use primarili queri time wrap anoth analyz provid layer protect prevent common word pass queri larg index cost read termdoc common word high analyz creat experi 38 million doc index term around 50 doc caus termqueri term take 2 second use various addstopword method class autom identif addit stop word found alreadi exist index
suggest patch multiphrasequeri querytermextractor use highlight encount problem highlight recogn multiphrasequeri fix develop follow two patch 1 addit org.apache.lucene.search.multiphrasequeri add follow method return set term phrase public term getterm arraylist allterm new arraylist iter iter termarrays.iter iterator.hasnext term term term iterator.next int 0 n terms.length n ++i allterms.add term return term allterms.toarray new term 0 2 patch org.apache.lucene.search.highlight.querytermextractor add follow import import org.apache.lucene.search.multiphrasequeri b add follow code end getterm method els queri instanceof multiphrasequeri gettermsfrommultiphrasequeri multiphrasequeri queri term fieldnam c add follow method privat static final void gettermsfrommultiphrasequeri multiphrasequeri queri hashset term string fieldnam term queryterm query.getterm int 0 queryterms.length i++ fieldname==nul || queryterm .field ==fieldnam terms.add new weightedterm query.getboost queryterm .text team updat repositori thank michael harhen
new tool reset length norm field chang similar ve written littl tool seem like can/wil handi tweak custom similar think would make good addit contrib/miscellan class test attach short
document improv 1.9 releas ve poke arround 1.9-rc1 build notic simpl document thing could clean patch follow 1 add addit info readme.txt 2 updat version info queryparsersyntax.xml fileformats.html advis peopl older version find correct document version 3 build javadoc contrib modul list incomplet
lucen 2.0 requir remov deprec code per move lucen 2.0 1.9 remov deprec code updat document etc patch follow short
need doap file lucen someon pleas draft doap file lucen re list http //projects.apache.org/ doap generat http //projects.apache.org/create.html pleas attach bug report thank
termscor cach valu unnecessarili termscor aggress cach doc freq 32 document time term score queri lot term caus lot garbag creat 's unnecessari segmenttermdoc retriev inform n't optim bulk load 's unnecessari addit score_cach 's limit benefit 's cach result sqrt place defaultsimilar re score document contain term 's need precalcul sqrt especi modern vms enclos patch replac termscor version cach doc feq case lot queri save 196 bytes/term unnecessari disk io extra sqrts add
contrib thaianalyz enabl thai full-text search lucen thai text n't space word usual dictionary-bas algorithm use break string word lucen usabl thai analyz know break thai word need ve implement analyz thaianalyz use icu4j dictionarybasedbreakiter word break ll upload code later 'm normal c++ programm new java pleas review code problem one possibl problem requir icu4j n't know whether ok
fuzzyqueri produc java.lang.negativearraysizeexcept priorityqueue.initi use integer.max_valu booleanquery.maxclausecount priorityqueu creat java.lang.negativearraysizeexcept initi integer.max_valu integ overflow think could general problem priorityqueu error occur set booleanquery.maxclausecount integer.max_valu user fuzzyqueri search
multireader.norm take much memori norm byte made object multireader.norm ineffici construct byte array 's long document everi segment doubl memori requir score multiread vs segment reader although cach 's still baselin memori unnecessari problem normal factor pass around byte instead replac object could perform whole host optim read would n't construct fakenorm array 1.0fs could instead return singleton object would return 1.0f b. multiread could use object could deleg normfactor subread c. could write implement could use mmap access norm factor index n't long live could use implement read direct disk patch provid replac use byte new abstract class call normfactor normfactor two method public abstract byte getbyt int doc throw ioexcept return byte doc public float getfactor int doc throw ioexcept call similarity.decodenorm getbyt doc four implement abstract class 1 normfactors.emptynormfactor replac fakenorm singleton return 1.0 2 normfactors.bytenormfactor convert byte normfactor backward compat constructor 3 multinormfactor multiplex normfactor multiread prevent need construct gigant norm array 4 segmentreader.norm class extend normfactor provid access addit mani queri scorer class chang pass around normfactor instead byte call getfactor instead use byte kept around indexreader.norm string backward compatibiltiy mark deprec believ use bytenormfactor indexreader.getnormfactor keep backward compat indexread implement n't know test
optim memori use short-liv index load terminfoindex know queri ahead time summari provid way avoid load terminfoindex memori know term ever go queri search environ larg number index mani thousand may queri number host index may larg ~1m document sinc low term/doc ratio 7-11m term index interv 128 mean ~70-90k term load index instanti term terminfo string char document long live make sens quick search list term use binari search howev sinc throw away index often lot garbag creat per queri 's exampl load larg index 10 time correspond 7mb garbag per queri percent live alloc' stack class rank self accum byte obj byte obj trace name 1 4.48 4.48 4678736 128946 23393680 644730 387749 char 3 3.95 12.61 4126272 128946 20631360 644730 387751 org.apache.lucene.index.terminfo 6 2.96 22.71 3094704 128946 15473520 644730 387748 java.lang.str 8 1.98 26.97 2063136 128946 10315680 644730 387750 org.apache.lucene.index.term add sinc know exact term re go search even open index 's need alloc much memori upon open index go tii sequenti order retriev entri main term dictionari reduc storag requir dramat reduc amount garbag generat queri 60 make 1 query/index 77 increas throughput accomplish factor index load aspect terminfosread new file segmentterminfosread terminfosread becom base class allow access term new class prefetchedterminfosread upon startup sort pass term retriev indexentri term indexread segmentread modifi take new constructor method take collect term correspond total set term ever search life index order support skip behavior chang need made segmenttermenum specif need abl go back entri order retriev previous terminfo indexpoint unlik normal case index want return valu right intend field behind desir termin main dictionari exampl re look appl index two adjac valu abba argon want return abba instead argon way wo n't miss term real index code confus probabl move subclass termbuff requir code want modifi termbuff keep small also lead odd npe catch segmenttermenum.java stickler contract may want renam segmenttermenum.skipto differ name implement differ contract would use anyon tri skip around tii figur right thing
segmenttermenum.next n't maintain prevbuff end re iter segmenttermenum go past end doc end state nextbuff null prevbuff penultim term last term patch fix 's also requir prefetch bug lucene-506 index java/org/apache/lucene/index/segmenttermenum.java java/org/apache/lucene/index/segmenttermenum.java revis 382121 +++ java/org/apache/lucene/index/segmenttermenum.java work copi -109,6 +109,7 increment enumer next element true one exist public final boolean next throw ioexcept position++ size 1 prevbuffer.set termbuff termbuffer.reset return fals
indexoutput.writestr write length byte chang format string written index length string byte java charact issu discuss http //www.mail-archive.com/java-dev lucene.apache.org/msg01970.html must increment file format number indic chang least format number segment file chang 'm target 2.1 i.e. n't commit trunk 2.0 releas minim incompat chang 1.9 2.0 remov deprec featur
new bufferedindexoutput optim fail updat bufferstart new bufferindexoutput optim writebyt fail updat bufferstart condit test case fix attach
classcastexcept parallelread class classcastexcept paralleread call gettermfreqvector line 153 reason cast key valu swap fix indexread reader indexread e.getvalu string field string e.getkey
remov superflu comment mmapdirectory.java see titl prefer name remov sourc code
multiphrasequeri allow access term
use constantscorequeri remotesearch throw java.io.notserializableexcept use constantscorequeri multisearch searchabl obtain rmi remotesearch throw java.io.notserializableexcept problem seem fact constantscorequery.constantweight searcher member variabl serializ keep refer searcher seem requir fix seem trivial ve creat testcas reproduc issu patch fix
testfsdirectori fail window ant test generat follow error consist run window machin even run user administr privileg junit testcas testtmpdirisplainfil org.apache.lucene.index.store.testfsdirectori caus error junit access deni junit java.io.ioexcept access deni junit java.io.winntfilesystem.createfileexclus nativ method junit java.io.file.createnewfil file.java:828 junit org.apache.lucene.index.store.testfsdirectory.testtmpdirisplainfil testfsdirectory.java:66
document field length count analyz synonym overlay use synonym expans analyz add token zero offset substitut token extend length field document score purpos
fsdirectory.openfil string caus classcastexcept call fsdirectory.openfil string get classcastexcept sinc fsindexinput org.apache.lucene.store.inputstream workaround reimplement use openinput string person n't need fix want document case anyon els run reason reason 'm call requir project creat read index name index segment consist one build next creat optim index renam file rewrit segment file would nice api would allow say want one segment want name foo instanc indexwriter.optim string segmentnam
current implement fuzzi wildcard queri inappropri implement boolean queri rewrit implement multitermqueri term booleanqueri introduc sever problem 1 collis maximum claus limit boolean queri throw except problemat difficult ascertain advanc mani term fuzzi queri wildcard queri might involv 2 boolean disjunct score appropri either fuzzi wildcard queri effect score divid number term queri noth relev result 3 perform disjunct boolean queri larg term set quit sub-optim
fieldsortedhitqueu subsequ string sort differ local sort ident post java-us list look sure 's bug seem 's possibl bug fieldsortedhitqueu specif getcachedcompar show 1.4.3 instal seem sourc code inspect 's bug 's 1.9.1 also issu show need sort result given indexread multipl time use differ local line 180 line number 1.9.1 code scoredoccompar compar lookup reader fieldnam type factori compar found cach new one creat line 193 store cach line 202 howev cach lookup store take account local index reader tri one search sort locale.french one locale.italian first one result cach miss new french compar creat store cach second time lookup find cach french compar even though time local paramet getcachedcompar italian local therefor n't creat new compar use wrong one sort result look unless 'm mistaken fieldcacheimpl.entri class addit properti .local ensur differ local get differ compar patch well one follow immedi
optim indexwriter.addindex one big perform problem indexwriter.addindex optim index ad segment larg index ad batch small updat call optim make use addindex imposs make parallel updat frustrat optim function help call mergeseg newli ad document tri avoid call mergeseg end unless re ad lot document also extens unit test verifi function work correct peopl interest gave differ name differ perform characterist make queri take longer
patch index hadoop distribut file system current project need way creat larg lucen index hadoop distribut file system tri direct dfs use nutch fsdirectori class immedi found index fail dfsindexoutput.seek method throw unsupportedoperationexcept reason behavior clear dfs support random updat seek method ca n't support least easili well ca n't support random updat question realli need search lucen code reveal 2 place call indexoutput.seek method one terminfoswrit anoth one compoundfilewrit n't plan use compoundfilewrit place concern us terminfoswrit terminfoswrit use indexoutput.seek close method write total number term file back begin file simpl chang file format littl bit write number term last 8 byte file instead write begin file place fix order work segmenttermenum constructor read piec inform posit file length 8 format hack abl use fsdirectori write index direct dfs without problem well still n't index direct dfs perform reason least build small local index merg main index dfs without copi big main index back forth
jedirectori delet issu jedirectori delet file proper block left behind due error cursor oper
use wildcardqueri multisearch boolean must_not claus search across multipl indic use multisearch seem problem use wildcardqueri exclud document result set attach set unit test illustr problem test two indic index contain set document field titl section index final aim keyword search across indic titl field abl exclud document certain section subsect use wildcardqueri section field e.g return document indic string xyzpqr titl lie news section subsect section /news/* first unit test testexcludesectionswildcard fail tri relax constraint made test pass n't use wildcardqueri pass news section 's child section exclud explicit testexcludesectionsexplicit /li exclud result one section 's children i.e n't use wildcardqueri testexcludesinglesect /li use wildcardqueri exclud section children use one index therebi use simpl indexread indexsearch object testexcludesectionsoneindex tri boolean must claus rather must_not use wildcardqueri i.e includ result /news/ section children
fix deprec contrib/surround fix deprec contrib/surround
merg multipl index maintain document order merg multipl index singl empti index document addit order maintain self contain test case come soon figur attach
disjunctionmaxqueri lack implement extractterm disjunctionmaxqueri lack implement extractterm
wildcard queri wildcard charact term throw stringindexoutofbound except queri q1 new wildcardqueri new term text hit hit searcher.search q1 caught except java.lang.stringindexoutofboundsexcept string index rang -1 java.lang.string.substr unknown sourc org.apache.lucene.search.wildcardtermenum. init wildcardtermenum.java:65 org.apache.lucene.search.wildcardquery.getenum wildcardquery.java:38 org.apache.lucene.search.multitermquery.rewrit multitermquery.java:54 org.apache.lucene.search.indexsearcher.rewrit indexsearcher.java:137 org.apache.lucene.search.query.weight query.java:92 org.apache.lucene.search.hits. init hits.java:41 org.apache.lucene.search.searcher.search searcher.java:44 org.apache.lucene.search.searcher.search searcher.java:36 quicktest.main quicktest.java:45 erik hatcher feel free log bug report jira issu tracker seem like reason chang make wildcardqueri without wildcard charact would behav like termqueri
multifieldquerypars field boost multipli allow specif boost per field e.g name foo^1 descript foo^0.1 went string field multifieldqueryparser.fieldset field constructor
field select lazi field load patch come short implement field select lazi load mechan document load indexread introduc fieldselector interfac defin accept method fieldselectorresult accept string fieldnam perhap want expand take paramet field metadata term vector etc anyon implement fieldselector defin want load field document fieldselectorresult one four valu load lazy_load no_load load_and_break fieldsread loop fieldsinfo appli fieldselector determin done current field model java.io.filefilt mechan two implement date setbasedfieldselector loadfirstfieldselector former take two set field name one load im one load lazili latter return load_and_break first field encount see testfieldsread exampl support utf-8 borrow code issu 509 thank see testfieldsread exampl ad expert method indexinput name skipchar take number charact skip compromis chang file format field better support seek work readchar n't requir buffer storag n't bitwis oper read appropri number byte prompt ignor use skip non-binari non-compress store field biggest chang far introduct fieldabl interfac per doug 's suggest mail list email lazi field load ago field fieldabl use field chang use fieldabl fieldsreader.lazyfield also implement fieldabl lazi field load implement major caveat document clone under indexinput upon lazi access field valu undefin whether lazi field load indexinput parent close although saw work thought ad reattach method seem easi reload document see testfieldsread dochelp exampl updat coupl test reflect new field dochelp document test pass
index corrupt use ramdirectori directori constructor lucene-475 introduc bug creat ramdirectori larg index truncat length file int origin long valu file larger int truncat patch fix attach
instantiatedindex faster memori consum index repres coupl graph class instanc all-in-memori index store implement deliv search result 100 time faster file-centr ramdirectori cost greater ram consumpt perform seem littl bit better log2n binari search real data eye popul singl document instantiatedindex almost quit fast memoryindex 20,000 document 10-50 charact long instantiatedindex outperform ramdirectori 30x 15x 100 document 2000 characht length linear ramdirectori 10,000 document 2000 charact length mileag may vari depend term satur
make lucen java 1.9.1 avail maven2 repositori ibibilio.org pleas upload 1.9.1 releas ibiblio maven user easili use latest releas current 1.4.3 recent avail version http //www.ibiblio.org/maven2/lucene/lucene/ pleas read follow faq inform http //maven.apache.org/project-faq.html
possibl index corrupt crash replac segment file lucen 's index expect reason toler comput crash index process kill reason toler mean ok lose document current buffer memori repeat work e.g. long merg progress ok entir index larg chunk becom irreversebl corrupt fact lucen work repeat merg sever small segment new larger segment solv crash problem new segment fulli creat old segment still fulli function howev one possibl corrupt remain segment replac code new segment creat new segment file written new file segments.new file renam segment problem renam done use directory.renamefil fsdirectory.renamefil *not* atom first delet old file renam new file crash stage perhap java 's renam also n't guarante atom potenti leav us without work segment file post patch bug short patch also includ chang directory.renamefil 's javadoc current claim replac atom fals fsdirectori instead make weaker claim exampl replac atom must least obey weaker guarante time replac either file still avail file avail either new old content drop guarantee altogeth like java 's file.renameto provid atomic- guarante
matchalldocsqueri multisearch custom hitcollector throw except encount issu lucene1.9.1 involv matchalldocsqueri multisearch custom hitcollector follow code throw java.lang.unsupportedoperationexcept remov matchalldocsqueri condit comment whole //1 block dont use custom hitcollector ms.search mbq instead ms.search mbq allcol except goe away step sourc see seem due matchalldocsqueri implement extractterm searcher searcher new indexsearch c \\projects\\mig\\runtime\\index\\01aug16\\ searchabl index new indexsearch 1 index 0 searcher multisearch ms new multisearch index allcollector allcol new allcollector ms booleanqueri mbq new booleanqueri mbq.add new termqueri new term bodi value1 booleanclause.occur.must_not 1 matchalldocsqueri alld new matchalldocsqueri mbq.add alld booleanclause.occur.must system.out.println queri mbq.tostr 2 ms.search mbq allcol //ms.search mbq
search vs explain score discrep 'm mission demonstr hope fix inconsist score get doc execut search score get ask explan queri doc
parallelread fail delet seek previous unus field use parallelread ve hit two bug 1 parallelreader.dodelet doundeleteal call dodelet doundeleteal subread method set haschang thus chang lost reader close fix call deletedocu undeleteal subread instead 2 parallelread discov field subindex use indexreader.getfieldnam find field occur least one document general parallel index design assign field sub-index term seek includ search may done field even document particular state index yet assign field seeks/search field yet index generat npe parallelread 's various inner class seek next method fieldtoreader.get return null unseen field fix extend add method suppli correct list field subindex patch correct issu attach
indexread current javadoc error current trunk javadoc error indexread contrib
class disjunctionsumscor need public see titl patch follow
support deletedocu indexwrit code perform result provid today applic open/clos indexwrit open/clos indexread direct indirect via indexmodifi order handl mix insert delet perform well insert delet come fair larg batch howev perform degrad dramat insert delet interleav small batch ramdirectori flush disk whenev indexwrit close caus lot small segment creat disk eventu need merg would like propos small api chang elimin problem awar kind chang come discus see http //www.gossamer-threads.com/lists/lucene/java-dev/23049 search_string=indexwrit 20delet 23049 differ time implement chang test perform describ api chang propos ad deletedocu term term method indexwrit use method insert delet interleav use indexwrit note chang would easi add anoth method indexwrit updat document allow applic avoid separ delet insert updat document also note chang co-exist exist api delet document use indexread propos accept think api probabl deprec code chang code chang local indexwrit intern new deletedocu method work buffer term delet delet defer ramdirectori flush disk either becom full indexwrit close use java synchron care taken ensur interleav sequenc insert delet document proper serial attach modifi version indexwrit releas 1.9.1 chang hundr line code chang need chang comment chang also attach modifi version exampl chapter 2.2 lucen action perform result test perform propos chang ran experi use trec wt 10g dataset experi run dual 2.4 ghz intel xeon server run linux disk storag configur raid0 array 5 drive index built input document pars remov html i.e. text index done minim impact pars perform simpl whitespaceanalyz use index build experi three workload insert 1.6m document insert final index size 2.3gb insert/delet big batch document insert 25 delet 1000 document delet everi 4000 insert insert/delet small batch case 5 document delet everi 20 insert current current new workload indexwrit indexmodifi indexwrit insert 116 min 119 min 116 min insert/delet big batch 135 min 125 min insert/delet small batch 338 min 134 min experi show propos chang perform improv 60 insert delet interleav small batch regard ning ning li search technolog ibm almaden research center 650 harri road san jose ca 95120
nearspan skipto bug nearspan appear bug skipto caus skip match document complet discov bug investig problem spanweight.explain far tell bug specif explan seem like could potenti result incorrect match situat spannearqueri nest anoth queri thatskipto use tri creat high level test case exploit bug search could testcas exploit class use nearspan spanscor follow
expos directori indexread would realli use expos index directori indexread class
spannotquery.hashcod ignor exclud file bug tracking/refr may 16 2006 3:33 chris hostett wrote spannodequeri 's hashcod method make two refrenc include.hashcod none exclude.hashcod mistak yes/no date tue 16 may 2006 05:57:15 -0400 erik hatcher java-dev lucene.apache.org subject re spannotquery.hashcod cut/past error yes mistak 'm happi fix look like patch progress
escap quot insid phrase caus parseexcept querypars handl escap quot insid phrase escap quot phrase problem ad testqueryparser.testescap demonstr issu second assert throw except assertqueryequ \\\ b c\\\ d b c\ d assertqueryequ \\\ b c\\\ d\ b c\ d\ see also thread http //www.nabble.com/parseexception-with-escaped-quotes-in-a-phrase-t1647115.html
spellcheck min score increas time minimum score instanc variabl modifi search wrong sinc make 1. thread unsaf 2. work lucki enought use one method call simpli compi instanc variabl local method variabl float min this.min
sweetspotsimiliar new similar impliment contrib/miscellaneous/ packag provid similiarti design peopl know sweetspot data three major piec function includ 1 lengthnorm creat platuea valu 2 baselin tf provid fix valu tf 's minimum point becom sqrt curv use tf int function 3 hyperbol tf function best explain graph equat n't use default avail subclass call tf function constant use function configur case lengthnorm constant configur per field well allow default unspecifi field
summer code gdata server project structur simpl version start initi issu gdata server project googl summer code purpos issu creat project structur svn repositori kick project sourc e.g project locat url http //svn.apache.org/repos/asf/lucene/java/trunk/contrib attach includ diff text file jar file includ lib directori tar.gz file get inform project see http //wiki.apache.org/general/simonwillnauer/summerofcode2006
pre-analyz field add possibl set tokenstream field construt time avail tokenstreamvalu addit stringvalu readervalu binaryvalu might problem mix store field name field tokenstreamvalu
n't throw toomanyclaus except wonder would make sens fall back constantscorequeri instead throw toomanyclaus except
isolatin1accentfilt discard posit increment filter term sure bug look like one
decoupl filter bitset code packag org.apache.lucene.search public abstract class filter implement java.io.serializ public abstract abstractbitset bit indexread reader throw ioexcept public interfac abstractbitset public boolean get int index code would use method =filter.bit return abstract interfac instead =java.util.bitset= use case larg index depend user 's privileg small portion index actual visibl spars popul =java.util.bitset= effici wast lot memori would desir altern bitset implement smaller memori footprint though _is_ possibl deriv class =java.util.bitset= obvious design purpos 's propos use interfac instead default implement could still deleg =java.util.bitset=
ineffici implement multitermdocs.skipto applic anytim index unoptimized/contain one segment sharp drop perform amount 50ms per search averag would consist see drop anytim index went optim state unoptim state track issu implement multitermdocs.skipto function found multireader.java optim index use class search unoptim index comment function even explicit state as yet unoptim implement implement call next even knew could skip ahead hundr thousand hit would re-impl function similar multitermdocs.next function implement test applic correct perform pass test perform penalti multipl segment vanish alreadi put new jar onto product machin implement skipto close mirror accept implement next pleas feel free test commit much optim implement could optim fair easili skip entir segment public boolean skipto int target throw ioexcept current null current.skipto target-bas return true els pointer readers.length base start pointer current termdoc pointer++ return skipto target els return fals
explanation.tohtml output invalid html want html represent explan might call tohtml method howev output method look like follow ul li valu descript /li ul li nest valu descript /li /ul /ul illeg html nest ul direct insid ul method alway output unpars html nest explan lucen probabl mean output follow valid html ul li valu descript ul li nest valu descript /li /ul /li /ul
escap wildcard charact wildcard term handl correct escap wildcard charact specifi wildcard queri treat wildcard instead liter e.g. t\ convert querypars escap charact discard
demo html parser n't work intern document javacc assum ascii wo n't work say japanes document ideal would read charset html markup tricki assum unicod would trick add follow line mark htmlparser.jj option static fals optimize_token_manag true //debug_lookahead true //debug_token_manag true unicode_input true
demo html parser give incorrect summari titl repeat head html document titl repeat head top document htmlparser return titl summari ignor everyth els ad summari instead keep rest summari chop titl part begin essenti opposit n't see benefit repeat titl summari case htmlparser.jj 's getsummari string sum summary.tostr .trim string tit gettitl sum.startswith tit || sum.equ return tit els return sum chang denot line chang string sum summary.tostr .trim string tit gettitl sum.startswith tit n't repeat titl summari return sum.substr tit.length .trim els return sum
add meta keyword htmlparser would good htmlparser could give us keyword specifi meta tag index htmlparser.jj void addmetatag metatags.setproperti currentmetatag currentmetacont currentmetatag null currentmetacont null return one way void addmetatag throw ioexcept metatags.setproperti currentmetatag currentmetacont currentmetatag.equalsignorecas keyword pipeout.writ currentmetacont currentmetatag null currentmetacont null return
spellcheck 's dictionari iter misbehav lucenedictionari luceneiterator.hasnext method two issu make misbehav 1 hasnext call item skip 2 much serious compar fieldnam done rather .equal potenti result noth index
javadoc field constructor reader need comment retain refer n't dig lucen intern n't obvious field constructor http //lucene.apache.org/java/docs/api/org/apache/lucene/document/field.html field 28java.lang.str 20java.io.read 29 retain refer reader use later would use comment ad javadoc say someth like note refer java.io.read retain field reader read document field ad ad index without caller liabl silli thing like close stream construct org.apache.lucene.document.field
gdata server mileston 1 revis improv gdata server crud action entri implement test storagecompon store entri feed user dynam feed element like link ad decoupl server compon storag reqeusthandl etc use lookup servic ad javadoc
ramdirectori implement serializ ramdirectori reason serializ
make explan includ inform match/non-match discuss 'm look possibl improv explan class includ basic info match status explan independ valu http //www.nabble.com/booleanweight.norm 28float 29-doesn 27t-normalize-prohibited-claus t1596471.html a4347644 neccesari deal thing like lucene-451
paralleltermenum broken paralleltermenum.next fail advanc proper new field serious bug christian kohlschuett diagnos root problem under lucene-398 post first patch ve address coupl issu patch close skip field termenum 's generat field iter integr christian 's test case lucen test packag revis patch lucen test pass ve test app make extens use parallelread
deprec document.field add getfield simpl api improv 'm go commit nobodi object
lazi field load break backward compat document.getfield document.getfield chang non backward compat manner simpl code like follow longer compil field x mydoc.getfield x
booleanscorer2 compil ecj booleanscorer2 deriv scorer two inner class deriv ultim scorer defin doc inherit ecj produc error doc call score inner class method countingdisjunctionsumscor countingconjunctionsumscor error messag method doc defin inherit type enclos scope affect line 160 161 178 179 run junit test testboolean2 well other doc chang booleanscorer2.this.doc also this.doc result test pass ad debug statement doc method score method affect class could determin
testconstantscorerangequeri compil ecj testconstantscorerangequeri assertequ string float float call assertequ string int int ecj complain follow error method assertequ string float float ambigu type testconstantscorerangequeri simpl solut suppli assertequ string int int call assert.assertequ string int int patch follow
patch javadoc comment updat booleanclaus javadoc comment updat booleanclaus one minor code simplif
clone -merg error add index indexoutofboundsexcept ve batch-build index ve build coupl hundr index total around 150 million record happen 's probabl imposs reproduc anyway build index around 9.6 million record toward end got java.lang.indexoutofboundsexcept index 54 size 24 java.util.arraylist.rangecheck arraylist.java:547 java.util.arraylist.get arraylist.java:322 org.apache.lucene.index.fieldinfos.fieldinfo fieldinfos.java:155 org.apache.lucene.index.fieldinfos.fieldnam fieldinfos.java:151 org.apache.lucene.index.segmenttermenum.readterm segmenttermenum.java :149 org.apache.lucene.index.segmenttermenum.next segmenttermenum.java:115 org.apache.lucene.index.segmentmergeinfo.next segmentmergeinfo.java:52 org.apache.lucene.index.segmentmerger.mergeterminfo segmentmerger.java:294 org.apache.lucene.index.segmentmerger.mergeterm segmentmerger.java:254 org.apache.lucene.index.segmentmerger.merg segmentmerger.java:93 org.apache.lucene.index.indexwriter.mergeseg indexwriter.java:487 org.apache.lucene.index.indexwriter.maybemergeseg indexwriter.java:458 org.apache.lucene.index.indexwriter.adddocu indexwriter.java:310 org.apache.lucene.index.indexwriter.adddocu indexwriter.java:294
gdata server wrong commit build last gdata server commit build due wrong commit yonik commit file diff file sever sourc packag miss diff file date 26.06.06 appli http //issues.apache.org/jira/browse/lucene-598 26.06.06.diff 644 kb could lucen committ appli patch yonik way dublin thank simon
gdata server testcas deadlock storagemodifi solf racecondit deadlock close storagecontrol occur first time hossman tri run test case concurr modif except iter collect seper thread modifiedentryfilt replac list array hossman get could tri testcas guy time could run testcas differ environ would help resolv bug test case server simon
default lock timeout static setter/gett recent stop use java system properti deriv default thing like write/commit lock timeout switch getter/sett 's across class see http //www.gossamer-threads.com/lists/lucene/java-dev/27447 case least write lock timeout 's mark public final static consum api longer chang valu instanti indexwrit getter/sett static general make sens chang timeout instanc indexwrit indexwrit construct use timeout valu use case need chang valu get instanc indexwrit actual regress lucen user lost function previous upgrad would propos add getter/sett default valu timeout would static ll attach patch file see thread context led issu http //www.gossamer-threads.com/lists/lucene/java-dev/37421
provid lucen maven pleas provid javadoc sourc jar lucene-cor also pleas provid rest lucen jar insid contrib download bundl possibl
ramdirectory.clos comment releas resourc wrong assum call ramdirectory.clos would free memori occupi ramdirectori might help add javadoc comment warn user ramdirectory.clos no-op sinc might common assumpt close would releas resourc
highlight problem overlap token lucen highlight problem token overlap generat exampl analysi ipod generat token pod ipod pod ipod posit highlight output iipod regardless token highlight discov via http //issues.apache.org/jira/browse/solr-24
perform improv merg store compress field hello everyon current merg store compress field optim follow reason everi time store compress field merg fieldsread uncompress data henc fieldswrit compress write merg field data .fdt file uncompress/compress step unneccessari slow merg perform signific patch improv merg perform avoid uncompress/compress step follow give overview chang made ad new fieldselectorresult constant name load_for_merg org.apache.lucene.document.fieldselectorresult segmentmerg use fieldselector get store field fieldsread fieldselector 's accept method return fieldselectorresult load_for_merg everi field ad new inner class fieldsread name fieldformerg extend org.apache.lucene.document.abstractfield class hold field properti data field fieldselectorresult load_for_merg fieldsread creat instanc fieldformerg uncompress field 's data fieldswrit check field write instanceof fieldsreader.fieldformerg true compress field data test perform index 350,000 text file store raw text store compress field lucen index use merg factor 10 final index size 366mb build index optim measur pure merg perform perform result old version time index 36.7 minut time optim 4.6 minut patch version time index 20.8 minut time optim 0.5 minut result show index build time improv 43 optim step 8x faster diff final index old patch version show ident furthermor junit testcas succeed patch version regard michael busch
results.jsp luceneweb.war use unknown parse-method results.jsp luceneweb.war demo throw jasperexcept org.apache.jasper.jasperexcept unabl compil class jsp error occur line 60 jsp file /results.jsp generat servlet error method pars string type querypars applic argument string string analyz think code line 81 results.jsp mayb look like follow querypars qp new querypars content analyz queri qp.pars querystr
gdata server mileston 3 patch bugfix document mileston 3 ad featur updat delet concurr version control second storag impl base db4o distribut storag move configur one singl config file remov depend testcas ad schema valid xml file project configur etc ad javadoc much better perform reus resourc ad recov compon lucen base storag recov entri server crash oom error simpl solv test case fail hyperthread multi core machin hossman give go yonik doug could get stuff svn pleas regard simon
creation spell index lucenedictionari via spellchecker.indexdictionari dictionari dict fail start 1.9.1 current svn version two differ error 1.9.1/2.0.0 current svn version 1.9.1/2.0.0 end indexdictionari dictionari dict indexreader-inst reader close caus nullpointerexcept reader initi neither method constructor uncom line reader.clos seem resolv issu current svn constructor tri creat indexsearcher-inst specifi path index path creat yet except thrown
querypars applic argument string string analyz error results.jsp execut search browser demo lucen 2.0 execut search browser describ demo3.html lucen demo get error demo use method querypars three argument delet deprec check demo lucen 1.4-final lucen 1.4-final work time method demo lucen 2.0 work lucen 2.0 error stack ttp status 500 type except report messag descript server encount intern error prevent fulfil request except org.apache.jasper.jasperexcept unabl compil class jsp error occur line 60 jsp file /results.jsp generat servlet error method pars string type querypars applic argument string string analyz org.apache.jasper.servlet.jspservletwrapper.handlejspexcept jspservletwrapper.java:510 org.apache.jasper.servlet.jspservletwrapper.servic jspservletwrapper.java:375 org.apache.jasper.servlet.jspservlet.servicejspfil jspservlet.java:314 org.apache.jasper.servlet.jspservlet.servic jspservlet.java:264 javax.servlet.http.httpservlet.servic httpservlet.java:802 root caus org.apache.jasper.jasperexcept unabl compil class jsp error occur line 60 jsp file /results.jsp generat servlet error method pars string type querypars applic argument string string analyz org.apache.jasper.compiler.defaulterrorhandler.javacerror defaulterrorhandler.java:84 org.apache.jasper.compiler.errordispatcher.javacerror errordispatcher.java:328 org.apache.jasper.compiler.jdtcompiler.generateclass jdtcompiler.java:409 org.apache.jasper.compiler.compiler.compil compiler.java:297 org.apache.jasper.compiler.compiler.compil compiler.java:276 org.apache.jasper.compiler.compiler.compil compiler.java:264 org.apache.jasper.jspcompilationcontext.compil jspcompilationcontext.java:563 org.apache.jasper.servlet.jspservletwrapper.servic jspservletwrapper.java:303 org.apache.jasper.servlet.jspservlet.servicejspfil jspservlet.java:314 org.apache.jasper.servlet.jspservlet.servic jspservlet.java:264 javax.servlet.http.httpservlet.servic httpservlet.java:802 note full stack trace root caus avail apach tomcat/5.5.15 log
patch decoupl lock implement directori implement spinoff http //issues.apache.org/jira/browse/lucene-305 ve open new issu captur 's wider scope lucene-305 patch origin creat jeff patterson see link modifi describ http //issues.apache.org/jira/browse/lucene-305 action_12418493 small addit chang fsdirectory.getdirectori made correspond version also accept lockfactori instanc construct fsdirectori lockfactori cascad default fsdirectori 's lockfactori implement pass lockfactori instanc 's use els setdisablelock call use nolockfactori els system properti org.apache.lucene.store.fsdirectorylockfactoryclass defin use final ll use origin lock implement simplefslockfactori gist lock code move *directori subclass new abstract lockfactori class set lockfactori directori chang lock exampl creat fsdirectori set lock singleinstancelockfactori know writing/read take place singl jvm chang pass unit test ubuntu linux sun java 1.5 window xp sun java 1.4 ad anoth testcas test lockfactori code note lockfactori default chang fsdirectori default simplefslockfactori ramdirectori default singleinstancelockfactori next step separ issu creat lockfactori use os nativ lock java.nio
patch differ configur lucen instanc jvm current lucen configur use system properti run multipl instanc lucen differ purpos jvm possibl use differ set instanc made chang lucen class pass configur class lucen instanc use set configur chang effect api and/or current behavior backward compat addit chang also made segmentread segmenttermdoc extens outsid packag would appreci inclus chang n't mind creat separ issu
ca n't put non-index file e.g cvs svn directori lucen index directori lucen wo n't toler foreign file index directori make imposs keep index cvs subvers repositori instanc except appear creat ramdirectori java.io.fil contain subdirectori call .svn java.io.filenotfoundexcept /home/local/ejj/ic/.caches/.search/.index/.svn directori java.io.randomaccessfile.open nativ method java.io.randomaccessfile. init randomaccessfile.java:212 org.apache.lucene.store.fsindexinput descriptor. init fsdirectory.java:425 org.apache.lucene.store.fsindexinput. init fsdirectory.java:434 org.apache.lucene.store.fsdirectory.openinput fsdirectory.java:324 org.apache.lucene.store.ramdirectory. init ramdirectory.java:61 org.apache.lucene.store.ramdirectory. init ramdirectory.java:86
maxfieldlength actual limit 1 greater expect valu prepar document document document new document document.add new field name pattern orient softwar architectur store.no index.token termvector.with_positions_offset set max field length 2. indexwriter.setmaxfieldlength 2 add document index indexwriter.adddocu document new standardanalyz creat queri querypars querypars new querypars name new standardanalyz queri queri queryparser.pars softwar search 3rd term hit hit indexsearcher.search queri assert.assertequ 0 hits.length fail actual hits.length 1 expect 0
gdata server indexcompon new featur ad indexcompon content extract entri custom content ext strategi ad user defin index schema extend gdata-config.xml schema xsd indexcompon unittest spellcheck javadoc new jar includ nekohtml.jar xercesimpl.jar yonik n't miss '+ button add directori
contrib anoth highlight approach mark harwood highlight packag great contribut lucen ve use lot howev *large* document field highlight quit time consum increas number byte analyz setmaxdocbytestoanalyz int default valu 50k often low index pdfs etcetera result empti highlight string altern approach use term posit vector build fragment info object stringread read relev fragment skip lot faster also method use *entire* field find best fragment re alway guarante get highlight snippet method work field term posit store one check method work particular field use follow code taken tokensources.java termfreqvector tfv termfreqvector reader.gettermfreqvector docid field tfv null tfv instanceof termpositionvector use fulltexthighlight els use standard highlight someon els might find use 'm post code
highligt fail includ non-token end string highlight follow code extract show problem termqueri query= new termqueri new term data help highlight hg new highlight new simplehtmlformatt new queryscor queri hg.settextfragment new nullfragment string match null tri match hg.getbestfrag new standardanalyz data help 54-65 catch ioexcept e e.printstacktrac system.out.println match sytsem output b help /b 54-65 would expect b help /b 54-65
patch fix various small issu get start demo page patch contain numer small fix get start page lucen java web site rough fix results.jsp chang stopanalyz standardanalyz chang refer url path field url never set therefor alway null remov prefix ../webapp path click work fix typo grammar cosmet thing modern thing chang time name jar file languag analyz etc ad outbound link javadoc wiki lucen static web site extern site appropri remov exact version tomcat demo web app think recent version tomcat work describ small chang net/net think improv version 's avail site today
fix spell mailinglist.xml fix spell mailinglist.xml /java/trunk/xdoc
npe local sensit sort sort field miss local sensit sort field miss document index npe get thrown attach patch resolv issu updat sort test case give coverag issu
poor perform race condit fieldcacheimpl race condit exist fieldcacheimpl caus signific perform degrad multipl thread concurr request valu yet cach degrad particular notic larg index mani concur request cach valu full discuss see mail list thread poor perform race condit fieldsortedhitqueu http //www.gossamer-threads.com/lists/lucene/java-user/38717
compress field extern field document right 2.0 releas lucen support compress store field howev discuss java-dev suggest aros robert engel would better logic move document level way index level store opaqu binari field document handl compress/uncompress need approach would prevent issu like lucene-629 merg segment would never need decompress see thread recent discuss http //www.gossamer-threads.com/lists/lucene/java-dev/38836 also work relat issu lucene-648
gdata-serv storag fix activ depth fix nullpoint except render feed big amount extens db4o context
gdata-serv websit sandbox part ad gdata-serv sandbox part websit xdocs/sandbox/ build websit fine
fieldsinfo use deprec api class fieldsinfo.java use deprec api method public void add document doc ruse replac creat patch see attach
fuzzyqueri final tri extend fuzzyqueri filter termenum index stem form origin form want match origin form fuzzi term otherwis get much nois howev fuzzyqueri final class extend discuss mail list http //www.gossamer-threads.com/lists/lucene/java-dev/38756 want make privat variabl inner class protect attach patch fuzzyquery.java implement ran unit test pass without error andrea
patch perfieldanalyzerwrapp fail implement getpositionincrementgap attach patch caus perfieldanalyzerwrapp deleg call getpositionincrementgap analyz appropri field question current behavior without patch alway use default valu analyz bug perfieldanalyzerwrapp behav analyz select field
gdata html render preview gdata output usual atom rss e.g plain xml featur enabl user admin preview server output html transform user defin xsl stylesheet stylesheet configur per servic 's cool featur develop user wan na use server simpl blog feed server regard simon
build.txt instruct wrong javacc text build.txt javacc say set properti bin directori javacc instal actual set javacc instal directori directori contain bin directori comment common-build.xml correct state
new featur rich higlight lucen well refactor took code two previous highlight highlight use termpositionvector avail use analyz termpositionvector found forc use support lucen queri term phrase slop prefix wildcard rang except fuzzi queri implement easli support score yet use prefix postfix accept term yet 's written java5 next releas 'd like add support fuzzi color f.e diffrent color term btw phrase term slop score fragment 's apach licens hope put licen statement everi file
patch small fix new scoring.html doc awesom initi need doc clean explain inner work lucen general thank grant steve other small initi propos fix larg ad descript around compon formula also coupl typo anoth link wikipedia miss close etc ve made understand score formula section far
javacc skeleton file regener copi charact stream file javacc check svn file generat javacc 3.0 least 's say though javacc 3.2 say javacc 4 complain date wo n't replac must remov regener one side effect remov local chang lost r387550 remov coupl deprec method use file generat javacc deprec method read least javacc team remov total chang made stream file woudl think 's better live unmodifi keep local version chang want javacc recreat file attach patch remov run javacc test pass use javacc3.2 4.0
final -method fsdirectory.fsindexinput fsdirectory.fsindexoutput tri close alreadi close file hi found small problem fsdirectori final -method fsdirectory.fsindexinput fsdirectory.fsindexoutput tri close under file problem unless file close call close method close final method throw ioexcept say file alreadi close usual ioexcept would go unnot garbagecollector call final eat howev use eclips debugg execut code alway suspend except thrown even though except probabl wo n't caus problem normal execut lucen code becom cleaner appli small patch might ioexcept also perform impact thrown frequent attach patch appli clean current svn head testcas pass verfi eclips debugg ioexcept longer thrown
new merg polici new merg polici develop cours http //issues.apache.org/jira/browse/lucene-565 http //issues.apache.org/jira/secure/attachment/12340475/newmergepolicy.sept08.patch
error fsdirectori java.io.tmpdir incorrect specifi user jamwiki project http //jamwiki.org/ report error follow stack trace sever unabl creat search instanc /usr/share/tomcat5/webapps/jamwiki-0.3.4-beta7/test/base/search/indexen java.io.ioexcept creat directori /temp org.apache.lucene.store.fsdirectory.init fsdirectory.java:171 org.apache.lucene.store.fsdirectory.getdirectori fsdirectory.java:141 org.apache.lucene.store.fsdirectory.getdirectori fsdirectory.java:117 org.jamwiki.search.lucenesearchengine.getsearchindexpath lucenesearchengine.java:318 culprit java.io.tmpdir properti incorrect specifi user 's system lucen could easili handl issu modifi fsdirectory.init method current code use index directori java.io.tmpdir org.apache.lucene.lockdir unspecifi could use directori valu unspecifi invalid would make lucen bit robust without break exist instal
lucen benchmark object perform test lucen need object way measur perform lucen index queri known corpus issu intend collect comment patch implement suit benchmark test regard corpus one wide use freeli avail corpora origin reuter collect avail http //www-2.cs.cmu.edu/afs/cs.cmu.edu/project/theo-20/www/data/news20.tar.gz http //people.csail.mit.edu/u/j/jrennie/public_html/20newsgroups/20news-18828.tar.gz propos use corpus base benchmark benchmark suit could automat retriev known locat cach local
promot solr 's prefixfilt java lucen 's core solr 's prefixfilt class specif solr seem interest core lucen user pylucen case promot lucen core would help
patch lockfactori implement base os nativ lock java.nio current default lock fsdirectori simplefslockfactori use java.io.file.createnewfil lock spooki warn sun 's javadoc note method use file-lock result protocol made work reliabl filelock facil use instead patch provid lockfactori implement base filelock use java.nio.* unit test pass patch os x 10.4.8 linux ubuntu 6.06 window xp sp2 anoth benefit nativ lock os automat free jvm exit lucen free lock mani peopl seem hit old lock file still disk ve creat new class org.apache.lucene.store.nativefslockfactori ad coupl test case exist testlockfactori ve left simplefslockfactori default lock fsdirectori think get usag experi nativefslockfactori later make default lock implement also test chang fsdirectori 's default lock nativefslockfactori unit test still pass platform one import note lock nfs nfs server and/or client support 's configur option mode must explicit enabl 's misconfigur 's abl take long time 35 second case throw except handl acquir releas random test lock creat nativefslockfactori verifi lock configur proper small chang patch ad failur reason lock.java obtain lockwaittimeout persist ioexcept tri obtain lock messag includ lock obtain time 's rais correct javadoc simplefslockfactori previous said wrong system properti overrid lock class via system properti fix unhandl ioexcept open indexwrit creat lock dir exist ad lockdir.exist check clearalllock method simplefslockfactori nativefslockfactori fix small unrel issu testlockfactori also fix test accept nativefslockfactori default lock implement fsdirectori fix typo javadoc fieldsreader.java ad javadoc lockfactory.setlockprefix
clone -querypars applic argument string string analyz error results.jsp execut search browser demo lucen 2.0 execut search browser describ demo3.html lucen demo get error demo use method querypars three argument delet deprec check demo lucen 1.4-final lucen 1.4-final work time method demo lucen 2.0 work lucen 2.0 error stack ttp status 500 type except report messag descript server encount intern error prevent fulfil request except org.apache.jasper.jasperexcept unabl compil class jsp error occur line 60 jsp file /results.jsp generat servlet error method pars string type querypars applic argument string string analyz org.apache.jasper.servlet.jspservletwrapper.handlejspexcept jspservletwrapper.java:510 org.apache.jasper.servlet.jspservletwrapper.servic jspservletwrapper.java:375 org.apache.jasper.servlet.jspservlet.servicejspfil jspservlet.java:314 org.apache.jasper.servlet.jspservlet.servic jspservlet.java:264 javax.servlet.http.httpservlet.servic httpservlet.java:802 root caus org.apache.jasper.jasperexcept unabl compil class jsp error occur line 60 jsp file /results.jsp generat servlet error method pars string type querypars applic argument string string analyz org.apache.jasper.compiler.defaulterrorhandler.javacerror defaulterrorhandler.java:84 org.apache.jasper.compiler.errordispatcher.javacerror errordispatcher.java:328 org.apache.jasper.compiler.jdtcompiler.generateclass jdtcompiler.java:409 org.apache.jasper.compiler.compiler.compil compiler.java:297 org.apache.jasper.compiler.compiler.compil compiler.java:276 org.apache.jasper.compiler.compiler.compil compiler.java:264 org.apache.jasper.jspcompilationcontext.compil jspcompilationcontext.java:563 org.apache.jasper.servlet.jspservletwrapper.servic jspservletwrapper.java:303 org.apache.jasper.servlet.jspservlet.servicejspfil jspservlet.java:314 org.apache.jasper.servlet.jspservlet.servic jspservlet.java:264 javax.servlet.http.httpservlet.servic httpservlet.java:802 note full stack trace root caus avail apach tomcat/5.5.15 log
lazi field load edg case bug caus read past eof tri run benchmark lazi file load discov seem edg case access last field last doc index problem seem happen doc access least one doc tri dig code find root caus testcas follow
refras javadoc 1st sentenc indexreader.deletedocu
perform improv lazi skip proxim file hello 'm propos patch chang org.apache.lucene.index.segmenttermposit avoid unnecessari skip read proxim stream current call next seek caus movement document freq file also move prox pointer post list document necessari actual posit retriev particular document consid exampl phrase queri two term freq pointer term 1 move document x answer question term occur document *only* term 2 also match document x posit read figur term 1 term 2 appear next document x thus satisfi queri move post list document quit expens skip last skip point document document skip point desir document scan mean vint posit document read decod improv move prox pointer lazili document nextposit call becom even import futur size proxim file increas e. g. ad payload post list patch implement lazi skip unit test pass also attach new unit test work follow use ramdirectori index creat test doc ad index optim make sure singl segment import indexreader.open return instanc segmentread one segment index proxstream instanc segmentread packag protect possibl set proxstream differ object use class call seekscountingstream extend indexinput way abl count number invoc seek testcas search index use phrasequeri term1 term2 known mani document match queri testcas verifi seek proxstream call often number search hit exampl number doc index 500 number doc match queri term1 term2 5 invoc seek prox stream old code 29 invoc seek prox stream patch version 5 michael
nullpointerexcept thrown equal method spanorqueri part code util equal method spanorqueri certain case detail follow necessari nullpointerexcept get thrown result string field null appli follow patch problem disappear index src/java/org/apache/lucene/search/spans/spanorquery.java src/java/org/apache/lucene/search/spans/spanorquery.java revis 465065 +++ src/java/org/apache/lucene/search/spans/spanorquery.java work copi -121,7 +121,8 final spanorqueri spanorqueri o clauses.equ that.claus return fals field.equ that.field return fals field null field.equ that.field return fals field null that.field null return fals return getboost that.getboost
lazyfield use indexinput thread safe hypothet problem indexinput.clon activ indexinput could result corrupt copi lazyfield clone fieldsreader.fieldsstream could use via indexreader.docu
conjunctionscor tuneup see also lucene-443 profil test new conjuctionscor 2.1 discov new bottleneck conjunctionscorer.sortscor java.utils.arrays.sort method clone scorer array everi sort quit expens larg index size norm array within n't necessari one possibl solut privat void sortscor squeez array sort length scorers.length scorer temp new scorer length system.arraycopi scorer 0 temp 0 length scorer temp insertionsort scorer length note compar consist equal arrays.sort scorer new compar sort array public int compar object o1 object o2 return scorer o1 .doc scorer o2 .doc first 0 last length 1 privat void insertionsort scorer score int len int i=0 len i++ int j=i j 0 score j-1 .doc score j .doc j swap score j j-1 return privat void swap object x int int b object x x x b x b squeez array longer need also initi scorer array 8 instead 2 avoid grow array common queri although probabl less perform impact chang ad 3 queri throughput test peter
improv bufferedindexinput.readbyt perform profil session discov bufferedindexinput.readbyt function read bunch byte index ineffici mani case effici one two byte also effici larg number byte e.g. norm read anyth e.g. 100 byte perform disast easili improv though includ patch basic problem exist code ask read 100 byte readbyt simpli call readbyt 100 time loop mean check byte byte buffer anoth charact instead check mani byte left copi version attach copi 100 byte avail bulk use system.arraycopi less 100 avail whatev avail get copi rest larg number byte request read direct final buffer profil fix caus amaz perform improv previous bufferedindexinput.readbyt took much 25 run time fix 1 run time howev scenario *not* typic lucen code rather version lucen ad payload payload averag 100 byte origin readbyt worst expect fix less impact vanilla lucen still impact use thing like read field awar standard lucen benchmark ca n't provid benchmark typic case addit chang readbyt attach patch also add new unit test bufferedindexinput previous unit test test simul file contain predict seri byte tri read readbyt readbut various size mani thousand combin tri see exact expect byte read test independ new readbyt inplement use check old implement well way 's interest bufferedindexoutput.writebyt alreadi effici n't simpli loop writebyt read code ineffici wonder happen
scorer.skipto n't alway work call next skipto n't work scorer call next
filteredqueri ignor boost filter queri ignor 's boost
lock-less commit patch base discuss back lucene-dev http //mail-archives.apache.org/mod_mbox/lucene-java-dev/200608.mbox/ 3c44e5b16d.4010805 mikemccandless.com 3e approach small modif origin discuss see retri logic work correct cross-machin test case want open feedback test users/develop divers environ etc small chang lucen store index enabl elimin commit lock entir write lock still remain two commit lock troublesom user sinc typic serv activ role product wherea write lock usual design check make sure one writer index time basic idea filenam never reus write mean writer never write file reader may read one except segments.gen file see retri logic instead write generat file ie segments_1 segments_2 etc besid segment file .del file norm file .sx suffix also generat generat store _n suffix file extens eg _p_4.s0 separ norm file segment p generat 4 one import benefit avoid file content cach entir like caus error reader open index mount nfs sinc file alway new file patch reliabl instanti reader nfs writer write index howev nfs still forc refresh reader writer commit point time search n't work nfs see lucene-673 chang fulli backward compat open old index search add/delet doc etc ve ad new unit test test case unit test pass ve ad number addit unit test fail win32 current lucen pass patch fileformats.xml updat describ chang file xxx refer need fix commit import benefit reader entir read-on reader longer block one anoth fals content initi hit content immedi retri instead fix default 1.0 second paus file renam ever done file renam caus sneaki access deni error win32 see lucene-665 yonik use approach renam segments_n file tri segments_ n-1 hit ioexcept segments_n separ .done file work reliabl high stress test directori list point time win32 call indexreader.setnorm even reader index open fix pre-exist minor bug lucen win32 creat indexwrit create=tru even reader index open eg see www.gossamer-threads.com/lists/lucene/java-user/39265 's overview chang everi commit write next segments_ n+1 load segments_n file open segment requir retri logic ve captur logic new static class segmentinfos.findsegmentsfil place need someth current segment file use class delet file instead writer comput what delet instanti updat memori whenev file delet ie commit creat common class index.indexfiledelet share reader writer manag delet store inform segment info file whether separ delet generat whether separ norm per field generat whether 's compound instead reli io oper file exist call note fix current mislead filenotfoundexcept user see _x.cfs file miss eg http //www.nabble.com/filenotfound-exception-t6987.html fix small thing ramdirectori filesystem-lik eg open non-exist indexinput fail rais ioexcept renam atom ad stress test ramdirectori 1 writer thread 2 reader thread uncov ad option remov old file create=tru creat fsdirectori writer sophist retri error remov remov refer commit lock commit_lock_timeout etc api chang extend index/indexfilenames.java index/indexfilenamefilter.java logic comput generat file name chang index/indexfilenamefilter.java use hashset check file extents better perform fix test case testindexreader.testlastmodifi incorrect think compar lastmodifi version index fix ad new test case version retri logic index/segmentinfos.java reader tri load segment writer commit may hit ioexcept normal content current lucen content caus default 1.0 second paus retri lock-less content caus ad delay beyond time retri happen first tri segments_ n-1 present could segments_n still written fail re-check see newer segments_m m n advanc els retri segments_n sinc could process previous must complet sinc segments_ n-1 load order find current segments_n file list directori take biggest segments_n exist howev extrem stress test 5 thread open close reader one platform os x found directori list incorrect stale 1.0 second mean list show segments_n file file exist fileexist return fals order handl platform switch hybrid approach origin propos doron cohen origin thread commit writer write file segments.gen generat commit write 2 ident long file retri logic detect directori list stale fall back content file file consist two long ident generat inde newer dir list use final approach also stale fallback step sequenti generat maximum tri 3 method fail throw origin except hit ad static method segmentinfos.setinfostream print detail retri attempt patch 's set system.out right turn real commit problem see retri logic done
disk full addindex directori corrupt index spinoff lucene-555 disk fill call commit segment file refer segment written whole index becom unus anyon know case disk full could corrupt index think disk full wors lose document flight time n't corrupt index
chang querypars use constantscorerangequeri prefer rangequeri default chang querypars default use new constantscorerangequeri prefer rangequeri rang queri implement general prefer run faster b scarciti rang term unduli influenc score c avoid toomanybooleanclaus except howev applic realli need use old-fashion rangequeri point requir useoldrangequeri properti use revert old behaviour patch includ extra junit test flag junit test pass
compoundfilewrit pre-set file length ve read write larg file 's best pre-set size file advanc write content general minim fragment improv io perform file futur think make sens intuit n't done real perform test verifi java java.io.file.setlength method sinc 1.2 easili fix compoundfilewrit call setlength file 's write add setlength method indexoutput compoundfilewrit know exact larg file anoth good thing go run disk space setlength call fail front instead fail compound file actual written two benefit first find sooner run disk space second n't fill disk 0 byte left alway frustrat experi instead leav space avail throw ioexcept one hesit exist filesystem ca n't handl call throw ioexcept platform balanc possibl easy-win improv perform anyon feedback thought experi relev
index file format exampl frequenc file .frq wrong report johan stuyt http //www.nabble.com/possible-documentation-error p7012445.html frequenc file exampl say exampl termfreq term occur document seven three time document eleven would follow sequenc vint 15 22 3 exampl termfreq term occur document seven three time document eleven would follow sequenc vint 15 8 3
lucen java site doc would realli nice java site doc consist rest lucen famili name navig tab etc one easili go nutch hadoop etc
setup night build websit link doc per discuss mail list go setup night build link websit link doc javadoc generat night build process build process may need modifi complet task go forward main websit part updat per releas imagin except made news item per committ 's discret javadoc link main websit alway latest releas
patch enabl application-level manag indexwriter.ramdirectori size indexwrit current support bound in-memori index cach use maxbuffereddoc limit fix number document document size vari substanti especi document truncat lead either ineffici too-smal valu outofmemoryerror larg valu simpl patch expos indexwriter.flushramseg provid access size inform indexwriter.ramdirectori applic manag base total number byte consum in-memori cach therebi allow larger number smaller document smaller number larger document lead much better perform elimi possibl outofmemoryerror actual job manag size constraint constraint left applicat addit synchron flushramseg safeti extern call signific effect intern call sinc come sychron caller
implement point time search without reli filesystem semant touch recent discuss dev list http //www.gossamer-threads.com/lists/lucene/java-dev/41700 41700 recent user list http //www.gossamer-threads.com/lists/lucene/java-user/42088 lucen 's point time search current reli under storag handl delet file held open read high variabl across filesystem exampl unix-lik filesystem usual close last delet window filesystem typic refus delet file open read lucen retri later nfs remov file reader reason point time search n't work nfs see lucene-673 lockless commit chang lucene-701 's quit simpl re-impl point time search reli filesystem semant keep last segments_n file well file refer also keep design goal reli littl possibl filesystem eg lockless longer re-us filenam n't reli filesystem cach coher longer use file renam window fail would anoth step reli semant delet open file less requir filesystem portabl lucen get interest polici would use remov segments_n file polici remov last one think would keep polici default could imagin polici keep past n day 's worth keep last n keep activ use reader somewher note tricki reliabl figur reader crash etc keep mark rollback point transact mark explicit snaphshot roll polici would interfac abstract class could make implement think issu could creat framework interface/abstract class polici invok indexfiledelet implement current polici delet recent segments_n default polici separ issu could creat interest polici think import advantag point time search would work nfs n't nfs n't delet last close see lucene-673 directori implement n't work current transact semant becom possibl set snapshot bunch stuff index rollback snapshot later time reader crash machin get reboot etc could choos re-open snapshot previous use wherea reader must alway switch last commit point searcher could search snapshot follow-on action mean user search next page drill solr drill etc separ trip server searcher re-open user get inconsist result lost trust one seri search interact could explicit stay snapshot start
booleanweight size weight vector correct weight field booleanweight use vector alway size exact outer class claus vector therefor size correct constructor trivial memori save enhanc
file format document correct term vector samir abdou dev mail list hi inconsist file format page lucen websit sourc code concern posit offset term vector seem document websit date accord file format page offset posit store correct mani thank samir inde file format term vector section n't talk store posit offset info
use system.arraycopi org.apache.lucene.index.documentwrit patch explain n't make perform test think obvious faster test pass
indexwrit releas write lock tri open index yet exist version 2.0.0 privat indexwrit constructor proper remov write lock event error seen one attempt open creat index directori exist segment file offend code 247 privat indexwrit directori d analyz final boolean creat boolean closedir 248 throw ioexcept 249 this.closedir closedir 250 directori d 251 analyz 252 253 lock writelock directory.makelock indexwriter.write_lock_nam 254 writelock.obtain writelocktimeout obtain write lock 255 throw new ioexcept index lock write writelock 256 this.writelock writelock save 257 258 synchron directori in- inter-process sync 259 new lock.with directory.makelock indexwriter.commit_lock_nam commitlocktimeout 260 public object dobodi throw ioexcept 261 creat 262 segmentinfos.writ directori 263 els 264 segmentinfos.read directori 265 return null 266 267 .run 268 269 line 254 write lock obtain constructor except rais insid dobodi method line 260 except propag constructor fail lock releas object garbag collect typic issu except use indexmodifi class file bug yet fix trunk indexwriter.java 472959 251 privat indexwrit directori d analyz final boolean creat boolean closedir 252 throw ioexcept 253 this.closedir closedir 254 directori d 255 analyz 256 257 lock writelock directory.makelock indexwriter.write_lock_nam 258 writelock.obtain writelocktimeout obtain write lock 259 throw new ioexcept index lock write writelock 260 this.writelock writelock save 261 262 synchron directori in- inter-process sync 263 new lock.with directory.makelock indexwriter.commit_lock_nam commitlocktimeout 264 public object dobodi throw ioexcept 265 creat 266 segmentinfos.writ directori 267 els 268 segmentinfos.read directori 269 return null 270 271 .run 272 273
support unicod escap querypars suggest yonik http //issues.apache.org/jira/browse/lucene-573 querypars abl handl unicod escap i. e. \uxxxx alreadi work test code base patch submit lucene-573 hope commit submit anoth patch
src build fail lib directori download http //mirrors.ibiblio.org/pub/mirrors/apache/lucene/java/lucene-2.0.0-src.tar.gz notic ca n't compil run test src build n't inlcud lib dir build file wo n't attempt make n't exist hossman coaster ~/tmp/l2 tar -xzvf lucene-2.0.0-src.tar.gz hossman coaster ~/tmp/l2 cd lucene-2.0.0/ hossman coaster ~/tmp/l2/lucene-2.0.0 ant test test mkdir creat dir /home/hossman/tmp/l2/lucene-2.0.0/build/test build fail /home/hossman/tmp/l2/lucene-2.0.0/common-build.xml:169 /home/hossman/tmp/l2/lucene-2.0.0/lib found 's refrenc junit.classpath 'm relali sure
unit test testbackwardscompat testindexfiledelet might fail depend jvm two unit test testbackwardscompat testindexfiledelet sever index file name hardcod exampl testbackwardscompatibility.testexactfilenam test index directori contain exact expect file sever oper like adddocu deletedocu setnorm perform appar unit test pass night build machin environ window xp ibm jvm 1.5 fail follow reason indexreader.setnorm call new norm file specifi field creat file end .sx x number field problem segmentmerg guarante keep order field word merg took place field differ field number specif testcas fail expect file end .s0 file end .s1 reason field number differ differ jvms use hashset segmentreader.getfieldnam depend hashset implement iter might iter entri insert order chang hashset linkedhashset two testcas pass howev even linkedhashset order field number might chang merg order segmentmerg merg fieldinfo depend field option like termvector index see segmentmerger.mergefield detail think use linkedhashset rather chang problemat testcas furthermor 'm sure hardcod filenam test anyway chang index format file name futur test case would fail without modif
code coverag report hi abl measur code coverag unit testcas believ would help committ could verifi commit patch reduc coverag furthermor peopl could take look code coverag report figur work need done i. e. addit testcas neccessari would nice could add page lucen websit show report generat night build mayb could add preview page lucene-707 grant attach patch use tool emma generat code coverag report emma nice open-sourc tool releas cpl licens junit patch add three target common-build.xml emma-check verifi emma.jar emma_ant.jar ant classpath emma-instru instrument compil code generate-emma-report generat html code coverag report follow step neccessari order generat code coverag report add emma.jar emma_ant.jar ant classpath download emma http //emma.sourceforge.net/ execut ant target emma-instru depend compile-test compil core test class execut ant target test run unit test execut ant target generate-emma-report view emma report open build/test/emma/index.html
default spell defalt morelikethis.java default spell defalt contrib/queries/src/java/org/apache/lucene/search/similar/morelikethis.java
querypars support matchalldoc seem like realli querypars support matchalldocsqueri propos bring back memori dos
remov usag deprec method document.field class documentwrit fieldswrit parallelread use deprec method document.field simpl patch chang three class use document.getfield instead unit test pass
mmapdirectori ca n't creat new index window set system properti request use mmap directori start build larg index process die ioexcept tri delet file appar lucen n't close memori map delet file
remov deprec contrib/similar class contrib/similar seem duplic class contrib/queri 'd like remov *.java contrib/similar without bother deprec sinc function exist contrib/queri anyon mind
non-recurs multitermdoc non-recurs implement multitermdocs.next skipto would nice 's current possibl get stack overflow rare situat
restor top level disjunct perform patch restor perform top level disjunct introduct booleanscorer2 impact report java-us 21 nov 2006 stanislav jordanov
support datetool querypars querypars current use deprec class datefield creat rangequeri date valu howev user probabl use datetool store date valu index recommend way sinc datefield deprec case rangequeri date valu produc querypars wo n't work index patch replac use datefield querypars datetool datetool produc date valu differ resolut patch add follow method querypars set default date resolut use rangequeri field specif date resolut set field specif resolut set link setdateresolut string datetools.resolut param dateresolut default date resolut set public void setdateresolut datetools.resolut dateresolut set date resolut use rangequeri specif field param field field date resolut set param dateresolut date resolut set public void setdateresolut string fieldnam datetools.resolut dateresolut also ad correspond getter method user set default date resolut use field second method field specif date resolut initi default resolut use user set differ resolut datetools.resolution.day pleas let know think use differ resolut default extend testquerypars test new featur unit test pass
upload lucen 2.0 artifact maven 1 repositori lucen 2.0 artifact found maven 2 repositori maven 1 repositori still project use maven 1 might interest upgrad lucen 2 artifact also maven 1 repositori would help
sloppi phrase scorer match doc b c d e queri b c b ~2 extens https //issues.apache.org/jira/browse/lucene-697 addit abnorm yonik point 697 seem issu slopi phrase search score 1 phrase repeat word would detect document although i.e document b d c e queri b c b would find document expect queri b c b ~2 would find think matter larg slop document match 2 document contain order queri symmetr would score differ queru reveres form i.e document b c b would score differ queri b c ~2 c b ~2 although symmetr attach test case show problem one report yonik 697
read/writ .del d-gap delet bit vector suffici spars .del file segment maintain info delet document segment file exist segment delet doc exist newli creat segment e.g result merg time close index reader delet document .del file rewritten fact sinc lock-less commit chang new generat .del file creat occas small index real problem current situat larg index time index reader close creat new bit-vector seem like unnecessari overhead case bit vector spars doc delet instanc index segment 1m doc sequenc open reader delet 1 doc segment close reader would write file ~128kb repeat sequenc 8 time 8 new file total size 1mb written disk whether bottleneck depend applic delet pattern case delet doc spars write d-gap would save space time simpl chang bitvector run current tri perform test yet convinc worthi
perform improv segmentmerger.mergenorm patch make two improv segmentmerger.mergenorm 1 segmentmerg merg norm valu alloc new byte array buffer valu everi field everi segment size array equal size correspond segment larg segment merg array becom larg easili reduc number array alloc reus byte array buffer norm valu grow segment larger previous one 2 norm valu written check correspond document delet norm written use indexoutput.writebyt byte patch introduc optim case segment delet doc case frequent call indexreader.isdelet int avoid effici method indexoutput.writebyt byte int use patch chang method segmentmerger.mergenorm unit test pass
spanorquery.java simplif test current spanorquery.java unnessari attribut remov found exist test ad test testspans.java
indexreader.reopen robert engel implement indexreader.reopen function set 3 new class easier implement probabl fold core look good
testfieldsread testlazyperform problem w/ permiss temp dir multius environ tri setup enhanc night build testlazyperform test fail testfieldsread sinc could n't delet lazydir directori someon els 's run test chang append user.nam system properti directori name
make inspect booleanqueri effici attempt inspect booleanqueri alloc two new array could cheaper
incorrect error messag analyzingqueryparser.getprefixqueri error messag getprefixqueri incorrect token ad exampl stemmer messag token consum even token ad attach patch appli give better descript actual happen
night build fail javadoc task fail due new project structur contrib/gdata-serv ad correct packag structur java/trunk/build.xml javadoc creation success patch ad attach regard simon
except indexwriter.clos prevent releas write.lock encount case index corrupt see http //issues.apache.org/jira/browse/lucene-140 close method encount except flushramseg method index write.lock releas ie realli close writelock releas indexwrit gc 'd final call
chainedfilt work well event filter andnot first andnot oper take place complet fals bitset alway return zero result
n't use final fsindexinput clone final expens avoid use possibl look like help tickl kind bug look like jvm bug http //www.nabble.com/15-minute-hang-in-indexinput.clon 28 29-involving-finalizers-tf2826906.html a7891015
test fail due common use java.io.tmpdir test use java.io.tmpdir other use tempdir defin common-build.xml reli java.io.tmpdir fail run machin someon els run test came test new night build script lucene.zones.a.o propos fix map java.io.tmpdir ant junit task valu tempdir
use nio posit read avoid synchron fsindexinput suggest doug could use nio pread avoid synchron under file could mitig mt perform drop caus reduc number file index format
fieldcach keep hard refer reader n't prevent multipl thread creat instanc
payload patch add possibl store arbitrari metadata payload togeth posit term post list ago discuss dev mail list propos initi design patch much improv design modif make new featur easier use effici payload array byte store inlin proxfil .prx therefor patch provid low-level api simpli store retriev byte array post list effici way api usag new class index.payload basic wrapper around byte array togeth int variabl offset length user creat byte array everi payload rather alloc one array payload document provid offset length inform reduc object alloc applic side order store payload post list one provid tokenstream tokenfilt produc token payload ad follow two method token class set token 's payload public void setpayload payload payload return token 's payload public payload getpayload order retriev data index interfac termposit offer two new method return payload length current term posit invalid link nextposit call first time return length current payload number byte int getpayloadlength return payload data current term posit invalid link nextposit call first time method must call call link nextposit howev payload load lazili payload data current posit need method may call perform reason param data array data payload store big enough otherwis new byte array alloc purpos param offset offset array data payload store return byte array contain data payload throw ioexcept byte getpayload byte data int offset throw ioexcept furthermor patch indroduc new method indexoutput.writebyt byte b int offset int length far writebyt -method without offset argument implement detail one field bit fieldinfo use indic payload enabl field user enabl payload field done automat documentwrit enabl payload field one ore token carri payload segmentmerg enabl payload field merg payload enabl field one segment backward compat payload use format proxfil freqfil n't chang payload store inlin post list term proxfil payload term occurr store right positiondelta same-length compress payload enabl field positiondelta shift one bit lowest bit use indic whether length follow payload store explicit i. e. bit fals payload length payload previous term occurr order support skip proxfil length payload everi skip point known therefor payload length also store skip list locat freqfil same-length compress also use lowest bit docskip use indic payload length store skipdatum length last skipdatum payload load lazili user call termpositions.nextposit posit payload length load proxfil user call getpayload payload actual load getpayload call nextposit call payload data skip chang file format fieldinfo .fnm format .fnm file chang chang use sixth lowest-ord bit 0x20 fieldbit bit set payload enabl correspond field proxfil .prx proxfil .prx termposit ^termcount termposit posit ^docfreq posit positiondelta payload ^freq payload payloadlength payloaddata positiondelta vint payloadlength vint payloaddata byte^payloadlength payload disabl unchang positiondelta differ posit current occurr document previous occurr zero first occurr document payload enabl positiondelta/2 differ posit current occurr document previous occurr positiondelta odd payloadlength store positiondelta even length current payload equal length previous payload thus payloadlength omit freqfil .frq skipdatum docskip payloadlength freqskip proxskip payloadlength vint payload disabl unchang docskip record document number everi skipinterv th document termfreq document number repres differ previous valu sequenc payload enabl docskip/2 record document number everi skipinterv th document termfreq docskip odd payloadlength follow docskip even length payload current skip point equal length payload last skip point thus payloadlength omit encod space effici differ use case field index payload 's space overhead field payload disabl payload consecut term posit length length store everi term common case user probabl use format payload term field payload n't wast much space benefit same-length-compress sinc store length zero empti payload per term unit test pass
maintain norm singl file .nrm non-compound index ~10 faster index perform 50 io activ compar compound index file descriptor foot print much higher maintain field norm singl .nrm file bound number file use non compound index possibl allow applic use format detail motiv http //www.nabble.com/potential-indexing-perormance-improvement-for-compound-index -cut-io -have-more-files-though-tf2826909.html particular http //www.nabble.com/r 3a-potential-indexing-perormance-improvement-for-compound-index -cut-io -have-more-files-though-p7910403.html
sourc packag fail dist.dir exist package-tgz-src package-zip-src fail dist.dir exist sinc two target call packag target respons make dir fix commit short
add n-gram token contrib/analyz would nice n-gram-cap token contrib/analyz patch come short
clone proxstream lazili segmenttermposit segmenttermposit proxstream clone lazili i. e. first time nextposit call initi cost termposit higher anymor compar termdoc thus reason anymor scorer use termdoc instead termposit fact scorer use termposit custom subclass exist scorer might want access payload possibl via termposit could merg segmenttermdoc segmenttermposit one class deprec interfac termdoc 'm go attach patch payload featur lucene-755 commit
patch effici retriev size field valu sometim applic would like know larg document retriev import memori manag choos algorithm especi case document might larg patch extend exist fieldselector mechan two new fieldselectorresult size size_and_break size creat field retriev document store field size instead actual valu size_and_break especi effici one field compris bulk document size e.g. bodi field thus use reason size approxim
lucenedictionari skip first word enumer current code lucenedictionari alway skip first word termenum reason n't initi retriev termenum.term first call termenum.next move past first term line 76 see problem caus failur add test testspellcheck similar spellchecker.suggestsimilar eihgt ,2 assertequ 1 similar.length assertequ similar 0 eight eight first word index fail
document temporari free space requir indexwrit method open issu track fix javadoc around directori space usag optim addindex adddocu came recent thread user list around unexpect high temporari disk usag optim http //www.gossamer-threads.com/lists/lucene/java-user/43475
maxdoc explicit store index deriv file length spinoff lucene-140 general reli littl possibl file system right maxdoc deriv check file length fieldsread index file .fdx make nervous think explicit store instead note known case actual caus problem specul discuss lucene-140 could one possibl dig discuss specif relev jvm bug found yet would defens fix point
except deletedocu undeleteal setnorm indexread fail releas write lock close hit work lucene-140 3 case indexread method pattern directoryown acquirewritelock dosometh haschang true problem hit except dosometh haschang alreadi true haschang set true yet write lock held tri close reader without make chang write lock releas indexreader.clos well commit releas write lock haschang true think simpl fix swap order haschang true dosometh alreadi fix one case lucene-140 commit yesterday fix two issu
chang default write lock file locat index directori java.io.tmpdir reader read-on longer need store lock file differ global lock directori index directori sourc confus caus problem user past furthermor write lock store index directori longer need big digest prefix previous requir make sure lock file global lock directori differ index conflict way file relat index appear singl directori easili list directori see write.lock present check whether writer open index note chang affect fsdirectori creat default lockfactori lockfactori specifi still possibl longer default pick differ directori store lock file pre-instanti lockfactori part would like remov lock_dir no-argu constructor simplefslockfactori nativefslockfactori don't think notion global default lock directori anymor actual api chang howev neither simplefslockfactori nativefslockfactori haver releas yet think api remov allow final want deprec yet remov api mani releas static lock_dir 's fsdirectori 's entir unus see discuss lead http //www.gossamer-threads.com/lists/lucene/java-dev/43940
deprec creat method fsdirectory.getdirectori favor indexwrit 's creat 's confus create=true|fals fsdirectori level also anoth create=true|fals indexwrit level one use creat index user confus past http //www.gossamer-threads.com/lists/lucene/java-user/4792 think general tri one obvious way achiev someth like python http //en.wikipedia.org/wiki/python_philosophi fact two code path suppos similar thing easili lead sneaki bug one case lucene-140 alreadi fix trunk past releas inspir issu happen send create=fals fsdirectori create=tru indexwrit final lockless commit possibl open exist index creat reader still use old point time index window least one user tri previous fail use indexfiledelet class retri failur also look segment file determin next segments_n file write futur issu like lucene-710 even smart may requir know take creat new index exist directori given quit directori implemen think smart logic live indexwrit replic directori implement leav directori interfac know make chang back store tri make chang
general directori copi oper copi oper ramdirectori directori constructor use general copi one directori anoth bound ramdirectori exampl build index ramdirectori need persist fsdirectori creat patch solv
npe multireader.iscurr getvers 'm attach fix npe multireader.iscurr plus testcas getvers throw better except npe commit unless someon object better idea
store metadata human-read segment file various index-read compon lucen need metadata addit data metadata present store arbitrari binari header spread sever file move concentr singl file file encod use human-read extens standard data serial languag either xml yaml make metadata human-read make debug easier central make debug easier still develop benefit abl scan locat relev inform quick less debug print user get new window peer index structur sinc metadata written separ file would longer need seek back begin data file finish header solv issu lucene-532 special-cas pars code need extract metadata suppli differ index format pare valu longer necessari ignored/discard remov header data file simplifi make file format easier implement header remov near data structur take form record stack end end decod select iter read file top tail extent allow us separ data-process algorithm serial algorithm decoupl lucen 's code base file format instanc instead subclass termdoc deal flexibl index format might replac postinglist return subclass post deseri code would wholli contain within post subclass rather spread sever subclass termdoc yaml xml equal well suit task store metadata either case complet parser would need small subset languag kinosearch 0.20 's custom-cod yaml parser occupi 600 line c bad consid miser c 's string handl capabl
ramdirectori serializ current implement ramdirectori throw notserializableexcept tri serial due inner class keyset hashmap serializ god know java.io.notserializableexcept java.util.hashmap keyset java.io.objectoutputstream.writeobject0 objectoutputstream.java:1081 caus line 43 privat set filenam filemap.keyset edit re goe inner class valu java.io.notserializableexcept java.util.hashmap valu java.io.objectoutputstream.writeobject0 objectoutputstream.java:1081 collect file filemap.valu
extend javadoc spellcheck ad javadoc explain spellcheck work one might expect http //www.nabble.com/spellcheck 3a 3asuggestsimilar 28 29-question-tf3118660.html a8640395 without look code long time think problem lucen score consid best first gram search result number hit edit-dist calcul hit genet appear third similar hit accord lucen best accord levenshtein i.e lucen use edit-dist similar need get bunch best hit order find one smallest edit-dist took look code assess seem right
ant test wo n't run out box instal one possibl solut would remov lib junit.classpath
contrib/benchmark assum locale.us pars date reuter collect simpledateformat use pars date reuter document instanti without specifi local use default local happen us work anoth local pars except like affect standardbenchmark reutersdocmak fix trivial specifi locale.us simpledateformat 's constructor
custom similar ignor use multisearch symptom use searcher.setsimilar provid custom similar turn tf factor howev somewher along way custom similar ignor defaultsimilar use use multisearch booleanqueri problem analysi problem seem multisearcher.createweight queri method creat instanc cacheddfsourc set similar result cacheddfsourc provid defaultsimilar queri use potenti solut ad follow line cachesim.setsimilar getsimilar creat instanc cachedfsourc line 312 seem fix problem howev n't understand enough inner work class absolut sure right thing
contrib/benchmark improv bug fix benchmark bytask slight improv 1. fix bug child-should-not-report mechan task sequenc contain simpl task work expect i.e child task report times/memori child task sequenc children would report fix properti penetrating/inherit way 2. doc size control possibl also reuter doc maker allow index n doc size c charact 3 trecdocmak ad read input .gz file use trec e.g .gov data handi benchmark lucen larg collect similar reuter collect doc-mak scan input directori file extract document file multipl document input file unlik reuter collect provid loader collect avail http //trec.nist.gov research purpos 4. new basicdocmak abstract class handl doc-mak task includ creat doc specif size ad new doc-mak data much simpler
updat wiki wiki need updat starter url still jakarta think infrastructur need contact move someon inclin might use go cleanup/organ
precedencequerypars misinterpret queri start foo baz pars +foo +baz instead -foo +bar 'm set parser.setdefaultoper precedencequeryparser.and_oper issu appli otherwis
javadoc explain possibl caus ioexcept method lucen reserv right throw ioexcept occur near method low level problem like wrong permiss transient io error bad hard drive corrupt file system corrupt index etc method also interest caus tri document spinoff thread http //www.gossamer-threads.com/lists/lucene/java-user/44929
extend contrib highlight proper support phrasequeri spanqueri constantscorerangequeri patch add new scorer class spanqueryscor highlight packag score like queryscor score 0 term caus queri hit give actual hit highlight rang spanqueri phrasequeri constantscorerangequeri new queri type easi add also new fragment attempt fragment without break span see http //issues.apache.org/jira/browse/lucene-403 background depend memoryindex
deprec directory.renamefil copi mail list post issu track necessari commit patch see directory.renamefil n't use anymor assum public technic reason expect use outsid lucen deprec method implement e.g fsdirectori look bit scari anyway comment correct say atom abstract class say replac atom
chang visibl field multifieldquerypars multifieldquerypars two method protect queri getfuzzyqueri string field string termstr float minsimilar throw parseexcept protect queri getwildcardqueri string field string termstr throw parseexcept intend overwritten one would like avoid fuzzi wildcard queri howev string field attribut class privat henc access subclass mfqparser chang protect issu solv
garbag data read compress text field lazili lazi compress text field case neglect lazi field implement testcas patch provid
incorrect pars queryparser.pars encount backslash alway eat one backslash test code output follow test lucen 1.9 version affect hose would index/search lucen 's reserv charact descript input search string sequenc n java-escap backslash n 2 querypars produc queri sequenc n-1 backslash test code analyz analyz new whitespaceanalyz string querystr item \\\\ item \\\\* item \\\\ item abcd\\\\ item \\\\ item abcd\\\\ string querystr querystr system.out.println system.out.println string querystr querystr queri lucenequeri null tri lucenequeri new querypars _default_ analyz .pars querystr system.out.println lucenequery.tostr lucenequery.tostr catch except e system.out.println e.getclass .tostr output remark comment notat string querystr item \\ lucenequery.tostr item //one backslash disappear searcher fail queri string querystr item \\* lucenequery.tostr item \* //one backslash disappear queri search someth unintend string querystr item \\ item abcd\\ lucenequery.tostr item item abcd\ //this thrown parseexcept unescap string querystr item \\ item abcd\\ class org.apache.lucene.queryparser.parseexcept one
build.xml cnotrib/benchmark auto build core java demo requir current one need build core jar demo jar building/run benchmark conveni chang use core class demo class instead jar build core demo depend requir
lucen jar includ licens notic lucen jar creat build includ licens notic file meta-inf
add svn ignor eclips artifact nice ignor file eclips put project root .idea file intellij two file .project .classpath 'm gon na lie say 's patch avail svn diff patch properi chang ca n't appli patch anyway
build.xml result dist-src support build-contrib current pack src distribut would fail run ant build-contrib would much nicer work fact would nicer could even re-pack mark 2.1 although yet sure stopper
synchron bottleneck fieldsortedhitqueu mani concurr reader post colleagu paul smith java-us list hi ho peopl applic internation store data mani languag project 's index most align singl languag mayb 2 anyway ve notic thread dump diagnos perform issu appear _potential_ synchron bottleneck use locale-bas sort string n't think problem root caus perform problem thought 'd mention 's stack dump thread wait http-1001-processor245 daemon prio=1 tid=0x31434da0 nid=0x3744 wait monitor entri 0x2cd44000..0x2cd45f30 java.text.rulebasedcollator.compar rulebasedcollator.java wait lock 0x6b1e8c68 java.text.rulebasedcol org.apache.lucene.search.fieldsortedhitqueu 4.compar fieldsortedhitqueue.java:320 org.apache.lucene.search.fieldsortedhitqueue.lessthan fieldsortedhitqueue.java:114 org.apache.lucene.util.priorityqueue.upheap priorityqueue.java:120 org.apache.lucene.util.priorityqueue.put priorityqueue.java:47 org.apache.lucene.util.priorityqueue.insert priorityqueue.java:58 org.apache.lucene.search.fieldsortedhitqueue.insert fieldsortedhitqueue.java:90 org.apache.lucene.search.fieldsortedhitqueue.insert fieldsortedhitqueue.java:97 org.apache.lucene.search.topfielddoccollector.collect topfielddoccollector.java:47 org.apache.lucene.search.booleanscorer2.scor booleanscorer2.java:291 org.apache.lucene.search.indexsearcher.search indexsearcher.java:132 org.apache.lucene.search.indexsearcher.search indexsearcher.java:110 com.aconex.index.search.fastlocalesortindexsearcher.search fastlocalesortindexsearcher.java:90 case 12 thread wait like one thread lock rulebasedcol turn rulebasedcollator's.compar method synchron wonder threadloc base collat would better n't appear reason thread search index wait sort easi use rulebasedcol heavi object memori wise would n't thought per thread thought ve investig somewhat agre potenti problem seri possibl workaround discuss includ proof-of-concept patch follow
minor improv javadoc scoredoccompar attach small patch scoredoccompar broaden contract compar scoredoc scoredoc follow semant java.util.comparator.compar allow integ return rather specif -1/0/-1 note behaviour must alreadi accept anonym scoredoccompar return fieldsortedhitqueue.comparatorstringlocal alreadi return result collator.compar tie -1/0/1 restrict
public api inconsist org.apache.lucene.index.segmentinfo public contain public method good expert-level index manipul tool luke howev segmentinfo class packag visibl lead strang result 's possibl read segmentinfo 's possibl access detail segmentinfos.info int user applic solut make segmentinfo class public
unabl set lockfactori implement via org.apache.lucene.store.fsdirectorylockfactoryclass tri move lucen 2.0 lucen 2.1 notic problem lockfactori instanti code previous test success specifi lockfactori implement set properti org.apache.lucene.store.fsdirectorylockfactoryclass org.apache.lucene.store.nativefslockfactori longer work due bug fsdirectori class problem caus fact class tri invok default constructor specifi lockfactori class howev neither nativefslockfactori simplefslockfactori default constructor fsdirectori line 285 tri lockfactori lockfactori c.newinst catch illegalaccessexcept e throw new ioexcept illegalaccessexcept instanti lockclass lockclassnam catch instantiationexcept e throw new ioexcept instantiationexcept instanti lockclass lockclassnam catch classcastexcept e throw new ioexcept unabl cast lockclass lockclassnam instanc lockfactori possibl workaround set properti call fsdirectory.setlockfactori instead
lead wildcard 's n't work trail wildcard report antoni bowesman lead wildcard n't work trail wildcard charact instead prefixqueri construct http //www.nabble.com/queryparser-bug tf3270956.html
javacc win32 cygwin creat wrong line end fix ant replac ant javacc windows/cygwin generat file wrong line end \r \r\n instead *nix 's \n manag get rid use perl -p -e s/ \r\n|\n|\r /\n/g use info line end issu http //en.wikipedia.org/wiki/newlin wast time get rid modifi javacc-querypars build.xml task take care querypars file creat ant javacc fix requir \n line end probabl also javacc target javacc-htmlpars javacc-standardanalyz
indexwrit detect 's use close spinoff thread java-us http //www.gossamer-threads.com/lists/lucene/java-user/45986 call adddocu indexwrit 's close ll hit hard-to-explain nullpointerexcept ramdirectori close 2.1 appar wo n't hit except indexwrit keep run releas 's write lock think plan fix indexwrit method throw illegalstateexcept close
segmentreader.setnorm fail remov separ norm file window work lucene-710 hit bug window segmentreader.setnorm call separ norm _x_n.si alreadi previous save close reader write next gen separ norm file correct _x_n+1.si fail delet current one 's quit minor next writer touch index remov stale file norm class still hold indexinput open reader commit
singl norm file still use descriptor new index file format singl .nrm file norm decreas file descriptor usag .nrm file open field norm index segment
make fieldselector usabl searchabl seem reason would want abl specifi fieldselector searchabl mani system use indexsearch get reader instead use searchabl searcher searcher multisearch use polymorph manner
lucen fail close file handl certain situat followon lucene-820 ve ad check mockramdirectori assert open file directori close check caus unit test fail dig reason uncov case lucen fail close file handl terminfosreader.clos set threadloc enumer null without first close segmenttermenum look like part fix lucene-436 ad call close somewhat sever sinc could leak mani file handl use case burn thread and/or index though fsindexinput final close flush delet indexwrit open segmentread flush correct call close close reader except hit commit actual close leav open handl fix first call docommit doclos final disk full test hit indexwrit 's addindex indexread method open reader close try/fin put try/fin ve also chang unit test use mockramdirectori instead ramdirectori increas test coverag leak open file handl
indexwrit addindexesnooptim redund try/catch new transact code try/catch claus begin indexwrit addindexesnooptim redund
nullpointerexcept segmentinfos.findsegmentsfile.run fsdirectory.list return null found bug run unit test verifi upgrad system 1.4.3 2.1.0 bug *not* occur 1.4.3 new 2.x 'm pretti sure 's 2.1-on index directori get delet lucen fsdirectori creat attempt open indexwrit indexread result npe lucen throw ioexcept case repro 1 creat fsdirectori point somewher filesystem e.g /foo/index/1 2 rm -rf parent dir rm -rf /foo/index 3 tri open indexread result nullpointerexcept line int i=0 files.length i++ file null expect ioexcept happen miss null check segmentinfo findsegmentsfile.run 0 method directori null file directory.list els file filedirectory.list gen getcurrentsegmentgener file gen -1 string int i=0 files.length i++ += file throw new filenotfoundexcept segments* file found file fsdirectori constructor make sure index dir exist reason delet underneath lucen fsdirectori instanti java.io.file.list return null probabl better fix fsdirectory.list check null return 0-length array org/apache/lucene/store/fsdirectory.java 314c314,317 return directory.list indexfilenamefilter.getfilt string toret directory.list indexfilenamefilter.getfilt toret null return new string return toret
term 's equal throw classcastexcept pass someth term term.equ object cast term without check object term 's unlik would ever crop violat impli contract object.equ
standardbenchmark makedocu explicit close open file standardbenchmark makedocu file string tag boolean store boolean token boolean tfv bufferedread reader new bufferedread new fileread reader close gc hit caus problem case ulimit set low line reader.readlin null body.append line .append reader.clos
norm file becom unexpect enorm spinoff user thread http //www.gossamer-threads.com/lists/lucene/java-user/46754 norm store spars even doc n't field x still use 1 byte norm file memori field search segment think done perform search time index larg document document wild vari field segment use document time field seen segment optim merg segment product grow multipl norm file singl segment requir far storag sum previous segment norm file think 's uncommon huge number distinct field would need solut n't hurt common case document field mayb someth analog bitvector option store spars one simpl workaround disabl norm
npe call iscurr parallellread demonstr test case call iscurr parallelread caus npe fix appear add iscurr parallelread call under index 'm sure problem may lurk method getvers lastmodifi isoptim also rewritten use case parallelread never mimic indexread perfect least behavior document other know expect junit testcas testiscurr org.apache.lucene.index.testparallelread caus error junit null junit java.lang.nullpointerexcept junit org.apache.lucene.index.segmentinfo findsegmentsfile.run segmentinfos.java:502 junit org.apache.lucene.index.segmentinfos.readcurrentvers segmentinfos.java:336 junit org.apache.lucene.index.indexreader.iscurr indexreader.java:316 junit org.apache.lucene.index.testparallelreader.testiscurr testparallelreader.java:146 index src/test/org/apache/lucene/index/testparallelreader.java src/test/org/apache/lucene/index/testparallelreader.java revis 518122 +++ src/test/org/apache/lucene/index/testparallelreader.java work copi -135,6 +135,15 assertequ docparallel.get f4 docsingle.get f4 public void testiscurr throw ioexcept directori dir1 getdir1 directori dir2 getdir2 parallelread pr new parallelread pr.add indexreader.open dir1 pr.add indexreader.open dir2 asserttru pr.iscurr fiel 1-4 index togeth privat searcher singl throw ioexcept
payload queri payload implement good make searchabl via one queri mechan see http //wiki.apache.org/lucene-java/payload_plan background inform https //issues.apache.org/jira/browse/lucene-755 issu start
benchmark enhanc precision/recal trec wikipedia would great benchmark contrib way provid precision/recal benchmark inform ala trec n't know copyright issu trec queries/data think queri avail sure data sure even feasibl could imagin could least incorpor support access data long time sinc particip trec perhap someon familiar w/ latest fill blank anoth option ask volunt creat queri make judgment reuter data bit complex probabl necessari even apach licens set benchmark may use communiti whole hmmm wikipedia might anoth option instead reuter setup download benchmark quit larg believ licens term quit amen larger collect would good stress lucen would give mani user demonstr lucen handl larg collect rate kind inform could use peopl look differ index scheme format payload differ queri strategi
contrib/benchmark querymak task refactor introduc abstract querymak implement share much common code various querymak implement add new querymak read queri file specifi properti patch short concern commit tomorrow wed
contrib/benchmark unit test need came thread http //www.mail-archive.com/java-dev lucene.apache.org/msg09260.html might want start think unit test seem kind weird test test becom suffici complex test
improv indexwrit use ram buffer ad document 'm work new class multidocumentwrit write one document direct singl lucen segment effici current approach affect creation initi segment ad document n't chang anyth eg segment merg basic idea write store field term vector direct disk don't use ram gather post list term info ram period in-ram merg ram full flush buffer disk merg later 's time make real segment recycl objects/buff reduc time/stress gc various optim chang similar kinosearch build segment n't made chang lucen 's file format ad requir global field schema far extern visibl chang new method setrambuffers indexwrit setmaxbuffereddoc deprec flush accord ram usag fix number document ad
flush ram usag indexwrit may over-merg think good way maxim perform lucen 's index given amount ram flush writer.flush ad document whenev ram usag writer.ramsizeinbyt cross max ram afford confus merg polici caus over-merg unless set maxbuffereddoc proper merg polici look current maxbuffereddoc figur segment level 0 first flush level 1 merg mergefactor level 0 segment 'm sure fix mayb look net size byte segment infer level still would resili applic sudden increas ram allow good news workaround bug think need ensur maxbuffereddoc less mergefactor typical-number-of-docs-flush
ioexecept caus loss data due prematur segment delet hit ioexcept e.g. disk full make cfs constitu part may abl rollback before-merg process happen via addindex n't nice easi test generat ioe ai n't easi happen patch factor merg polici exist test pseudo-random generat ioe fall differ place
factor merg polici indexwrit factor merg polici indexwrit make pluggabl make possibl app choos custom merg polici easier experi merg polici variant
add support wikipedia english corpus benchmark stuff add support use wikipedia benchmark
contrib/benchmark configur html parser extern class path exhaust doc maker doc make enhanc 1 allow configur html parser new html.parser properti current trecdocmak use demo html parser new properti overridden 2. allow add extern class path benchmark use modifi makers/pars without add code lucen run benchmark e.g ant run-task -dbenchmark.ext.classpath=/myproj/myclass 3. allow crawl doc maker exhaust files/doc without know advanc mani doc make use instanc input data zip file
spellcheck make hard-cod valu configur class org.apache.lucene.search.spell.spellcheck use follow hard-cod valu method indexdictionari writer.setmergefactor 300 writer.setmaxbuffereddoc 150 pose problem spellcheck index creat system certain limit i.e unix environ ulimit set restrict user http //www.gossamer-threads.com/lists/lucene/java-dev/47428 47428 sever way circumv 1. add anoth indexdictionari method addit paramet public void indexdictionari dictionari dict int mergefactor int maxbuffereddoc throw ioexcept 2. add setter method mergefactor maxbuffereddoc see code http //www.gossamer-threads.com/lists/lucene/java-dev/47428 47428 3 make spellcheck subclass easier suggest chris hostett see repli http //www.gossamer-threads.com/lists/lucene/java-dev/47463 47463 thanx karin
cach work use rmi filter cach use transient map cach work use rmi remot searcher want add new remotecachededfilt make sure cach done remot searcher side
creat merg polici n't period inadvert optim current merg polici everi maxbuffereddoc power-of-mergefactor doc ad fulli cascad merg optim think good optim poin particular adddocu call surpris expens amort adddocu call cost low cost paid front bunch manner think pay forward pay full cost optim right expect hope ad great mani doc n't add mani doc amort cost index fact far higher better pay go instead could make small chang polici merg first mergefactor segment hit 2x merg factor mergefactor=10 creat 20th level 0 flush segment merg first 10 level 1 segment creat anoth 10 level 0 segment merg second set 10 level 0 segment level 1 segment etc new merg polici index 's bit bigger current optim point would lower amort cost per document plus merg cost less bunch less pay forward instead pay actual use start creat merg polici probabl combin size doc count segment level comput lucene-845 later decid whether make default merg polici
remov bitset cach queryfilt sinc cach built public bitset bit indexread reader method n't see way deprec mean ll cut document changes.txt anyon want queryfilt cach abl get cach back wrap queryfilt cachingwrapperfilt
contrib queri packag queri implement overrid equal queri implement overrid equal queri instanc cach filter know queri use see discuss thread http //www.mail-archive.com/java-us lucene.apache.org/msg13061.html follow 3 contrib queri implement overrid equal org.apache.lucene.search.boostingqueri org.apache.lucene.search.fuzzylikethisqueri org.apache.lucene.search.similar.morelikethisqueri test case show problem packag com.teamware.office.lucene.search import static org.junit.assert import org.apache.lucene.analysis.standard.standardanalyz import org.apache.lucene.index.term import org.apache.lucene.search.boostingqueri import org.apache.lucene.search.fuzzylikethisqueri import org.apache.lucene.search.termqueri import org.apache.lucene.search.similar.morelikethisqueri import org.junit.aft import org.junit.befor import org.junit.test public class contribqueriesequalstest throw java.lang.except public void setup throw except throw java.lang.except public void teardown throw except show boostingqueri queri contrib packag implement equal correct test public void testboostingqueryequ termqueri q1 new termqueri new term subject java termqueri q2 new termqueri new term subject java assertequ two termqueri attribut equal q1 q2 boostingqueri bq1 new boostingqueri q1 q2 0.1f boostingqueri bq2 new boostingqueri q1 q2 0.1f assertequ boostingqueri attribut equal bq1 bq2 show morelikethisqueri queri contrib packag implement equal correct test public void testmorelikethisqueryequ string morelikefield new string subject bodi morelikethisqueri mltq1 new morelikethisqueri java morelikefield new standardanalyz morelikethisqueri mltq2 new morelikethisqueri java morelikefield new standardanalyz assertequ morelikethisqueri attribut equal mltq1 mltq2 show fuzzylikethisqueri queri contrib packag implement equal correct test public void testfuzzylikethisqueryequ fuzzylikethisqueri fltq1 new fuzzylikethisqueri 10 new standardanalyz fltq1.addterm javi subject 0.5f 2 fuzzylikethisqueri fltq2 new fuzzylikethisqueri 10 new standardanalyz fltq2.addterm javi subject 0.5f 2 assertequ fuzzylikethisqueri attribut equal fltq1 fltq2
contrib queri org.apache.lucene.search.boostingqueri set boost constructor queri clone copi boostingqueri set boost valu pass context queri public boostingqueri queri match queri context float boost this.match match this.context queri context.clon clone boost this.boost boost context.setboost 0.0f ignor context-on match this.context.setboost 0.0f ignor context-on match also boost valu 0.0 may wrong effect see discuss http //www.mail-archive.com/java-us lucene.apache.org/msg12243.html
deprec standardbenchmark old benchmark code favor task base approach deprec standardbechmark code start benchmark contribut favor much easier use/extend bytask benchmark code
contrib/benchmark file need eol-styl set follow file contrib/benchmark n't eol-styl set nativ check n't get convert ./build.xml ./changes.txt ./conf/sample.alg ./conf/standard.alg ./conf/sloppy-phrase.alg ./conf/deletes.alg ./conf/micro-standard.alg ./conf/compound-penalty.alg
spellcheck work stale indexsearch spellcheck unit test work stale indexread indexsearch instanc call indexdictionari dictionari
multi-level skip post list acceler post list skip termdocs.skipto int lucen use skip list default skip interv set 16 want skip e. g. 100 document necessari read 100 entri post list 100/16 6 skip list entri plus 100 16 4 entri post list speed conjunct phrase queri signific howev skip interv alway compromis big index huge post list want skip let say 100k document still necessari read 100k/16 6250 entri skip list big index skip interv could set higher valu big skip long scan target doc might necessari solut compromis multi-level skip list guarante logarithm amount skip target post list patch implement approach follow way exampl skipinterv 3 c skip level 2 c c c skip level 1 x x x x x x x x x x skip level 0 d d d d d d d d d d d d d d d d d d d d d d d d d d d d d d d d post list 3 6 9 12 15 18 21 24 27 30 df d document x skip data c skip data child pointer skip level contain everi skipinterval-th entri skip level i-1 therefor number entri level floor df skipinterv 1 skip entri level 0 contain pointer correspond skip entri list i-1 guarante logarithm amount skip find target document implement detail factor skip code segmentmerg segmenttermdoc simplifi class two new class abstractskiplistread abstractskiplistwrit implement skip function abstractskiplistread writer take care write read multipl skip level implement actual skip data format two new subclass defaultskiplistread writer implement skip data format current use lucen two file pointer freq prox file payload length inform ad extra layer prepar flexibl index differ post list format file format chang ad new paramet maxskiplevel term dictionari increas version file maxskiplevel set one format freq file chang one skip level backward compat maxskiplevel set one automat index without new paramet read case maxskiplevel 1 frq file chang follow freqfil .frq termfreq skipdata ^termcount skipdata skiplevellength skiplevel min maxskiplevel floor log docfreq/log skipinterv 1 skiplevel skiplevel skipdatum ^docfreq/ skipinterval^ level 1 remark length skiplevel store level 0 1 need 2 format file chang maxskiplevels=1 unit test pass patch
incomplet lucene-core-1.9.1 maven2 repositori 'm new lucen set project use v1.9.1 use maven2 instead ant project would build maven2 due lack lucen class track problem lucene-core-1.9.1 jar file maven2 download repositori smaller 2.3kb one got local ant repositori 408kb pleas updat v1.9.1 file maven2 1 2 repositori develop n't get frustrat incomplet jar 1 http //repo1.maven.org/maven2/org/apache/lucene/lucene-core/1.9.1/ 2 http //mirrors.ibiblio.org/pub/mirrors/maven2/org/apache/lucene/lucene-core/1.9.1/ issu copi mail sent java-dev lucene.apache.org list april 4 2007
make term vector access one big issu term vector usag inform load parallel array load often time manipul use applic instanc sort frequenc ad callback mechan allow vector load handl applic would make lot effici propos add indexread abstract public void gettermfreqvector int docnumb string field termvectormapp mapper throw ioexcept similar one field version termvectormapp interfac singl method void map string term int frequenc int offset int posit termvectorread modifi call termvectormapp exist gettermfreqvector reimplement use implement termvectormapp creat parallel array addit simpl implement automat sort vector also creat first draft api subject chang hope patch soon see http //www.gossamer-threads.com/lists/lucene/java-user/48003 search_string=get 20the 20total 20term 20frequenc 48003 relat inform
make fsindexinput fsindexoutput inner class fsdirectori would like make fsindexinput fsindexoutput protect static inner class fsdirectori current class locat sourc file fsdirectori mean class outsid store packag extend n't see perform impact side effect trivial patch unit test pass
add concurr merg polici provid abil handl merg one concurr thread i.e. concurr indexwrit oper 'm factor code lucene-847
isolatin1accentfilt bit slow isolatin1accentfilt bit slow give 300+ ms respons use highligh output respons patch follow
night build depend clover report michael pelz sherman java-dev lucen solr-us lucen night build come hudson current depend clover root crm.test.bbhmedia.net tmp string lucene-core-nightly.jar grep -i clover|mor org/apache/lucene/lucenepackag __clover_0_0.class org/apache/lucene/analysis/analyz __clover_1_0.class old nightly.sh dealt run ant night twice first without clover get jar clover get report lok like mayb logic never made hudson setup someon hudson admin access/knowledg need look
javadoc creation mani warnings/error current run ant javadoc creat mani warn grep output verifi new code add current error might minor might hide serious one never know abut someon complain best fix keep alway clean
2.1 lock document apach lucen index file format section 6.2 lock file date process migrat lucen 2.0 lucen 2.1 read chang document understand write lock written index folder instead java.io.tmpdir apach lucen index file format document section 6.2 lock file read write lock use indic anoth process write index file store java.io.tempdir confus impress lock file go index folder use java.io.tempdir local support access share index folder miss someth document updat
document number integr merg polici patch allow document number stay even merg segment delet consum need indexwriter.setskipmergingdeleteddocu fals effect delet document replac new document merg segment mark delet probabl polici thingi allow differ solut keep old document et c. also see http //www.nabble.com/optimization-behaviour-tf3723327.html a10418880
documentwrit close tokenstream earli documentwrit close tokenstream soon consum token javadoc tokenstream.clos say releas resourc associ stream howev documentwrit keep refer resourc i. e. payload byte array term string write post new segment mean documentwrit call tokenstream.clos written post problem occur multithread applic e. g. pool use resourc patch add new test testpayload show problem multipl thread add document payload index use pool byte array payload tokenstream.clos put byte array back pool test fail old version run success patch version unit test pass well
querypars escaping/parsin issu string starting/end || problem queri parser search string starts/end || string contain || middl like someth || someth everyth run without problem part code searchtext queryparser.escap searchtext querypars parser null parser new querypars fieldnam new customanalys parser.pars searchtext customanalys class extend analys redefin method overrid public tokenstream tokenstream string fieldnam reader reader return new porterstemfilt new stopanalyz .tokenstream fieldnam reader test lucen 2.1 latest sourc checked-out svn revis 538867 case pars except thrown part stack trace lucen svn checkout revis 538867 pars somet || encount eof line 1 column 11 expect one quot term prefixterm wildterm number org.apache.lucene.queryparser.parseexcept pars somet || encount eof line 1 column 11 expect one quot term prefixterm wildterm number org.apache.lucene.queryparser.queryparser.pars queryparser.java:150 part stack trace lucen 2.1 pars someth || encount eof line 1 column 12 expect one quot term prefixterm wildterm number org.apache.lucene.queryparser.parseexcept pars someth || encount eof line 1 column 12 expect one quot term prefixterm wildterm number org.apache.lucene.queryparser.queryparser.pars queryparser.java:149
spellcheck n't need store ngram spellcheck contrib store ngram although n't seem necessari patch chang commit unless someon object improv index speed index size number small test input origin index 2200 text file index size 5.3 mb index took 17 second spell index patch 60.000 document index size 13 mb index took 62 second spell index patch 60.000 document index size 6.3 mb index took 52 second btw test case fail even patch ll probabi submit anoth issu fix
make spell checker test case work see attach path make spellcheck test case work problem without patch consecut call indexdictionari creat spell index duplic word anybodi see problem patch see spellcheck code use solr n't n't time test patch insid solr also see http //issues.apache.org/jira/browse/lucene-632 null check includ patch npe describ happen anymor
queri syntax page make clear wildcard search allow phrase queri queryparsersyntax page expect novic start lucen seem indic wildcard use phrase term quot term queri broken term oper two type term singl term phrase singl term singl word test hello phrase group word surround doubl quot hello dolli wildcard search lucen support singl multipl charact wildcard search perform multipl charact wildcard search use symbol multipl charact wildcard search look 0 charact exampl search test test tester use search test* also use wildcard search middl term. noth indic section wildcard search perform singl word term phrase term chris argu that noth descript phrase indic anyth say group word surround doubl quot point suggest type queri syntax use insid quot likewis discuss wildcard make mention phrase suggest wildcard charact use phrase n't accept noth descript singl term either indic use wildcard either wildcard mention wildcard section say thay use term restrict type term propos simpl solut modifi lucen support singl multipl charact wildcard search lucen support singl multipl charact wildcard search within singl term chris ask patch im sure chang simpl enough
clean build file contrib test run easili per mail list discuss http //www.nabble.com/test 2c-contrib 2c-and-releases-tf3768924.html a10655448 test contrib run ant test use exist test target renam test-cor
spellcheck cleanup cleanup attach track necessari javadoc improv n't print except stderr re-throw new constructor new test case commit soon
improv index perform increas intern buffer size work lucene-843 notic two buffer size substanti impact overal index perform first bufferedindexoutput.buffer_s also use bufferedindexinput second compoundfilewrit 's buffer use actual build compound file 1 kb 1024 byte ran index test 'm use lucene-843 'm index ~5,500 byte plain text doc deriv europarl corpus english index 200,000 doc compound file enabl term vector posit offset store plus store field flush document 16 mb ram usag set maxbuffereddoc care hit lucene-845 result index 1.7 gb index optim end left mergefactor 10 ran test quad-cor os x 10 machin 4-drive raid 0 io system 1 kb current lucen trunk take 622 sec build index increas buffer 8 kb take 554 sec build index 11 overal gain run test see natur knee curv buffer size n't realli gain much perform 'm guess leav bufferedindexinput 's default buffer_s 1024 least search quit class instanti like larger buffer size freq/prox stream could actual hurt search perform search use skip compoundfilewrit buffer creat briefli think use fair larg 32 kb buffer mani bufferedindexoutput aliv think large-ish buffer 16 kb ok
fix small syntax omiss termqueri document code exampl could cut n'past user unbalanc parenthesi fix correct document make chang function readabl
number document fix search packag summari improv readabl clariti correct basic english make exampl text even clear repair typo
compoundfileread 's openinput produc stream may extra buffer copi spinoff lucene-888 class read compound file compoundfileread primari stream bufferedindexinput stream fsdirectori norm one layer buffer openinput call csindexinput creat also subclass bufferedindexinput 's second layer buffer consum actual use csindexinput read call readbyt readbyt run 's first buffer go refil buffer refil call first bufferedindexinput turn may refil buffer doubl copi read under stream sure fix yet chang thing extra buffer copi
custom build.xml binari distribut binari file distribut come demo sourc build.xml file howev build.xml n't work binari distribut ca n't use build demo problem notic first time releas 2.1 made ship 2.2 fix
exclud precedencequerypars build disabl fail test case erik comment lucene-885 precendencequerypars current unmaintain sinc test fail either exclud pqp build simpli disabl fail test
let user set similar morelikethi let user set similar use morelikethi discuss see http //www.nabble.com/morelikethis-api-chang tf3838535.html
contrib/javascript packag releas contrib/javascript directori appar collect javascript util lucen build file mechan packag exclud form releas
enabl java assert junit test background see http //www.mail-archive.com/java-dev lucene.apache.org/msg10307.html
defaultsimilarity.querynorm never return infin current defaultsimilarity.querynorm return infin sumofsquaredweights=0 result score nan e. g. termscor boost=0.0f simpl fix would return 1.0f case zero pass see lucene-698 discuss
filteredqueri explan inaccuraci boost valu explan differ product part boost 1 expos tighten explan check part lucene-446
calcul md5 checksum target dist-al trivial patch extend ant target dist-al calcul md5 checksum dist file
left nav docs/index.html dist artifact link hudson javadoc build zip tgz releas artifact docs/index.html file contain releas starter point peopl read document link api doc http //lucene.zones.apache.org:8080/hudson/job/lucene-nightly/javadoc/ instead ./api/index.html local copi javadoc relat initi migrat hudson night build plan copi javadoc back lucene.apache.org n't consid urgent sinc transient night doc side affect releas document also link hudson even n't modifi night build process 2.2 releas updat link left nav 2.2 releas branch build final releas
elis filter simpl french analyz n't wont use stem standardanalyz miss french strang like elis l'avion wich mean plane must token avion plane filter could use latin languag elis exist
demo contrib jar contain notice.txt license.txt includ notice.txt license.txt core jar also demo contrib jar
manifest.mf cleanup main jar luci custom sever problem manifest.mf file use core jar inconsist th luci jar luc 's build.xml jar target use jar target common-build.xml result manifest.mf file consist meta-inf dir contain license.txt notice.txt reason luc behav differ regard think fix
demo target run demo demo build target work build jar/war may use user also abl run demo someth like ant run-demo complement exist docs/demo.html
add/chang warn comment javadoc payload api sinc payload api still experiment chang comment javadoc similar new search/funct packag
disjunctionmaxscorer.skipto bug keep skip report mail list disjunctionmaxscorer.skipto broken call next situat http //www.nabble.com/potential-issue-with-disjunctionmaxscorer-tf3846366.html a10894987
two consecut score call return differ score boolean queri two consecut call score return differ score next skipto call background lucene-912
scorer.skipto current remain current scorer background http //www.nabble.com/scorer.skipto 28 29-contr-tf3880986.html appear sever scorer strict follow spec scorer.skipto n skip current locat remain current locat wherea spec say beyond current probabl either relax spec fix implement
javadoc improv payload class method org.apache.lucene.index.payload n't javadoc
interfac termfreqvector incomplet javadoc improv javadoc org.apache.lucene.index.termfreqvector
defaultskiplistread public 's need org.apache.lucene.index.defaultskiplistread public class n't releas yet fix 2.2
indexmodifi incomplet javadoc lot public protect member org.apache.lucene.index.indexmodifi n't javadoc
indexreader.fieldopt incomplet javadoc indexreader.fieldopt javadoc
segmenttermpositionvector public 'm wonder segmenttermpositionvector public implement public interfac termpositionvector remov public
indexwrit incomplet javadoc coupl getter method indexwrit javadoc
analysi packag level javadoc analysi packag level javadoc need improv overview analyz mayb sampl code show write analyz token tokenfilt would realli help bonus would discuss best practic achiev perform analysi
document packag level javadoc need improv document packag packag level javadoc could use improv 1 info document well field fieldabl 2 exampl fieldselector implement 3 sampl use datetool numbertool
contrib/benchmark build n't handl check content proper extract contrib/benchmark build proper handl check see content reuter coll proper extract check see directori exist thus possibl directori get creat extract fail next time run skip extract part tri continu run benchmark workaround manual delet extract directori
fail build contrib test fail compil spinoff lucene-885 steven 's comment look current build r545324 look like contrib failur get swallow thing like luc throw error along line subant /home/barronpark/smparkes/work/lucene/trunk/common-build.xml:366 srcdir /home/barronpark/smparkes/work/lucene/trunk/contrib/lucli/src/test exist n't make back top level status look like current state bubbl junit failur mayb build failur 's test-compile-contrib fail rather contrib-crawl 's done target test contrib directori point 's run protect contrib-crawl easi enough lift loop anoth target e.g. build-contrib-test start surfac error work
file miss licens header jukka provid follow list file miss licens header addit might file like build script n't header src/java/org/apache/lucene/document/mapfieldselector.java src/java/org/apache/lucene/search/prefixfilter.java src/test/org/apache/lucene/testhititerator.java src/test/org/apache/lucene/analysis/testisolatin1accentfilter.java src/test/org/apache/lucene/index/testaddindexesnooptimize.java src/test/org/apache/lucene/index/testbackwardscompatibility.java src/test/org/apache/lucene/index/testfieldinfos.java src/test/org/apache/lucene/index/testindexfiledeleter.java src/test/org/apache/lucene/index/testindexwriter.java src/test/org/apache/lucene/index/testindexwriterdelete.java src/test/org/apache/lucene/index/testindexwriterlockrelease.java src/test/org/apache/lucene/index/testindexwritermergepolicy.java src/test/org/apache/lucene/index/testnorms.java src/test/org/apache/lucene/index/testparalleltermenum.java src/test/org/apache/lucene/index/testsegmenttermenum.java src/test/org/apache/lucene/index/testterm.java src/test/org/apache/lucene/index/testtermvectorsreader.java src/test/org/apache/lucene/search/testrangequery.java src/test/org/apache/lucene/search/testtermscorer.java src/test/org/apache/lucene/store/testbufferedindexinput.java src/test/org/apache/lucene/store/testwindowsmmap.java src/test/org/apache/lucene/store/_testhelper.java src/test/org/apache/lucene/util/_testutil.java contrib/benchmark/src/java/org/apache/lucene/benchmark/bytask/feeds/simplesloppyphrasequerymaker.java contrib/gdata-server/src/core/src/java/org/apache/lucene/gdata/server/feednotfoundexception.java contrib/gdata-server/src/core/src/java/org/apache/lucene/gdata/server/registry/componenttype.java contrib/gdata-server/src/core/src/java/org/apache/lucene/gdata/server/registry/registryexception.java contrib/gdata-server/src/core/src/java/org/apache/lucene/gdata/storage/lucenestorage/storageaccountwrapper.java contrib/gdata-server/src/core/src/test/org/apache/lucene/gdata/storage/lucenestorage/testmodifiedentryfilter.java contrib/gdata-server/src/gom/src/test/org/apache/lucene/gdata/gom/core/atomurielementtest.java contrib/gdata-server/src/gom/src/test/org/apache/lucene/gdata/gom/core/gomentryimpltest.java contrib/gdata-server/src/gom/src/test/org/apache/lucene/gdata/gom/core/gomfeedimpltest.java contrib/gdata-server/src/gom/src/test/org/apache/lucene/gdata/gom/core/gomgenereatorimpltest.java contrib/gdata-server/src/gom/src/test/org/apache/lucene/gdata/gom/core/gomsourceimpltest.java contrib/highlighter/src/java/org/apache/lucene/search/highlight/tokensources.java contrib/javascript/queryconstructor/lucenequeryconstructor.j contrib/javascript/queryescaper/lucenequeryescaper.j contrib/javascript/queryvalidator/lucenequeryvalidator.j contrib/queries/src/java/org/apache/lucene/search/booleanfilter.java contrib/queries/src/java/org/apache/lucene/search/boostingquery.java contrib/queries/src/java/org/apache/lucene/search/filterclause.java contrib/queries/src/java/org/apache/lucene/search/fuzzylikethisquery.java contrib/queries/src/java/org/apache/lucene/search/termsfilter.java contrib/queries/src/java/org/apache/lucene/search/similar/morelikethisquery.java contrib/queries/src/test/org/apache/lucene/search/booleanfiltertest.java contrib/regex/src/test/org/apache/lucene/search/regex/testspanregexquery.java contrib/snowball/src/java/net/sf/snowball/among.java contrib/snowball/src/java/net/sf/snowball/snowballprogram.java contrib/snowball/src/java/net/sf/snowball/testapp.java contrib/spellchecker/src/test/org/apache/lucene/search/spell/testspellchecker.java contrib/surround/src/test/org/apache/lucene/queryparser/surround/query/booleanquerytst.java contrib/surround/src/test/org/apache/lucene/queryparser/surround/query/exceptionquerytst.java contrib/surround/src/test/org/apache/lucene/queryparser/surround/query/singlefieldtestdb.java contrib/surround/src/test/org/apache/lucene/queryparser/surround/query/test01exceptions.java contrib/surround/src/test/org/apache/lucene/queryparser/surround/query/test02boolean.java contrib/surround/src/test/org/apache/lucene/queryparser/surround/query/test03distance.java contrib/wordnet/src/java/org/apache/lucene/wordnet/synexpand.java contrib/wordnet/src/java/org/apache/lucene/wordnet/synlookup.java contrib/wordnet/src/java/org/apache/lucene/wordnet/syns2index.java
querypars produc empti sub booleanqueri analyz proudc token input trigger solr-261 queri like +foo bbb yak aaa baz ccc analyz produc token yak aaa baz ccc portion queri posisbl stop word result queri produc querypars +foo bbb booleanqueri two requir claus one empti booleanqueri claus appear good behavior general querypars smarter pars encount paren whose content result empti booleanqueri exact follow situat +foo bbb b +foo bbb c +foo bbb interpret would think situat b clear lend drop sub-booleanqueri complet situat c may also lend solut sinc semant mean n't allow match queri empti set queri idea right thing situat
upload lucen 2.1 ibiblio pleas upload lucen specif lucene-cor 2.1.0 ibiblio see 2.0.0 2.1.0 thank
improv maven artifact coupl thing improv next releas *pom.xml file renam *pom.xml.templ artifact lucene-par extend apache-par add sourc jar artifact updat generate-maven-artifact task work latest version maven-ant-tasks.jar metadata filenam contain local
typo queri parser syntax web page web page http //lucene.apache.org/java/docs/queryparsersyntax.html n10126 text say search document must contain jakarta may contain lucen use queri exampl say +jakarta apach problem exampl use apach text say lucen
make cachingtokenfilt faster linkedlist use cachingtokenfilt access use get method direct access linkedlist slow iter use instead hand token differ speed grow exponenti
i/o except caus loss buffer delet i/o except result segmentinfo rollback oper caus buffer delet exist rollback creation point incorrect lost ioexcept trigger rollback
check boundari condit fieldinfo fieldinfo three method n't check boundari condit catch e. g. indexoutofboundsexcept npe think n't good code style probabl even faster check explicit except use alter flow program part normal execut also irrit re tri debug indexoutofboundsexcept thrown somewher els program place breakpoint except three method public int fieldnumb string fieldnam tri fieldinfo fi fieldinfo fieldnam fi null return fi.numb catch indexoutofboundsexcept ioob return -1 return -1 public string fieldnam int fieldnumb tri return fieldinfo fieldnumb .name catch nullpointerexcept npe return public fieldinfo fieldinfo int fieldnumb tri return fieldinfo bynumber.get fieldnumb catch indexoutofboundsexcept ioob return null
simpledateformat use non thread safe manner mike point http //www.mail-archive.com/java-dev lucene.apache.org/msg10831.html simpledateformat thread safe henc docmak need maintain threadloc
benchmark alg line adddoc 4000 4 caus infinit loop background http //www.mail-archive.com/java-dev lucene.apache.org/msg10831.html line adddoc 4000 4 caus infinit loop parallel sequenc would mask exhaust outer sequenti sequenc fix docmak exhaust check modifi reli doc maker instanc reset input reset
comparatorkey local base sort reply/follow-up chris hostett 's messag lucen develop list aug 2006 http //mail-archives.apache.org/mod_mbox/lucene-java-dev/200608.mbox/ 3cpine.lnx.4.58.0608211050330.5081 hal.rescomp.berkeley.edu 3e perhap would worthwhil comparatorstringlocal convert string get back fieldcache.default.getstr new collationkey mayb even fieldcache.default.getstr deprec replac fieldcache.default.getcollationkey reader field collat think best keep default behavior today cost build cach sort field think everyon want howev intern product environ inde possibl perform gain compar precalcul key instead compar string rulebas collat sinc lucen 's sort architectur pluggabl easi creat custom locale-bas compar util built-in caching/warm mechan fieldcach may use sortfield constructor 'm sure whether class lucen core could nice option perform vs. memori consumpt local sort without use addit jar
remov deprec method booleanqueri remov deprec method setusescorer14 getusescorer14 booleanqueri adapt javadoc
contrib/benchmark test fail find data dir expos lucene-940 test ad use reuter collect test succeed ran contrib/benchmark e.g ide fail run part ant test-contrib test expect find reuter data trunk/work
replac text onlin collect use test case text sure 100 free text onlin firstaid collect firstaid ie eu org use arbitrari text test document creation o.a.l.analysis.analyzer.functiontestsetup.doc_text_lin o.a.l.benchmark.bytask.feeds.simpledocmaker.doc_text got text project gutenberg sure free refer web site seem respond find firstaid ebook project gutenberg site sinc n't matter text use replac word
improv contrib/benchmark ve made small improv contrib/benchmark most merg ad-hoc benchmark code ve use lucene-843 fix thread safeti dirdocmak 's usag simpledateformat print prop sort order ad new config autocommit=true|fals createindextask ad new config ram.flush.mb=int adddoctask ad new config doc.term.vector.positions=true|fals doc.term.vector.offsets=true|fals basicdocmak ad writelinedoctask.java make alg use build singl file contain one document per line singl file eg alg convert reuters-out tree singl file ~1000 byte per bodi field save work/reuters.1000.txt docs.dir=reuters-out doc.maker=org.apache.lucene.benchmark.bytask.feeds.dirdocmak line.file.out=work/reuters.1000.txt doc.maker.forever=fals writelinedoc 1000 line tab-separt titl date bodi field creat feeds/linedocmaker.java creat document read file creat writelinedoctask.java eg alg index document creat analyzer=org.apache.lucene.analysis.simpleanalyz directory=fsdirectori doc.add.log.step=500 docs.file=work/reuters.1000.txt doc.maker=org.apache.lucene.benchmark.bytask.feeds.linedocmak doc.tokenized=tru doc.maker.forever=fals resetsystemeras createindex adddoc closeindex repsumbypref adddoc ll attach initi patch short
writer two machin nfs hit fnfe due stale nfs client cach issu spawn thread http //www.gossamer-threads.com/lists/lucene/java-user/50680 indexfiledelet list directori look segments_x file load hit fnfe open file catch treat file exist nfs possibl file system directori list guarante current /coher specif machin 1 remov file segments_n short thereaf machin 2 dir list 's possibl like dir list still show segments_n exist think fix simpl catch fnfe handl segments_n fact exist
analyzingquerypars ca n't work lead wildcard getwildcardqueri mehtod analyzingqueryparser.java need follow chang accept lead wildcard protect queri getwildcardqueri string field string termstr throw parseexcept string usetermstr termstr string leadingwildcard null .equal field .equal usetermstr return new matchalldocsqueri boolean hasleadingwildcard usetermstr.startswith || usetermstr.startswith true fals getallowleadingwildcard hasleadingwildcard throw new parseexcept '* allow first charact wildcardqueri getlowercaseexpandedterm usetermstr usetermstr.tolowercas hasleadingwildcard leadingwildcard usetermstr.substr 0 1 usetermstr usetermstr.substr 1 list tlist new arraylist list wlist new arraylist somewhat hack find/stor wildcard char order put back analyz boolean iswithintoken usetermstr.startswith usetermstr.startswith iswithintoken true stringbuff tmpbuffer new stringbuff char char usetermstr.tochararray int 0 usetermstr.length i++ char || char '* iswithintoken tlist.add tmpbuffer.tostr tmpbuffer.setlength 0 iswithintoken fals els iswithintoken wlist.add tmpbuffer.tostr tmpbuffer.setlength 0 iswithintoken true tmpbuffer.append char iswithintoken tlist.add tmpbuffer.tostr els wlist.add tmpbuffer.tostr get analyz superclass token term tokenstream sourc getanalyz .tokenstream field new stringread usetermstr org.apache.lucene.analysis.token int counttoken 0 true tri source.next catch ioexcept e null null break .equal t.termtext tri tlist.set counttokens++ t.termtext catch indexoutofboundsexcept ioob counttoken -1 tri source.clos catch ioexcept e ignor counttoken tlist.siz mean analyz use either ad consum common stemmer token ca n't build wildcardqueri throw new parseexcept build wildcardqueri analyz getanalyz .getclass token ad lost tlist.siz 0 return null els tlist.siz 1 wlist.siz 1 wlist contain one wildcard must end 1 wildcard 1st posit term querypars truncat 2 wildcard *not* end would *two* token stringbuff sb new stringbuff hasleadingwildcard ad leadingwildcard sb.append leadingwildcard sb.append string tlist.get 0 sb.append wlist.get 0 .tostr return super.getwildcardqueri field sb.tostr els wlist.siz 0 hasleadingwildcard wlist contain wildcard must 1st posit stringbuff sb new stringbuff hasleadingwildcard ad leadingwildcard sb.append leadingwildcard sb.append string tlist.get 0 sb.append wlist.get 0 .tostr return super.getwildcardqueri field sb.tostr els never get method call termstr contain wildcard throw new illegalargumentexcept getwildcardqueri call without wildcard els term token let 's rebuild one token wildcard put back postion stringbuff sb new stringbuff hasleadingwildcard ad leadingwildcard sb.append leadingwildcard int 0 tlist.siz i++ sb.append string tlist.get wlist null wlist.siz sb.append string wlist.get return super.getwildcardqueri field sb.tostr
patch multilevelskiplistread nullpointerexcept reconstruct document use luke tool receiv nullpointerexcept java.lang.nullpointerexcept org.apache.lucene.index.multilevelskiplistreader.loadskiplevel multilevelskiplistreader.java:188 org.apache.lucene.index.multilevelskiplistreader.skipto multilevelskiplistreader.java:97 org.apache.lucene.index.segmenttermdocs.skipto segmenttermdocs.java:164 org.getopt.luke.luk 2.run unknown sourc luke version 0.7.1 email luke author andrzej bialecki suggest attach patch file fix problem
gdata 's testgdataindexer.testdestroy intermitt hit spin loop caus build timeout sever night build least 136 143 144 fail due timeout 45 minut run testgdataindexer.testdestroy test case track line wait activ commit this.indexer.writ null intermitt loop spin forev get failur happen linux n't happen mac os x haven't tri window night build run solari 10 also happen turn due fact writer declar volatil one thread close index set writer null anoth thread run loop this.indexer.writ set null loop start test run fine els wo n't plan fix ad method gdataindex class use test protect synchron indexwrit getwrit return this.writ chang unit test call method
bug segmenttermposit use first term dictionari segmenttermposit object reset via seek move proxstream correct posit case term first one dictionari reason behavior skipstream move lazyskippoint 0 0 valid valu post list first term fix easi simpli set lazyskippoint -1 case lazi skip perform move skipstream lazyskippoint =-1
lucen ram directori n't work index size 8 gb user list http //www.gossamer-threads.com/lists/lucene/java-user/50982 problem seem cast issu raminputstream line 90 bufferstart buffer_s currentbufferindex rhs int lhs long larg product would first overflow max_int becom negat auto cast long late line 91 bufferlength int length bufferstart rhs long lhs int int cast result may turn negat logic follow would wrong
document vector- arraylist document vector chang arraylist document advertis thread safe 's doubt anyon modifi document multipl thread
spanqueryfilt addit similar queryfilt whatev call spanqueryfilt regular lucen filter also return spans-lik inform use want filter base queri want abl compar given match new queri compar posit filter spanqueri patch come short also contain cach mechan spanqueryfilt
regexcap serializ class regexqueri mark serializ super class contain regexcap serializ thus attempt serial queri result except make regexcap serializ problem sinc subclass contain serializ class java.util.regex.pattern org.apache.regexp.r
i/o except docswrit add updatedocu may delet unreferenc file i/o except thrown documentswrit adddocu updatedocu store field file may clean
add setter field allow re-us field instanc index add setter field make possibl re-us field instanc index sizabl perform gain small document see discuss http //www.gossamer-threads.com/lists/lucene/java-dev/51041
remov documentwrit documentwrit replac documentswrit lucene-843 need remov fix unit test direct use
faster jflex-bas replac standardanalyz jflex http //www.jflex.de/ use generat faster sever time replac standardanalyz add patch simpl benchmark code
add token document task contrib/benchmark ve look perform improv token re-us token help benchmark chang ve ad new task call readtoken step field document get tokenstream read token eg alg read token doc reuter collect doc.maker=org.apache.lucene.benchmark.bytask.feeds.reutersdocmak doc.maker.forever=fals readtoken
optim core tokenizers/analyz deprec token.termtext low hang fruit optim core token analyz re-us singl token instanc index instead creat new one everi term ad new method token next token result doron 's suggest mean tokenstream may use token result return token requir ie still return entir differ token conveni ad default implement next method tokenstream.java tokenstream choos implement one next method use char termbuff token instead string termtext token maintain char termbuff hold term text token filter retriev buffer direct alter put term text chang term text deprec termtext method still allow ctor pass string termtext well settermtext string ad note perform cost use method think 's ok keep conveni method next releas remov deprec api clean token.java longer maintain either string char inittermbuff privat method alway use char termbuff instead re-us tokenstream instanc across field document instead creat new one doc ad option reusabletokenstream analyz default call tokenstream implement core analyz 'm use patch lucene-967 benchmark token chang give 21 speedup 742 second 585 second lowercasetoken stopfilt porterstemfilt chain token wikipedia jdk 1.6 -server -xmx1024m debian linux raid 5 io system best 2 run pre-break wikipedia doc 100 token doc 's 37 faster 1236 sec 774 sec think re-us tokenstream across doc 'm run alg record elaps time analyzer=org.apache.lucene.analysis.lowercasestopporteranalyz doc.tokenize.log.step=50000 docs.file=/lucene/wikifull.txt doc.maker=org.apache.lucene.benchmark.bytask.feeds.linedocmak doc.tokenized=tru doc.maker.forever=fals readtoken see thread discuss lead http //www.gossamer-threads.com/lists/lucene/java-dev/51283 also fix token.tostr work correct termbuff use ad unit test
filterindexread overwrit isoptim call filterindexreader.isoptim result npe filterindexread overwrit isoptim
creat enwiki index data line-per-articl rather file-per-articl creat line per articl rather file consum indexlinefil task
token return cjktoken new testcjktoken string return token boundari two byte charact one byte charact problem cjkanalyz cjktoken use unit becom problem use solr etc
remov author tag code remov author tag code
posit base termvectormapp part new termvectormapp approach termvector ensu patch load term vector store term info posit let peopl direct index term vector given posit actual map b/c array base bookkeep pain given way posit store map look like map string map integ tvpositioninfo string field name integ posit tvpositioninfo storag mechan term offset occur posit _should_ handl multipl term per posit alway downfal test perform approach
mmapdirectori miss newli ad openinput method fsdirectori issu caus optim lucene-888 new openinput string name int buffers ad fsdirectori also overridden mmapdirectori
intern hash improv intern power-of-two close hashtabl travers documentswrit chararrayset could better current method resolv collis text2 null equal text len text2 final int inc code*1347|1 code += inc pos code mask text2 entri pos text2 null equal text len text2 problem two differ hashcod lower bit keep pick slot upper bit ignor multipl *1347 realli shift bit left given two code alreadi match right pick increment keep path tabl even though 's ad number differ left resolv bit need move right calcul increment
gc resourc terminfosread except occur constructor replac indexmodifi indexwrit test case teststressindex notic test fail time time .tis file still open mockramdirectory.clos call turn .tis file close except occur terminfosread 's constructor
remov deprec benchmark util contrib/benchmark old benchmark util contrib/benchmark deprec remov 2.9 lucen
format error reporttask contrib/benchmark build new task analyzertask let chang analyz loop thus allow comparison analyz set document algorithm declar look like newanalyz whitespaceanalyz simpleanalyz stopanalyz standard.standardanalyz could longer except error execut algorithm string index rang 85 java.lang.stringindexoutofboundsexcept string index rang 85 java.lang.string.substr string.java:1765 org.apache.lucene.benchmark.bytask.utils.format.format format.java:85 org.apache.lucene.benchmark.bytask.tasks.reporttask.tabletitl reporttask.java:85 org.apache.lucene.benchmark.bytask.tasks.reporttask.genpartialreport reporttask.java:140 org.apache.lucene.benchmark.bytask.tasks.repsumbynametask.reportsumbynam repsumbynametask.java:77 org.apache.lucene.benchmark.bytask.tasks.repsumbynametask.dolog repsumbynametask.java:39 org.apache.lucene.benchmark.bytask.tasks.perftask.runandmaybestat perftask.java:83 org.apache.lucene.benchmark.bytask.tasks.tasksequence.doserialtask tasksequence.java:112 org.apache.lucene.benchmark.bytask.tasks.tasksequence.dolog tasksequence.java:93 org.apache.lucene.benchmark.bytask.utils.algorithm.execut algorithm.java:228 org.apache.lucene.benchmark.bytask.benchmark.execut benchmark.java:73 org.apache.lucene.benchmark.bytask.benchmark.main benchmark.java:109 error seem caus fact reporttask use op oper column string use length algorithm declar index string result index bound except line question return padd .substr 0 col.length probabl chang someth like string s1 padd return s1.substr 0 math.min col.length s1.length either column trim workaround explicit name task object make chang tomorrow
newanalyzertask newanalyzertask patch follow allow contrib/benchmark algorithm chang analyz run use compar analyz newanalyz newanalyz whitespaceanalyz simpleanalyz stopanalyz standard.standardanalyz sampl declar algorithm file
creat new method optim int maxnumseg indexwrit spin discuss lucene-847 think way slight optim index would use mani applic current optim call expens larg indic alway optim fulli 1 segment add new method instead allow stop optim maxnumseg segment index would allow applic eg optim say 10 segment bunch updat nice compromis gain good speedup search spend full typic high cost optim singl segment sinc lucene-847 formal api decoupl merg polici indexwrit want add new optim method need take account lucene-847
remov termvectorswrit 's longer use remov termvectorswrit 's longer use documentswrit write term vector direct index
aioob thrown length termtext longer 16384 charact arrayindexoutofboundsexcept documentswrit max term length 16384 cross get unfriend arrayindexoutofboundsexcept fix rais clearer except
refactor segmentinfo indexread subclass refer segmentinfo indexread caus differ kind problem subclass indexread like e. g. multiread subclass indexread index directori name segmentread multisegmentread segmentinfo object abl access inform http //www.gossamer-threads.com/lists/lucene/java-dev/51808 http //www.gossamer-threads.com/lists/lucene/java-user/52460 part refactor work alreadi done lucene-781
deprec indexmodifi see discuss http //www.gossamer-threads.com/lists/lucene/java-dev/52017 search_string=deprec 20indexmodifi 52017 deprec indexmodifi 3.0 remov 3.0 patch includ 1 indexmodifi testindexmodifi deprec 2 testindexwritermodifi ad similar testindexmodif use indexwrit chang chang differ indexmodifi indexwrit 3 testindexwriterlockreleas teststressindex switch use indexwrit instead indexmodifi
boostingtermquery.explain bug coupl minor bug boostingtermquery.explain 1 comput averag payload score produc nan payload found probabl float avgpayloadscor super.scor payloadsseen 0 payloadscor payloadsseen 1 2 averag payload score zero valu explan 0 result.setvalu nonpayloadexpl.getvalu avgpayloadscor queri part booleanclaus result match requir claus failur meet condit required/prohibit claus averag payload score zero field boost 0 ve attach patch testboostingtermquery.java howev test testnopayload fail spanscorer.scor doc -1 look like setfreqcurrentdoc call score mayb someon knowledg span could investig
indexwriter.updatedocu longer atom spinoff lucene-847 ning caught lucene-843 lost atom delet add indexwriter.updatedocu ning suggest simpl fix move buffer delet documentswrit let delet add atom nice side effect also consolid time flush logic documentswrit
chang default indexwrit maxim box perform follow-through lucene-845 lucene-847 lucene-870 ll commit three commit box perform indexwrit maxim flush ram instead fix document count default today document vari great size likewis merg perform faster merg net segment size sinc minim net io cost merg segment time want merg segment equal byte size final concurrentmergeschedul improv index speed substanti 25 simpl initi test lucene-870 run merg backround n't block add/update/deletedocu call machin concurr cpu io make sens default mergeschedul note chang break user parallelread parallel indic longer match docid user need switch indexwrit back flush doc count switch mergepolici back logdocmergepolici 's like also necessari switch mergeschedul back serialmergeschedul ensur determinist docid assign think combin three default chang plus perform improv index lucene-966 lucene-843 lucene-963 lucene-969 lucene-871 etc make sizabl perform gain lucen 2.3
add open end rang queri syntax querypars querypars fail generat open end rang queri pars e.g date 1990 give zero result constantrangequeri date 1990 null true true produc expect result date 1990 give result constantrangequeri date null 1990 true true
pars mix inclusive/exclus rang queri current queri parser n't handl pars rang queri i.e constantscorerangequeri mix inclusive/exclus bound
add search timeout support lucen patch base nutch-308 patch add support maximum search time limit time exceed search thread stop partial result return total number result estim patch tri minim overhead relat time-keep use version safe unsynchron timer also discuss e-mail thread http //www.nabble.com/search-timeout-tf3410206.html a9501029
add payload retriev span nice access payload spanqueri see http //www.gossamer-threads.com/lists/lucene/java-dev/52270 http //www.gossamer-threads.com/lists/lucene/java-dev/51134 current api ad spans.java tri post patch soon figur make work unord span believ case work noformat return payload data current span invalid link next call first time method must call call link next howev payload load lazili payload data current posit need method may call perform reasons. br br p font color= ff0000 warn status b payload /b featur experiment api introduc might chang futur support anymor case. /font return list byte array contain data payload throw ioexcept todo remov warn api final list/* byte getpayload throw ioexcept check payload load posit p/ payload load per call link next p/ p font color= ff0000 warn status b payload /b featur experiment api introduc might chang futur support anymor case. /font return true payload avail posit load todo remov warn api final public boolean ispayloadavail noformat
night build night build lucen huge due inclus contrib/benchmark temp work directori directori exclud
patch russiananalyz 's token skip number input text russiananalyz 's token skip number input text result token stream miss number problem solv ad number russiancharsets.unicoderussian see test case detail code title=testrussiananalyzer.java|borderstyle=solid public class testrussiananalyz extend testcas reader reader new stringread text 1000 test fail public void teststemm testanalyz new russiananalyz test pass public void testfixedrussiananalyz testanalyz new russiananalyz getrussiancharset privat void testanalyz russiananalyz analyz tri tokenstream stream analyzer.tokenstream text reader assertequ text stream.next .termtext assertnotnul stream.next catch ioexcept e fail e.getmessag privat char getrussiancharset int length russiancharsets.unicoderussian.length final char russianchar new char length 10 system .arraycopi russiancharsets.unicoderussian 0 russianchar 0 length russianchar length++ 0 russianchar length++ 1 russianchar length++ 2 russianchar length++ 3 russianchar length++ 4 russianchar length++ 5 russianchar length++ 6 russianchar length++ 7 russianchar length++ 8 russianchar length 9 return russianchar code
gdata testdateformat sic fail date return sun 23 sep 2007 01:29:06 gmt+00:00 testdateformater.testformatd fail date return sun 23 sep 2007 01:29:06 gmt+00:00 issu lie +00:00 end string question though valid date gdata mark major b/c caus night build fail
querypars n't accept empti string foo current throw pars except foo bar also pars foo bar serious sinc 's arguabl illeg syntax
flexibl turn on/off flush trigger see discuss http //www.gossamer-threads.com/lists/lucene/java-dev/53186 provid flexibl turn on/off flush trigger rambuffers maxbuffereddoc maxbuffereddeleteterm one rambuffers maxbuffereddoc must enabl
document term vector field document term vector field corrupt index document term-vector-en field ad document term vector part singl set buffer doc term-vector document file corrupt fail write 0 vint thank grant spot spinoff thread http //www.gossamer-threads.com/lists/lucene/java-dev/53306
logbytesizemergepolici over-merg autocommit=fals document term vector and/or store field mark miller notic slowdown see detail lucene-994 app happen segmentinfo.sizeinbyt run file associ segment sum byte size case share doc store happen autocommit=fals quit correct file share across multipl segment plan fix sizeinbyt includ size doc store share
document term vector mix one term vector caus eofexcept merg anoth spinoff http //www.gossamer-threads.com/lists/lucene/java-dev/53306 thank andi vajda captur issu compact test logic error lucene-1008 case bug termvectorswrit fail write 0 field count tvd file document vector unit test show issu simpl fix
two writer nfs caus index corrupt index use nfs one machin writer swap role quick 's possibl index becom corrupt nfs client directori cach stale nfs client show recent version linux nfs client seem show issu yet slight older one latest mac os x one well ve work patrick kimber provid standalon test show problem thank patrick came thread http //www.gossamer-threads.com/lists/engin do=post_view_flat post=50680 page=1 sb=post_latest_repli so=asc mh=25 list=lucen note first issu discuss resolv lucene-948 new issu
problem maxmergedoc paramet found two possibl problem regard indexwrit 's maxmergedoc valu 'm use follow code test maxmergedoc code java public void testmaxmergedoc throw ioexcept final int maxmergedoc 50 final int numseg 40 mockramdirectori dir new mockramdirectori indexwrit writer new indexwrit dir new whitespaceanalyz true writer.setmergepolici new logdocmergepolici writer.setmaxmergedoc maxmergedoc document doc new document doc.add new field field aaa field.store.y field.index.token field.termvector.with_positions_offset int 0 numseg maxmergedoc i++ writer.adddocu doc //writer.flush uncom avoid documentswrit bug writer.clos new segmentinfos.findsegmentsfil dir protect object dobodi string segmentfilenam throw corruptindexexcept ioexcept segmentinfo info new segmentinfo infos.read directori segmentfilenam int 0 infos.s i++ asserttru infos.info .doccount maxmergedoc return null .run code seem documentswrit obey maxmergedoc paramet n't flush manual index contain one segment end test fail flush manual adddocu call index contain segment still segment contain doc maxmergedoc e. g. 55 vs. 50 javadoc indexwrit say code java return largest number document allow singl segment see setmaxmergedoc public int getmaxmergedoc return getlogdocmergepolici .getmaxmergedoc code
indexwriter.setmaxmergedoc give non-backwards-compat except box yonik hit see detail lucene-994 switch logbytesizemergepolici default indexwrit use mb limit max size merg setmaxmergemb exist app call setmaxmergedoc getmaxmergedoc hit illegalargumentexcept drop new jar think simplest solut fix logbytesizemergepolici allow set max either mb doc count like lucene-1007 allow flush either mb doccount
fieldcach support long doubl would nice fieldcach support long doubl
termvectoraccessor transpar vector space access class visit termvectormapp popul inform transpar either pass default term cach document index field.termvector resolv invert index
intermitt except testconcurrentmergeschedul testconcurrentmergeschedul throw intermitt except result test failur except happen testnowaitclos test repeat test close indexwrit fals mean abort still-run merg merg abort hit various except file read and/or write delet ignor except bug fail proper check whether run merg actual abort scope issu merg variabl concurrentmergeschedul except actual harmless thank ning spot
customscorequeri support multipl valuesourcequeri customscorequeri 's constructor current accept subqueri valuesourcequeri would like accept multipl valuesourcequeri workaround nest customscorequeri work simpl case quick becom either cumbersom manag imposs implement desir function patch implement custommultiscorequeri desir function refactor customscorequeri implement special case custommultiscorequeri 0 1 valuesourcequeri keep customscorequeri api intact patch includ basic test less taken origin implement custom bit cover new case
basic tool check repair index request number time mail list recent http //www.gossamer-threads.com/lists/lucene/java-user/53474 think provid basic tool box
unit test fail concurrentmergeschedul thread hit except cms default 's import fail unit test hit except cms thread fail prefer solut thank erik hatcher fix lucen unit test subclass new lucenetestcas o.a.l.util base assert except test
indexwriter.setinfostream percol mergepolici mergeschedul right *mergepolici *mergeschedul ad-hoc mean verbos action unifi indexwrit 's infostream thank hoss suggest
contrib/benchmark config play nice doubl flush.by.ram valu o.a.l.benchmark.bytask.utils.config.java file nextround various method handl doubl round properti configur syntax replic copi micro-standard.alg replac merge.factor=mrg:10:100:10:100 max.buffered=buf:10:10:100:100 ram.flush.mb=ram:32:40:48:56 get various classcastexcept config one newround fix getcolsvaluesforvalsbyround fix seem mirror handl int fix seem relat minor patch short plan commit tomorrow even
weight serializ queri order work parallelmultisearch queri weight need serializ interfac weight extend java.io.serializ appear newer queri unnecessarili store global state weight thus caus serial error
fix hand misspellings/mistak changes.txt hand misspellings/mistak changes.txt patch fix avoid one two british english convers g
unreleas 2.3 version indexwriter.optim consist throw java.lang.illegalargumentexcept out-of-the-box sinc upcom 2.3 version lucen support setrambuffersizemb method index writer thought would test perform use applic built upon work lucen 2.2 download night build 2007-10-26_03-16-46 rebuilt applic new code set setrambuffersizemb properti file test data resid databas tabl 30 column hold 1.25 million record good news perform superior lucen 2.2 index complet rough 1/3 time bad news index writer.optim step throw java.lang.illegalargumentexcept also run test various tabl index smaller amount data throw except index larger amount data throw except note also test night build date back 2007-10-05 info seindexthread.commitcheck info commit point reach 1200000 info seindexthread.commitcheck info commit point reach 1225000 info seindexthread.commitcheck info commit point reach 1250000 info seindexthread.closeindex info commit point reach 1250659 info optim index info seindexthread java.lang.illegalargumentexcept java.lang.illegalargumentexcept java.lang.thread.setprior thread.java compil code org.apache.lucene.index.concurrentmergescheduler.merg concurrentmerg escheduler.java compil code org.apache.lucene.index.indexwriter.maybemerg indexwriter.java:1750 org.apache.lucene.index.indexwriter.optim indexwriter.java:1686 org.apache.lucene.index.indexwriter.optim indexwriter.java:1652 lucenesearchengine.optimizeindex lucenesearchengine.java:643 lucenesearchengine.optimizeindex lucenesearchengine.java:636 seindexthread.closeindex seindexthread.java:674 seindexthread.processsearchobject seindexthread.java:487 seindexthread.prepareindex seindexthread.java:391 seindexthread.run seindexthread.java:41
termvectormapper.setdocumentnumb pass index document whose term vector current bee map top level call term vector reader see http //www.nabble.com/allowing-ioexceptions-in-termvectormapp tf4687704.html a13397341
ca n't quick creat stopfilt due use chararrayset stopfilt one longer effici pre-creat set use futur stopfilt instanc
discrep gettermfreqvector-method gettermfreqvector int termvectormapp never call mapper term vector consit gettermfreqvector method return null gettermfreqvector int string termvectormapp throw ioexcept field contain term vector suggest code index src/java/org/apache/lucene/index/segmentreader.java src/java/org/apache/lucene/index/segmentreader.java revis 590149 +++ src/java/org/apache/lucene/index/segmentreader.java work copi -648,7 +648,7 ensureopen fieldinfo fi fieldinfos.fieldinfo field fi null || fi.storetermvector || termvectorsreaderorig null throw new ioexcept field contain term vector return code
speedup merg store field field map match robert engel suggest follow idea http //www.gossamer-threads.com/lists/lucene/java-dev/54217 merg store field segment field name number map ident simpli bulk copi entir entri document rather re-interpret re-writ actual store field ve pull code thread got work current trunk
behavior hard power shutdown index larg number document upon hard power failur e.g pull power cord index seem get corrupt start java applic window servic feed document case index size 1.7gb 30-40 index segment .cfs file follow observ segment file contain zero size 265 byte byte zero delet file also contain zero size 85 byte byte zero corrupt segment file delet file appear correct corrupt index corrupt lost problem observ lucen 1.4.3 abl upgrad custom deploy 1.9 later version would happi back-port patch patch small enough problem alreadi solv
sortfield.auto n't work long actual lucene-463 find way re-open issu 'm attach test case dragon-fly999 hotmail com show problem patch seem fix problem long use date pars integ next step pars float work correct patch follow parser use order int long float
dead code spellchecker.java branch never execut spellcheck contain follow line code final int goalfreq morepopular ir null ir.docfreq new term field word 0 word exist real index n't care word frequenc return word morepopular goalfreq 0 return new string word branch never execut way goalfreq greater zero morepopular true morepopular true express statement evalu fals
chang mergepolici mergeschedul abstract base class instead interfac give us freedom add method default base implement time w/o break backward compat thank hoss rais
lock.obtain timeout behav incorrect larg timeout timeout long intern valu deriv timeout int possibl overflow intern valu negat number caus incorrect behavior spinoff thread http //www.gossamer-threads.com/lists/lucene/java-user/54376
simpl tostr booleanfilt work booleanfilt want basic tostr debug came work ok
simplefslockfactori ignor error delet lock file spinoff http //www.gossamer-threads.com/lists/lucene/java-user/54438 lock.releas simplefslockfactori ignor return valu lockfile.delet plan throw new lockreleasefailedexcept subclass ioexcept return fals minor chang backward compat method lucen releas lock alreadi throw ioexcept
separ javadoc core contrib ago discuss java-dev separ javadoc contrib modul instead one big javadoc contain core contrib class patch add new target build.xml javadocs-al generat javadoc core demo contrib class javadocs-cor generat javadoc core class javadocs-demo generat javadoc demo class javadocs-contrib use contrib-crawl generat javadoc contrib modul except similar current empti gdata add submenu javadoc link lucen site link differ javadoc includ javadoc maven artifact remark remov ant target javadocs-intern n't want add correspond target new javadoc target instead defin new properti javadoc.access ant -djavadoc.access=packag use combin javadoc target ok n't includ gdata yet use build file n't extend lucen standard build file 's preview http //people.apache.org/~buschmi/site-preview/index.html pleas let know think chang
add terminfosindexdivisor indexread termindexinterv set index time let 's tradeoff much ram use reader load index term vs cost seek specif term want load downsid must set index time issu add indexdivisor terminfosread open reader could sub-sampl termindexinterv use less ram eg set 2 mean everi 2 termindexinterv load ram particular use index great mani term eg accident index binari term spinoff thread http //www.gossamer-threads.com/lists/lucene/java-dev/54371
remov gdata trunk gdata n't seem maintain anymor re go remov cut 2.3 releas unless negat vote case someon jump futur start maintain re-add trunk anyon use gdata need 2.3 pleas let us know soon
index n't reset token state indexwrit documentswrit forget reset token state result incorrect positionincr payload token type
new analyz buffer token case would handi analyzer/tokenizer/tokenfilt could siphon certain token store buffer use later process pipelin exampl want two field one lowercas one analysi could save token output differ field patch follow still sure coupl thing most play new reus api see http //www.gossamer-threads.com/lists/lucene/java-dev/54397 search_string=bufferinganalyz 54397
bad java practic affect perform result code inspect intellij idea found follow issu lucens sourc code test 1 explicit loop call system.arraycopi 2 call boolean constructor stead appropri static method/field 3 instanti unnecessari integ instanc tostr instead call static one 4 string concaten use insid call stringbuffer.append stead chain append call minor issu patch forthcom
correct 2 minor javadoc mistak core javadoc.access=priv patch token.java termvectorsreader.java
ad factori querypars instanti queri instanc new effort payload score function would nice plugin custom queri implement use querypars includ patch refactor querypars take factori produc queri instanc
improv payload api want make optim payload api see follow thread relat discuss http //www.gossamer-threads.com/lists/lucene/java-dev/54708
make topdoc constructor public topdoc constructor packag visibl prevent instanti outsid packag exampl wrote hitcolletor could n't extend direct topdoccollector need creat new topdoc instanc howev sinc c'tor packag visibl ca n't complet duplic code hope ll fix soon
better explain output simpl patch slight improv output idf show docfreq numdoc
teststressindex intermitt failur see http //www.gossamer-threads.com/lists/lucene/java-dev/55092 copi ok seen twice last two day testsuit org.apache.lucene.index.teststressindex junit test run 1 failur 1 error 0 time elaps 18.58 sec junit junit standard output junit java.lang.nullpointerexcept junit org.apache.lucene.store.raminputstream.readbyt raminputstream.java:67 junit org.apache.lucene.store.indexinput.readint indexinput.java:66 junit org.apache.lucene.index.segmentinfo findsegmentsfile.run segmentinfos.java:544 junit org .apach .lucene.index.directoryindexreader.open directoryindexreader.java:63 junit org.apache.lucene.index.indexreader.open indexreader.java:209 junit org.apache.lucene.index.indexreader.open indexreader.java:192 junit org.apache.lucene.search.indexsearcher. init indexsearcher.java:56 junit org.apache.lucene.index.teststressindex searcherthread.dowork teststressindexing.java:111 junit org.apache.lucene.index.teststressindex timedthread.run teststressindexing.java:55 junit junit testcas teststressindexandsearch org.apache.lucene.index.teststressindex fail junit hit unexpect except search1 junit junit.framework.assertionfailederror hit unexpect except search1 junit org .apach .lucene.index.teststressindexing.runstresstest teststressindexing.java 159 junit org .apach .lucen .index .teststressindex .teststressindexandsearch teststressindexing.java:187 junit junit junit test org.apache.lucene.index.teststressindex fail subsequ run howev pass anyon els hit trunk run use ant clean test 'm mac pro 4 core 4gb machin help sure reproduc point strike thread issu oh joy ll tri investig tomorrow see dream test case -grant
invalid behavior standardtokenizerimpl follow code print output standardanalyz analyz analyz new standardanalyz tokenstream ts analyzer.tokenstream content new stringread text token ts.next null system.out.println pass www.abc.com output www.abc.com,0,11 type= host correct opinion howev pass www.abc.com notic extra end output wwwabccom,0,12 type= acronym think behavior second case incorrect sever reason 1 recogn string incorrect argu 2 kind prevent put url end sentenc perfect legal 3 acronym least best understand form a.b.c abc.def look standardtokenizerimpl.jflex think problem come definit acronym u.s.a. i.b.m. etc use post-filt remov dot acronym alpha alpha notic comment relat acronym u.s.a. i.b.m someth els chang definit acronym letter letter solv problem also report http //www.nabble.com/inconsistent-standardtokenizer-behaviour-tf596059.html a1593383 http //www.nabble.com/standard-analyz -host-and-acronym-tf3620533.html a10109926
checkindex incorrect see delet index corrupt silli bug checkindex wherebi segment delet consid corrupt thank bogdan ghidireac report
segmentmerg n't set payload bit new optim code new optim code segmentmerg payload bit set correct merg segment mean loos payload merg payload unit test n't catch new documentswrit buffer much doc default mean test case ca n't assum anymor docswrit flush 10 doc default testpayload howev fals assum mean merg happen anymor testpayload check whether testcas reli fix testpayload segmentmerg simpl ll attach patch soon
nullpointerexcept index documentswrit threadstat fielddata.addposit case index sometim appear document unusu larg word text-encod imag fact attempt add document contain field token produc java.lang.illegalargumentexcept java.lang.illegalargumentexcept term length 37944 exceed max term length 16383 org.apache.lucene.index.documentswrit threadstat fielddata.addposit documentswriter.java:1492 org.apache.lucene.index.documentswrit threadstat fielddata.invertfield documentswriter.java:1321 org.apache.lucene.index.documentswrit threadstat fielddata.processfield documentswriter.java:1247 org.apache.lucene.index.documentswrit threadstate.processdocu documentswriter.java:972 org.apache.lucene.index.documentswriter.updatedocu documentswriter.java:2202 org.apache.lucene.index.documentswriter.adddocu documentswriter.java:2186 org.apache.lucene.index.indexwriter.adddocu indexwriter.java:1432 org.apache.lucene.index.indexwriter.adddocu indexwriter.java:1411 expect except caught ignor problem indexwrit becom somewhat corrupt subsequ attempt add document index fail well time npe java.lang.nullpointerexcept org.apache.lucene.index.documentswrit threadstat fielddata.addposit documentswriter.java:1497 org.apache.lucene.index.documentswrit threadstat fielddata.invertfield documentswriter.java:1321 org.apache.lucene.index.documentswrit threadstat fielddata.processfield documentswriter.java:1247 org.apache.lucene.index.documentswrit threadstate.processdocu documentswriter.java:972 org.apache.lucene.index.documentswriter.updatedocu documentswriter.java:2202 org.apache.lucene.index.documentswriter.adddocu documentswriter.java:2186 org.apache.lucene.index.indexwriter.adddocu indexwriter.java:1432 org.apache.lucene.index.indexwriter.adddocu indexwriter.java:1411 100 reproduc
add unit test show live backup index question backup index come everi often list back index also clear import fundament admin task mani applic need fault toler past forc stop block chang index perform backup resum chang mani applic afford potenti long paus index addit deletionpolici lucene-710 's possibl live backup mean backup index background without paus ongo chang index snapshotdeletionpolici mark chosen commit point delet backup finish
possibl thread hazard indexwriter.clos fals spinoff thread http //www.gossamer-threads.com/lists/lucene/java-dev/55391 review code found one case abort merg call close fals could write file newli open indexwrit would also tri write strengthen exist test case testconcurrentmergeschedul tickl case also modifi mockramdirectori throw ioexcept ever file besid segments.gen overwritten howev strang ca n't get unhandl except occur test 'm sure still think good defens check commit
allow mergepolici select non-contigu merg start work lucene-1044 wo n't make much progress want checkpoint current state/patch backward compat must leav default mergepolici select contigu merg necessari applic reli tempor monoton doc id mean even though merg re-numb document renumb alway reflect order document ad index still app reli offer mergepolici free select best merg regardless whether continugu requir fix indexwrit accept merg fix logmergepolici option allow freedom
new analysi contribut advent new teetokenfilt sinktoken exist interest new thing done analysi phase index see lucene-1058 patch provid new implement sinktoken may use
cleanup unus unnecessari code sever class trunk unus unnecessari code includ unus field unus automat variabl unus import unnecessari assign attach patch clean
docvalu cleanup constructor getinnerarray docvalu constructor take numdoc paramet clean get rid also 's option getinnerarray method clean necessari better test current test fail implement modifi throw unsupportedop except rather return empti array modifi test fail warn test iml overrid chang make easier implement docvalu valuesourc 's e.g payload without cach
make token.default_typ public make token.default_typ public tokenfilt use reusabl token model way set type back default patch necessari commit soon
indexreader.lastmodifi throw npe indexreader.lastmodifi string dir variant alway return npe 2.3 perhap someth segmentinfo
increas default maxfieldlength understand lucen 2.3 easili index larg document n't get rid 10,000 default limit field length 10,000 n't much lucen n't error log default common problem user difficult debug n't know look better new default might integer.max_valu
docmak setup docs.dir properti fail pass absolut path setconfig trecdocmak assum docs.dir relat path therefor creat new file workdir docs.dir howev docs.dir absolut path work incorrect result txt file datadir except
multisearcher.explain return incorrect score/explan relat docfreq creat 2 differ index search individu print score detail compar search index mulitsearch print score detail docfreq valu print n't correct valu print index search individu code like code multisearch multi new multisearch searchabl hit hit multi.search queri int i=0 hits.length i++ explan expl multi.explain queri hits.id system.out.println expl.tostr code rais lucen user mail list advis log bug email thread given noformat -origin messag chris hostett sent friday decemb 07 2007 10:30 pm java-us subject re multisearch class calcul idf proper quick glanc code seem indic multisearch code calcuat docfreq accross searchabl search docfreq method explicit call explain method deleg searchabl specif docid came compar explan score got score return hitcollector topdoc probabl wo n't match would say yes multisearch calcul idf proper multiseracher.explain broken pleas file bug ca n't think easi way fix certian seem broken subject multisearch class calcul idf proper tri follow creat 2 differ index search individu print score detail compar search index mulitsearch print score detail docfreq valu print n't seem right problem use explain togeth multisearch code like multisearch multi new multisearch searchabl hit hit multi.search queri int i=0 hits.length i++ explan expl multi.explain queri hits.id system.out.println expl.tostr output id 14 score 0.071 0.07073946 match fieldweight content climat 2 product 1.0 tf termfreq content climat =1 1.8109303 idf docfreq=1 0.0390625 fieldnorm field=cont doc=2 noformat
add insertwithoverflow priorityqueu featur propos add insertwithoverflow priorityqueu caller reus object drop queue also chang heap protect easier extens pq
remov relat path assumpt benchmark code also see eric comment http //www.nabble.com/forum/viewpost.jtp post=14347924 framed=i benchmark 's config.xml reli relat path less like base-dir conf-dir work-dir docs-dir indexes-dir assumpt also java code inconveni use absolut path e.g specifi doc dir work-dir relax modifi build.xml replac valu line prop locat file requir absolut path java code
keywordtokenizer/analyz re-us new reusabletokenstream api keywordanalyz fail reset token re-us issu came thread http //www.gossamer-threads.com/lists/lucene/java-dev/55929 thank hideaki takahashi find
except documentswriter.adddocu corrupt store field file fdt documentswrit write number store field front fdtlocal buffer field process write store field buffer document done final claus flush buffer real fdt file directori problem except hit number store field high corrupt fdt file solut write front instead write number field actual saw
stopfilt option incr positionincr stop word ve seen come mail list time last month 'm file known bug/improv arround stopfilt option set record mani stop word skip row set valu positionincr next token stopfilt return
delet doc return hit search caus arrayindexoutofboundsexcept background user discuss http //www.nabble.com/document-deletion-problem-to14414351.html code hit h m_indexsearcher.search q return 11475 document int 0 h.length i++ int doc h.id m_indexsearcher.getindexread .deletedocu doc caus arrayindexoutofboundsexcept 6400 code
indexwriter.clos fals actual stop background merg thread right close fals indexwrit mark run merg abort wait merg finish caus problem thread still hold file open someon might think call close fals say delet file directori would fail window instead close fals notifi run merg abort return run merg done segmentmerg period check whether abort stop
small perform enhanc standardanalyz class standardanalyz inner class savedstream use intern maintain state class n't use implicit refer enclos class made static reduc memori requir patch attach short
make tokenizer.reset reader public order implement reusabletokenstream abl reset token token defin reset reader method problem method protect need call reset reader method without know advanc type token plan sever notic almost token extens defin method public wonder chang token also ca n't simpli creat general token extens inherit want use standardtoken well
tokenstream.next token reus polici call token.clear respons produc token implement reus form next method next token result reset postionincr return token 1
enwikidocmak id field enwikidocmak fair usabl outsid benchmark class would benefit index id field doc patch follow add id field
wikipediatoken extend standardtoken recogn wikipedia syntax mark token certain attribut n't necessarili complet good enough job consum improv other set token.typ valu depend wikipedia syntax link intern link bold ital etc base pass http //en.wikipedia.org/wiki/wikipedia tutori test benchmark enwikidocmak wikipedia stuff seem decent job caveat sure best handl test sinc content licens gnu free doc licens believ ca n't copi past whole document unit test hand code one doc anoth one general run benchmark wikipedia download one question put could go analysi test least depend benchmark think ad new contrib/wikipedia could grow wikipedia thing perhap would move enwikidocmak revers depend benchmark post patch next day
clean old jira issu compon analysi list jira issu compon analysi n't updat 2007 lucene-760 spellcheck could/should use n-gram token instead roll n-gram lucene-677 italian analyz lucene-571 standardtoken pars decim number host lucene-566 esperanto analyz lucene-559 turkish analyz lucen lucene-494 analyz prevent overload search servic queri common term larg index lucene-424 patch submissiom form simpl romanian analyz lucene-417 standardtoken problem comma-separ valu lucene-400 ngramfilt construct n-gram tokenstream lucene-396 patch add posit increment back stopfilt lucene-387 contrib main memori base synonymmap synonymtokenfilt lucene-321 patch submissiom tswana analyz lucene-233 patch analyz refactor base cvs head 6/21/2004 lucene-210 patch never write analyz lucene-205 patch patch russiananalyz lucene-185 patch thai analysi enhanc lucene-152 patch kstem lucen lucene-82 patch htmlparser ioexcept pipe close
clean old jira issu compon list jira issu compon n't updat 2007 lucene-746 incorrect error messag analyzingqueryparser.getprefixqueri lucene-644 contrib anoth highlight approach lucene-574 support vjc java compil also known j lucene-471 gcj ant target n't work window lucene-434 lucen databas bind lucene-254 patch pseudo-relev feedback enhanc lucene-180 patch languag guesser contribut
document partial index unhandl except lucene-843 's possibl subset document fields/term index store except hit case past none plan make none immedi mark document delet except hit index discuss lead http //www.gossamer-threads.com/lists/lucene/java-dev/56103
fix document.getboost document attach patch fix javadoc make clear getboost never return use valu case commit unless someon better word real fix
contrib/highlight javadoc exampl need updat javadoc package.html exampl code outdat still use queryparser.pars http //lucene.zones.apache.org:8080/hudson/job/lucene-nightly/javadoc/contrib-highlighter/index.html
small fix contrib/benchmark ve fix small issu ve hit contrib/benchmark first alg work first round subsequ round immedi finish code analyzer=org.apache.lucene.analysis.standard.standardanalyz doc.maker=org.apache.lucene.benchmark.bytask.feeds.linedocmak work.dir /lucene/work docs.file=work/reuters.lines.txt doc.maker.forever=fals directory=fsdirectori doc.add.log.step=3000 round resetsystemeras createindex adddoc adddoc closeindex newround 3 code think fail reset exhaust fals perftask.dolog ad plus re-open file linedocmak second made small optim call updateexhaust unless child task tasksequ resetinputstask comput up-front final allow flush ram doc count fix logic create/openindextask set rambuffersizemb maxbuffereddoc
contrib.benchmark.qu packag improv fix improv search qualiti benchmark packag flush report logger end otherwis long submiss report might miss last line add run-tag-nam submiss report api chang add control max- queri run use debug qualiti evalu setup move control max-docs-to-retriev benchmark constructor setter method api chang add comput mean reciproc rank mrr qualitystat qualitystat fix fail result averag add trec queri reader adequ 1mq track track start 2007 test pass commit 1-2 day object
intermitt thread safeti issu enwikidocmak intermitt thread safeti issu enwikidocmak run conf/wikipediaoneround.alg sometim get start ok time 1/3rd time see except thread thread-0 java.lang.runtimeexcept java.io.ioexcept bad file descriptor org.apache.lucene.benchmark.bytask.feeds.enwikidocmak parser.run enwikidocmaker.java:76 java.lang.thread.run thread.java:595 caus java.io.ioexcept bad file descriptor java.io.fileinputstream.readbyt nativ method java.io.fileinputstream.read fileinputstream.java:194 org.apache.xerces.impl.xmlentitymanag rewindableinputstream.read unknown sourc org.apache.xerces.impl.io.utf8reader.read unknown sourc org.apache.xerces.impl.xmlentityscanner.load unknown sourc org.apache.xerces.impl.xmlentityscanner.scanqnam unknown sourc org.apache.xerces.impl.xmlnsdocumentscannerimpl.scanstartel unknown sourc org.apache.xerces.impl.xmldocumentfragmentscannerimpl fragmentcontentdispatcher.dispatch unknown sourc org.apache.xerces.impl.xmldocumentfragmentscannerimpl.scandocu unknown sourc org.apache.xerces.parsers.xml11configuration.pars unknown sourc org.apache.xerces.parsers.xml11configuration.pars unknown sourc org.apache.xerces.parsers.xmlparser.pars unknown sourc org.apache.xerces.parsers.abstractsaxparser.pars unknown sourc org.apache.lucene.benchmark.bytask.feeds.enwikidocmak parser.run enwikidocmaker.java:60 1 problem thread pull xml doc start soon enwikidocmak class instanti 's start use filei fileinputstream feed xml parser openfil actual call twice start alg use task deriv resetinputstask close origin filei xml parser may use chang thread instead start on-demand first time next call also remov redund resetinput call open file frequent need final ad logic thread detect input stream close linedocmaker.resetinput call eg run doc maker exhaust
core analyz produc token n 100 charact length discuss led http //www.gossamer-threads.com/lists/lucene/java-dev/56103 believ near time token 100 charact length produc 's bug analysi user awar long token caus sort problem downstream it best catch earli sourc accomplish tack lengthfilt onto chain standardanalyz simpleanalyz whitespaceanalyz etc 2.3 realiz technic break backward compat howev think must incred rare break would fact break someth real applic
optim terminfoswriter.add found one optim term written terminfoswrit previous term requir new term new string look cpu time use yourkit could see ad non-trivi cost flush index wikipedia chang terminfoswriter.add accept char direct instead ran quick test build first 200k doc wikipedia fix took 231.31 sec best 3 without fix took 236.05 sec best 3 ~2 speedup
use bulk-byte-copi merg term vector index wikipedia term vector yourkit profil show 26 time spent merg vector without offset posit would make matter even wors depress merg even concurrentmergeschedul fact keep flush new segment test strong io system mac pro 4 drive raid 0 array 4 cpu core like robert 's idea merg store field bulk copi whenev field name- number map congruent lucene-1043 term vector 's littl trickier term vector format n't quit make easi bulk-copi n't direct encod offset tvf file work patch chang tvx format slight store absolut posit tvf file start document tvx file like tvd add extra 8 byte long tvx file per document remov vlong first posit store insid tvd file make tvd content fulli posit independ copi byte add 7 byte per document less larger indic term vector enabl think small increas index size accept gain index perform chang time spent merg term vector drop 26 3 cours appli document regular think futur could lucen tri hard assign field number given field name seen index merg term domin merg cost ~20 overal time build wikipedia index also beef testbackwardscompat unit test test non-cf cfs version 1.9 2.0 2.1 2.2 index format ad term vector field indic
allow overrid specif version manifest.mf specif version manifest.mf consist digit e. g. build releas candid version like 2.3-rc1 specifi differ specif version see relat discuss http //www.gossamer-threads.com/lists/lucene/java-dev/56611
short circuit fuzzyquery.rewrit input token length small compar minsimilar found unrepli email float around lucen folder holiday noformat timo nentwig java-dev subject fuzzi make sens short token date mon 31 dec 2007 16:01:11 +0100 message-id 200712311601.12255.lucen nitwit.d hi general make sens search fuzzi short token chang even singl charact cours alreadi result high edit distanc actual make sens case token.length 1f 1f minsimilar e.g chang one charact 3-letter token foo result edit distanc 0.6 minsimilar default 0.5 higher save expens rewrit logic noformat n't know much fuzzyqueri reason seem sound fuzzyquery.rewrit abl complet skip termenumer event input token shorter simpl math minsimilar 'm smart enough certain math right howev 's sinc look levenstein distanc test need
excess arrays.fil 0 documentswrit drastic slow small doc 3.9x slowdown ve final perform test 2.3rc1 uncov fair serious bug add larg fix cpu cost document term vector enabl field bug affect correct perform basic everi document call arrays.fil 0 larg 32 kb byte array fact need zero small part happen term vector turn especi devast small document
simplifi standardtoken jflex grammar summari thread entitl fullwidth alphanumer charact plus question korean rang begun daniel noll java-us carri java-dev 01/07/2008 5:06 pm daniel noll wrote wish tokenis could use character.islett character.isdigit instead know rang sinc jre alreadi inform character.islett return true cjk charact though rang would still come handi determin kind letter n't support jflex way digit macro could replac jflex 's predefin charact class digit semant java.lang.character.isdigit although jflex 's predefin charact class letter semant java.lang.character.islett includ cjk charact way handl use jflex 's regex negat syntax jflex documentation|http //jflex.de/manual.html bq express match everyth match b b exclud cj charact letter macro code letter letter cj code sinc letter includ korean rang 's reason afaict treat separ unlik chines japanes charact individu token korean charact particip token boundari rule letter look differ unicod 3.0.0 java 1.4.2 support unicod 5.0 latest version lot new modifi letter digit rang stuff get tweak time n't think lucen busi tri track take posit unicod version user data conform switch use jflex 's letter digit predefin charact class tie decis user 's choic jvm version seem much reason current status quo attach patch short
tokensources.gettokenstream document sometim one alreadi document need generat tokenstream go add conveni method tokensourc sometim also alreadi string add conveni method
add highlight benchmark support contrib/benchmark would like abl test perform speed initi highlight standard way patch follow add highlight depend benchmark add task extend readtask perform highlight retriev document
readtask ignor traversals readtask dolog method ignor valu traversals loop hits.length instead thus fals report desir number iter hit list fix relat trivial sinc alreadi calcul code int traversals math.min hits.length traversals code need use valu loop condit
hit disk full documentwriter.threadstate.init caus hang test rc2 found one case hit disk full init documentswriter.threadst first creat term vector field writer subsequ call indexwriter.add/updatedocu hang forev 's happen case increment nextdocid even though never call finishdocu thought init succeed finish next document never actual write miss finishdocu call never happen
add numdeleteddoc indexread add numdeleteddoc indexread basic implement simpl public int numdeleteddoc return deleteddoc null 0 deleteddocs.count segmentread patch follow includ indexread extens
highlight document updat various place highlight document refer byte i.e simplefragment char see http //www.gossamer-threads.com/lists/lucene/java-user/56986
wikipediatoken need way token certain part text would nice wikipediatoken way via flag leav categori link etc singl token least part thus came across categori big idea would way output singl token big idea option would good output big idea individu token well sure jflex insight would appreci
booleanquery.rewrit work proper minnumbershouldmatch booleanquery.rewrit respect minnumbershouldmatch number claus 1 caus inconsist queri +def +abc +def set minnumshouldmatch 1 first queri result return although claus queri second queri result return reason lie optim booleanquery.rewrit one claus queri patch includ optim queri singl claus minnumshouldmatch 0
mark contrib/wikipedia experiment go add javadoc trunk 2_3 branch mark wikipediatoken experiment think fine releas want peopl know grammar may chang next releas although tri keep
add abil count sub-task dolog increment contri/benchmark sometim want run sub-task like closeindex includ time take run includ count return report rec/ could adopt approach task preced charact count valu return dolog see discuss lead http //www.gossamer-threads.com/lists/lucene/java-dev/57081
token type bitset typebit sometim use compact easi pars type represent token current type string patch add bitset onto token default null accessor set bit flag token use communic inform token tokenfilt chain exampl wikipediatoken possibl exist token could categori bold mani variat yet difficult communic without ad lot differ string type unlik use payload inform could serv purpos bitset get ad index although one could easili convert payload
spellchecker.clearindex call unlock inappropri note lucene-1050 fix bug simplelockfactori relat report success/filur lock file delet surfac bad behavior spellchecker.clearindex grant quot seem spellcheck tell indexread delet lockfil lockfil n't exist n't know much lock mechan seem like check see lockfil exist tri delet quot hoss quot grant take spellchecker.clearindex wrong n't call unlock unless reason think stale lock need close ie bug spellcheck discov bug lucene-1050 fix would suggest new issu track patch spellchecker.clearindex n't call unlock unless islock return true even might make sens catch ignor lockreleasefailedexcept let whatev result except may origin new indexwrit return quot mark 2.3 sinc seem like fair trivial fix n't deal bug introduc 2.3
various small improv contrib/benchmark ve work small improv contrib/benchmark refactor common code open/createindextask set configur indexwrit also fix bug openindextask prevent disabl flush ram ad new config properti linedocmak doc.reuse.fields=true|fals turn on/off reus field/docu linedocmak let us measur perform impact share field/docu vs also turn necessari eg consum use privat thread ad merge.schedul merge.polici config option ad param optimizetask expect int call optim maxnumseg param ad param closeindex true|fals pass fals mean close index abort run merg
npe stopfilt caus standardanalyz boolean replaceinvalidacronym constructor think found problem new code https //issues.apache.org/jira/browse/lucene-1068 usag new constructor standardanalyz boolean replaceinvalidacronym caus npe stopfilt java.lang.nullpointerexcept org.apache.lucene.analysis.stopfilter. init stopfilter.java:74 org.apache.lucene.analysis.stopfilter. init stopfilter.java:86 org.apache.lucene.analysis.standard.standardanalyzer.tokenstream standardanalyzer.java:151 org.apache.lucene.queryparser.queryparser.getfieldqueri queryparser.java:452 org.apache.lucene.queryparser.queryparser.term queryparser.java:1133 org.apache.lucene.queryparser.queryparser.claus queryparser.java:1020 org.apache.lucene.queryparser.queryparser.queri queryparser.java:948 org.apache.lucene.queryparser.queryparser.claus queryparser.java:1024 org.apache.lucene.queryparser.queryparser.queri queryparser.java:948 org.apache.lucene.queryparser.queryparser.toplevelqueri queryparser.java:937 org.apache.lucene.queryparser.queryparser.pars queryparser.java:147 reason new constructor forget initi stopset field public standardanalyz boolean replaceinvalidacronym this.replaceinvalidacronym replaceinvalidacronym guess chang someth like public standardanalyz boolean replaceinvalidacronym stop_word this.replaceinvalidacronym replaceinvalidacronym bug present rc3 fix one line ll great 2.3 releas
updat snowbal packag updat snowbal contrib packag new org.tartarus.snowbal java packag patch snowballprogram abstract avoid use reflect introduc hungarian turkish romanian stemmer introduc constructor snowballfilt snowballprogram possibl chang made stemmer algorithm patch current svn trunk lucen index might thus compat new stemmer api backward compatibil test pass
documentswriter.abort fail clear docstoreoffset hit work lucene-1044 disk full event flush documentswrit abort clear buffer doc add anoth doc two close writer time succeed flush say 's coupl buffer doc result segment smaller flush corrupt segment incorrect non-zero docstoreoffset modifi testconcurrentmergeschedul test show bug ll attach patch short
npe crash case memori attach class make lucen crash npe start -xmx10m although 's probabl outofmemori problem stacktrac except thread main java.lang.nullpointerexcept java.util.arrays.fil unknown sourc org.apache.lucene.index.documentswrit byteblockpool.reset documentswriter.java:2873 org.apache.lucene.index.documentswrit threadstate.resetpost documentswriter.java:637 org.apache.lucene.index.documentswriter.resetpostingsdata documentswriter.java:458 org.apache.lucene.index.documentswriter.abort documentswriter.java:423 org.apache.lucene.index.documentswriter.updatedocu documentswriter.java:2433 org.apache.lucene.index.documentswriter.adddocu documentswriter.java:2397 org.apache.lucene.index.indexwriter.adddocu indexwriter.java:1445 org.apache.lucene.index.indexwriter.adddocu indexwriter.java:1424 lucenecrash.myrun lucenecrash.java:32 lucenecrash.main lucenecrash.java:19 document quit big hundr kb attach send via privat mail need crash happen first time reset call index 10 document assum bug error mislead mayb oom error
disjunctionsumscor small tweak move scorerdocqueu initi next skipto method constructor make disjunctionsumscor bit faster less 1 test downsid one judg would throw ioexcept disjunctionsumscor constructor touch harddisk see problem ioexcept propag far modif made booleanscorer2 scorerdocqueu null initscorerdocqueu attach test quick dirti rip testscorerperf standard lucen test packag includ patch like test pass patch made trunk revis 613923
add option checkindex check certain segment simpl patch add -segment option checkindex tool check particular segment instead segment index
creat new sub-class spanqueri enabl use rangequeri within spanqueri user express queri use syntax enabl emb various queri type within spanqueri instanc one featur ve ask abil emb numer rang queri could exampl find document match 2.0 2.75 mhz attach patch add capabl hope other find use
token type standard token access standardtokenizerimpl public token type access code java public static final int alphanum 0 public static final int apostroph 1 public static final int acronym 2 public static final int compani 3 public static final int email 4 public static final int host 5 public static final int num 6 public static final int cj 7 deprec solv bug host end identifi acronym deprec remov next releas public static final int acronym_dep 8 public static final string token_typ new string alphanum apostroph acronym compani email host num cj acronym_dep code custom tokenfilt base token type actual even standardfilt writen outsid org.apache.lucene.analysis.standard packag
fix standardanalyz mis-identifi host acronym default come discuss around back compat seem best default standardanalyz proper fix lucene-1068 preserv abil get back-compat behavior rare event 's desir mean chang replaceinvalidacronym fals true ad clear entri changes.txt slight non back compat chang took place spinoff http //www.gossamer-threads.com/lists/lucene/java-dev/57517 57517 ll commit chang day two
spellcheck work proper call indexdictionari clearindex call clearindex indexdictionari rebuild dictionari fresh call spellcheck clearindex function reset searcher henc call indexdictionari mani entri alreadi stale searcher index also see indexread reader use sole purpos obtain docfreq given term exist function function also obtain use searcher call searcher.docfreq thus get away complet reader code associ like indexreader.islock spellindex indexreader.unlock spellindex reader relat code final
lucen need ship junit jar test order hudson build etc work proper lucen need ship junit jar made avail test classpath system req say 3.8.1 3.8.2 lay around updat system requir
system req page releas specif system requir page current main- resourc section websit part given version 's document sinc chang given releas deprec exist one leav place messag cover exist releas n't also add releas doc futur releas
wikipedia document generat chang enwikidocmak current produc fair number document download dubious use term benchmark index issu redirect current handl redirect redirect document redirect templat file appear useless mark term templat begin bodi see exampl http //en.wikipedia.org/wiki/templ imag page http //en.wikipedia.org/wiki/imag sciencefieldnewark.jpg.jpg use redirect templat file pend delet one bit trickier handl general mark wikipedia vote delet variat depend along delet think implement backward compat need come contrib/benchmark suit
format chang log changes.txt easi edit friend read lucen user background http //www.nabble.com/formatable-changes-log-tt15078749.html
datetool utc/gmt mismatch post antoni bowesman java-us notic although javadoc lucen 2.2 state date datetool use utc timezon actual use gmt either javadoc correct code correct use utc instead 'm attach patch chang javadoc commit unless someon know reason javadoc correct code chang utc understand 's signific differ utc gmt
mergeexcept cms thread record directori hit unhandl except concurrentmergeschedul throw mergepolicy.mergeexcept 's easi way figur index caus one plan add directori mergeexcept also made small chang concurrentmergeschedul ad handlemergeexcept method call except subclass concurrentmergeschedul someth except occur ad getmergethread method overrid thread creat eg want make differ thread group use pool chang prioriti etc. ad domerg actual merg someth start finish merg chang privat protect attr plan commit day two
improv architectur fieldsortedhitqueu per discuss quit time ago issu lucene-806 'd like propos architectur chang way fieldsortedhitqueu work particular way creat sortcomparatorsourc think hope anyon look fshq code agre class lot much 's repetit stuff realli busi class attach patch n't realli achiev much 's concret tidi thing great deal make easier plug differ behaviour subsequ patch provid fair simpl flexibl exampl might replac implement case field-local-string-compar version lucene-806 downsid patch involv chang signatur sortcomparatorsource.newcompar take local would way around let fieldsortedhitqueu take either sortcomparatorsourc new improv interfac take local possibl extend sortcomparatorsourc 'm open person think local version make sens would suggest code would nicer break api henc target presum 3.0 minimum code includ specif test add peopl like general idea 'm propos current test pass chang patch follow
chararrayset.contain char text int int len work tri use chararrayset filter write heavili use char-array code speed thing stumbl upon bug chararrayset method _public boolean contain char text int int len seem work code set.contain buffer offset length code code fail code set.contain new string buffer offset length code everyth work expect variant behav attach small piec code show problem
improv concurrentmergeschedul handl too-many-merg case cms let set maxmergethread control max simultan merg howev cms hit max still allow merg run run foreground thread set max 1 use 1 thread add doc get 2 merg run think broken think instead cms paus foreground thread wait number merg thread drop limit kick backlog merg thread return control back primari thread
reduc exposur night build document lucene-1157 ..the night build document promin search indexwrit api googl yahoo return night document releas document https //issues.apache.org/jira/browse/lucene-1157 focusedcommentid=12565820 action_12565820
tokenfilt decompos compound word tokenfilt decompos compound word find mani german languag like german swedish singl token exampl donaudampfschiff would decompos donau dampf schiff find word even enter schiff use hyphen code apach xml project fop http //xmlgraphics.apache.org/fop/ first step decomposit current use fop jar direct use hand class fop project question would ok copi class lucen project renam packag cours stick depend fop jar fop code use asf v2 licens well think
termvector index file becom corrupt autocommit=fals spinoff thread http //www.gossamer-threads.com/lists/lucene/java-dev/55951 actual 2 separ case happen autocommit=fals first issu caus lucene-843 sigh add bunch doc term vector 1 flush happen add doc term vector tvx file enough entri corrupt second issu caus bulk merg term vector lucene-1120 trunk bulk merg store field lucene-1043 2.3 show autocommit=fals bulk merg optim run case code read rawdoc tri read far tvx/fdx file it realli index corrupt rather bug rawdoc read
search filter work see attach junittest self-explanatori
make documentswrit robust hit oom ve stress test documentswrit index wikipedia give enough memori jvm vari heap size tickl differ interest case sometim documentswrit deadlock time hit subsequ npe aioob assert failur ve fix case ve found ad assert produc plain oom except chang contain documentswriter.java test pass plan commit day two
small speedup documentswrit small fix found profil index wikipedia main use quicksort instead arrays.sort test first 200k doc wikipedia show speedup 274.6 second 270.2 second ll commit day two
index corrupt autocommit=fals lucen 2.3 trunk index becom corrupt autocommit=fals
outdat inform analyz javadoc 'm sure find way improv javadoc feel free chang extend patch
occasion mergeexcept index teststressindexing2.testmulticonfig occasion hit merg except
termvector corrupt case autocommit=fals took yonik 's awesom test case teststressindexing2 extend also compar term vector 's fail still need track seem like separ issu
iw.optim mani merg end fix trunk lucene-1044 'd like separ backport 2.3 concurrentmergeschedul bug cfs wherebi final merg optim finish 's build cfs merg polici may incorrect ask anoth merg collaps segment compound file net effect optim spend mani extra iter unecessarili merg singl segment collaps compound file believ case rare hard hit mayb multipl thread call optim testthreadedoptim test hit 's low-risk fix plan commit 2.3 short
assertionerror creat doc contain field empti string field name spinoff http //www.gossamer-threads.com/lists/lucene/java-user/58496 pre-2.3 allow add field document field name empti string 2.3.0 broke hit flush code java.lang.assertionerror org.apache.lucene.index.terminfoswriter.add terminfoswriter.java:143 org.apache.lucene.index.documentswriter.appendpost documentswriter.java:2290 org.apache.lucene.index.documentswriter.writeseg documentswriter.java:1985 org.apache.lucene.index.documentswriter.flush documentswriter.java:539 org.apache.lucene.index.indexwriter.doflush indexwriter.java:2497 org.apache.lucene.index.indexwriter.flush indexwriter.java:2397 org.apache.lucene.index.indexwriter.closeintern indexwriter.java:1204 org.apache.lucene.index.indexwriter.clos indexwriter.java:1178 org.apache.lucene.index.indexwriter.clos indexwriter.java:1153 code bug over-aggress assert statement ll commit fix short port 2.3 branch 2.3.1 releas
syns2index fail run syns2index fail java.lang.illegalargumentexcept maxbuffereddoc must least 2 enabl except org.apache.lucene.index.indexwriter.setmaxbuffereddoc indexwriter.java:883 org.apache.lucene.wordnet.syns2index.index syns2index.java:249 org.apache.lucene.wordnet.syns2index.main syns2index.java:208 code blind paramet speed writer.setmergefactor writer.getmergefactor 2 writer.setmaxbuffereddoc writer.getmaxbuffereddoc 2 look like getmaxbuffereddoc use return 10 return -1 sure start happen suggest would remov three line sinc speed alreadi improv vast n't need speed thing run syns2index requir two arg first locat wn_s.pl file second directori creat index
similaritydeleg miss deleg scorepayload method handi similaritydeleg method miss scoredeleg deleg method fix trivial add code end class public float scorepayload string fieldnam byte payload int offset int length return delegee.scorepayload fieldnam payload offset length
trstringdist use way much memori patch implement trstringdist base version 2.1 org.apache.commons.lang.stringutil getlevenshteindist string string use un-optim implement levenshtein distanc algorithm use way much memori pleas see bug 38911 http //issues.apache.org/bugzilla/show_bug.cgi id=38911 inform commons-lang implement heavili optim version 2.2 3x speed-up report new implement trstringdist
allow snapshotdeletionpolici reus across writer close/open re-us instanc snapshotdeletionpolici across close/open writer snapshot open still remov 2nd writer open sdp compar indexcommitpoint instanc fix instead compar segment file name ve also chang inner class indexfiledeleter.commitpoint static instanc snapshotdeletionpolici hold refer indexfiledelet documentswrit etc spinoff http //markmail.org/message/bojgqfgyxkkv4fyb
patch avoid check termbuff segmenttermenum scanto seem segmenttermenum scanto critic method call often especi whenev iter sequenc term index method call first thing happen check whether temporari termbuff scratch alreadi initi fact necessari simpli declar initi scratch -buffer class-level right initi valu _null_ java 's lazy-load capabl allow without ad memori footprint case need buffer attach patch take care save one comparison per term addit patch renam scratch scanbuff align name two buffer declar class
patch clear threadloc instanc close alreadi found lucene-436 seem garbag collect problem threadloc certain constel result outofmemoryerror resolut remov refer threadloc valu call close method affect class see fieldsread terminfosread java 5.0 effect done call threadlocal.set null java 5.0 would call threadlocal.remov analog done *any* class creat threadloc valu right two class core api make use threadloc proper remov refer threadloc valu 1. org.apache.lucene.index.segmentread 2. org.apache.lucene.analysis.analyz segmentread attach simpl patch analyz current patch analyz provid close method futur to-do
thing done filter independ bitset asid document mark text jira comment follow thing left lucene-584 lucen 3.0 filter.bit remov checkm indexsearch use conjunctionscor boolean behaviour filter look filter cach yet suppos room improv iirc current core move use openbitsetfilt probabl cach case might better cach sortedvintlist instead boolean logic docidsetiter alreadi avail scorer inherit docidsetiter search packag current implement conjunctionscor disjunctionsumscor reqoptsumscor reqexclscor boolean logic bitset avail contrib/misc contrib/queri disjunctionsumscor call score subscor score valu actual need could reason introduc disjunctiondocidsetiter perhap superclass disjunctionsumscor fulli implement non score queri termdocidsetiter need perhap superclass termscor javadoc org.apache.lucene.search use match vs non-zero score ll investig soon provid patch necessari earli version patch lucene-584 contain class matcher differ current docidset matcher explain method remain seen whether matcher could use docidset scorer semant scorer.skipto scorer.doc discuss briefli also discuss anoth issu recent perhap wortwhil open separ issu skip sortedvintlist done use linear search could improv ad multilevel skiplist info much like lucen index document contain term one comment 3 dec 2008 complet test class deprec might good add target releas remov
equal hashcod implement org.apache.lucene.search packag would like talk implement equal hashcod method org.apache.lucene.search packag exampl one org.apache.lucene.search.spans.spantermqueri super class org.apache.lucene.search.payloads.boostingtermqueri sub class observ boostingtermqueri defin equal inherit hashcod spantermqueri definit equal code clone spantermqueri chang class name intent believ intent equal redefinit boostingtermqueri make object spantermqueri boostingtermqueri compar ie spantermquery.equ boostingtermqueri fals boostingtermquery.equ spantermqueri fals problem current implement intent might respect result symmetr properti violat equal contract i.e spantermquery.equ boostingtermqueri true boostingtermquery.equ spantermqueri fals alway note provid state variabl equal solut chang implement equal spantermqueri code title=spantermquery.java|borderstyle=solid public boolean equal object o o instanceof spantermqueri return fals spantermqueri spantermqueri o return this.getboost other.getboost this.term.equ other.term code code title=spantermquery.java|borderstyle=solid public boolean equal object o o return true o null || o.getclass this.getclass return fals o instanceof spantermqueri return fals spantermqueri spantermqueri o return this.getboost other.getboost this.term.equ other.term code advantag boostingtermquery.equ boostingtermquery.hashcod need still preserv intent subclass add new state variabl extend class spantermqueri redefin equal hashcod even new state variabl ad subclass symmetr properti equal contract still respect irrespect implement i.e instanceof getclass equal hashcod subclass exampl two org.apache.lucene.search.cachingwrapperfilt super class org.apache.lucene.search.cachingwrapperfilterhelp sub class observ exampl one problem exampl one solut chang equal cachingwrapperfilt code title=cachingwrapperfilter.java|borderstyle=solid public boolean equal object o o instanceof cachingwrapperfilt return fals return this.filter.equ cachingwrapperfilt o .filter code code title=cachingwrapperfilter.java|borderstyle=solid public boolean equal object o o instanceof cachingwrapperfilt return fals o return true o null || o.getclass this.getclass return fals return this.filter.equ cachingwrapperfilt o .filter code advantag exampl one cachingwrapperfilterhelper.equ cachingwrapperfilterhelper.hashcod need exampl three org.apache.lucene.search.multitermqueri abstract parent org.apache.lucene.search.fuzzyqueri concret sub org.apache.lucene.search.wildcardqueri concret sub observ problem wildcardqueri defin equal inherit hashcod multitermqueri definit equal contain super.equ invoc fuzzyqueri state variabl ad referenc equal hashcod intent believ intent make object fuzzyqueri wildcardqueri compar ie fuzzyquery.equ wildcardqueri fals wildcardquery.equ fuzzyqueri fals propos implement chang implement equal multitermqueri code title=multitermquery.java|borderstyle=solid public boolean equal object o o return true o instanceof multitermqueri return fals final multitermqueri multitermqueri multitermqueri o term.equ multitermquery.term return fals return getboost multitermquery.getboost code code title=multitermquery.java|borderstyle=solid public boolean equal object o o return true o instanceof multitermqueri return fals o null || o.getclass this.getclass return fals final multitermqueri multitermqueri multitermqueri o term.equ multitermquery.term return fals return getboost multitermquery.getboost code advantag wildcardquery.equ need defin new state fuzzyquery.equ still need fuzzyqueri defin new state
querypars correct handl escap charact within quot string lucen queri parser incorrect handl escap charact insid quot string specif quot string end escap backslash follow addit quot string proper token consid follow exampl bq name ///mike\\\\\\ name alphons contriv exampl deriv actual bug ve encount system run queri throw except remov second claus resolv problem dig ve found problem way quot string process lexer ll notic mike 's name follow three escap backslash right end quot look javacc code queri parser highlight problem code title=queryparser.jj|borderstyle=solid default token || plus minus lparen rparen colon star carat boost quot \\\ code take look way quot token construct lexic process escap charact within quot string queri lexer match everyth first quot backslash _treat end quot escap character_ thus also match start quot second term caus lexer error last quot consid start new match ve come understand lucen queri handler suppos abl handl unsanit human input inde lexer would handl queri like blah\ without complain 's best-guess approach result bug legal automat generat queri ve attach patch fix erron behavior maintain lenienc malform queri believ correct approach two design goal fundament odd 'd appreci comment
indexwrit hit outofmemoryerror commit progress made make indexwrit robust oom think still real risk oom bad time could put indexwrit bad state close call somehow succeed without hit anoth oom risk introduc mess index 'd like detect oom hit method alter iw 's state commit chang index close call hit oom think writer instead abort attach patch add try/catch claus catch oom note hit re-throw sync refus commit new segments_n oom hit close instead call abort oom hit test pass plan commit day two
add deletebyqueri indexwrit discuss sever time recent http //markmail.org/message/awlt4lmk3533epb http //www.gossamer-threads.com/lists/lucene/java-user/57384 57384 add deletebyqueri indexwrit big step toward allow indexread readon took approach suggest first thread buffer delet queri like buffer delet term hold max docid delet appli also decoupl flush delet map term queri actual docid need delet flush ad document flush delet merg start commit close segmentmerg export docid map use merg use renumb max docid pend delet final turn track memori usag pend delet sinc live beyond flush delet explicit flush set maxbuffereddeleteterm someth disable_auto_flush otherwis flush start everi merg
perform improv terminfosread current bottleneck multi-term queri dictionari lookup done twice term first time similarity.idf searcher.docfreq call second time post list open termdoc termposit dictionari lookup cheap 's signific perform improv possibl avoid second lookup easi way add small lru cach terminfosread ran perform experi lru cach size 20 mid-siz index 500,000 document wikipedia test result 50,000 queri 3 term old 152 sec new lru cach 112 sec 26 faster 50,000 queri 3 term old 175 sec new lru cach 133 sec 24 faster bigger index patch probabl less impact smaller attach patch soon
ramdirectori report incorrect eof seek creat file whose length multipl 1024 buffer_s tri seek end file hit eofexcept actual legal long n't tri read byte point 'm hit rare bulk-merg logic term vector lucene-1120 seek end file read byte condit right
indexwrit flush earli flush ram usag silli bug documentswrit track ram usag whenev term vector enabl incorrect count space use term vector toward flush fact space recycl per document function bug caus flush happen frequent indexwrit use less ram ask work around simpli give bigger ram buffer commit fix short
except documentswriter.threadstate.init lead corrupt except hit init method documentswrit incorrect increment numdocsinram fact document ad spinoff thread http //markmail.org/message/e76hgkgldxhakuaa root caus led except init actual due incorrect use lucen 's api one thread still modifi document indexwriter.adddocu ad still protect except come init
nullpointerexcept indexmodifier.clos upgrad lucen 2.0.0. 2.3.1 hope would resolv issu http //jira.codehaus.org/browse/mrm-715 trace lucen 2.3.1 java.lang.nullpointerexcept org.apache.lucene.index.indexmodifier.clos indexmodifier.java:576 org.apache.maven.archiva.indexer.lucene.lucenerepositorycontentindex.closequiet lucenerepositorycontentindex.java:416 org.apache.maven.archiva.indexer.lucene.lucenerepositorycontentindex.modifyrecord lucenerepositorycontentindex.java:152 org.apache.maven.archiva.consumers.lucene.indexcontentconsumer.processfil indexcontentconsumer.java:169 org.apache.maven.archiva.repository.scanner.functors.consumerprocessfileclosure.execut consumerprocessfileclosure.java:51 org.apache.commons.collections.functors.ifclosure.execut ifclosure.java:117 org.apache.commons.collections.collectionutils.foralldo collectionutils.java:388 org.apache.maven.archiva.repository.scanner.repositorycontentconsumers.executeconsum repositorycontentconsumers.java:283 org.apache.maven.archiva.proxy.defaultrepositoryproxyconnectors.transferfil defaultrepositoryproxyconnectors.java:597 org.apache.maven.archiva.proxy.defaultrepositoryproxyconnectors.fetchfromproxi defaultrepositoryproxyconnectors.java:157 org.apache.maven.archiva.web.repository.proxieddavserver.applyserversidereloc proxieddavserver.java:447 org.apache.maven.archiva.web.repository.proxieddavserver.fetchcontentfromproxi proxieddavserver.java:354 org.apache.maven.archiva.web.repository.proxieddavserver.process proxieddavserver.java:189 org.codehaus.plexus.webdav.servlet.multiplexed.multiplexedwebdavservlet.servic multiplexedwebdavservlet.java:119 org.apache.maven.archiva.web.repository.repositoryservlet.servic repositoryservlet.java:155 javax.servlet.http.httpservlet.servic httpservlet.java:803
indexwriter.addindexes* deadlock rare case somewhat rare case 's possibl addindex deadlock synchron method normal merg necessari addindex done serial primari thread involv segment extern directori howev mergefactor merg complet merg becom necessari merg segment extern run background mani bg thread need run current 4 paus primari thread approach adopt lucene-1164 deadlock addindex method hold lock indexwrit appear intermitt deadlock testindexwritermerg test case issu present 2.3 caus lucene-1164 solut shrink scope synchron don't synchron whole method wrap synchron right place insid method
add getindexcommit method indexread spinoff thread http //markmail.org/message/bojgqfgyxkkv4fyb think make sens ask indexread commit point open enabl use case describ thread creat delet polici abl queri open reader commit point use prevent delet
clover setup current problem track bug get lost email http //www.nabble.com/clover-reports-missing-from-hudson to15510616.html a15510616 clover setup lucen current problem 3 think 1 instrument fail contrib/db/ contain java packag asf clover lscenc n't allow instrument patch 2 run instrument contrib test contrib produc strang error monospac junit testsuit org.apache.lucene.analysis.el.greekanalyzertest junit test run 1 failur 0 error 1 time elaps 0.126 sec junit junit standard error junit clover fatal error clover could initialis sure clover runtim classpath class java.lang.noclassdeffounderror com_cenqua_clover/cloverversioninfo junit junit testcas testanalyz org.apache.lucene.analysis.el.greekanalyzertest caus error junit com_cenqua_clover/g junit java.lang.noclassdeffounderror com_cenqua_clover/g junit org.apache.lucene.analysis.el.greekanalyzer. init greekanalyzer.java:157 junit org.apache.lucene.analysis.el.greekanalyzertest.testanalyz greekanalyzertest.java:60 junit junit junit test org.apache.lucene.analysis.el.greekanalyzertest fail monospac 'm sure 's go error seem happen tri run clover singl contrib full build suspect issu way batchtest fork ca n't see would happen contrib regular test fork well 3 accord grant quot also bit chang hudson migrat new server need iron quot
indexwriter.deletedocu bug indexwriter.deletedocu fail random test
deadlock case indexwrit except flush document hit non-abort except eg someth goe wrong tokenstream.next document trigger flush due ram doc count documentswrit deadlock thread mark flush pend fail clear except simpl test case show fix fix
setconfig config config call resetinput turn term vector round want abl run one benchmark test thing use term vector use term vector current easi specifi term vector per round creat new index per round autom prefer comparison run two separ test n't affect anyth els would great setconfig config config call basicdocmaker.resetinput would keep term vector option date per round reset mark
indexwrit concurrentmergeschedul deadlock case start merg hit except re use cms default mergeinit hit except eg oom proper clear indexwrit 's intern track run merg caus iw.clos hang incorrect wait non-start merg finish
small speedup documentswrit 's quicksort work lucene-510 found documentswrit 's quicksort optim handl common case sort 2 valu ran alg analyzer=org.apache.lucene.analysis.standard.standardanalyz doc.maker=org.apache.lucene.benchmark.bytask.feeds.linedocmak docs.file=/volumes/external/lucene/wiki.txt doc.stor true doc.term.vector true doc.add.log.step=2000 doc.maker.forev fals directory=fsdirectori autocommit=fals compound=fals ram.flush.mb=64 round resetsystemeras buildindex createindex adddoc adddoc 200000 closeindex newround 5 repsumbyprefround buildindex best 5 857.3 docs/sec optim 881.6 2.8 speedup quad-cor mac pro 4-drive raid 0 array fix trivial commit short
basic refactor documentswrit start point make documentswrit understand ve fix inner class static broke class separ sourc org.apache.lucene.index packag
multifieldquerypars ignor slop paramet multifieldqueryparser.getfieldqueri string string int call super.getfieldqueri string string thus obliter slop paramet present queri probabl chang call super.getfieldqueri string string int except result recurs loop side-effect may deeper problem multifieldquerypars getfieldqueri string string int document deleg getfieldqueri string string yet actual exact opposit also caus problem subclass need overrid getfieldqueri string string provid differ behaviour
possibl hidden except segmentinfo commit sure big deal ran thought might mention segmentinfos.commit remov segment file hit except remov segment file window someth hold anoth except thrown abl delet segment file lose first except might use info includ segment file might delet mark
use isbinari cach variabl instead instanceof field field class hold three type valu see abstractfield.java protect object fieldsdata null current main rtti instanceof use determin type valu store particular instanc field binari valu mix rtti cach variabl boolean isbinari patch make consist use cach variabl isbinari benefit consist usag method determin run-tim type binari case reduc chanc get sync cach variabl slight faster well think aloud would make sens maintain type integer/byt poor man 's enum interfac coupl constant code java public static final interfac type public static final byte boolean 0 public static final byte string 1 public static final byte reader 2 use instead isbinari instanceof
support array/offset/ length setter field binari data current field/field interfac support compact zero base byte array forc end user creat copi content new object pass lucen field often variabl size depend use case bring far neglig perform improv approach extend fieldabl interfac 3 new method getoffset gettlenght getbinaryvalu return refer array
indexwriter.doafterflush call delet flush call flush either ad doc delet fix trivial ll commit short trunk 2.3.2
lazi field n't enforc binari vs string valu binari field load lazi ask field stringvalu incorrect give string back refus give binaryvalu vice-versa
indexwriter.addindex indexread fail creat compound file even except thrown write compound file end addindex call transact roll back success written cfs file delet fix simpl code java success true code statement miss end tri claus test pass ll commit soon trunk 2.3.2
indexwriter.commit updat index version indexwriter.commit updat index *version* *generation* updat *version* lost result ad document seen indexreader.reopen might side effect awar fix 1 line updat also version segmentsinfo.updategener find line involv line though
sourc releas file miss *.pom.templ file sourc releas file contain *.pom.templ file otherwis possibl build maven artifact use ant generate-maven-artifact offici releas file
fix document.getfield other never return null document.getfield similar method return null field match name avoid npe consum api instead return empti array spinoff http //markmail.org/message/g2nzstmce4cnf3zj
boostingtermqueri 's boostingspanscor class protect instead packag access current boostingtermscor inner class boostingtermqueri access outsid search.payload make difficult write extens boostingtermqueri inner class protect alreadi
edgengram* document improv clarifi edg mean ad descript edg mean beggin edg term end edg term
intermitt failur testtimelimitedcollector.testtimeoutmultithread night test occas testtimelimitedcollector.testtimeoutmultithread fail e.g output noformat junit standard error junit except thread thread-97 junit.framework.assertionfailederror hit found junit junit.framework.assert.fail assert.java:47 junit junit.framework.assert.asserttru assert.java:20 junit org.apache.lucene.search.testtimelimitedcollector.dotesttimeout testtimelimitedcollector.java:152 junit org.apache.lucene.search.testtimelimitedcollector.access 100 testtimelimitedcollector.java:38 junit org.apache.lucene.search.testtimelimitedcollector 1.run testtimelimitedcollector.java:231 junit except thread thread-85 junit.framework.assertionfailederror hit found junit junit.framework.assert.fail assert.java:47 junit junit.framework.assert.asserttru assert.java:20 junit org.apache.lucene.search.testtimelimitedcollector.dotesttimeout testtimelimitedcollector.java:152 junit org.apache.lucene.search.testtimelimitedcollector.access 100 testtimelimitedcollector.java:38 junit org.apache.lucene.search.testtimelimitedcollector 1.run testtimelimitedcollector.java:231 junit junit testcas testtimeoutmultithread org.apache.lucene.search.testtimelimitedcollector fail junit thread fail expect 50 48 junit junit.framework.assertionfailederror thread fail expect 50 48 junit org.apache.lucene.search.testtimelimitedcollector.dotestmultithread testtimelimitedcollector.java:255 junit org.apache.lucene.search.testtimelimitedcollector.testtimeoutmultithread testtimelimitedcollector.java:220 junit noformat problem either test timelimitedcollector
termsfilt reus termdoc termsfilt current call termdoc term per term termsfilt sort term 's filter optimis call termdoc skip term per term signific speed filter
small speedup bulk merg bulk merg code store field term vector call isdelet twice delet doc patch also chang documentswrit use indexwriter.messag infostream messag
new benchmark task task would help see ad might want expans basic one use commitindextask reopenreadertask searchwithsorttask sort similar way highlight done anoth method may better would great sort also sinc great field sort reuter date alway appear chang id field doc+id id mayb best solut get ball roll
get rid anoth hard code path
miss null check booleanquery.tostr string queryparser/token situat creat null queri ad claus boolean queri tri log queri npe thrown log booleanqueri booleanquery.tostr string simpl null check overlook
unnecessari assert org.apache.lucene.index.documentswriterthreadstate.trimfield org.apache.lucene.index.documentswriterthreadstate.trimfield follow code fp.lastgen -1 field seen sinc previous flush free resourc unhash final int hashpo fp.fieldinfo.name.hashcod fielddatahashmask documentswriterfielddata last null documentswriterfielddata fp0 fielddatahash hashpo fp0 fp last fp0 fp0 fp0.next assert fp0 null assert end necessari fp0 null first line code guarante fp null time loop hit loop exit fp0 fp equal sinc fp null fp0 null loop exit thus assert guarante never occur detect findbug
bug org.apache.lucene.index.termvectorsreader.clon coupl thing implement return null allow throw clonenotsupportedexcept 's case part code read termvectorsread clone null tri clone termvectorsread super.clon catch clonenotsupportedexcept e clone.tvx indexinput tvx.clone clonenotsupportedexcept caught clone null assign clone.tvx fail null pointer except
equal method check null argument equal method follow class check null argument thus would incorrect fail null pointer except pass null org.apache.lucene.index.segmentinfo org.apache.lucene.search.function.customscorequeri org.apache.lucene.search.function.ordfieldsourc org.apache.lucene.search.function.reverseordfieldsourc org.apache.lucene.search.function.valuesourcequeri null paramet pass equal fals return
disk full close fsindexoutput fail close descriptor close method code isopen super.clos file.clos isopen fals code super.clos bufferedindexoutput.clos tri flush buffer disk full someth els wrong hit except n't actual close descriptor put try/fin alway close take care preserv origin except ll commit short backport 2.3.2
lengthfilt tokenfilt skip token ignor relat positionincr see refer http //www.nabble.com/worddelimiterfilt 2blenghtfilter-results-in-termposit 3d 3d-1-td16306788.html http //www.nabble.com/lucen -java-f24284.html seem lengthfilt least could produc stream first token positionincr 0 make checkindex luke function reconstruct edit generat except someth done avoid situat could error ignor allow term posit -1 relax checkindex check
addindexesnooptim enforc maxmergedocs/maxmerges limit pass index segment maxmergedoc maxmerges addindexesnooptim throw illegalargumentexcept check n't reason segment merg easili produc segment size sinc limit appli segment merg final size segment produc set maxmergedoc x build index tri add index anoth index also maxmergedoc x easili hit except think 's pedant plan remov check size
checkindex allow term posit -1 spinoff discuss http //mail-archives.apache.org/mod_mbox/lucene-java-user/200803.mbox/ 3cpine.lnx.4.62.0803292323350.16762 radix.cryptio.net 3e right checkindex claim index corrupt index token -1 posit happen first token positionincrementgap set 0 far tell lucen n't mind happen plan fix checkindex allow case ll backport 2.3.2 well lucene-1253 one exampl lucen 's core analyz could
changes.html format improv improv changes.html generat changes2html.pl script via changes-to-html ant task simplifi simpl stylesheet remov monospac font specif made default fanci stylesheet realli hard look yellow text light blue background may provid high contrast low eye strain imho 's ugli move monospac style simpl stylesheet new stylesheet name fix width fix syntax error fanci stylesheet display intend ad span style= attrib chang attribut fanci simpl stylesheet chang attribut color dark green proper handl chang attribut changes.txt trail period click anchor expand children chang document locat show children hover anchor caus tooltip display either click expand click collaps tooltip chang appropri collaps expans
port java5 need ve updat lucen use java 5 construct know java 5 migrat plan 2.1 someday past n't know plan patch trunk includ obvious generic usag ton usag set common use generifi priorityqueu generif replac index loop construct remov unnececessari unbox code opinion much readabl featur actual *know* store collect read code without need lookup field definit everytim simplifi mani algorithm note patch also includ interfac queri class done compani 's need build custom queri class add behaviour base lucen queri prevent multipl unnnecessari cast know introduct want team realli make develop easier maintain n't want use replac /queriable/ call standard /query/
norm codec strategi similar static span resolut 8 bit norm codec might fit applic use case requir 100f-250f discret 60 bag instead default.. 10
indexoutofboundsexcept fieldsread problem read index situat ioexcept read hit next time get nullpointerexcept instead ioexcept exampl stack trace java.io.ioexcept specifi network name longer avail java.io.randomaccessfile.readbyt nativ method java.io.randomaccessfile.read randomaccessfile.java:322 org.apache.lucene.store.fsindexinput.readintern fsdirectory.java:536 org.apache.lucene.store.bufferedindexinput.readbyt bufferedindexinput.java:74 org.apache.lucene.index.compoundfileread csindexinput.readintern compoundfilereader.java:220 org.apache.lucene.store.bufferedindexinput.refil bufferedindexinput.java:93 org.apache.lucene.store.bufferedindexinput.readbyt bufferedindexinput.java:34 org.apache.lucene.store.indexinput.readvint indexinput.java:57 org.apache.lucene.index.fieldsreader.doc fieldsreader.java:88 org.apache.lucene.index.segmentreader.docu segmentreader.java:344 org.apache.lucene.index.indexreader.docu indexreader.java:368 org.apache.lucene.search.indexsearcher.doc indexsearcher.java:84 org.apache.lucene.search.hits.doc hits.java:104 error fine problem next call doc generat java.lang.nullpointerexcept org.apache.lucene.index.fieldsreader.getindextyp fieldsreader.java:280 org.apache.lucene.index.fieldsreader.addfield fieldsreader.java:216 org.apache.lucene.index.fieldsreader.doc fieldsreader.java:101 org.apache.lucene.index.segmentreader.docu segmentreader.java:344 org.apache.lucene.index.indexreader.docu indexreader.java:368 org.apache.lucene.search.indexsearcher.doc indexsearcher.java:84 org.apache.lucene.search.hits.doc hits.java:104 presum fieldsread cach partially-initialis data somewher would normal expect exact ioexcept thrown subsequ call method
indexwriter.optim boolean dowait ignor dowait paramet indexwriter.optim boolean dowait ignor dowait paramet alway call optim 1 true seem intend behavior base doc comment
add numdoc maxdoc method indexwrit deprec doccount spinoff http //mail-archives.apache.org/mod_mbox/lucene-java-user/200804.mbox/ 3c405706.11550.qm web65411.mail.ac4.yahoo.com 3e think add maxdoc numdoc method indexwrit deprec doccount favor maxdoc think cach delet count segment segment file
changes.html visibl user close releas changes.html current avail dev page trunk see lucene-1157 discuss exact expos
iw.addindexesnooptim iw.clos may hang spinoff http //mail-archives.apache.org/mod_mbox/lucene-java-user/200804.mbox/ 3c43128.192.168.1.71.1208561409.webmail 192.168.1.71 3e addindexesnooptim method first merg elig segment accord mergepolici copi one one remain extern segment copi possibl rather rare result new merg becom elig size chang index ad creat autocommit=fals howev fail invok mergeschedul run merg result close wait run pend merg complet never return fix simpl invok merg schedul insid copyexternalseg segment copi also ad defens invoc merg schedul close case code path could allow merg ad pend queue schedul
support boost factor morelikethi patch made abl boost term specif factor besid relev return morelikethi help 1 morelikethi queri word field i.e titl boost word field b i.e descript
expos explicit 2-phase commit indexwrit current indexwrit commit two-phas commit intern first prepar new index file sync write new segments_n file sync success remov un-referenc index file howev two phase done privat intern commit method lucen involv transact extern resourc eg databas 's use explicit break prepar phase commit phase spinoff thread http //mail-archives.apache.org/mod_mbox/lucene-java-dev/200804.mbox/ 3c16627610.post talk.nabble.com 3e
build file highlight contrib work run isol core dist run build.xml highlight work compil trigger clean core dist call patch chang fix updat build.xml follow xml-query-pars build.xml
remov system.out left spanhighlight code system.out debug left code queri support spanhighlight issu simpli remov
rangequeri rangefilt use collat check rang inclus see java-us discussion|http //www.nabble.com/lucene-farsi-problem-td16977096.html problem caus unicod code-point comparison instead collat rangequeri rangequeri could take local via setter could use java.text.col and/or collationkey 's handl rang languag alphabet order differ unicod
npe phrasequery.tostr string f section public string tostr string f stringbuff buffer new stringbuff field.equ f buffer.append field buffer.append snip public string tostr string f stringbuff buffer new stringbuff field null field.equ f buffer.append field buffer.append snip issu aris phrase queri creat term ad phrase queri ad boolean queri call tostr boolean queri result npe insdi phrasequeri
sun hotspot compil bug 1.6.0_04/05 affect lucen lucen bug 's as-yet fulli character sun jre bug best tell 'm open gather thing know work around lucen possibl mayb open issu sun reduc compact test case 's hit least 3 user http //mail-archives.apache.org/mod_mbox/lucene-java-user/200803.mbox/ 3c8c4e68610803180438x39737565q9f97b4802ed774a5 mail.gmail.com 3e http //mail-archives.apache.org/mod_mbox/lucene-solr-user/200804.mbox/ 3c4807654e.7050900 virginia.edu 3e http //mail-archives.apache.org/mod_mbox/lucene-java-user/200805.mbox/ 3c733777220805060156t7fdb8fectf0bc984fbfe48a22 mail.gmail.com 3e 's specif least jre 1.6.0_04 1.6.0_05 affect lucen wherea 1.6.0_03 work ok 's unknown whether 1.6.0_06 show bug affect bulk merg store field strike segment produc merg corrupt fdx file store field index file miss one document iter mani time first user hit ad diagnost assert seem call fieldswriter.adddocu either fail run entir fail invok call indexstream.writelong 's hotspot compil method 's sort race condit cut compil code wherebi singl method call fail invok specul unfortun corrupt silent occur later detect merg tri merg bad segment indexread tri open 's typic merg except code except thread thread-10 org.apache.lucene.index.mergepolici mergeexcept org.apache.lucene.index.corruptindexexcept doc count differ segment _3gh fieldsread show 15999 segmentinfo show 16000 org.apache.lucene.index.concurrentmergeschedul mergethread.run concurrentmergescheduler.java:271 caus org.apache.lucene.index.corruptindexexcept doc count differ segment _3gh fieldsread show 15999 segmentinfo show 16000 org.apache.lucene.index.segmentreader.initi segmentreader.java:313 org.apache.lucene.index.segmentreader.get segmentreader.java:262 org.apache.lucene.index.segmentreader.get segmentreader.java:221 org.apache.lucene.index.indexwriter.mergemiddl indexwriter.java:3099 org.apache.lucene.index.indexwriter.merg indexwriter.java:2834 org.apache.lucene.index.concurrentmergeschedul mergethread.run concurrentmergescheduler.java:240 code 's typic except hit open searcher code org.apache.lucene.index.corruptindexexcept doc count differ segment _kk fieldsread show 72670 segmentinfo show 72671 org.apache.lucene.index.segmentreader.initi segmentreader.java:313 org.apache.lucene.index.segmentreader.get segmentreader.java:262 org.apache.lucene.index.segmentreader.get segmentreader.java:230 org.apache.lucene.index.directoryindexread 1.dobodi directoryindexreader.java:73 org.apache.lucene.index.segmentinfo findsegmentsfile.run segmentinfos.java:636 org.apache.lucene.index.directoryindexreader.open directoryindexreader.java:63 org.apache.lucene.index.indexreader.open indexreader.java:209 org.apache.lucene.index.indexreader.open indexreader.java:173 org.apache.lucene.search.indexsearcher. init indexsearcher.java:48 code sometim ad -xbatch forc front compil -xint disabl compil java command line work around issu os 's ve seen failur code suse 10.0 linux phoeb 2.6.13-15-smp 1 smp tue sep 13 14:56:15 utc 2005 x86_64 x86_64 x86_64 gnu/linux suse 8.2 linux phobo 2.4.20-64gb-smp 1 smp mon mar 17 17:56:03 utc 2003 i686 unknown unknown gnu/linux red hat enterpris linux server releas 5.1 tikanga linux lab8.betech.virginia.edu 2.6.18-53.1.14.el5 1 smp tue feb 19 07:18:21 est 2008 i686 i686 i386 gnu/linux code ve alreadi ad assert lucen detect bug strike sinc assert usual enabl plan add real check catch bug strike *before* commit merg index way detect quarantin failur prevent corrupt enter index
factor byteslicewrit documentswriterfielddata documentswrit use byte slice share byte 's hold grow post data mani differ term memori probabl trickiest confus part documentswrit right 's clean factor easi separ test work issu http //mail-archives.apache.org/mod_mbox/lucene-java-user/200805.mbox/ 3c126142c0805061426n1168421ya5594ef854fae5e4 mail.gmail.com 3e eventu turn bug oracl jre 's jit compil factor byteslicewrit creat unit test stress test write read byte slice test random write n stream interleav share byte 's read back verifi result correct creat stress test tri find bug code test ran fine bug found think refactor still much worthwhil expect chang reduc index throughput ran test index first 200k wikipedia doc use alg code analyzer=org.apache.lucene.analysis.standard.standardanalyz doc.maker=org.apache.lucene.benchmark.bytask.feeds.linedocmak docs.file=/volumes/external/lucene/wiki.txt doc.stor true doc.term.vector true doc.add.log.step=2000 directory=fsdirectori autocommit=fals compound=tru ram.flush.mb=256 round resetsystemeras buildindex createindex adddoc adddoc 200000 closeindex newround 4 repsumbyprefround buildindex code ok trunk produc result code oper round runcnt recsperrun rec/ elapsedsec avgusedmem avgtotalmem buildindex 0 1 200000 791.7 252.63 338,552,096 1,061,814,272 buildindex 1 1 200000 793.1 252.18 605,262,080 1,061,814,272 buildindex 2 1 200000 794.8 251.63 601,966,528 1,061,814,272 buildindex 3 1 200000 782.5 255.58 608,699,712 1,061,814,272 code patch code oper round runcnt recsperrun rec/ elapsedsec avgusedmem avgtotalmem buildindex 0 1 200000 745.0 268.47 338,318,784 1,061,814,272 buildindex 1 1 200000 792.7 252.30 605,331,776 1,061,814,272 buildindex 2 1 200000 786.7 254.24 602,915,712 1,061,814,272 buildindex 3 1 200000 795.3 251.48 602,378,624 1,061,814,272 code look like perform cost chang neglig nois
weightedspantermextractor incorrect treat term occur differ queri type given booleanqueri multipl claus term occur span phrase queri termqueri result term extract unpredict depend order claus concequ result highlight incorrect exampl text t1 t2 t3 t4 t2 exampl queri t2 t3 t1 t2 current highlight t1 t2 t3 t4 t2 correct highlight t1 t2 t3 t4 t2 problem come fact keep map termtext weightedspanterm term occur phrase span queri result weightedspanterm positionsensitive=tru wherea term ad termqueri positionsensitive=fals end result particular term depend order claus process fix use subclass map put alway set result lax set i.e alreadi term positionsensitive=tru tri put term positionsensitive=fals set result positionsensitive=fals match case
largedochighlight anoth span highlight optim larg document exist highlight api rich well design approach taken effici larg document believ current highlight rebuild document run score everi everi token tokenstream break current api altern approach taken rebuild document run queri term use offset benefit clear larg doc larg tokenstream queri like small comparison expect approach quit bit faster larg document still support phrase span queri first rough patch follow short
allow usag hyphenationcompoundwordtokenfilt without dictionari allow use hyphenationcompoundwordtokenfilt without dictionari produc lot nonword token might use sometim
add getvers method indexcommit return equival indexreader.getvers indexcommit code public abstract long getvers code
jar manifest contain user.nam person build sure big deal n't particular like user id build machin manifest jar construct 's stretch security-wis know n't see serv use purpos signatures/logs/svn tag know built particular item w/o need know local user account name fix code index common-build.xml common-build.xml revis 661027 +++ common-build.xml work copi -281,7 +281,7 attribut name= implementation-titl value= org.apache.lucen impl version string attribut name= implementation-vers value= version svnversion user.nam dstamp tstamp value= version svnversion dstamp tstamp attribut name= implementation-vendor value= apach softwar foundat attribut name= x-compile-source-jdk code
make retrieveterm int docnum public morelikethi would use code privat priorityqueu retrieveterm int docnum throw ioexcept code public sinc similar use code public priorityqueu retrieveterm reader r throw ioexcept code also seem use add code public string retrieveinterestingterm int docnum throw ioexcept code mirror one work reader
allow use compact docidset cachingwrapperfilt extend cachingwrapperfilt protect method determin docidset cach
allow string distanc measur spellcheck updat spell code allow string distanc measur use creat stringdist interfac modifi exist levenshtein distanc measur implement interfac renam class verifi chang levenshtein distanc n't impact runtim perform implement jaro/winkl distanc metric modifi spellcheck take distacn measur constructor set method use interfac call
morelikethi ignor custom similar morelikethi allow use defaultsimilar patch short
spell checker suggestsimilar throw npe indexread null field null spellchecker.suggestsimilar string word int numsug indexread ir string field boolean morepopular throw nullpointerexcept indexread null field javadoc say fine field null n't comment fact indexread also need null case
refactor documentswrit ve work refactor documentswrit make modular ad new index function like column-strid store field lucene-1231 matter ad plugin index chain initi step toward flexibl index still alot 's much still work progress intemitt thread safeti issu need add test case test/iter perform mani nocommit etc snapshot current state approach introduc consum abstract class defin interfac differ level index eg docconsum consum whole document docfieldconsum consum separ field one time inverteddocconsum consum token produc run field analyz termshashconsum write byte in-memori post list store byte slice index term etc documentswriter*.java much simpler interact docconsum idea consum docconsum whole index chain real work normswrit hold norm memori flush _x.nrm freqproxtermswrit hold post data memori flush _x.frq/prx storedfieldswrit flush immedi _x.fdx/fdt termvectorstermswrit flush immedi _x.tvx/tvf/tvd documentswrit still manag thing like flush segment close doc store buffer appli delet free memori abort necesari etc first step everyth package-priv index chain hardwir instanti documentswrit chain current match lucen trunk time open chang index file format part larg refactor except two small actual chang improv concurr mix large/smal doc previous thread state would tie doc finish index out-of-ord 's instead use separ class hold pend state flush doc store immedi free thread state index doc buffer norm memori remain spars flush _x.nrm file previous would fill hole norm memori go could easili use way much memori realli n't solut problem spars norm lucene-830 delay issu caus memori blowup index memori use still blowup search expect perform index throughput wors chang ll profil iter minim think accept loss also plan measur benefit manual re-cycl rawpostinglist instanc pool vs let gc recycl
boostingtermqueri 's explan mark match even payload part negat zero' sinc btq multipli payload score might return negat score explan mark match otherwis ad contain explan see also lucene-1302
phrase queri term repeat 3 time requir slop expect consid document text phrase queri exact match succeed queri ~1 document queri increas slop valu one fail ~2 succeed exact match succeed would n't expect queri slop fail fault seem requir term repeat least three time queri three occurr need adjac attach file contain set junit test demonstr mean
add abil open prior commit indexread use custom deletionpolici keep multipl commit around instead default preserv recent commit 's use abl list commit open reader one commit ve ad api list commit public static collect indexreader.listcommit directori two new open method indexread open specif commit public static indexread open indexcommit public static indexread open indexcommit indexdeletionpolici spinoff http //mail-archives.apache.org/mod_mbox/lucene-java-dev/200806.mbox/ 3c85d3c3b60806161735o207a3238sa2e6c415171a8019 mail.gmail.com 3e
instantiatedindexread implement getfieldnam proper caus error org.apache.lucene.index.segmentmerger.mergefield
indexreader.clon base discuss http //www.nabble.com/indexreader.reopen-issue-td18070256.html problem reopen return reader chang doc delet new reader also reflect previous reader alway desir behavior
avoid synchron bottleneck matchalldocsqueri matchallscor isdelet method indexread mention number time potenti synchron bottleneck howev reason bottleneck occur actual higher level n't focus least thread read everi case saw stack trace provid show lock/block higher stack see matchallscorer.next method solr paricular scorer use queri saw incred poor perform order magnitud load test queri due bottleneck problem everi singl document run isdelet method synchron optim index exacerb issu singl segmentread synchron caus major thread pileup wait lock simpli matchallscor see delet reader much avoid especi read-on environ product slave high load search modifi line 67 matchalldocsqueri reader.isdelet id reader.hasdelet || reader.isdelet id micro load test queri major perform improv also got queri result n't believ improv situat index delet pleas consid make adjust futur bug fix releas
instantiatedindexreader.norm call multiread bug small bug instantiatedindexreader.norm string field byte byte int offset offset appli proper system.arraycopi
shinglematrixfilt three dimension permut shingl filter back column focus matrix creat permut shingl token three dimens i.e handl multi token synonym could instanc case use replac 0-slop phrase queri someth speedier code java token hello greet salut world earth tellus code pass follow test 2-3 gram code java assertnext ts hello_world assertnext ts greetings_and assertnext ts greetings_and_salut assertnext ts and_salut assertnext ts and_salutations_world assertnext ts salutations_world assertnext ts hello_earth assertnext ts and_salutations_earth assertnext ts salutations_earth assertnext ts hello_tellus assertnext ts and_salutations_tellus assertnext ts salutations_tellus code contain less complex test demonstr offset posincr payload boost calcul construct matrix token stream matrix attempt hog littl memori possibl seek maximumshingles column forward stream clear unus resourc column uniqu token set still optim quit bit though
highlight fragment extend maxdoccharstoanalyz current highlight code check whether total length text highlight strict smaller maxdoccharstoanalyz ad text remain last token fragment mean maxdoccharstoanalys set exact length text last token text term highlight follow non-token text non-token text highlight exampl consid phrase text searchterm token re stopword set maxdoccharstoanalyz 36 length sentenc search searchterm give fragment end searchterm expect behaviour end fragment sinc maxdoccharstoanalys explicit state whole phrase consid
remov synchron compoundfileread current seem unnecessari synchron compoundfileread solv clone base indexinput synchron low level io class creat lock content high multi thread lucen instal much mani case cpu util never reach maximum without use someth like parallelmultisearch
multiread make privat copi subread array spinoff http //mail-archives.apache.org/mod_mbox/lucene-java-user/200806.mbox/ 3c88f3f6a4-fbfb-43df-890d-db5f0d9a2461 gmail.com 3e multiread hold refer array pass 's possibl hit scari except look like index corrupt array later alter eg reopen reader fix trivial make privat copi
tokenfilt implement reset tokenfilt maintain privat member tokenstream implement reset call member tokenstream 's reset method otherwis tokenstream never get reset patch appli
add indexcommit.isoptim method spinoff http //mail-archives.apache.org/mod_mbox/lucene-java-user/200807.mbox/ 3c69de18140807010347s6269fea5r12c3212e0ec0a12a mail.gmail.com 3e
inflater.end method alway call fieldsread ve found insidi memori leak applic alway call deflater.end inflater.end document http //bugs.sun.com/view_bug.do bug_id=4797189 non-heap memori nativ zlib code use freed time manner fieldswrit appear safe except thrown deflat 's creation end use bytearrayoutputstream fieldsread howev safe event dataformatexcept call end occur
termspan skipto n't alway move forward termspan anonym span class return spanstermqueri depend version skipto method improp implement target doc less equal current doc public boolean skipto int target throw ioexcept alreadi correct posit doc target return true violat correct behavior describ span interfac document skipto alway move forward word correct implement would doc target return next bug caus particular problem one want use payload featur one load payload perform skipto document tri load next payload span n't chang posit attempt load payload error
remov synchron segmentreader.isdelet remov segmentreader.isdelet synchron use volatil deleteddoc variabl java 1.5 platform java 1.4 platform synchron limit obtain deleteddoc refer
fsdirectori n't detect double-clos usag close fsdirectory.clos implement logic ensur singl instanc fsdirectori per canon directori exist mean code synchron fsdirectori instanc also synchron canon directori think indexmodifi deprec actual make use 'm certain close method n't detect doubl close n't catch usag close one easili get two instanc fsdirectori canon directori
token implement need improv discuss thread sure place best refer two http //mail-archives.apache.org/mod_mbox/lucene-java-dev/200805.mbox/ 3c21f67cc2-ebb4-48a0-894e-fba4aecc0d50 gmail.com 3e see http //www.gossamer-threads.com/lists/lucene/java-dev/62851 issu 1 javadoc insuffici lead one read code figur use class 2 deprec incomplet constructor take string argument method take and/or return string *all* deprec 3 alloc polici aggress larg token result buffer over-alloc less aggress algorithm would better thread python exampl good comput simpl 4 part code current use token 's deprec method upgrad rather wait 3.0 stand filter chain altern char string sub-optim current use core queri class rest contrib most analyz 5 intern optim done regard char alloc 6 tokenstream next next token next deprec reus maxim descend class rewritten over-rid next token 7 token often store string term would good add constructor took token would simplifi use two togeth
term improv term design reus suppli filter minim intern one common use pattern creat term txt field empti string simplifi pattern document 's use suggest ad constructor public term string fld obvious implement use throughout core contrib replac
correct handl concurr call addindex optim commit spinoff http //mail-archives.apache.org/mod_mbox/lucene-java-dev/200807.mbox/ 3cc7b302c50807111018j58b6d08djd56b5889f6b3780d mail.gmail.com 3e
add indexreader.acquir releas method use indexread 's ref count http //mail-archives.apache.org/mod_mbox/lucene-java-dev/200807.mbox/ 3cpine.osx.4.64.0807170752080.1708 c5850-a3-2-62-147-22-102.dial.proxad.net 3e server bunch thread handl search request anoth process updat index use search server ask searcher server reopen index reader updat complet reopen index reader also close old one reopen yield new instanc caus problem thread current middl search request 'd like propos addit two method acquir releas attach bug report increment/decr ref count indexread instanc current maintain relat purpos ref count prevent index reader actual close reach zero server 's search thread thus acquir releas index reader sure index reader re current use good re done current request ie releas
make posibl includ tf inform index term frequenc typic need field cpu read one vint less one x 1 io spare make pure boolen field possibl lucen topic alreadi discuss accept part flexibl index issu tri push thing bit faster forward concret custom demand benefit expect field typic candid filter enumer user right id short text phone number zip code name status pass standard test compat commit earli review tri new featur miss assert one two unit test complex simpler expect use via omittf use omitnorm know find
boostingnearqueri class prototyp patch implement term boost spannearqueri refer http //www.gossamer-threads.com/lists/lucene/java-user/62779 patch work probabl need work n't like use instanceof n't want touch span termspan also payload code most copi 's boostingtermqueri could common-sourc somewher feel free throw dart
replac asciifoldingfilt thorough job remov diacrit mark non-spac modifi isolatin1accentfilt take unicod charact diacrit mark replac version charact diacrit mark remov exampl ?| becom e. howev anoth equal valid way repres accent charact unicod unacc charact follow non-spac modifi charact like ?| isolatin1accentfilt n't handl accent decompos unicod charact addit instanc word contain look like accent charact actual consid separ unacc charact ? make search easier want fold onto latin1 lookalik version l unicodenormalizationfilt filter accent diacrit mark whether occur compos charact decompos charact also handl case describ charact look like diacrit n't fold onto letter look like ? l
make lucen jar osgi bundl order use lucen osgi environ addit header need manifest jar lucen depend pretti straight forward ill easi maintain think
replac vector arraylist queri replac vector arraylist queri make differ heavili concurr scenario queri object examin compar e.g use cach key
indexwriter.rollback hang previous call hit except iw.rollback logic make sure one thread actual get rollback whenev multipl thread call time set boolean close true thread got first thread wait variabl becom fals return abort restor close fals try/fin rollback mean hit except rollback subsequ call rollback hang forev close logic alreadi try/fin restor close fals except fix straightforward
testtimelimitedcollector shuold fail test machin happen slow test fail hudson month like quot junit testcas testtimeoutnotgreedi org.apache.lucene.search.testtimelimitedcollector fail junit lastdoc=21 allowed=799 elapsed=900 886 2*resolut time_allow slow_down 2*20 799 47 junit junit.framework.assertionfailederror lastdoc=21 allowed=799 elapsed=900 886 2*resolut time_allow slow_down 2*20 799 47 junit org.apache.lucene.search.testtimelimitedcollector.dotesttimeout testtimelimitedcollector.java:189 junit org.apache.lucene.search.testtimelimitedcollector.testtimeoutnotgreedi testtimelimitedcollector.java:150 junit junit junit test org.apache.lucene.search.testtimelimitedcollector fail quot modifi test print warn case still verifi earli termin
mark fieldabl allow chang 2.x futur releas see http //lucene.markmail.org/message/4k2gqs3n7coh4lmd q=fieldabl 1 mark fieldabl subject chang heavili advertis java-dev java-us mayb general next minor releas lucen 2.4 fieldabl chang also mark top changes.txt clear world see sinc 2.4 probabl least month away think give anyon puls enough time react
add ligatur ff fi fl ft st isolatin1accentfilt isolatin1accentfilt remov common diacrit ligatur patch add support addit common ligatur ff fi fl ft st
javacc ant task contrib/misc preced queri parser add javacc task contrib/misc preced queri parser
provid programmat access checkindex would nice programmat access checkindex tool use applic like solr see solr-566
use weightedterm option highlight caus fragment supress index delet index document mani delet report lower total doc docfreq term total doc account delet docfreq caus idf negat fragment score 0
allow easi extens topdoccollector topdoccollector 's member constructor declar either privat packag visibl make hard extend want extend reus *hq* *totatlhits* member need defin also forc overrid gettotalhit topdoc chang member constructor one accept pq protect allow user extend order get differ view top doc like topfieldcollector still enjoy gettotalhit topdoc method implement
spanscor respect constantscorerangequeri set constantscorerangequeri actual ca n't disabl default option turn
deadlock queri object equal method f.ex phrasequeri concurr environ queri object lucen 2.3.2 previous version intern variabl use vector variabl use call equal method concurr environ deadlock might occur attach code exampl show happen lucen 2.3.2 patch lucene-1346 fix issu though n't seem intent patch accord descript
frenchanalyz 's tokenstream method honour contract analyz analyz code creat tokenstream token text provid reader default implement forward tokenstream reader compat older version overrid allow analyz choos strategi base document and/or field must abl handl null field name backward compat public abstract tokenstream tokenstream string fieldnam reader reader code frenchanalyz code public final tokenstream tokenstream string fieldnam reader reader fieldnam null throw new illegalargumentexcept fieldnam must null reader null throw new illegalargumentexcept reader must null code
deprec indexwriter.addindex directori sinc addindexesnooptim accomplish thing effici alway call optim realli want think deprec older addindex directori
renam field.index.un_tokenized/tokenized/no_norm confus current field option think renam deprec old name 2.4/2.9 remov 3.0 code token analyz un_token not_analyz no_norm not_analyzed_no_norm code also add analyzed_no_norm spinoff http //mail-archives.apache.org/mod_mbox/lucene-java-user/200808.mbox/ 3c48a3076a.2679420a.1c53.ffffa5c4 40mx.google.com 3e
add isdelet method indexcommit wish add indexcommit.isdelet method use-cas solr support configur indexdeletionpolici solr-617 new replic solr-561 work need access list indexcommit instanc n't delet yet wrap user specifi indexdeletionpolici sinc indexcommit isdelet method may store refer indexcommit delet call delet polici wrap indexcommit object isdelet method workaround exist big pain manag lucen side easili ll appreci would save write deleg code
elimin unnecessari use hashtabl vector lucen use vector hashtabl enumer n't need chang arraylist hashmap may provid better perform place vector show api imho list use paramet return valu distinct usag class intern arraylist hashmap would well simpli replac intern synchron requir either leav use collect synchron wrapper paramet method list map would well contrib replac core deprec current add new method signatur generat javacc *.jj file noth done base class sure appli segmentinfo extend vector use safe manner place perhap implement list would better return valu packag protect method synchron use chang return type return valu final method chang list map use vector follow iter pattern frequent use int 0 v.size i++ object o v.elementat indic synchron unimport list could chang iter
add shinglefilt option output unigram shingl generat current shinglefilter.outputunigrams==fals under token stream one token long shinglefilter.next wo n't return token patch provid new option outputunigramifnongram option set under stream one token long shinglefilt return token regardless set outputunigram use case speed phrase queri techniqu follow first index-tim analysi use shinglefilt use outputunigrams==tru therebi expand thing follow pleas divid sentenc shingl pleas pleas divid divid divid sentenc sentenc sentenc shingl shingl second query-tim analysi use shinglefilt use outputunigrams==fals outputunigramifnongrams==tru user enter phrase queri get token follow manner pleas divid sentenc shingl pleas divid divid sentenc sentenc shingl phrase queri bigram like gain consider speedup without outputunigramifnongram option singl word queri would token like pleas token thank outputunigramifnongram singl word token like pleas pleas patch also add littl pre-outputunigramifnongram option test 'm sure patch state use anyon els thought throw tri find
add searcher.search queri int ve deprec hit lucene-1290 think add trivial conveni method searcher sugar searcher.search queri null int ie null filter return topdoc way simpl api user retriev top n result queri
merg compress string field may hit npe bug introduc lucene-1219 present 2.4 bug happen merg compress string field bulk-merg code appli fieldinfo segment merg congruent test show bug code public void testmergecompressedfield throw ioexcept file indexdir new file system.getproperti tempdir mergecompressedfield directori dir fsdirectory.getdirectori indexdir tri int i=0 5 i++ must make new writer doc time w/ differ field bulk merg store field run indexwrit w new indexwrit dir new whitespaceanalyz i==0 indexwriter.maxfieldlength.unlimit w.setmergefactor 5 w.setmergeschedul new serialmergeschedul document doc new document doc.add new field test1 data compress field.store.compress field.index.no doc.add new field test2 new byte 20 field.store.compress doc.add new field field random field field.store.no field.index.token w.adddocu doc w.close byte cmp new byte 20 indexread r indexreader.open dir int i=0 5 i++ document doc r.document assertequ data compress doc.getfield test1 .stringvalu byte b doc.getfield test2 .binaryvalu asserttru arrays.equ b cmp final dir.clos _testutil.rmdir indexdir code 's fieldsread load field merg creat fieldformerg instanc subsequ return right valu getbinari valu length offset
add indexcommit.gettimestamp method conveni method getdirectori .filemodifi getsegmentsfilenam
sometim bg merg hit except optim fail forward except see intermitt failur window instanc run insid vmware testindexwriter.testaddindexondiskful happen loop check merg except occur optim fail catch case bg optim merg complet hit except loop begin ie bg thread finish fg thread advanc loop case code fail check except fix straightforward chang loop alway check least whether except
add htmlstripread worddelimiterfilt solr solr two class htmlstripread worddelimiterfilt use wide varieti use case would good place core lucen
remov remain author refer find -name \*.java xarg grep author cut -d -f1 xarg perl -pi -e s/ author
spanscor fail sloppyfreq return 0 think fix 2.4 back 10
patch shinglefilter.enableposit positionfilt make possibl *all* word shingl place posit _all_ shingl unigram includ treat synonym today shingl generat synonym first term shingl exampl queri abcd efgh ijkl result abcd abcd efgh abcd efgh ijkl efgh efgh ijkl ijkl abcd efgh abcd efgh ijkl synonym abcd efgh ijkl synonym efgh exist way today alter token particular shingl synonym patch take first step make possibl make shingl unigram includ synonym see http //comments.gmane.org/gmane.comp.jakarta.lucene.user/34746 mail list thread
allow store user data indexwriter.commit call spinoff http //www.mail-archive.com/java-us lucene.apache.org/msg22303.html idea allow option pass opaqu string commituserdata indexwriter.commit method string would store segments_n file would retriev indexread applic could use assign mean commit would nice get done 2.4 n't think hold releas
work around threadloc 's leak java 's threadloc danger use abl take surpris long time releas refer valu store even threadloc instanc gc 'd hard refer valu store easili kept quit time later technic memori leak eventu under map store valu clean stale refer hard refer clear gc proceed end behavior differ memori leak right situat easili tie far memori you'd expect hit unexpect oom error despit alloc extrem larg heap jvm lucen user hit mani time 's recent thread http //mail-archives.apache.org/mod_mbox/lucene-java-dev/200809.mbox/ 3c6e3ae6310809091157j7a9fe46bxcc31f6e63305fcdc 40mail.gmail.com 3e 's anoth http //mail-archives.apache.org/mod_mbox/lucene-java-dev/200807.mbox/ 3cf5fc94b2-e5c7-40c0-8b73-e12245b91ce 40mikemccandless.com 3e 's lucene-436 lucene-529 least googl search threadloc leak yield mani compel hit sun perform reason think 's terribl trap work around lucen
addindexesnooptim intermitt throw incorrect segment exist extern directori except spinoff http //mail-archives.apache.org/mod_mbox/lucene-java-user/200809.mbox/ 3cba72f77f0809111418l29cf215dnd45bf679832d7d42 40mail.gmail.com 3e 's respons thread bug happen call addindexesnooptim one simpl workaround would use serialmergeschedul think alreadi fix trunk soonish 2.4 side effect https //issues.apache.org/jira/browse/lucene-1335 2.3 merg involv extern segment segment fold addindexesnooptim suppos run bg thread prevent addindexesnooptim return extern segment carri merg copi index except eg disk full addindexesnooptim abl rollback index start point primari merg method cms inde bg extern merg bug bg merg finish select new merg kick select happi pick extern segment
add locallucen local lucen geo-search donat lucen project per https //issues.apache.org/jira/browse/incubator-77 issu handl lucen portion integr see http //lucene.markmail.org/message/orzro22sqdj3wow q=locallucen
add init method closeablethreadloc java threadloc init method allow subclass easili instanti initi valu
simplespanfragment creat short fragment line 74 simplespanfragment return true current token start hit span phrase thus start new fragment two problem occur previous fragment may short contain hit combin new fragment later disappear token close natur fragment boundari new fragment end short possibl even short span phrase result creat new fragment without increment currentnumfrag fix remov comment line 74 result fragment averag fragment size unless span phrase hit toward end fragment fragment made larger follow fragment shorter accommod hit
add asciifoldingfilt deprec isolatin1accentfilt isolatin1accentfilt remov accent accent charact iso latin 1 charact set bug would nicer though comprehens version code includ iso-latin-1 iso-8859-1 entir latin 1 latin extend unicod block see http //en.wikipedia.org/wiki/latin-1_supplement_unicode_block see http //en.wikipedia.org/wiki/latin_extended-a_unicode_block way languag use roman charact cover new class isolatinaccentfilt attach intend superced isolatin1accentfilt get deprec
small javadocs/extra import fix two thing uwe schindler caught plus fix javadoc warn core plan commit trunk 2.4
lucen 's night hudson build n't svn version manifest.mf solr issu appar made configur chang hudson configur get work https //issues.apache.org/jira/browse/solr-684 also open infra issu https //issues.apache.org/jira/browse/infra-1721 say svnversion exe locat path /opt/subversion-current/bin inra issu /etc/init.d/tomcat also fix theori svnversion would path next time hudson restart still case n't work chang futur seem good idea make chang solr made lucen 's hudson configur hoss detail need solr mayb also lucen thank
includ changes.txt contrib alreadi includ root changes.txt fail includ one contrib
javadoc mistak segmentmerg
improv phrasequery.tostr phrasequery.tostr over simplist n't correct show phrase gap overlap term may mislead present phrase queri built use complex analyz filter
bg merg hit except optim sometim throw ioexcept miss root caus indexwriter.optim call concurrentmergeschedul run request merg background thread optim wait merg complet merg hit except record root caus except optim retriev root caus throw except root caus bug sometim fact except occur merg record root caus miss caus optim still throw except correct indic optim finish success 's help 's miss root caus must go find root caus jre 's stderr log hit user list recent http //www.nabble.com/background-merge-hit-exception-td19540409.html a19540409 found isssu final got unit test intermitt show 's simpl thread safeti issu final claus indexwriter.merg record fact merg hit except actual set root caus concurrentmergeschedul 's except handler set root caus optim thread schedul two throw except miss root caus fix straightforward plan commit 2.4 2.9
add reversestringfilt add reversestringfilt reversestringanalyz use backword much exampl *ri *ing *ber
add apach rat releas audit tool target build.xml apach rat use tool check common mistak sourc code eg miss copyright header http //incubator.apache.org/rat/ 'm copi patch grant work solr solr-762 plan commit 2.4 2.9
deprec autocommit 2.4 lead compil problem autocommit fals current chang code compat 2.4 switch deprec warn got warn autocommit paramet indexwrit constructor code *should* use autocommit=fals want use new semant default indexwrit still autocommit=tru problem disabl autocommit whithout deprec warn mayb old constructor deprec use autocommit=tru new constructor indexwriter.maxfieldlength mfl appear new 2.4 deprec indexwrit directori d boolean autocommit analyz boolean creat indexdeletionpolici deletionpolici indexwriter.maxfieldlength mfl deprec remov 3.0 autocommit hardwir fals use indexwrit directori analyz boolean indexdeletionpolici maxfieldlength instead call commit need hell meant new constructor deprec hint wrong use constructor warn get autocommit=tru someth complet wrong clear constructor set autocommit=tru set per default fals perhap new one deprec text wrong autocommit default fals
checkindex api chang without backward compait api checkindex chang check function return checkindexstatus boolean javadoc note boolean return valu sure work would good check method return boolean avail deprec i.e deprec public static checkindexstatus check directori dir boolean dofix throw ioexcept final checkindexstatus stat=this.check dir dofix return stat.clean sure done method name prevent drop-in-replac lucen work
npe nearspansunordered.ispayloadavail use rc1 lucen 2.4 result null pointer except construct spannearqueri implement ispayloadavail result except code public boolean ispayloadavail spanscel pointer min pointer.ispayloadavail return true pointer pointer.next pointer.next null return fals code fix ispayloadavail code public boolean ispayloadavail spanscel pointer min pointer null pointer.ispayloadavail return true pointer pointer.next return fals code except produc code junit java.lang.nullpointerexcept junit org.apache.lucene.search.spans.nearspansunord spanscell.access 300 nearspansunordered.java:65 junit org.apache.lucene.search.spans.nearspansunordered.ispayloadavail nearspansunordered.java:235 junit org.apache.lucene.search.spans.nearspansordered.shrinktoaftershortestmatch nearspansordered.java:246 junit org.apache.lucene.search.spans.nearspansordered.advanceafterord nearspansordered.java:154 junit org.apache.lucene.search.spans.nearspansordered.next nearspansordered.java:122 junit org.apache.lucene.search.spans.spanscorer.next spanscorer.java:54 junit org.apache.lucene.search.scorer.scor scorer.java:57 junit org.apache.lucene.search.indexsearcher.search indexsearcher.java:137 junit org.apache.lucene.search.indexsearcher.search indexsearcher.java:113 junit org.apache.lucene.search.hits.getmoredoc hits.java:113 junit org.apache.lucene.search.hits. init hits.java:80 junit org.apache.lucene.search.searcher.search searcher.java:50 junit org.apache.lucene.search.searcher.search searcher.java:40 junit com.attivio.lucene.spanquerytest.search spanquerytest.java:79 junit com.attivio.lucene.spanquerytest.asserthitcount spanquerytest.java:75 junit com.attivio.lucene.spanquerytest.test spanquerytest.java:67 code attach unit test caus except pass updat ispayloadavail
support new resourc model ant 1.7 lucen ant task ant task lucen use modern resourc model fileset child element patch requir chang support old ant 1.6 new ant 1.7 resourc model index lucen ant task fileset /index support new ant 1.7 resourc model index lucen ant task filelist /index index lucen ant task userdefinied-filesourc /index
new arab analyz apach licens ve notic arab analyz lucen like tim buckwalt 's morpholog dictionari gpl howev necessari full morpholog analysi engin qualiti arab search implement implement light-8 algorithm present follow paper http //ciir.cs.umass.edu/pubfiles/ir-249.pdf see paper improv via method search surfac form lucen current signific almost 100 improv averag precis person n't think choic best easili improv still possibl major motiv implement exact way present paper algorithm trec-test precision/recal improv lucen alreadi document stopword list use list present http //members.unine.ch/jacques.savoy/clef/index.html simpli creator list document data bsd-licens implement analyz consist mention stopword list plus two filter arabicnormalizationfilt perform orthograph normal hamza seat alif alif maksura teh marbuta remov harakat tatweel etc arabicstemfilt perform arab light stem filter oper direct termbuff maximum perform object creation analyz extern depend ve index half billion word arab text test issu implement will fix use lucen daili basi would like give someth back thank
refactor searchabl rmi remot depend per http //lucene.markmail.org/message/fu34tuomnqejchfj q=remotesearch refactor searchabl slight n't extend java.rmi.remot marker interfac believ could achiev mark remotesearch refactor rmi implement core contrib deprecate/denot 2.9 move 3.0
enabl indexwrit open arbitrari commit point 2-phase commit involv multipl resourc resourc first preparecommit success commit except timeout/pow loss hit resourc preparecommit commit resourc must rollback indexwrit alway open recent commit get lucen rollback commit call easi unless make lucen last resourc commit simpl workaround simpli remov segments_n file newer commit that sort hassl fix need add ctor indexwrit take indexcommit recent ad indexread lucene-1311 well ctor definit expert method make sens custom deletionpolici preserv recent commit
filenotfoundexcept thrown directory.copi java.io.filenotfoundexcept segments_bu org.apache.lucene.store.ramdirectory.openinput ramdirectory.java:234 org.apache.lucene.store.directory.copi directory.java:190
increas maxmemori unit test unit test requir fair amount ram sometim jre give larg max heap size default eg mac pro 6 gb physic ram see jre 1.6.0 default max 80 gb alway hit except test junit testcas testhugefil org.apache.lucene.store.testhugeramfil caus error junit java heap space junit java.lang.outofmemoryerror java heap space junit java.util.arrays.copyof arrays.java:2760 junit java.util.arrays.copyof arrays.java:2734 junit java.util.arraylist.ensurecapac arraylist.java:167 junit java.util.arraylist.add arraylist.java:351 junit org.apache.lucene.store.ramfile.addbuff ramfile.java:69 junit org.apache.lucene.store.ramoutputstream.switchcurrentbuff ramoutputstream.java:129 junit org.apache.lucene.store.ramoutputstream.writebyt ramoutputstream.java:115 junit org.apache.lucene.store.testhugeramfile.testhugefil testhugeramfile.java:68 fix simpl add maxmemory=512m common-build.xml ll commit short
multiphrasequeri incorrect hashcod implement lead solr cach miss found hunt caus solr cach miss multiphrasequeri class hashcod implement non-determinist use termarrays.hashcod comput content arraylist actual array return refer id hashcod instead return hashcod base content array would suggest implement involv arrays.hashcod method tri submit patch soon today
ant contrib test fail space path lucen project coupl contrib ant test get path test file url object path url encod normal fine space path /svn stuff/lucene/contrib/ 20 space least ubuntu system test fail filenotfound patch simpli replac 20 sure want/ne take
expert api specifi index chain would nice add expert api specifi index chain make use mike 's nice lucene-1301 featur patch simpli add package-protect expert api indexwrit documentswrit add inner abstract class documentswrit call indexingchain default implement current use one might final solut nice way play differ modul index chain could take look patch mike
similarity.lengthnorm positionincrement=0 calcul lengthnorm factor case take account number token positionincrement=0 made option support two differ scenario analyz insert artifici construct token tokenstream e.g ascii-fi version accent term stem term 's unlik user submit queri contain version token case lengthnorm calcul ignor token positionincrement=0 analyz insert synonym 's like user may submit queri contain multipl synonym term case lengthnorm calcul i.e take account term matter positionincr default backward-compat i.e count token see also discuss http //markmail.org/message/vfvmzrzhr6pya22h
abil group search result field would awesom group search result specifi field function provid apach solr think done core lucen could use inform like total hit collaps data like total count thank artyom
new tokenstream api earli version new tokenstream api start discuss http //www.gossamer-threads.com/lists/lucene/java-dev/66227 implement bit differ initi propos thread introduc new class call attributedtoken contain termbuff logic token addit lazily-initi map class extend attribut attribut attribut also new class new packag plus sever implement like positionincrementattribut payloadattribut etc similar initi propos prototypetoken method consum e. g. documentswrit need call token creat token end chain push filter end consum token also filter add attribut token keep refer actual type attribut need read modifi way boolean nexttoken call cast necessari ad class call testnewtokenstreamapi realli test case yet static demo method demonstr use new api reason merg token tokenstream one class might cach tee/sink filter chain might want store clone copi token cach ad new class newcachingtokenstream show class could work also implement deep clone method attributedtoken copyfrom attributedtoken method need cach method iter list attribut attribut subclass also copyfrom attribut method unfortun down- cast actual type first thought might ineffici 's bad well add attribut attributedtoken old token class like offset payload posincr perform cach somewhat slower ~40 howev add less attribut might need perform even slight faster old api also new api flexibl enough someon could implement custom cach filter know attribut token cach fast old api patch near readi lot 's thing miss unit test chang documentswrit use new api backwards-compat fashion patch current java 1.5 need chang commit 2.9 tokenstream -filter chang use new api javadoc incorrect miss hashcod equal method miss attribut attributedtoken want submit alreadi brave peopl give earli feedback spend time work
instantiatedtermenum skipto term throw arrayindexoutofboundsexcept empti index code java.lang.arrayindexoutofboundsexcept 0 org.apache.lucene.store.instantiated.instantiatedtermenum.skipto instantiatedtermenum.java:105 org.apache.lucene.store.instantiated.testemptyindex.termenumtest testemptyindex.java:73 org.apache.lucene.store.instantiated.testemptyindex.testtermenum testemptyindex.java:54 code
chang multi-term queri extend multitermqueri allow constant score mode clean bunch code duplic closer thing design wise give us constant score multi term queri allow us least option highlight constant score queri without much work
add constantscor highlight support spanscor actual easi enough support famili constantscor queri new spanscor also remov requir rewrit queri main index highlight fact constantscor queri highlight
next step toward flexibl index work lucene-1410 pfor compress tri prototyp switch post file use pfor instead vint encod quick becam difficult eg current mux skip data .frq file mess int block inlin payload posit would also mess int block skip offset terminfo offset hardwir file pointer frq prox file yet need chang block offset etc separ thread also start custom lucen store posit inform index http //www.gossamer-threads.com/lists/lucene/java-user/66264 decid make bit progress toward flexibl index first modularizing/isol class actual write index format idea captur logic term freq positions/payload separ interfac switch flush new segment well write segment merg use api
querywrapperfilt score purpos querywrapperfilt simpli filter includ docid match queri implement wast comput score match doc even though score unus could fix get scorer iter doc without ask score code index src/java/org/apache/lucene/search/querywrapperfilter.java src/java/org/apache/lucene/search/querywrapperfilter.java revis 707060 +++ src/java/org/apache/lucene/search/querywrapperfilter.java work copi -62,11 +62,9 public docidset getdocidset indexread reader throw ioexcept final openbitset bit new openbitset reader.maxdoc new indexsearch reader .search queri new hitcollector public final void collect int doc float score bits.set doc set bit hit final scorer scorer query.weight new indexsearch reader .scorer reader scorer.next bits.set scorer.doc return bit code mayb 'm miss someth seam like simpl win
highlight dist jar includ memori binari class file mark harwood sent note issu notic colleagu previous releas memori class file highlight distribut jar highlight use contrib depend method xml queri parser problem n't manifest alphabet order build though fix inherital launch ant task build memori contrib
close throw incorrect illegalstateex indexwrit hit oom autocommit true spinoff http //www.nabble.com/illegalstateex-thrown-when-calling-close-to20201825.html indexwrit hit oom record close call call rollback instead defens measur case oom corrupt intern buffer state added/delet doc 's bug open indexwrit autocommit true close incorrect throw illegalstatexcept fix simpl allow rollback call even autocommit true intern close extern call rollback autocommmit true still allow
indexreader.open string|fil may incorrect throw alreadyclosedexcept spinoff http //www.nabble.com/runtime-exception-when-creating-indexsearcher-to20226279.html open indexsearcher/read pass string file closedirectori set true reader index singl segment segmentreader.get use open index ioexcept hit segmentread close close directori sinc closedirectori true problem retri logic segmentinfo look anoth segments_n tri kick hit alreadyclosedexcept mask origin root caus workaround separ get directori use fsdirectory.getdirectori instanti indexsearcher/read manifest mask root caus corrupt single-seg index confus alreadyclosedexcept could also hit fals except writer process commit ie retri realli need transient io problem open index eg mani open file
changes.html generat improv bug fix improv changes2html.pl generat changes.html changes.txt current locat fragment identifi expand parent section linked-to section visibl proper handl beginning-of-releas comment n't fall section head previous content releas 1.9 final invis auto-linkifi solr-xxx infra-xxx jira issu previous lucene-xxx issu auto-linkifi bugzilla bug prefac issu previous bug patch auto-linkifi bugzilla bug form bug xxxxx yyyyy auto-linkifi issu follow attribut
indexablebinarystringtool convert arbitrari byte sequenc string use index term vice versa provid support convert byte sequenc string use index term back result string preserv origin byte sequenc sort order assum byte interpret unsign string construct use base 8000h encod origin binari data char encod string repres 15-bit chunk byte sequenc base 8000h chosen allow lower 15 bit char use without restrict surrog rang u+d800-u+dfff repres valid char would requir complic handl avoid allow use char 's high bit class intend serv mechan allow collationkey serv index term
collationkeyfilt convert token collationkey encod use indexablebinarystringtool convert token collationkey use provid collat encod collationkey indexablebinarystringtool allow store index term allow effici rang search sort field need collat proper order
make reqexclscor packag privat use docidsetiter exclud part
standardtoken split host name hyphen multipl token standardtoken recogn host name hyphen singl host token specif www.m-w.com token www.m w.com host type standardtoken instead output singl host token www.m-w.com sinc hyphen legitim charact dns host name ve local fix grammar file also requir us signific simplifi num type get behavior need host name 's junit test desir behavior public void testwithhyphen throw except final string host www.m-w.com final standardtoken token new standardtoken new stringread host final token token new token tokenizer.next token assertequ host token.typ assertequ www.m-w.com token.term
add abil run backwards-compat test automat idea doug mention lucene-1422 patch add new target build.xml automat download junit test previous lucen releas run current core execut test like ant -dtag=lucene_2_4_0 test-tag creat new directori tags/lucene_2_4_0 fetch test svn repositori run
keywordtoken set start/end offset token produc think ad two line next token method right fix reusabletoken.setstartoffset 0 reusabletoken.setendoffset upto n't think back compat issu start/end offset meaningless sinc inherit whatev reusabl token previous use
not_analyz field double-count offset field name 2 not_analyz field instanc offset double-count
perform improv openbitsetdisi.inplaceand
broken javadocs- site doc link see java-dev mail list discuss http //www.nabble.com/broken-javadocs- 3esite-docs-links-to20369092.html lucen java websit transit version document link javadoc modifi follow resourc found broken link gettingstarted.html queryparsersyntax.html one exampl gettingstarted.html link text demo http //lucene.apache.org/java/2_4_0/api/org/apache/lucene/document/package-summary.html attach patch convert absolut url javadoc version doc relat modifi javadocs-al target build.xml add path element name version javadoc core+contrib separ core contrib use relat url ad path element javadocs-al target necessari current javadoc one fewer path element separ javadoc left as-i one absolut url o.a.l.index.segmentinfo javadoc fileformats.html segmentinfo package-priv class javadoc target build.xml generat javadoc public class
includ junit jar sourc dist recent ad junit jar lib checkout run test fail includ sourc dist
run test-tag night build chang trivial patch ant target night also depend test-tag add properti compatibility.tag common-build.xml alway point last tag releas unit test download unless -dtag= use overrid download-tag fail svn checkout n't success instead test-tag check specifi tag checked-out avail fail
improv payload error handling/report tri load payload get except ioexcept payload load term posit also get except payload load bit confus messag n't relat actual problem
add getfinaloffset tokenstream add multipl fieldabl instanc field name document index field termvector store offset 's like offset first field instanc wrong indexwrit hood add cumul base offset field instanc base 1 endoffset last token saw analyz field logic over simplist exampl whitespaceanalyz use text analyz end 3 whitespac charact inform lost next field 's offset 3 small similar stopfilt appear chain last n token stop word base 1 endoffset last non-stopword token fix 'd like add new getfinaloffset tokenstream 'm think default return -1 mean n't know figur mean fallback faulti logic today come sever time user 's list
indexdeletionpolicy.delet behav incorrect delet latest generat look provid abil rollback commit transact encount issu appreci indexdeletionpolici 's main motiv handl clean away old commit point explicit state use clean new commit point support document ideal state intent support behaviour read seem 2 issu far 1 first attempt call indexcommit.delet latest commit point fail remov content subsequ call succeed howev 2 delet latest commit point fail updat segments.gen file point segments_n-1 new indexread open misdirect open segments_n delet junit test follow
rangequeri rangefilt use collat seek lowerterm use compareto constructor rangetermenum initi termenum start lowertermtext collat defin term given field need check sinc collat introduc non-unicod order instead rangetermenum constructor test non-nul collat one point termenum first term given field lucene-1424 introduc bug
ca n't creat niofsdirectori w/o set system properti niofsdirectory.getdirectori return fsdirectori object
binari field content lost optim scenario creat index arbitrari content close open indexwrit add document binari field store compress close indexwrit _without_ optim new document separ segment open indexread read last document binari field fine open indexwrit optim index close indexwrit open indexread field still present null mark binari data field.getbinarylength return 0
reopen return new indexread indexread may control lifecycl under directori manag refer count rough summari basic fsdirectori track refer fsdirectori indexreader.reopen share directori creat indexread closedirectori true fsdirectori 's ref manag see two decrement one increment end get alreadyclos except directori indexread open test ll put solut seem fair straightforward least need accomplish
org.apache.lucene.ant.htmldocu creat fileinputstream constructor n't close look jtidi sourc code n't show close find pars seem standard close stream anyway look like small descriptor leak
fieldinfo omitterm bug around line 95 this.omittf omittf this.omittf true one requir omittf least remain life refer omittf boolean statement refer field guess meant other.omittf like norm code
binari search implment lucen suffer well known overflow bug http //googleresearch.blogspot.com/2006/06/extra-extra-read-all-about-it-nearly.html place see multisearcher.subsearch int terminfosreader.getindexoffset term multisegmentreader.readerindex int int int mergedocidremapper.remap int hav n't taken much time consid like overflow valu averag would larg would rule possibl problem least coupl someth like mergedocidremapp document number could reach chanc trigger bug close record look
step toward flexibl index attach rough checkpoint current patch get earli feedback test pass though back compat test n't pass due chang package-priv api plus certain bug test happen work eg call termpostions.nextposit mani time new api assert asid think commit chang package-priv api back-compat test n't pass could go back make branch back-compat tag commit chang test use new packag privat api branch fix night build use tip branch o 's still plenti committ rather larg chang switch new effici term dict format still use tii/ti file tii store term long offset terminfo seek point tis encod term freq/prox offset absolut instead delta delta also tis/tii structur field n't record field number everi term first 1 m doc wikipedia tii file 36 smaller 0.99 mb 0.64 mb tis file 9 smaller 75.5 mb 68.5 mb ram usag load term dict index signific less sinc load array offset array string terminfo array faster init part basic done introduc modular reader codec strong decoupl term dict docs/posit reader eg terminfo use read new format 's nice symmetri read write codec chain current docs/prox format captur code formatpostingstermsdictwriter/read formatpostingsdocswriter/read .frq file formatpostingspositionswriter/read .prx file code part basic done introduc new flex api iter field term doc posit code fieldproduc termsenum docsenum postingsenum code replac termenum/docs/posit segmentread emul old api top new api keep back-compat next step plug new codec puls pfor exercis modular fix hidden assumpt expos new api indexread deprec old api emul old api top new one switch core/contrib user new api mayb switch attributesourc base class termsenum docsenum postingsenum would give reader api flexibl index-file-format flexibl eg someon want store payload term-doc level instead term-doc-posit level could add new attribut test perform iter
cachingwrapperfilt crash call bit getdocidset cachingwrapperfilt use singl cach call bit call getdocidset result type error addit code necessari wrap synchron block
chang contrib tokenstreams/filt use new tokenstream api new tokenstream api lucene-1422 chang contrib modul use
cach filter singl term field class implement inexpens rang filter field contain singl term build integ array term number store term- number map treemap implement fast integ comparison base docsetiditer code current use age rang filter could also use date filter applic need multipl filter base singl term field untest implement singl term filter consid yet implement term set filter use locat base search well code fair rough work lack javadoc tostr hashcod method etc 'm post discov interest featur n't mind fix would hate go effort 's go make lucen
instantiated/indexwrit discrepani ramdirectori seem reset tokenstream first time permit initialis object start stream instantiatedindex serial ramdirectori instantiatedindex java.io.notserializableexcept org.apache.lucene.index.termvectoroffsetinfo http //www.nabble.com/instatiatedindex-questions-to20576722.html
fsdirectory.getdirectori alway creat index path report luke bug go deeper prove non-intuit broken behavior fsdirectori use fsdirectory.getdirectori file nonexist nonexist path one locat exist parent path fsdirectory:174 use file.mkdir creat directori one would expect variant method boolean flag decid whether creat output path howev api creat flag deprec comment point indexwrit 's creat flag comment mislead indic path creat anyway file system call fsdirectory.getdirectori propos one follow reinstat variant method creat flag case flag fals index directori miss either return null throw ioexcept keep api either return null throw ioexcept index dir miss break backward compat user requir file.mkdir prior call fsdirectory.getdirectori
nearspansordered.getpayload return payload minimum match span
charfilt normal charact token propos import charfilt introduc solr 1.4 pleas see detail solr-822 http //www.nabble.com/proposal-for-introducing-charfilter-to20327007.html
consolid solr 's lucen 's openbitset class see solr-875 detail
fsdirectory.list inconsist lucene-638 ad check fsdirectory.list method return file lucen relat think chang made fsdirectori implement inconsist method directori e.g creat file arbitrari name use fsdirectori fileexist report deletefil remov array return list contain file actual issu report lucene-638 sub directori clear list imo respons directori implement decid kind file creat list directori class abstract directori should't
isvalid invok analyz rather valid output analyz synonym map protect method string analyz string word design custom stem howev analyz invok word boolean isvalid string str use valid word caus program discard word mayb useabl custom analyz method think isvalid invok analyz rather valid output analyz allow implemt decid valid overridden analyz method fact look code snippet isvalid realli go empti string check two line chang org.apache.lucene.index.memory.synonymmap part b ignor phrase space hyphen non-alphabet word let user custom word e.g stem isvalid word continu ignor word analyz word word null || word.length 0 continu ignor
add trierangefilt contrib accord thread java-dev http //www.gossamer-threads.com/lists/lucene/java-dev/67807 http //www.gossamer-threads.com/lists/lucene/java-dev/67839 want includ fast numer rang queri implement lucen contrib-queri implement base rangefilt anoth approach faster rangequeri base long store index special format idea behind store long differ precis index partit queri rang way outer boundari search use term highest precis center search rang lower precis implement store long 8 differ precis use class call trieutil also support doubl use ieee 754 floating-point doubl format bit layout bit map make binari sortabl approach use rather big index queri time even low perform desktop comput 100 ms big rang index 500000 doc call rangequeri variant format trierangerang queri idea look like well-known trie structur ident real tri algorithm relat
datetools.stringtod caus lock content load load test applic jira issu tracker shown thread spend lot time block datetools.stringtod stringtod method use singleton simpledateformat object pars date call simpledateformat.pars *synchronized* simpledateformat thread safe
incorrect segmentinfo.delcount indexreader.flush use delet document flush use indexreader.flush delcount segmentinfo updat base current valu segmentreader.pendingdeletecount introduc lucene-1267 seem pendingdeletecount reset commit mean second flush close index reader delcount segmentinfo incorrect subsequ indexreader.open call fail error assert enabl e.g java.lang.assertionerror delet count mismatch info=3 vs bitvector=2 org.apache.lucene.index.segmentreader.loaddeleteddoc segmentreader.java:405
miss possibl suppli custom fieldpars sort search result implement new trierangequeri contrib lucene-1470 confront problem special trie-encod valu long special encod sort searcher.search sortfield problem use sortfield.long get numberformatexcept trie encod valu may sort use sortfield.str encod way sortabl string memori ineffect extendedfieldcach give possibl specifi custom longpars retriev cach valu use search possibl suppli custom longpars sortfield propos chang sort class includ pointer parser instanc use sortfield given use default idea creat sortfield use new constructor code sortfield string field int type object parser boolean revers code parser object current parser super-interfac ideal solut would code sortfield string field int type fieldcache.pars parser boolean revers code fieldcache.pars super-interfac empti like marker-interfac parser like longpars sort implement must chang respect given parser null els use default fieldcache.getxxxx without parser
trecdocmak skip document date miss document trecdocmak skip trec document date line document encount code may skip sever document next tag search found result instead read ~25m document gov2 collect code read ~23m n't rememb actual number fix add terminatingtag read code look prefix terminatingtag found appropri chang made getnextdocdata patch follow
wrap messag output check infostream null ve found sever place code messag output w/o first check infostream null result time unnecessari string creat never output infostream set follow java 's log best practic log messag alway output follow format logger.islogg leve logger.log level msg log messag usual creat w/o pay much attent perform string concaten use '+ instead stringbuff therefor runtim import avoid creat messag discard eventu add method indexwrit messagesen use wherev call iw.messag made patch follow
sort sortfield equal hashcod develop project panfmp follow issu cach queri like solr queri result cach also use sort/sortfield key cach problem sort/sortfield implement equal hashcod store cach key workaround current use sort.tostr cach key nice corel issu lucene-1478 could fix one patch togeth improv
chang indexsearch multiseg search search individu segment use singl hitcollector issu chang indexsearch search multipl segment current method search multipl segment use multisegmentread treat segment one caus filter fieldcach key multiread make reopen expens segment chang fieldcach still load patch chang thing search individu segment one time share hitcollector use across segment allow fieldcach filter key individu segmentread make reopen much cheaper fieldcach load multipl segment much faster well old method uniqu term everi segment enumer segment like logarithm chang term per segment wast search individu segment avoid cost term/docu statist multiread use score result segment sort difficult use singl hitcollector sub searcher ordin compar across segment account new field sort enabl hitcollector introduc abl collect sort across segment abil compar ordin across segment topfieldcollector class collect values/ordin given segment upon move next segment translat ordinals/valu compar valu new segment done lazili switch seem provid numer perform benefit sort non sort search see good loss indic lot segment 1000 certain queue size queri latest result seem show that most taken care shouldnt use larg queue segment index anyway introduc multireaderhitcollector hitcollector collect across multipl indexread old hitcollector wrap support multipl indexread topfieldcollector hitcollector compar values/ordin across indexread sort field fieldvaluehitqueu prioriti queue part topfieldcollector implement fieldcompar new compar class work across indexread part topfieldcollector implement fieldcomparatorsourc new class allow custom compar alter indexsearch use singl hitcollector collect hit individu segmentread chang stem deprec topfielddoccollector fieldsortedhitqueu
remov segmentreader.docu synchron probabl last synchron issu lucen document method segmentread avoid use threadloc fieldsread
fieldcachetermsfilt companion fieldcacherangefilt except oper set term rather rang work best set compar larg term compar common
multilingu analyz base icu standard analyz lucen exact unicode-friend regard break text word especi respect non-alphabet script unawar unicod bound properti actual could n't figur thai analyz could possibl work look jflex rule saw codepoint rang thai block ad alphanum specif defin exact codepoint rang like everi languag could help problem 'd basic reimplement bound properti alreadi state unicod standard general look like kind behavior bad lucen even latin instanc analyz break word around accent mark decompos form latin letter accent combin compos form unicod also issu asciifoldingfilt suppos ve got partial test standardanalyz use icu rule-bas breakiter instead jflex use method defin word boundari accord unicod bound properti get good shape 'd happi contribut contrib wonder there better solut box lucen friend non-ascii text unfortun seem jflex support use properti \p word_break extend probabl major barrier thank robert
cjktoken convert halfwidth_and_fullwidth_form wrong cjktoken lines.. ub character.unicodeblock.halfwidth_and_fullwidth_form convert halfwidth_and_fullwidth_form basic_latin int int c 65248 c char wrong charact block e.g u+ff68 basic_latin counterpart 65281-65374 convert way fix ub character.unicodeblock.halfwidth_and_fullwidth_form 65474 65281 convert halfwidth_and_fullwidth_form basic_latin int int c 65248 c char
edgengramtokenfilt stop token smaller minimum gram size token encount stream shorter length min gram size filter stop process token stream work unit test may day provid want get system
allow readon openread task 'd like chang openread contrib/benchmark open readon reader default take readon option param reason writabl indexread becom necessari futur
enabl set hit queue size search*task contrib/benchmark test lucene-1483 'd like tri differ collector queue size benchmark current contrib/benchmark use deprec hit hardwir top 100 queue size ll switch topdoc api
mask field span cross search across multipl field many-to-on style issu cover chang requir search across multipl field name fashion similar many-to-on databas post java-dev topic detail chang need interest situat effect index two entiti system share one-to-mani relationship imagin user deliveri address demonstr purpos moment index one lucen document per mani end duplic one end data like userid 1 userfirstnam fred addresscountri au addressphon 1234 userid 1 userfirstnam fred addresscountri nz addressphon 5678 userid 2 userfirstnam mari addresscountri au addressphon 5678 note 2 document index user 1 somewhat annoy us search lucen result want back conceptu user level collaps result distinct user id etc etc let alon blow size index enorm would make sens use multipl field userid 1 userfirstnam fred addresscountri au addressphon 1234 addresscountri nz addressphon 5678 userid 2 userfirstnam mari addresscountri au addressphon 5678 imagin search +addresscountri au +addressphone:5678 'd like match mari cours match fred also match term differ address two aspect approach ve less got work 'd like run past group see re worth tri get lucen proper ll creat jira issu 1 use modifi spannearqueri assum countri phone alway one token reli fact posit au 5678 fred 's document differ spanqueri q1 new spantermqueri new term addresscountri au spanqueri q2 new spantermqueri new term addressphon 5678 spanqueri snq new spannearqueri new spanqueri q1 q2 0 fals slop 0 mean ll return two term posit respect field work brilliant requir chang spannearqueri 's constructor check claus field peopl amen perhap ad anoth constructor snq n't check subclass give protect non-check constructor subclass call 2 snip see lucene-1626 second idea
allow tasksequ run certain time help perf test lucene-1483 ad simpl abil specifi fix run time second task sequenc eg code xsearchwithsort searchwithsort doctitl string 2.7s code iter subtask 2.7 second elaps set repetit count mani iter done use run search whose runtim may vari drastic
minor chang simplehtmlformatt 'd like make minor chang simplehtmlformatt 1 defin default_pre_tag default_post_tag use default constructor trigger string lookup jvm whenev highlight instanti 2 creat stringbuff highlightterm right number charact begin even though stringbuff 's default constructor alloc 16 char probabl enough highlight term pre post tag 7 char leav 9 char term think 's better alloc sb right char advanc avoid char alloc middl
minor refactor indexfilenamefilt indexfilenamefilt look like 's design singleton howev constructor public singleton member packag visibl propos patch chang constructor member privat sinc alreadi static getfilt method code lucen refer two n't think creat problem api perspect
highlight throw stringindexoutofboundsexcept use canon solr exampl ant run-exampl ad document use exampledocs/post.sh add doc field name= id test highlight stringindexoutofboundsexcdpt /field field name= name name /field field name= manu acm inc. /field field name= featur descript featur mention various thing /field field name= featur featur also multivalu /field field name= popular 6 /field field name= instock true /field /doc /add url http //localhost:8983/solr/select/ q=featur hl=true hl.fl=featur caus except patch n't know complet correct avoid except
chararrayset behav inconsist add object contain object chararrayset 's add object method look like o instanceof char return add char o els o instanceof string return add string o els o instanceof charsequ return add charsequ o els return add o.tostr ll notic case object exampl integ o.tostr ad howev contain object method look like o instanceof char char text char o return contain text 0 text.length els o instanceof charsequ return contain charsequ o return fals case contain integ alway return fals ve ad simpl test testchararrayset reproduc problem public void testobjectcontain chararrayset set new chararrayset 10 true integ val new integ 1 set.add val asserttru set.contain val asserttru set.contain new integ 1 chang contain object solv problem o instanceof char char text char o return contain text 0 text.length return contain o.tostr patch also includ minor improv discuss mail list remov follow dead code gethashcod charsequ fals text instanceof string code text.hashcod simplifi add object o instanceof char return add char o return add o.tostr also align equival contain method one thing 's still left open whether avoid call character.tolowercas call char array method first convert char lowercas pass equal gethashcod method work add fail contain char sinc modifi input array
refactor spatial contrib filter queri class erik 's comment lucene-1387 distancequeri awkward name 's extend queri 's pojo helper mayb distancequeryfactori creat filter also cartesianpolyfilt filter cartesianshapefilt
contrib-spati use docset api rather deprec bitset api contrib-spati rewritten use new docidset filter api openbitset instead j.u.bitset filtereddocidset use replac serialchainfilt
chang contrib/spati use trie 's numericutil remov numberutil current spatial contrib includ copi numberutil solr otherwis would depend solr lucene-1496 sort copi remov
ad filtereddocidset filtereddocidsetiter ad 2 conveni class filtereddocidset filtereddocidsetiter
ad emptydocidset/iter ad conveni class emptydocidset emptydocidsetiter
cartesiantierplott fieldprefix configur cartesiantierplott field prefix currrent hardcod _localti configur
indexcommit.getfilenam return dup index creat autocommit fals 1 segment flush indexwrit session share doc-stor file incorrect duplic indexcommit.getfilenam method walk segmentinfo append file list sinc multipl segmentinfo 's may share doc store file caus dup fix ve ad segmentinfos.fil method refactor place comput file one segmentinfo time use new method instead
instantiatedindexread throw nullpointerexcept norm use multiread use instantiatedindexread multiread reader contain document nullpointerexcept thrown public void norm string field byte byte int offset throw ioexcept byte norm getindex .getnormsbyfieldnameanddocumentnumb .get field system.arraycopi norm 0 byte offset norms.length norm variabl null perform copi norm null work though 'm sure 's right fix java.lang.nullpointerexcept org.apache.lucene.store.instantiated.instantiatedindexreader.norm instantiatedindexreader.java:297 org.apache.lucene.index.multireader.norm multireader.java:273 org.apache.lucene.search.termqueri termweight.scor termquery.java:70 org.apache.lucene.search.indexsearcher.search indexsearcher.java:131 org.apache.lucene.search.indexsearcher.search indexsearcher.java:112 org.apache.lucene.search.searcher.search searcher.java:136 org.apache.lucene.search.searcher.search searcher.java:146 org.apache.lucene.store.instantiated.testwithmultireader.test testwithmultireader.java:41 sun.reflect.nativemethodaccessorimpl.invoke0 nativ method sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:39 sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:25 java.lang.reflect.method.invok method.java:597 junit.framework.testcase.runtest testcase.java:164 junit.framework.testcase.runbar testcase.java:130 junit.framework.testresult 1.protect testresult.java:106 junit.framework.testresult.runprotect testresult.java:124 junit.framework.testresult.run testresult.java:109 junit.framework.testcase.run testcase.java:120 junit.framework.testsuite.runtest testsuite.java:230 junit.framework.testsuite.run testsuite.java:225 org.eclipse.jdt.internal.junit.runner.junit3.junit3testreference.run junit3testreference.java:130 org.eclipse.jdt.internal.junit.runner.testexecution.run testexecution.java:38 org.eclipse.jdt.internal.junit.runner.remotetestrunner.runtest remotetestrunner.java:460 org.eclipse.jdt.internal.junit.runner.remotetestrunner.runtest remotetestrunner.java:673 org.eclipse.jdt.internal.junit.runner.remotetestrunner.run remotetestrunner.java:386 org.eclipse.jdt.internal.junit.runner.remotetestrunner.main remotetestrunner.java:196
incorpor geohash contrib/spati base comment yonik ryan solr-773 geohash provid abil store latitud longitud valu singl field consist hash field element need maintain 2 field cach latitud longitud field reduc size index amount memori need spatial search
shinglematrixfilt eaili throw stackoverflow complex matrix grow shinglematrixfilt next make recurs function invoc current permut iter exhaust current state permut iter alreadi produc ident shingl complex matrix requir gigabyt size stack per thread solut avoid recurs invoc refactor like code java public token next final token reusabletoken throw ioexcept assert reusabletoken null matrix null matrix new matrix fill matrix maximumshingles column matrix.columns.s maximumshingles readcolumn loop look ugli loop exist order avoid recurs call next method complex larg matrix would requir multi gigabyt size stack token token token producenexttoken reusabletoken token request_next_token return token privat static final token request_next_token new token method exist order avoid reursiv call method complex fairlt small matrix easili would requir gigabyt size stack per thread param reusabletoken return null exhaust instanc request_next_token one call requir answer instanc paramet resuabletoken throw ioexcept privat token producenexttoken final token reusabletoken throw ioexcept code
integr indexread indexwrit current problem indexread indexwrit open time perform updat requir write lock index method iw.deletedocu enabl delet iw method ir.deletedocu int doc norm updat avail iw limit capabl perform updat index dynam realtim without close iw open ir delet updat norm flush open iw process detriment realtim updat patch expos indexwriter.getread method return current flush state index class implement indexread new ir implement differ exist ir implement multisegmentread flush synchron updat iw part share write lock method ir usabl includ reopen clone
chang superclass trierangequeri patch chang superclass trierangequeri constantscorequeri current implement use rewrit copi earli rangequeri need trierangequeri easili subclass constantscorequeri lucene-1345 solv whole trierangequeri remov trierangefilt ad booleanqueri whole trierangequeri class conveni class easier usag trie contrib
chang primit data type int long class segmentmerger.java hi get except optim get except mergefield produc invalid result doccount 385282378 fdx file size 3082259028 abort merg prevent index corrupt check code class segmentmerger.java found check 4+doccount*8 fdxfilelength like bug sun jre 1.6.0_04/_05 detect bug struck throw except prevent corrupt enter index see lucene-1282 detail throw new runtimeexcept mergefield produc invalid result doccount doccount fdx file size fdxfilelength abort merg prevent index corrupt case doccount 385282378 fdxfilelength size 3082259028 even though 4+385282378*8 equal 3082259028 code work number 3082259028 int rang type variabl doccount need chang long written small test public class segmentmergertest public static void main string arg int doccount 385282378 long fdxfilelength 3082259028l 4+doccount*8 fdxfilelength system.out.println match 4+doccount*8 els system.out.println match 4+doccount*8 test print match chang data type doccount long print match pleas advis us issu fix next releas regard deepak
oom erro checkindex index conta lot field norm index reader cach last use norm segmentread multiread multisegmentread cach never clean access norm field norm 's byte maxdoc array freed close/reopen index see problem creat index mani field norm test 4,000 field mani document half million call checkindex call norm field segment call creat new cach entri get outofmemoryexcept short time test index abl checkindex even -xmx 16gb 64bit java checkindex open test segment index separ segmentread big index outofmemori problem optim consist one segment half million doc 4,000 field byte array take half mib index checkindex funtion creat norm 4000 field segmentread cach 2 gib ram oom unus opinion best would use weak- better softrefer norms.byt get java.lang.ref.softrefer byte use cach proper synchron done norm cach segmentread best softrefer refer garbag collect oom may happen byte array freed freed refer exist lter call getnorm creat new array code hard referenc norm array freed problem could done indexread field without norm problem field share one-tim alloc dummi norm array index without norm enabl field check perfect prepar patch tomorrow mike propos anoth quick fix checkindex bq could someth first specif checkindex eg could simpli use 3-arg non-cach byte method instead prevent oom error use
fdx size mismatch except storedfieldswriter.closedocstor close index 500m document close index contain 500,000,000 random generat document except thrown java.lang.runtimeexcept flush fdx size mismatch 500000000 doc vs 4000000004 length byte _0.fdx org.apache.lucene.index.storedfieldswriter.closedocstor storedfieldswriter.java:94 org.apache.lucene.index.docfieldconsumers.closedocstor docfieldconsumers.java:83 org.apache.lucene.index.docfieldprocessor.closedocstor docfieldprocessor.java:47 org.apache.lucene.index.documentswriter.closedocstor documentswriter.java:367 org.apache.lucene.index.indexwriter.flushdocstor indexwriter.java:1688 org.apache.lucene.index.indexwriter.doflush indexwriter.java:3518 org.apache.lucene.index.indexwriter.flush indexwriter.java:3442 org.apache.lucene.index.indexwriter.closeintern indexwriter.java:1623 org.apache.lucene.index.indexwriter.clos indexwriter.java:1588 org.apache.lucene.index.indexwriter.clos indexwriter.java:1562 appear bug storedfieldswriter.java:93 4+state.numdocsinstore*8 state.directory.filelength state.docstoresegmentnam indexfilenames.fields_index_extens multipl 8 caus integ overflow fix would cast state.numdocsinstor long multipli appear anoth instanc mistak caus bug lucene-1519 cursori seach \*8 code see might yet instanc mistak found none
anoth highlight ve written highlight project support bi-gram token stream general token stream e.g whitespacetoken also support see test code patch idea inherit previous project colleagu lucene-644 approach need highlight field termvector.with_positions_offset fast support n-gram depend lucene-1448 get refin term offset usag code java topdoc doc searcher.search queri 10 highlight h new highlight fieldqueri fq h.getfieldqueri queri scoredoc scoredoc docs.scoredoc fieldname= content fragcharsize=100 numfragments=3 string fragment h.getbestfrag fq reader scoredoc.doc content 100 3 fragment null string fragment fragment system.out.println fragment code featur fast larg doc support whitespace-bas token stream also fix size n-gram e.g 2,2 1,3 solv lucene-1489 support phrasequeri phrase-unit highlight slop noformat q= w1 w2 b w1 w2 /b q= w1 w2 ~1 b w1 /b w3 b w2 /b w3 b w1 w2 /b noformat highlight field need termvector.with_positions_offset easi appli patch due independ packag contrib/highlighter2 use java 1.5 look queri boost score fragment current n't see idf possibl pluggabl fraglistbuild pluggabl fragmentsbuild term posit unnecessari phrasehighlight==fals collect perform number
isopen need access subclass directori directori abstract class member variabl name isopen packag access usag variabl readabl must writabl order implement close concret implement directori current access variabl possibl creat directori implement also org.apache.lucene.stor propos either isopen variabl either need declar protect getter/sett method protect
miss depend two generat maven pom file miss depend generat maven pom.xml file benchmark highlight
benchmark deletes.alg fail benchmark deletes.alg fail index reader default open readon
add support ideograph space querypars also know fullwith space wide-spac ideograph space space charact wide normal cjk charact cell also known wide-spac fullwith space.thi type space use cjk languag patch add support wide space make querypars compon friend queri contain cjk text refer http //en.wikipedia.org/wiki/space_ punctuat see tabl space char u+3000 also ad new testcas fail patch patch appli junit pass
back-compat test ant test-tag test jar drop-in- test back-compat ant test-tag use catch break back compat commit howev current check src/test sourc compil trunk jar run test wherea back compat polici http //wiki.apache.org/lucene-java/backwardscompat state recompil requir upgrad new jar ie abl drop new jar place old one thing work fine fix ant test-tag full checkout core sourc test back-compat-tag compil jar back-compat sourc compil test back-compat jar swap trunk jar run test
support inclusive/exclus trierangequery/-filt remov default trie variant setters/gett trierangequery/filt miss one thing rang exclus bound trierangequeri may import rang long date ==long valu 1..5 like 0..6 0..5 simpl doubl must add/substract 1 trie encod unsign long conform rang queri submit patch two addit boolean paramet ctor support inclusive/exclus rang end intern implement use trieutils.incrementtriecoded/decrementtriecod make life simplier doubl rang simpl exclus replac float point rang 0.0..1.0 possibl without under unsign long decemb trie contrib includ lucene-1470 3 trie variant suppli trieutil new api static configur default trie variant conform api want lucen current want deprec static setters/gett import thing make code shorter easier understand error prone releas 2.9 good time remov default trie variant alway forc paramet trierangequery/filt better choos variant applic automat manag lucen 2.9 yet releas chang ctor preserv old one
contrib/xml-query-pars boostingtermqueri support 'm 100 patch booleantermqueri part span famili general use class replac termqueri thus dtd state part root queri well part span howev spanfooqueri xml element name spanfoo/ rather spanfooquery/ howev chosen call boostingtermquery/ would possibl set would pars spanboostingterm/ insid spansometh find confus
make test use java.util.random reproduc failur patch lucenetestcas support log random seed use random test patch also includ exampl implement testtrierangequeri overrid protect method runtest insert try-catch around super.runtest call two new method newrandom newrandom long avail test case test case run testcas object instanc 5 test method class instanti 5 instanc method work separ random seed save newrandom test fail throwabl messag seed null print newrandom never call messag print patch one problem singl test method call newrandom last seed save print test method testcas call newrandom exact usag execut test method thread save sync volatil test 's unimport forgot mention test fail messag use seed print stdout develop chang test temporarili code lucenetestcase.newrandom lucenetestcase.newrandom long code use seed fail test printout *refer quot allow random random seed effect test much much larger space ie everi time run test 's differ potenti cast much larger net fix seed guess 'm favor less random iter fix bug easi part discov bug present need help get yes know bug w/o idea trigger frustrat would enough test pick random number log use seed way get failur least know seed use hardcod temporarili reproduce/debug -hoss quot
filter support random access api use ran perform test compar appli filter via random-access api instead current trunk 's iter api inspir lucene-1476 realiz delet realli implement like filter test found switch delet iter sizabl perform hit note test index first 2m doc wikipedia test machin mac os x 10.5.6 quad core intel cpu 6 gb ram java 1.6.0_07-b06-153 test across multipl queri 1-x mean queri eg 1-4 mean 1 2 3 4 wherea +1-4 queri ie 1 2 3 4 u mean unit state phrase search test multipl filter densiti 0 1 2 5 10 25 75 90 95 98 99 99.99999 filter non-nul bit set 100 filter=nul control method high mean use random-access filter api indexsearch 's main loop method low mean use random-access filter api segmenttermdoc like delet doc today baselin qps current trunk filter appli iter high ie indexsearch 's search loop
valuesourcequeri hit synchron bottleneck indexreader.isdelet plan fix way lucene-1316 matchalldocsqueri use termdoc null
improv benchmark benchmark improv incorpor recent suggest post java-dev m. mccandless python script execut multipl round test either incorpor codebas convert java
improv contrib.benchmark trec collect benchmark util trec test collect http //trec.nist.gov quit limit support variat format older trec collect benchmark work lucen modifi packag support older trec document format current parser fail due miss document header variat queri format newlin titl tag caus queri parser get confus abil detect read uncompress text collect storag document number default without store full text submit patch interest although probabl want write unit test new function first
lucen incorrect set posit token start field positoninc 0 info lucene-1465
field specifi norm matchalldocumentsscor patch allow option set field use norm factor score matchingalldocumentsqueri test case code java ramdirectori dir new ramdirectori indexwrit iw new indexwrit dir new standardanalyz true indexwriter.maxfieldlength.limit iw.setmaxbuffereddoc 2 forc multi-seg adddoc one iw 1f adddoc two iw 20f adddoc three four iw 300f iw.clos indexread ir indexreader.open dir indexsearch new indexsearch ir scoredoc hit assert norm score turn hit is.search new matchalldocsqueri null 1000 .scoredoc assertequ 3 hits.length assertequ one ir.docu hit 0 .doc .get key assertequ two ir.docu hit 1 .doc .get key assertequ three four ir.docu hit 2 .doc .get key assert norm score turn matchalldocsqueri normsqueri new matchalldocsqueri key assertequ 3 hits.length is.explain normsqueri hit 0 .doc hit is.search normsqueri null 1000 .scoredoc assertequ three four ir.docu hit 0 .doc .get key assertequ two ir.docu hit 1 .doc .get key assertequ one ir.docu hit 2 .doc .get key code
deadlock indexwriter.addindex indexread deadlock issu occur follow circumst indexwriter.autocommit true indexwriter.directori contain multipl segment indexwriter.addindex indexread invok put togeth junit test recreat deadlock ve attach first test method testaddindexbyindexread nutshel happen 1 addindex indexread acquir write lock begin optim destin index prior ad extern segment 2 main thread start concurrentmergescheduler.mergethread merg 2 segment 3 merg thread tri acquir read lock indexwriter.blockaddindex boolean indexwriter.startcommit 4 main thread still hold write lock wait indexwriter.runningmerg data structur devoid merg optim flag set indexwriter.optimizemergespend
standard analyz correct token combin charact u+0364 combin latin small lettr e standard analyz correct token combin charact u+0364 combin latin small lettr e. word mo?cht incorrect token mo chte combin charact lost expect result token mo?cht
add indexreader.flush commituserdata indexwrit offer commit string commituserdata method indexread commit well use flush/clos method need analog method accept commituserdata
rare thread hazard indexwriter.commit night build 2 night ago hit code note random seed testcas testatomicupd -5065675995121791051 junit junit testcas testatomicupd org.apache.lucene.index.testatomicupd fail junit expect 100 91 junit junit.framework.assertionfailederror expect 100 91 junit org.apache.lucene.index.testatomicupdate.runtest testatomicupdate.java:142 junit org.apache.lucene.index.testatomicupdate.testatomicupd testatomicupdate.java:194 junit org.apache.lucene.util.lucenetestcase.runtest lucenetestcase.java:88 code 's intermitt failur happen multipl thread call commit autocomit=tru concurrentmergeschedul happen often merg thread call commit 's done problem happen one thread alreadi begun commit process anoth two thread come along want also commit chang happen two thread would wait current commit thread finish 'd wake commit problem wake would fail check whether supersed ie whether anoth thread alreadi commit up-to-d chang fix simpl wake check commit supersed skip commit
levenshteindist code normal incorrect normal edit distanc use maximum two string compar instead minimum otherwis negat distanc possibl spell checker filter edit certain threshold n't problem practic
strengthen checkindex bit small improv checkindex detect possibl doc order case
add n-gram string match spell check n-gram version edit distanc base paper grzegorz kondrak n-gram similar distanc proceed twelfth intern confer string process inform retriev spire 2005 pp 115-126 bueno air argentina novemb 2005. http //www.cs.ualberta.ca/~kondrak/papers/spire05.pdf
add reopen indexcommit method indexread add reopen indexcommit method indexread abl reopen index previous save commit point advantag lucene-1483 similar open indexcommit compani avail 2.4.0
indexwriter.addindex indexread reader n't correct handl except success flag bit code addindex indexread reader tri flush true fals true optim start zero 1 seg success true final take care releas write lock hit except start transact success releasewrit success flag reset fals 's use anoth try/catch/fin block testindexwriter.testaddindexondiskful sometim hit bug 's infrequ
concurrentschedulemanager.addmyself wrong int method wrong index size variabl think b allinstances.s code java privat void addmyself synchron allinst final int size=0 int upto 0 int i=0 size i++ final concurrentmergeschedul concurrentmergeschedul allinstances.get other.clos 0 other.mergethreadcount keep one still thread may spawn new thread allinstances.set upto++ allinstances.sublist upto allinstances.s .clear allinstances.add code
problem indexwriter.mergefinish 'm get infrequ assert indexwriter.mergefinish testindexwriter.testaddindexondiskful problem occur rollback merg n't regist 'm 100 sure correct fix 's infrequ event code java final synchron void mergefinish mergepolicy.onemerg merg throw ioexcept optim addindex finishmerg may wait merg finish notifyal merge.increfdon decrefmergeseg merg assert merge.registerdon final segmentinfo sourceseg merge.seg final int end sourcesegments.s int i=0 end i++ mergingsegments.remov sourcesegments.info mergingsegments.remov merge.info merge.registerdon fals code someth like code java final synchron void mergefinish mergepolicy.onemerg merg throw ioexcept optim addindex finishmerg may wait merg finish notifyal merge.increfdon decrefmergeseg merg merge.registerdon final segmentinfo sourceseg merge.seg final int end sourcesegments.s int i=0 end i++ mergingsegments.remov sourcesegments.info mergingsegments.remov merge.info merge.registerdon fals code
valid email address charact correct recogn email express standardtokenizerimpl.jflex miss unusu valid charact left-hand-sid email address caus address broken sever token exampl somename+sit gmail.com get broken somenam site gmail.com husband wife talktalk.net get broken husband wife talktalk.net seem occur often first seem anti-spam trick use googl see http //labnol.blogspot.com/2007/08/gmail-plus-smart-trick-to-find-block.html see second sever domain disproportion amount talktalk.net expect 's signup suggest servic perhap fix would chang line 102 standardtokenizerimpl.jflex email alphanum alphanum alphanum alphanum email alphanum alphanum alphanum alphanum 'm awar standardtoken meant basic implement rather implement full standard quit use place hope would improv slight
make indexreader/search ctor readonly=tru default anoth chang default 3.0 right get read/writ reader indexreader.open new indexsearch reserv right write caus thread content isdelet 3.0 let 's make readon reader default still allow open read/writ indexread
mayb renam field.omittf strengthen javadoc spinoff http //www.nabble.com/search-problem-when-indexed-using-field.setomittf -td22456141.html mayb renam omittf someth like omittermposit make clear queri silent fail work result
add exampl test case surround queri languag
field.setvalu n't proper handl switch byte type came pylucen test base lucen 2.4.1 thread http //pylucene.markmail.org/message/75jzxzqi3smp2s4z problem field.setvalu fix isbinari boolean creat string field setvalu byte ll get except ad document contain field index
larg lucen index hit fals oom due sun jre issu lucen issu want open futur googl digger easili find 's nasti bug sun 's jre http //bugs.sun.com/bugdatabase/view_bug.do bug_id=6478546 gist seem tri read larg eg 200 mb number byte singl randomaccessfile.read call incorrect hit oom lucen norm sinc read one byte per doc per field norm contigu array length maxdoc workaround custom patch larg file read sever smaller read background http //www.nabble.com/problems-with-large-lucene-index-td22347854.html
new flexibl queri parser new flexibl queri parser thread micheal busch team ibm use differ queri parser lucen 's product quit recent spent signific amount time refactor code design generic architectur queri parser easili use differ product vari queri syntax work origin driven andrea neumann howev left team code written lui alv bit activ lucen past adriano campo join team ibm half year ago adriano apach committ pmc member tuscani project get familiar lucen think code much flexibl extens current lucen queri parser would therefor like contribut lucen 'd like give brief architectur overview adriano lui answer detail question re much familiar code goal separ syntax semant queri e.g b +a +b and b could differ syntax queri distinguish semant differ queri compon e.g whether tokenize/lemmatize/norm differ term queri object creat term want abl write parser new syntax reus under semant quick possibl fact adriano current work 100 lucene-syntax compat implement make easi peopl use lucen 's queri parser switch queri parser three layer core call querynodetre tree initi repres syntax origin queri e.g b b three layer 1 querypars 2 querynodeprocessor 3 querybuild 1 upper layer pars layer simpli transform queri text string querynodetre current implement layer use javacc 2 queri node processor work fact configur chain processor processor walk tree modifi node even tree 's structur make possibl e.g queri optim queri execut token term 3 third layer also configur chain builder transform querynodetre lucen queri object furthermor queri parser use flexibl configur object base attributesource/attribut also use messag class allow attach resourc bundl make possibl translat messag import featur queri parser design allow us develop differ queri syntax quick adriano wrote lucene-compat syntax matter hour under processor builder day 100 compat lucen queri parser mean syntax ident queri parser test case pass new one use wrapper recent post show demand queri syntax improv e.g improv rang queri syntax oper preced alreadi differ qp implement lucene+contrib howev think keep date sync surpris usual fix chang made main queri parser peopl n't make correspond chang contrib parser 'm guilti new architectur much easier maintain differ queri syntax actual code first layer much syntax would benefit patch improv make under layer make support differ syntax much manag
fix npe 's spatial lucen search bound box npe occur use distancequerybuild minim bound box search without distanc filter
indexreader.clon leav file open hit work lucene-1516 use compound file format clone indexread close origin close clone store field file _x.fdt _x.fdx remain incorrect open test show fix trivial post patch commit short
distancefilt problem delet document know locallucen lib want make sure n't get bug get lucen contrib suspect issu delet document tri evalu filter debug confirm bomb document mark delet use luke thank use locallucen librari 1.51 get nullpointerexcept line 123 distancefilt method public bitset bit indexread reader line doubl x numberutils.sortablestr2doubl sx stack trace java.lang.nullpointerexcept org.apache.solr.util.numberutils.sortablestr2long numberutils.java:149 org.apache.solr.util.numberutils.sortablestr2doubl numberutils.java:104 com.pjaol.search.geo.utils.distancefilter.bit distancefilter.java:123 org.apache.lucene.search.filter.getdocidset filter.java:49 org.apache.lucene.search.indexsearcher.search indexsearcher.java:140 org.apache.lucene.search.indexsearcher.search indexsearcher.java:112 org.apache.lucene.search.hits.getmoredoc hits.java:113 org.apache.lucene.search.hits. init hits.java:90 org.apache.lucene.search.searcher.search searcher.java:72
indexwrit right thing thread interrupt 'd spinoff http //www.nabble.com/deadlock-with-concurrent-merges-and-indexwrit lucene-2.4 to22714290.html thread interrupt 'd insid lucen risk current caus spinloop starv bg merg complet instead possibl allow interrupt unfortun back-compat need wrap except uncheck version 3.0 chang simpli throw interruptedexcept
refactor lucen collector hitcollector extens issu result recent discuss ve mail list read thread here|http //www.nabble.com/is-topdoccollector 27s-collect -implementation-correct td22557419.html agre follow refactor renam multireaderhitcollector collector purpos base class collector implement deprec hitcollector favor new collector introduc new method indexsearch accept collector deprec accept hitcollector creat final class hitcollectorwrapp use deprec method indexsearch wrap given hitcollector hitcollectorwrapp mark deprec remov 3.0 remov hitcollector remov instanceof check current exist indexsearch code creat new abstract topdocscollector leav collect setnextread unimpl introduc protect member priorityqueu totalhit introduc singl protect constructor accept priorityqueu implement topdoc gettotalhit use pq totalhit member use as-ar extend class well overridden introduc new topdoc start howmani method use conveni method implement search applic allow page search result also attempt improv memori alloc alloc scoredoc request size chang topscoredoccollector extend topdocscollector use topdoc gettotalhit implement topdocscollector class also made final chang topfieldcollector extend topdocscollector make class final also implement topdoc start howmani chang topfielddoccollector deprec extend topdocscollector instead topscoredoccollector implement topdoc start howmani review place hitcollector use scorer deprec place use collector instead addit follow propos made w.r.t decoupl score collect chang collect accecpt doc id unbas introduc setscor scorer method collect implement need score call scorer.scor need review place code collect doc score call assert whether scorer pass also rais question collect scorer null i.e. set even possibl notic mani collect implement discard document score greater 0 n't mean score need collect alway open issu name collector topdocscollector mention thread topresultscollector thought call colletor resultscolletor sinc decid far collector think topdocscollector make sens topdoc output decoupl score collect post patch bit later expect larg patch split 2 1 code patch 2 test case move use collector instead hitcollector well test new topdoc start howmani method might even 3rd patch handl setscor thing collector mayb even differ issu
brazilian analyz n't remov stopword uppercas given order filter matter need appli lowercas token filter remov stopword result new stopfilt result stoptabl result new brazilianstemfilt result excltabl convert lowercas stem result new lowercasefilt result lowercas must come brazilianstemfilt end day ll attach patch 's straightforward
instantiatedindex support non-optim indexread instantiatedindex current support non-optim indexread
clone segmentread fail share fieldcach entri hit lucene-1516 return clone readon reader indexwrit problem clone creat new thin clone segmentread segment fieldcach key direct object clone reader search requir fieldcach eg sort first search alway slow everi singl segment reload fieldcach cours complet showstopp lucene-1516 lucene-831 ll switch new fieldcach api ensur bug present also fix bug current fieldcach api sinc 2.9 user may hit
make trierang complet independ document/field tokenstream prefix encod valu trierang current follow problem add field use trie encod manual add term index use helper method trieutil helper method problem use fix field configur trieutil current creat per default helper field contain lower precis term enabl sort limit one term/docu sort triecodelong/int creat unnecessarili string char array heavi gc index lot numer valu also lot char string copi involv issu improv triecodelong/int return tokenstream encod char array reus token api addit string array encod result creat instead tokenstream enumer trie valu trie field ad document index use standard api new field name tokenstream extra util method need use token filter one could also add payload custom everyth drawback sort would work anymor enabl sort sub- issu extend fieldcach stop iter term soon lower precis one enumer termenum creat hack patch trieutils-us use non-check exceptionin parser stop iter lucene-831 generic api type use custom parser/iter implement fieldcach attach field cach patch temporari solut fieldcach reimplement separ patch file mayb open anoth issu
spanorqueri skipto n't alway move forward spanorqueri skipto method improp implement target doc less equal current doc sinc skipto may call claus span public boolean skipto int target throw ioexcept queue null return initspanqueu target queue.siz 0 top .doc target top .skipto target queue.adjusttop els queue.pop return queue.siz 0 violat correct behavior describ span interfac document skipto alway move forward word correct implement would public boolean skipto int target throw ioexcept queue null return initspanqueu target boolean skipcal fals queue.siz 0 top .doc target top .skipto target queue.adjusttop els queue.pop skipcal true skipcal return queue.siz 0 return next
callback intercept merg segment indexwrit thing like merg field cach bitset 's use know segment merg creat new segment
allow control payload merg lucen handl backwards-compat data structur convert old new format segment merg payload simpli byte array user store arbitrari data applic use payload might want convert format payload similar fashion otherwis 's easili possibl ever chang encod payload without reindex propos introduc payloadmerg class segmentmerg invok merg payload multipl segment user implement payloadmerg convert payload old new format futur need kind flexibl also column-strid field lucene-1231 flexibl index codec addit would nice user could store version inform segment file e.g could store segment _2 term b use payload format x.i
add indexreader.getuniquetermcount simpl api return number uniqu term across field spinoff http //www.lucidimagination.com/search/document/536b22e017be3e27/term_limit
rangequeri equal method compar collat properti fulli equal method rang queri collat comparison implement this.col null this.collator.equ other.col _this.col null_ _other.col somecollator_ method incorrect assum equal ad someth like || this.col null other.col null would fix problem
updat spatial lucen sort use fieldcomparatorsourc updat distanc sort use fieldcompar sort oppos sortcompar
stored-on field automat enabl norm tf ad document updat intern compon new trieapi seen follow index lot numer field trie encod omit norm term frequenc work great luke show omit sometim also want compon field store want use field name add addit field document store field c'tor use tokenstream addit store field store thought left explicit set omitnorm omittermfreqandposit ad stored-only-without-omit field luke show field norm enabl sure norms/tf realli ad index luke show valu norm fieldinfo enabl opinion intuit o.a.l.document.field switch omit* option store field also disabl indexing-on option altern intern fieldinfo.upd boolean isindex boolean storetermvector boolean storepositionwithtermvector boolean storeoffsetwithtermvector boolean omitnorm boolean storepayload boolean omittermfreqandposit chang omit* option isindex paramet this.isindex also true elsewher leav principl ad stored-on field indexing-specif option chang fieldinfo field index norm norm stay enabl would default
enabl bzip compress benchmark bzip compress aid benchmark packag requir extract bzip file enwiki order index plan add config paramet bzip.compression=true/fals relev task either decompress input file compress output file use bzip stream add depend ant.jar contain two class similar gzipoutputstream gzipinputstream compress/decompress file use bzip algorithm bzip known superior compress perform gzip algorithm ~20 better compress although compression/decompress bit slower wil post patch add paramet implement linedocmak enwikidocmak writelinedoc task mayb even add capabl docmak super class inherit sub-class
fix deprec termsenum.skipto method trap look legitim hideous poor perform simpl linear scan implement termsenum base class sinc none concret impl overrid effici implement least 2.9 deprec method strong warn perform see background http //www.lucidimagination.com/search/document/77dc4f8e893d3cf3/possible_terminfosreader_speedup histor context http //www.lucidimagination.com/search/document/88f1b95b404ebf16/remove_termenum_skipto_term_target
optim topscoredoccollector topfieldcollector spin-off lucene-1575 propos optim tsdc tfc code remov unnecessari check plan ensur indexsearch return segement increas doc id order instead numdoc chang tsdc tfc 's code use doc id tie breaker new doc alway larger id therefor compet pre-popul hitqueu sentinel valu tsdc score float.neg_inf remov check reusablesd null also move use chang top call adjusttop case updat queue method sort explicit add sortfield.field_doc tie breaker last sortfield necessari sinc alreadi break tie docid fact less effici optim investig pq deprec insert insertwithoverflow add adddummyobject method popul queue without arrang store object array use pre-popul sentinel valu post patch well perf measur soon
split docmak contentsourc docmak issu propos refactor benchmark packag today docmak two role collect document collect prepar document object two actual split contentsourc docmak use contentsourc instanc contentsourc implement method docmak like getnextdocdata raw size byte track etc actual fit well w/ 1591 basic contentsourc offer input stream servic wrap file exampl bzip gzip stream etc docmak implement makedocu method reus docstat etc idea collect enwiki document exampl whether creat document use docstat add payload index addit metadata goe trec reuter collect well linedocmak fact one inspect enwikidocmak linedocmak close 99 99 differ differ lie way read data similar lie way creat document use docstat led somehwat bizzar extens linedocmak enwikidocmak reus docstat also docmak use docstat today someth could gotten free refactor propos enwikicontentsourc reuterscontentsourc other trec line simpl write sever docmak docstatemak configurabledocmak one accpet kind config option custom docmak payload facet sort pass contentsourc instanc reus docmak algorithm mani content sourc well contentsourc algorithm mani docmak implement also give us opportun perf test content sourc alon i.e. compar bzip gzip regular input stream w/o overhead creat document object ve alreadi done code environ extend benchmark packag applic 's purpos like flexibl think nice contribut benchmark packag result code cleanup well
optim multitermenum/multitermdoc optim multitermenum multitermdoc avoid seek termdoc n't match term
could use custom sort compar sourc remot searchabl longer fieldcomparatorsourc fieldcomparatorsourc serializ live sortfield
spanregexqueri spannearqueri work multisearch multisearch use queri searchabl .rewrit origin rewrit queri use combin combin spanregexqueri 's rewrit differ other call queri alway return rewritten queri result search first indexsearch work other use first indexsearch 's rewrit queri mani term miss return unexpect result billow
reduc usag string.intern perform terribl profil simpl matchalldocsqueri ~1.5 million document 8 field short text field.store.y field.index.not_analyzed_no_norm retriev document via searcher.doc fs string.intern show top hotspot see attach screenshot implement small optim intern everi new field instead forc intern fieldinfo class ad option internnam constructor field reduc execut time search iter document 35 result similar -server -client trunk 2.9 w/out patch match 1435563 8884 ms/search trunk 2.9 w/patch match 1435563 5786 ms/search
rewrit trierang use multitermqueri issu discuss http //www.lucidimagination.com/search/document/46a548a79ae9c809/move_trierange_to_core_module_and_integration_issu patch rewrit trierang use multitermqueri like core queri make trierang ident function core rang queri
chang trierang filteredtermenum multitermqueri improv patch need multitermquery-rewrit trierang lucene-1602 make privat member protect access special trierangetermenum fix small inconsist docfreq return valu valid term exist improv multitermfilter.getdocidset return docidset.empty_docidset termenum empti less memori usag faster add getlastnumberofterm multitermqueri statist differ multi term queri may term affect use new function improv trierang shown extract test case 10000 doc index long valu code junit averag number term random search field8 junit trie queri 244.2 junit classic queri 3136.94 junit averag number term random search field4 junit trie queri 38.3 junit classic queri 3018.68 junit averag number term random search field2 junit trie queri 18.04 junit classic queri 3539.42 code core test pass
stop creat huge array repres absens field norm creat keep around huge array hold constant valu ineffici heap usag standpoint localil refer standpoint would much effici use null repres miss norm tabl
add subset method bitvector recent need abil effici comput subset bitvector method public bitvector subset int start int end start start index inclus end end index exclus attach patch includ subset method well relev unit test
automaton query/filt scalabl regex attach patch automatonquery/filt name chang suitabl wherea out-of-box contrib regexqueri nice larg index 100m+ uniqu token queri quit slow 2 minut etc addit exist regexqueri implement lucen realli slow constant prefix implement depend upon constant prefix run queri 640ms use case envis 1. lexicography/etc larg text corpora 2. look thing url prefix constant http ftp filter use bric packag http //www.brics.dk/automaton/ convert regular express dfa filter enumer term special way use under state machin short descript comment algorithm pretti basic enumer term instead binari accept/reject 1 look portion ok enter reject state dfa 2 generat next possibl string seek queri simpli wrap filter constantscorequeri includ automaton.jar insid patch download http //www.brics.dk/automaton/ bsd-licens
string.intern faster altern use intern string pool top default string.intern great optim setup java 6 altern run ~15.8x faster alreadi intern string ~2.2x faster new string intern java 5 4 speedup lower still consider
elimin synchron content initi index read terminfosread ensureindexisread synchron method ensureindexisread terminfosread caus content heavi load simpl reproduc e.g solr cach turn simpl rang search e.g id 0 999999 even small index case 28k doc load/stress test applic later examin thread dump kill -3 mani thread block wait monitor entri method rather use double-check lock known issu implement use state pattern one thread move object indexnotread state indexread alter object behavior i.e index load index nolong need synchron method particular test uncreas throughput least 30 time
preserv whitespac code section changes.html generat changes.txt changes2html.pl trunk section changes.txt sport use new featur code section two mention lucene-1575 look fine text render look crappi html version sinc changes2html.pl escap html metacharact appear as-i html render newlin code convert singl space think fix modifi changes2html.pl convert code /code unescap code pre /pre /code respect sinc pass code /code without pre chang font monospac nice still collaps whitespac nice see java-dev thread spawn issu http //www.nabble.com/changes.txt-td23102627.html
launch new merg indexwrit hit oom indexwrit hit oom defend refus commit chang index includ merg lead infinit merg attempt fail prevent start merg spinoff http //www.nabble.com/semi-infinite-loop-during-merging-td23036156.html
add next skipto variant docidsetiter return current doc instead boolean see http //www.nabble.com/another-possible-optim -now-in-docidsetiterator-p23223319.html full discuss basic idea add variant two method return current doc save success call doc doc return -1 summari discuss far deprec two method add nextdoc skiptodoc int return doc default impl disi call next skipto respect chang abstract 3.0 actual would like propos altern name advanc advanc int first advanc one second advanc target wherev use someth like doc advanc 0 instead compar -1 improv perform post patch short
deprec method use fieldsread setomittf setomittf boolean deprec use core class one place appear fieldsread patch fix necessari chang fieldabl abstractfield two place local variabl
add one setter start end offset offsetattribut add offsetattribut setoffset startoffset endoffset trivial chang junit need chang chartoken use
add testpackag common-build.xml one defin testcas execut one test class conveni howev n't notic equival test whole packag find conveni abl test packag rather test case often clear test class run follow patch allow one ant test -dtestpackage=search exampl run test \*/search/\* packag core contrib tag ant test-cor -dtestpackage=search execut similar core ant test-cor -dtestpacakge=lucene/search/funct run test \*/lucene/search/function/\* case anoth o.a.l.something.search.funct packag want exclud
allow set indexwrit docstor differ directori add indexwriter.setdocstoredirectori method allow doc store place differ directori iw default dir
termattribute.termlength optim public int termlength inittermbuff patch remov method call return termlength see reason inittermbuff termlength test pass could wrong
deprec term getterm multitermqueri mean move getterm term sub class appropri reimplement equal hashcod appropri sub class
back-compat break non-ascii field name field name contain non-ascii charact 2.3.x index upgrad 2.4.x unexpect problem hit 's possibl hit read past eof ioexcept 's also possibl hit except get incorrect field name caus lucene-510 fieldinfo *.fnm file proper version spinoff http //www.nabble.com/read-past-eof-td23276171.html
n't commit empti segments_n iw open create=tru iw open create=tru forc commit empti segments_n realli autocommit fals noth commit commit close explicit call spinoff http //www.nabble.com/no-segments*-file-found -file -error-on-opening-index-td23219520.html
openreaderpass popul checkindex.status.segmentinfostatus use checkindex programat openreaderpass flag segmentinfostatus never popul alway come back fals look code clear openreaderpass defin never use furthermor appear inform propag infostream avail via segmentiinfostatus follow inform abl gather public properti segmentinfostatus test open reader ok test field norm .ok 2 field test term freq prox ok 101 term 133 terms/doc pair 133 token test store field .ok 100 total field count avg 1 field per doc test term vector ..ok 0 total vector count avg 0 term/freq vector field per doc
spellcheck close method spellcheck close method mean way forc close indexsearch maintain done use spellcheck quick skim indexsearch n't even suggest final self close event gc http //www.nabble.com/spellchecker-locks-folder-to23171980.html a23171980 hackish work around peopl want forc spellcheck close indexsearch open directori care someth code yourspellchecker.setspellindex new ramdirecotri code
persian analyz simpl persian analyz measur trec score benchmark packag http //ece.ut.ac.ir/dbrg/hamshahri/ simpleanalyz summari search second 0.012 docnam second 0.020 num point 981.015 num good point 33.738 max good point 36.185 averag precis 0.374 mrr 0.667 recal 0.905 precis 1 0.585 precis 2 0.531 precis 3 0.513 precis 4 0.496 precis 5 0.486 precis 6 0.487 precis 7 0.479 precis 8 0.465 precis 9 0.458 precis 10 0.460 precis 11 0.453 precis 12 0.453 precis 13 0.445 precis 14 0.438 precis 15 0.438 precis 16 0.438 precis 17 0.429 precis 18 0.429 precis 19 0.419 precis 20 0.415 persiananalyz summari search second 0.004 docnam second 0.011 num point 987.692 num good point 36.123 max good point 36.185 averag precis 0.481 mrr 0.833 recal 0.998 precis 1 0.754 precis 2 0.715 precis 3 0.646 precis 4 0.646 precis 5 0.631 precis 6 0.621 precis 7 0.593 precis 8 0.577 precis 9 0.573 precis 10 0.566 precis 11 0.572 precis 12 0.562 precis 13 0.554 precis 14 0.549 precis 15 0.542 precis 16 0.538 precis 17 0.533 precis 18 0.527 precis 19 0.525 precis 20 0.518
contrib intellig analyz chines wrote analyz apach lucen analyz sentenc chines languag 's call imdict-chinese-analyz project googl code http //code.google.com/p/imdict-chinese-analyzer/ chines |??12? chines token | ? ?12? chines | ?? 12? analyz must handl sentenc proper mis-understand everywher index construct lucen accuraci search engin affect serious although two analyz packag apach repositori handl chines chineseanalyz cjkanalyz take charact everi two adjoin charact singl word obvious true realiti also strategi increas index size hurt perform badd algorithm imdict-chinese-analyz base hidden markov model hmm token chines sentenc realli intellig way tokenizaion accuraci model 90 accord paper hhmm-base chines lexic analyz ictclal analyz 's 60 imdict-chinese-analyz realli fast intellig want contribut apach lucen repositori
mate collector scorer doc id order spin lucene-1593 issu propos expos appropri api scorer collector one creat optim collector base given scorer 's doc-id order vice versa copi lucene-1593 list chang deprec weight creat queryweight abstract class new scorer reader scoredocsinord replac current scorer reader method queryweight implement weight score reader call score reader fals out-of-ord scorer reader scoredocsinord defin abstract also add queryweightwrapp wrap given weight implement one also deprec well package-priv add queri variant createweight weight return queryweight prefer add default impl wrap weight variant instead overrid queri extens 3.0 remov weight variant overrid extend class add scorer isoutoford default fals overrid bs true modifi booleanweight extend queryweight implement new scorer method return bs2 bs base number requir scorer setallowoutoford add collector abstract _acceptsdocsoutoforder_ return true/fals use indexsearcher.search method accept collector order creat appropri scorer use new queryweight provid static creat method tfc tsdc accept argument creat proper instanc wherev creat collector tsdc tfc alway ask out-of-ord scorer check result scorer isoutoford creat optim collector instanc modifi indexsearch use logic class 'm worri would like verifi searchabl want deprec search method indexsearch searcher searchabl accept weight add new one accept queryweight must follow deprec searchabl favor searcher add searcher new queryweight variant two choic 1 break back-compat add abstract like ve done new collector method 2 add default impl call weight version document becom abstract 3.0 searcher extend unicastremoteobject remotesearch extend searcher 's part 'm littl bit worri searchabl implement java.rmi.remot mean could implement implement searchabl extend someth differ unicastremoteobject like activ think small chanc actual happen would like confirm guy first add deprec package-priv searchablewrapp extend searcher deleg call searchabl member deprec use searchabl add searcher instead default old one use searchablewrapp make necessari chang indexsearch multisearch etc regard overrid new method one optim discuss lucene-1593 expos topscor api weight return scorer score collector call addit add start method disi allow scorer initi either start score collector propos main bs bs2 check initi everi call next skipto score person prefer see separ issu follow one might add method queryweight
copy/paste-typo tostr spanqueryfilt public string tostr return querywrapperfilt queri return spanqueryfilt queri say
logmergepolici use number delet doc decid segment merg found indexwriter.optim int method pick larg segment lot delet even doc delet exist segment affect queri perform signific creat index 1 million doc went doc updat thousand time ran optim 20 occasion saw larg segment doc delet although segment valid doc remain directori long time segment compar bigger size creat logmergepolicy.findmergeforoptim use size segment take number delet document consider decid segment merg simpl fix use delet count calibr segment size creat patch
thread safeti issu caus index corrupt autocommit=tru multipl thread commit present 2.9 trunk sinc lucene-1516 commit believ 's rare hit happen multipl call commit flight differ thread least one call due merg call commit autocommit true strike leav index corrupt incorrect remov activ segment caus except like code java.io.filenotfoundexcept _1e.fnm org.apache.lucene.store.mockramdirectory.openinput mockramdirectory.java:246 org.apache.lucene.index.fieldinfos. init fieldinfos.java:67 org.apache.lucene.index.segmentreader.initi segmentreader.java:536 org.apache.lucene.index.segmentreader.get segmentreader.java:468 org.apache.lucene.index.segmentreader.get segmentreader.java:414 org.apache.lucene.index.indexwrit readerpool.get indexwriter.java:641 org.apache.lucene.index.indexwrit readerpool.get indexwriter.java:627 org.apache.lucene.index.documentswriter.applydelet documentswriter.java:923 org.apache.lucene.index.indexwriter.applydelet indexwriter.java:4987 org.apache.lucene.index.indexwriter.doflushintern indexwriter.java:4165 org.apache.lucene.index.indexwriter.doflush indexwriter.java:4025 org.apache.lucene.index.indexwriter.flush indexwriter.java:4016 org.apache.lucene.index.indexwriter.closeintern indexwriter.java:2077 org.apache.lucene.index.indexwriter.clos indexwriter.java:2040 org.apache.lucene.index.indexwriter.clos indexwriter.java:2004 org.apache.lucene.index.teststressindexing2.indexrandom teststressindexing2.java:210 org.apache.lucene.index.teststressindexing2.testmulticonfig teststressindexing2.java:104 code 's caus fail increment changecount insid synchron block segmentinfo chang commitmerg fix simpl plan commit short
intermitt failur testindexwrit testrandomiwread rare test ad lucene-1516 fail mockramdirectory.clos file close eg code junit note random seed testcas testrandomiwread -5001333286299627079 junit junit testcas testrandomiwread org.apache.lucene.index.teststressindexing2 caus error junit mockramdirectori close still open file _cq.tvx=3 _cq.fdx=3 _cq.tvf=3 _cq.tvd=3 _cq.fdt=3 junit java.lang.runtimeexcept mockramdirectori close still open file _cq.tvx=3 _cq.fdx=3 _cq.tvf=3 _cq.tvd=3 _cq.fdt=3 junit org.apache.lucene.store.mockramdirectory.clos mockramdirectory.java:292 junit org.apache.lucene.index.teststressindexing2.testrandomiwread teststressindexing2.java:66 junit org.apache.lucene.util.lucenetestcase.runtest lucenetestcase.java:88 code
mockramdirectori use unit test synchron problem come failur earwin note java-dev morn rework synchron mockramdirectori
correct spatial trie document link javadoc site updat site doc chang site javadoc lucen 2.9 add spatial contrib javadoc add trie packag contrib/queri packag chang prevent pacakg apear core 's pacakg list javadocs/al homepag also adjust document page reflect chang commit attach patch nobodi object
indexwriter.addindexesnooptim ignor compound file set destin index indexwriter.addindexesnooptim directori ignor compound file set destin index use compound file flag segment sourc index sometim caus undesir increas number file destin index non-compound file index ad merg kick
use reusabl collat key icucollationfilt icucollationfilt need creat new collationkey object token icu mechan use reusabl key
enabl multitermqueri 's constant score mode also use booleanqueri hood multitermqueri use via one subclass eg wildcardqueri prefixqueri fuzzyqueri etc ask use constant score mode pre-build filter wrap filter constantscorequeri n't set instead build potenti massiv booleanqueri one claus per term limit approach score return booleanqueri often quit meaningless app one abl use booleanqueri yet get constant score back though vagu rememb least one exampl someon rais score use result booleanqueri easili mani claus throw extrem confus except newish user 'd better freedom pick build filter front vs build massiv booleanqueri constant score enabl differ perform tradeoff constant score mode openbitset alway use yet spars bit set give good perform think could address issu give booleanqueri constant score mode empow multitermqueri constant score mode pick choos whether use booleanqueri vs up-front filter final empow multitermqueri pick best spars vs dens bit set impl
delet document visibl across reopen msrs
querypars throw new except even custom pars logic threw better one subclass querypars various custom field field contain invalid valu throw subclass parseexcept use messag also localis messag problem lucen 's querypars code catch parseexcept tme rethrow includ origin queri throw new parseexcept pars +query+ tme.getmessag code thus nice use parseexcept thrown away replac one inform 's actual wrong queri append getmessag n't localis also throw away under caus except patch copi simpli remov four line caller know queri string copi pass error messag use furthermor queri string big user want know whole queri bad part bad
indexreader.undeleteal mess delet count store segment file spinoff lucene-1474 ll attach test case show issu
clone reopen indexread pend chang new reader n't commit chang work lucene-1647 came across issu fail carri haschang norms/deletionsdirti etc clone new reader
make indexreader.open alway return msr simplifi re- open per discuss mail list 'm make directoryindexreader.open alway return msr even single-seg index theoret valid past make sure keep index constant optim featur made practic obsolet per-seg collect patch somewhat de-hairi re- open logic msr/sr sr longer need abil pose toplevel directory-own ir relat logic move dir msr dir becom almost empti copi two three remain field msr/sr remov lot test fail reli sr return ir.open fix introduc sr.getonlysegmentread static package-priv method previous bug uncov one fix lucene-1645 anoth partial fix lucene-1648 fix patch
chang datetool creat calendar everi call datetostr timetostr datetool creat calendar instanc everi call datetostr timetostr specif timetostr call calendar.getinst everi call datetostr call timetostr date.gettim instanti new date think chang order call call round call timetostr creat calendar instanc creat anoth calendar instanc seem synchron method creat calendar instanc static solv
includ diagnost per-seg write new segment would help segment index includ diagnost inform current version lucen eg lucene-1474 would help see certain segment written 2.4.0 start current version could also consid make extens could provid arbitrari diagnost segmentinfo/ public think api would one-way 'd use checkindex check later could wait extens provid consist way access per-seg detail index
remov 1.5 unit test code snuck tri run unit test w/ java 1.4.2 hit code common.compile-test mkdir creat dir /lucene/src/diagnostics.1654/build/classes/test javac compil 191 sourc file /lucene/src/diagnostics.1654/build/classes/test javac /lucene/src/diagnostics.1654/src/test/org/apache/lucene/index/testindexwriterreader.java:26 packag java.util.concurrent.atom exist javac import java.util.concurrent.atomic.atomicinteg javac javac /lucene/src/diagnostics.1654/src/test/org/apache/lucene/index/testindexwriterreader.java:262 resolv symbol javac symbol class atomicinteg javac locat class org.apache.lucene.index.testindexwriterreader.deletethread javac atomicinteg delcount new atomicinteg javac javac /lucene/src/diagnostics.1654/src/test/org/apache/lucene/index/testindexwriterreader.java:332 resolv symbol javac symbol class atomicinteg javac locat class org.apache.lucene.index.testindexwriterreader.adddirectoriesthread javac atomicinteg count new atomicinteg 0 javac javac /lucene/src/diagnostics.1654/src/test/org/apache/lucene/index/testindexwriterreader.java:333 resolv symbol javac symbol class atomicinteg javac locat class org.apache.lucene.index.testindexwriterreader.adddirectoriesthread javac atomicinteg numaddindexesnooptim new atomicinteg 0 javac javac /lucene/src/diagnostics.1654/src/test/org/apache/lucene/index/testindexwriterreader.java:262 resolv symbol javac symbol class atomicinteg javac locat class org.apache.lucene.index.testindexwriterreader.deletethread javac atomicinteg delcount new atomicinteg javac javac /lucene/src/diagnostics.1654/src/test/org/apache/lucene/index/testindexwriterreader.java:332 resolv symbol javac symbol class atomicinteg javac locat class org.apache.lucene.index.testindexwriterreader.adddirectoriesthread javac atomicinteg count new atomicinteg 0 javac javac /lucene/src/diagnostics.1654/src/test/org/apache/lucene/index/testindexwriterreader.java:333 resolv symbol javac symbol class atomicinteg javac locat class org.apache.lucene.index.testindexwriterreader.adddirectoriesthread javac atomicinteg numaddindexesnooptim new atomicinteg 0 javac javac /lucene/src/diagnostics.1654/src/test/org/apache/lucene/search/testsort.java:932 resolv symbol javac symbol method getsimplenam javac locat class java.lang.class javac assertequ actualtfcclass j tdc.getclass .getsimplenam javac javac /lucene/src/diagnostics.1654/src/test/org/apache/lucene/search/testtopscoredoccollector.java:70 resolv symbol javac symbol method getsimplenam javac locat class java.lang.class javac assertequ actualtsdcclass tdc.getclass .getsimplenam javac javac note input file use overrid deprec api javac note recompil -deprec detail javac 9 error code
sort field indexsearch comput score default 2.9 ve ad abil turn score maxscor trackscor separ sort field expect app n't use score sort field 's sizabl perform gain score think 2.9 score default add show chang enabl score reli object ll commit chang day two 's trivial
make boolean readon requir arg indexreader.open app n't need read/writ indexread readon indexread better concurr perform 'd love simpli default readon true 'd specifi fals want read/writ reader think 's natur default think 'd break mani back-compat case workaround make paramet explicit 2.9 think even indexsearch 's method open indexread hood also make paramet explicit
absorb niofsdirectori fsdirectori think whether one use java.io vs java.nio eventu java.nio2 mean under-the-hood implement detail fsdirectori n't merit whole separ class think fsdirectori core class one use one 's index filesystem 'd like deprec niofsdirectori absorb fsdirectori add set usenio fsdirectori default true non-window oss give far better concurr perform platform window due known sun jre issu http //bugs.sun.com/bugdatabase/view_bug.do bug_id=6265734
make stopfilter.enablepositionincr explicit think default true ie lose inform filter preserv posit origin token ca n't chang without break back-compat workaround make paramet explicit one must decid front
chang visibl getcompar method sortfield protect public hi current 'm use sortfield creation fieldcompar ran issu invok sortfield.getcompar direct code forc use workaround subclass sortfield overrid getcompar method visibl public 'm propos make method public current see problem chang visibl public know reason method current protect think cleaner solut workaround use also develop benefit also attach patch issu base code trunk 26th may place pleas let know thought cheer martijn
consolid fieldcach extendedfieldcach instanc 's confus error prone two instanc fieldcach fieldcach .default extendedfieldcach .ext_default accident use wrong one silent doubl memori usag field sinc extendedfieldcach extend fieldcach 's reason share instanc across
document bug 2.4.1 queri parser syntax wiki page say 1.9 page http //lucene.apache.org/java/2_4_1/queryparsersyntax.html say .bq page provid queri parser syntax lucen 1.9 use differ version lucen pleas consult copi docs/queryparsersyntax.html distribut version use mislead doc page 2.4.1
remov sortfield.auto 'd like remov sortfield.auto 's danger lucen guess type field base first term encount easili wrong whether 's wrong right could sudden chang index differ document unexepct bind sortfield need indexread guess 's caus various problem past recent lucene-1656 fix issues/mak improv 'd prefer user lucen 's field sort explicit type lucen cast field someday option strong er type lucen 's field type inform would alreadi known meantim think user explicit
constant caus nullpointerexcept fetch metadata implement version manifest manifest.mf file contain metadata implementation_vers null valu return caus nullpointerexcept commit except thread main java.lang.nullpointerexcept org.apache.lucene.store.indexoutput.writestr indexoutput.java:109 org.apache.lucene.store.indexoutput.writestringstringmap indexoutput.java:229 org.apache.lucene.index.segmentinfo.writ segmentinfo.java:558 org.apache.lucene.index.segmentinfos.writ segmentinfos.java:337 org.apache.lucene.index.segmentinfos.preparecommit segmentinfos.java:808 org.apache.lucene.index.indexwriter.startcommit indexwriter.java:5319 org.apache.lucene.index.indexwriter.preparecommit indexwriter.java:3895 org.apache.lucene.index.indexwriter.commit indexwriter.java:3956 happen build jar assembl use maven origin manifest.mf lucen jar overwritten n't contain anynor implement version metadata path attach
trunk fail test fsd.open relat junit testcas testreadafterclos org.apache.lucene.index.testcompoundfil fail junit expect readbyt throw except junit junit.framework.assertionfailederror expect readbyt throw except junit org.apache.lucene.index.testcompoundfile.demo_fsindexinputbug testcompoundfile.java:345 junit org.apache.lucene.index.testcompoundfile.testreadafterclos testcompoundfile.java:313 junit org.apache.lucene.util.lucenetestcase.runtest lucenetestcase.java:88 one non-bug ask test fail simplefsd system fsd.open creat mmapd one close read succeed junit standard output junit thread thread-34,5 main exc junit java.nio.bufferunderflowexcept junit java.nio.buffer.nextgetindex buffer.java:474 junit java.nio.directbytebuffer.get directbytebuffer.java:229 junit org.apache.lucene.store.mmapdirectori mmapindexinput.readbyt mmapdirectory.java:67 junit org.apache.lucene.store.checksumindexinput.readbyt checksumindexinput.java:36 junit org.apache.lucene.store.indexinput.readint indexinput.java:70 junit org.apache.lucene.index.segmentinfos.read segmentinfos.java:238 junit org.apache.lucene.index.directoryindexread 1.dobodi directoryindexreader.java:106 junit org.apache.lucene.index.segmentinfo findsegmentsfile.run segmentinfos.java:699 junit org.apache.lucene.index.directoryindexreader.open directoryindexreader.java:126 junit org.apache.lucene.index.indexreader.open indexreader.java:374 junit org.apache.lucene.index.indexreader.open indexreader.java:260 junit org.apache.lucene.search.indexsearcher. init indexsearcher.java:76 junit org.apache.lucene.index.teststressindex searcherthread.dowork teststressindexing.java:109 junit org.apache.lucene.index.teststressindex timedthread.run teststressindexing.java:52 junit note random seed testcas teststressindexandsearch -7374705829444180151 junit junit testcas teststressindexandsearch org.apache.lucene.index.teststressindex fail junit null junit junit.framework.assertionfailederror junit org.apache.lucene.index.teststressindexing.runstresstest teststressindexing.java:155 junit org.apache.lucene.index.teststressindexing.teststressindexandsearch teststressindexing.java:178 junit org.apache.lucene.util.lucenetestcase.runtest lucenetestcase.java:88 one suce sometim sometim most fail obvious link switch mmapd real caus n't know junit standard output junit note random seed testcas testsetbuffers 8481546620770090440 junit junit testcas testsetbuffers org.apache.lucene.store.testbufferedindexinput caus error junit org.apache.lucene.store.mmapdirectori mmapindexinput cast org.apache.lucene.store.bufferedindexinput junit java.lang.classcastexcept org.apache.lucene.store.mmapdirectori mmapindexinput cast org.apache.lucene.store.bufferedindexinput junit org.apache.lucene.store.testbufferedindexinput mockfsdirectory.tweakbuffers testbufferedindexinput.java:226 junit org.apache.lucene.store.testbufferedindexinput.testsetbuffers testbufferedindexinput.java:181 junit org.apache.lucene.util.lucenetestcase.runtest lucenetestcase.java:88 broken assumpt
cosmet javadoc updat ve taken liberti make cosmet updat various javadoc mergepolici minor cosmet chang logmergepolici minor cosmet chang indexwrit major cleanup class descript chang anchor javadoc link work eclips content chang attach diff svn r780545 would appreci whomev goe let know issu paramet choic correct yeah blame ocd 's practical/conveni way send pleas let know
deprec string/fil ctors/open indexreader/indexwriter/indexsearch investig lucene-1658 found even lucene-1453 complet fix 1658 deprec fsdirectory.getdirectori static factori use anymor user free choos correct directori implement use direct instanti use fsdir.open longer use ctors/method indexwriter/indexreader/indexsearch co. simpli take path name string file alway instanti directori lucene-1453 current work cach directori implement fsdir.getdirectori uncach non refcount fsdir sometim reopen close directori far see segmentread chang multisegmentread and/or delet appli hard track lucen 3.0 remov whole bunch closedirectori parameters/field class simpli care anymor close directori remov closedirectori paramet 3.0 also fix 1453 correct addit idea would chang factori take file/str return indexread wrap filteredindexread keep track close under directori close reopen simplier pass boolean differ directoryindexread instanc small perform impact wrap filterindexread bad method deprec state better user factori method directori paramet
move trierang core trierang iter mani time seem stabl lucene-1470 lucene-1582 lucene-1602 lot user interest solr ad default fieldtyp solr-940 possibl want move core releas 2.9 done thing think class call longtrierangequeri inttrierangequeri call core would suggest leav hand keep numer queri implement could call longrangequeri intrangequeri numericrangequeri see problem tokenstream filter mayb pair class index search move one class numerictokenstream numericrangequeri numericrangefilt problem ctor must abl pass int long doubl float rang paramet end user mix 4 type one class hard handl somebodi forget add l long sudden instanti int version rang queri hit result type mayb accept java.lang.numb paramet nullabl half-open bound one enum type trieutil move o.a.l.util document move tokenstream o.a.l.analysi shiftattribut o.a.l.analysis.tokenattribut somewher els renam class solr stay trie differ impl mayb add subclass abstractfield automat creat tokenstream omit norms/tf per default easier addit document instanc
add link releas archiv would nice releas page|http //lucene.apache.org/java/docs/releases.html contain link releas archiv http //archive.apache.org/dist/lucene/java/
new token filter ad payload in-stream tokenfilt abl split token base delimit use one part token part payload allow someon includ payload inlin token presum setup pipelin ahead time exampl apropo given delimit could stream look like quot quick|jj red|jj fox|nn jumped|vb lazy|jj brown|jj dogs|nn quot case would produc token payload assum whitespac token token payload null token quick payload jj token red pay jj patch also support pluggabl encod payload convert charact array byte array appropri
remov gcj indexread special special outdat unsupport probabl pointless due speed modern jvms bet nobodi use mike said go ask peopl java-us anybodi repli need give noth make segmentread instanti code look real ugli nobodi object 'm go post patch remov lucen
deprec analyzer.tokenstream addit reusabletokenstream core analyz unfortun broke back compat extern subclass http //www.nabble.com/extending-standardanalyzer-considered-harmful-td23863822.html upgrad subclass would silent use anymor sinc lucen 's index invok reusabletokenstream think least deprec analyzer.tokenstream today user see deprec warn class overrid method go forward want chang api core class extend think introduc entir new class keep back compat
make wildcardtermenum differ non-fin method wildcardtermenum differ declar final found use subclass wildcardtermenum implement differ score exact vs. partial match chang rather trivial attach guess could make life easier coupl user attach two patch one contain singl chang make differ non-fin wildcardtermenum.patch one also contain minor cleanup wildcardtermenum remov unnecessari member initi made final wildcardtermenum_cleanup.patch thank simon
make prefixlength access prefixtermenum subclass prefixtermenum differ offer way influenc score base differ prefix term term enumer effect use facil length prefix access subclass current prefix term privat prefixtermenum ad getter prefix length made prefixtermenum endenum prefixtermenum termcompar final consist termenum subclass patch attach simon
docvalu infinit loop caus call getminvalu getmaxvalu getaveragevalu org.apache.lucene.search.function.docvalu offer 3 public option method access valu statist like min max averag valu intern valu call one method result infinit loop intern counter increment ad testcas javadoc slight differ implement guess break back compat call method would caus infinit loop anyway chang return valu method float.nan docvalu implement contain valu might consider fix 2.4.2 2.3.3
unit test use privat directori affect unit test run ant test ant test-tag concurr test fals failur eg testpayload use fix test directori filesystem test ve ad simpl method _testutil get temp dir switch test ve hit fals failur
regexqueri match term input regex n't actual match write unit test wrapper around lucen regex class got trip someth interest regex cat match cat also anyth cat 1+ follow letter e.g cathi catcher implicit alway ad end regex 's unit test behaviour would expect test public void testnecess throw except file dir new file new file system.getproperti java.io.tmpdir index indexwrit writer new indexwrit dir new standardanalyz true tri document doc new document doc.add new field field cat cat cathi field.store.y field.index.token writer.adddocu doc final writer.clos indexread reader indexreader.open dir tri termenum term new regexqueri new term field cat .getenum reader assertequ wrong term cat terms.term assertfals one term terms.next final reader.clos test fail term check terms.term equal cathi workaround mangl queri like string fix string.format origin
add matchvers standardanalyz think add matchvers arg standardanalyz allow us fix bug new user keep precis back compat user upgrad ve discuss java-dev 'd like make concret patch attach think actual work well simpl tool help us carri back-compat polici code exampl standardanalyz ctor take requir arg version matchvers pass version.lucene_curr alway get late greatest eg version.lucene_24 match 2.4 's bugs/settings/behavior standardaalyz condition replac invalid acronym enabl posit increment stopfilt base matchvers also prevent creat zillion ctor time need chang set class eg standardanalyz 2 set version depend 's least anoth 2 issu open fix bug migrat also clean 'd add class need basi first releas add arg default remain back compat prior releas go forward free fix issu class condition matchvers javadoc top standardanalyz clear call version specif behavior done code p must specifi requir link version compat creat standardanalyz ul li 2.9 stopfilt preserv posit increment default li 2.9 token incorrect idenfi acronym correct see href= https //issues.apache.org/jira/browse/lucene-1068 lucene-1608 /a /ul code
make highlight use spanscor default ve alway thought made sens frank took year get spanscor includ lucen pretti much readi move got rather push default think make sens default solr well mention back put ala option well highlight packag back compat req custom conserv one reason hav n't push chang might best actual make switch 3 could go either way know bunch peopl use 'm bet larg minor never list chang entri lia 1 pretti much stumbl upon figur ll point fast standard scorer claus queri posit sensit posit sensit queri claus obvious somewhat slower highlight highlight correct rather ignor posit
remov unnecessari null check findsegmentsfil cleanup findsegmentsfil access member directori line 579 perform null check 592 null check unnecessari directori null line 579 would throw npe remov null check made member directori final addit ad null check constructor valu null catch asap
remov extendedfieldcach roll function fieldcach silli extendedfieldcach workaround suppos back compat problem patch merg extendedfieldcach interfac fieldcach therebi break back compat creat much simpler api fieldcach
deprec stopanalyz english_stop_word general replac immut set stopanalyz standartanalyz use static final array english_stop_word default various place intern array convert mutabl set look kind weird think way go deprec use static final array replac immut implement chararrayset insid analyz make sens mutabl set anyway could prevent set creation time analyz creat case immut set wo n't multithread issu either essenc get rid fair bit convert string array set code public static refer array mutabl reduc overhead analyz creation let know think creat patch simon
contrib analyz need test analyz contrib need test prefer one test behavior token attribut involv offset type etc token text way convert new api without breakag
attributesource/tokenstream api improv patch make follow improv attributesourc tokenstream/filt introduc interfac attribut correspond implement postfix impl e.g termattribut termattributeimpl attributesourc factori creat attribut instanc default implement look implement class postfix impl token implement 6 tokenattribut interfac new method ad attributesourc addattributeimpl attributeimpl use reflect walk class hierarchi pass object find interfac class superclass implement extend attribut interfac add interface- instanc map attribut map found interfac remov set/getusenewapi method includ standard one instead enough implement new api one old tokenstream implement still old api next /next token wrap automat deleg path determin via reflect patch determin three method overridden token longer deprec instead implement 6 standard token interfac see wrapper next next token use automat map attribut interfac one tokenwrapp instanc implement 6 interfac contain token instanc next next token exchang inner token instanc need new incrementtoken one tokenwrapp instanc visibl deleg currect reusabl token api also preserv custom token subclass mayb creat special token stream see exampl backwards-test attributeimpl default implement tostr use reflect print valu attribut default format make bit easier implement attributeimpl tostr declar abstract clone done much effici capturest method figur uniqu attributeimpl instanc contain valu attribut map one need clone creat singl link list support deep clone inner class attributesource.st attributesourc keep track state chang i.e whenev new attribut ad attributesourc case capturest recomput state otherwis simpli clone precomput state return clone restorest attributesource.st walk link list use copyto method attributeimpl copi valu attribut sourc stream e.g sinktoken use tee- sinktoken deprec use token instanc cach compat new api use attributesource.st object still use old deprec one new featur provid new attribut type may get lost chain replac new teesinktokenfilt factori creat new sink instanc compat attribut sink instanc creat one tee also ad anoth tee long attribut implement compat possibl add sink tee use one token instanc tee use six separ attribut impl case uoe thrown clone perform great improv multipl attributeimpl instanc use one tokenstream user e.g simpli add token instanc stream instead individu attribut user could implement subclass attributeimpl implement exact attribut interfac need think consid expert api addattributeimpl manual optim need clone perform crucial ran quick perform test use tee/sink token clone perform rough 20 faster new api ll run perform test post number note also add serial attribut e.g support store serial tokenstream index serial benefit even signific new api clone issu contain one backwards-compat break tokenstreams/filters/token normal final see lucene-1753 explain core class final one could overrid next next token method case backwards-wrapp would automat use incrementtoken implement overridden method never call prevent user error visibl compil test stream behav wrong patch make implement method final next next token incrementtoken whenev class itsself final bw break user clear see done someth unsupoort better creat custom tokenfilt addit implement instead extend core implement chang contrib token stream follow proceder use rewrit replac next token /next implement new api class final next token /next method need must remov class non-fin add follow method class code java deprec remov lucen 3.0 method final overridden deleg backward compat layer public final token next final token reusabletoken throw java.io.ioexcept return super.next reusabletoken deprec remov lucen 3.0 method final overridden deleg backward compat layer public final token next throw java.io.ioexcept return super.next code also incrementtoken method must final case new method end lucene-1448
queri mergebooleanqueri argument type booleanqueri instead queri method mergebooleanqueri accept queri cast element booleanqueri without check guarante classcastexcept boolean queri enforc chang signatur wo n't realli break back compat work instanc booleanqueri
updat highlight use new tokenstream api
ad new token api impl asciifoldingfilt ad implement incrementtoken asciifoldingfilter.java extend exist testcas attach patch short besid improv would like start small discuss filter asciifoldingfitl meant replac isolatin1accentfilt quit nice cover superset latter use filter quit often never basi case filter correct thing replac special char ascii correspond case like german umlaut return expect result german umlaut like ? translat rather ae would like chang n 100 sure expect user filter anoth way would make configur flag would affect perform check umlaut char found would realli help filter could inject original/unmodifi token posit increment token stream demand think valid use-cas index modifi unmodifi token instanc german word s?1d would fold sud queri q s?1d filter would also fold sud therefor find sud total differ mean fold work quit well special case would could add option make user life easier latter could done subclass umlaut problem fix base class simon
field tokenstream usabl store field field.tokenstream usabl index even store valu use mani type pre-analyz valu text/numb etc http //search.lucidimagination.com/search/document/902bad4eae20bdb8/field_tokenstreamvalu
logmergepolicy.findmergestoexpungedelet need get delet segmentread lucene-1516 delet carri segmentread mean implement mergepolicy.findmergestoexpungedelet logmergepolici need obtain delet info sr instead segmentinfo wo n't inform
add numericfield make plain text numer parser public fieldcach move trie parser fieldcach discuss lucene-1673 mike want add new numericfield o.a.l.docu specif easi index altern would add numericutils.newxxxfield factori creat preconfigur field instanc norm tf option store text lucene-1699 tokenstream alreadi initi hand numericutils.newxxxsortfield could move numericsortfield yonik tend use factori mike tend creat new class also parser string-format numer public fieldcach new sortfield api lucene-1478 make possibl support parser sortfield instanti would good static parser fieldcach public avail sortfield would init member variabl instead null make code lot easier fieldcompar ugli null check retriev valu cach move trie parser also static instanc fieldcach would make code cleaner would abl hide hack stopfillcacheexcept make privat fieldcach current public numericutil o.a.l.util
thai token type bug ad test offset type thaianalyz discov type thai numer digit correct thaianalyz use standardtoken realli issu grammar add entir thai block alphanum propos alphanum describ littl bit differ grammar instead letter allow diacritics/signs/combin mark attach would allow thai hack complet remov would allow standardtoken pars complex write system indian languag would fix lucene-1545
add waitformerg method indexwrit would use waitformerg method indexwrit right way see achiev call indexwriter.clos ideal would method indexwrit wait merg without actual close index would make background merg optim wait without close indexwrit reopen new indexwrit close reopen indexwrit method problemat close fail write lock wo n't releas could result follow sequenc close fail forc unlock write lock per close document new indexwrit acquir write lock final old indexwrit releas write lock index lock anoth indexwrit point directori could open n't forc unlock write lock open new indexwrit fail garbag collect call final old indexwrit waitformerg method avail would like never need close indexwrit right process shutdown issu would occur worst case scenario waitformerg fail
org.apache.lucene.ant.htmldocu ad tidi config file passthrough avail pars html document use org.apache.lucene.ant.htmldocument.docu method result mani error messag line 152 column 725 error as-html recogn document error must fix use html tidi generat tidi version solut configur tidi accept abnorm tag ad tag name new-inline-tag option tidi config file command line make sens context like new-inline-tag as-html tidi need know configur file new constructor document method ad code code construct code htmldocument /code link java.io.fil param file code file /code contain html pars param tidyconfigfil code string /code contain full path tidi config file except ioexcept i/o except occur public htmldocument file file string tidyconfigfil throw ioexcept tidi tidi new tidi tidy.setconfigurationfromfil tidyconfigfil tidy.setquiet true tidy.setshowwarn fals org.w3c.dom.docu root tidy.parsedom new fileinputstream file null rawdoc root.getdocumentel creat lucen code document /code link java.io.fil param file param tidyconfigfil full path tidi config file except ioexcept public static org.apache.lucene.document.docu document file file string tidyconfigfil throw ioexcept htmldocument htmldoc new htmldocument file tidyconfigfil org.apache.lucene.document.docu lucenedoc new org.apache.lucene.document.docu lucenedoc.add new field titl htmldoc.gettitl field.store.y field.index.analyz lucenedoc.add new field content htmldoc.getbodi field.store.y field.index.analyz string content null bufferedread br new bufferedread new fileread file stringwrit sw new stringwrit string line br.readlin line null sw.write line line br.readlin br.close content sw.tostr sw.close lucenedoc.add new field rawcont content field.store.y field.index.no return lucenedoc code use work fine configur file pass tidi abl index thousand html page tidi tag error
add deletealldocu method indexwrit ideal would deletealldocu clear method indexwrit method perform characterist currentwriter.clos currentwrit new indexwrit create=tru would great optim delet document case use deletedocu new matchalldocsqueri could expens given larg exist index indexwriter.deletealldocu semant commit far index visibl goe new indexread open would get empti index see previous ask lucene-932 howev would nice final see ad indexwrit would need close perform clear seem general recommend work indexwrit deletealldocu method abort background merg pointless deleteal receiv write new segment file referenc segment method would remov one final reason would ever need close indexwrit reopen new one
site search power lucene/solr number year lucen communiti critic eat dog food come search compani built host site search http //www.lucidimagination.com/search power apach solr lucen 'd like donat 's use lucen communiti addit allow one search lucen content singl place includ web wiki jira mail archiv see also http //www.lucidimagination.com/search/document/bf22a570bf9385c7/search_on_lucene_apache_org see live mahout tika solr lucid fault toler setup replic fail well monitor servic place commit maintain expand search capabl site follow patch add skin forrest site enabl lucen site search lucen content use lucene/solr search submit automat select lucen facet lucen content search user narrow/broaden search criteria plan commit 3 4 day
n't use ensureopen excess indexread indexwrit spin http //www.nabble.com/excessive-use-of-ensureopen -td24127806.html stop call method 's necessari intern lucen code current code seem hurt proper written app unnecessarili post patch soon
improv use isdelet index code spin http //www.nabble.com/some-thoughts-around-the-use-of-reader.isdeleted-and-hasdeletions-td23931216.html two chang optim segmentmerg work reader delet indexreader.docu longer check document delet post patch short
parallel test lucen test parallel make faster test system task ant use http //ant.apache.org/manual/coretasks/parallel.html previous discuss http //www.gossamer-threads.com/lists/lucene/java-dev/69669 note mike m. quot 'd love see clean solut test embarrass paralleliz machin good concurr day rather hack solut use -dtestpackage=xxx split test ideal would abl say use n thread 'd right thing like -j flag make quot
set default precisionstep numericfield numericrangefilt spinoff lucene-1701 user use numeric* need understand what hood order index search abl simpli code doc.add new numericfield price 15.50 code decent default precisionstep select actual add ctor numericfield support type code work set default per-typ think 4 int 6 long propos good default default need perfect advanc user alway optim precisionstep user experienc slow rangequeri perform numericrangequeri default discuss much faster
renam rangequeri termrangequeri sinc numericrangequeri lucene-1701 renam rangequeri textrangequeri make clear textrangequeri termrangequeri stringrangequeri base entir text comparison exist user upgrad 2.9 use rangequeri slow numer search would realiz good option numer rang search
writelinedoctask incorrect normal field writelinedoctask normal bodi titl date field replac \t space howev one contain newlin linedocmak fail sinc first line read includ text howev second line expect new document includ part text n't know n't hit far mayb wikipedia text n't line howev ran trec collect hit lot attach patch short
directoryindexread final hold terminfosread longer necessari directoryindexread final method caus jdk keep refer object final segmentread multisegmentread subclass contain refer potenti hundr megabyt cach data terminfosread option would remov final directoryindexread releas write lock moment possibl null refer various close doclos method throughout class hierarchi finaliz object n't refer term array origin mail list messag http //mail-archives.apache.org/mod_mbox/lucene-java-user/200906.mbox/ 3c7a5cb4a7bbce0c40b81c5145c326c31301a62971 numevp06.na.imtn.com 3e
ad norm properti index writer.infostream support benchmark would like add follow support benchmark abil specifi whether norm store index abil specifi whether norm store bodi field assum norm usual store field real life applic make explicit abil specifi infostream indexwrit abil specifi whether index properti return docdata content sourc like trec may includ arbitrari meta tag may want index patch come short
indexwrit proper account ram consum pend delet indexwrit autocommit fals abl carri buffer delet quit time materi docid thus free ram use 's trigger merg commit/clos delet materi ram freed expect practic smallish amount ram still fix n't patch yet someon want grab feel free
indexreader.setterminfosindexdivisor n't carri reopen reader reopen reader segment share thus proper inherit index divisor other newli open use default index divisor way chang index divisor newli open one workaround use reopen alway open new reader 'd like make terminfosdivisor up-front param indexread anyway lucene-1609 like ll fix issu
add javadoc note icucollationkeyfilt 's advantag collationkeyfilt contrib/col 's icucollationkeyfilt use icu4j collat faster collationkeyfilt jvm-provid java.text.col implement packag javadoc class modifi add note effect curios piqu robert muir 's comment|http //issues.apache.org/jira/browse/lucene-1581 focusedcommentid=12720300 action_12720300 lucene-1581 state icucollationkeyfilt 30x faster collationkeyfilt time oper two class sun jvm version 1.4.2/32-bit 1.5.0/32- 64-bit 1.6.0/64-bit use 90k word list 4 languag taken correspond debian wordlist packag truncat first 90k word fix random shuffl use collat default strength window vista 64-bit machin use analysi pipelin consist whitespacetoken chain collat key filter isol time taken collat key filter also time whitespacetoken oper alon combin rightmost column repres perform advantag icu4j implemt icu java.text.col implement jvm discount whitespacetoken time wst jvm-icu icu-wst best time 5 run combin millisecond follow ||sun jvm||language||java.text||icu4j||whitespacetokenizer||icu4j improvement|| |1.4.2_17 32 bit |english|522|212|13|156 |1.4.2_17 32 bit |french|716|243|14|207 |1.4.2_17 32 bit |german|669|264|16|163 |1.4.2_17 32 bit |ukranian|931|474|25|102 |1.5.0_15 32 bit |english|604|176|16|268 |1.5.0_15 32 bit |french|817|209|17|317 |1.5.0_15 32 bit |german|799|225|20|280 |1.5.0_15 32 bit |ukranian|1029|436|26|145 |1.5.0_15 64 bit |english|431|89|10|433 |1.5.0_15 64 bit |french|562|112|11|446 |1.5.0_15 64 bit |german|567|116|13|438 |1.5.0_15 64 bit |ukranian|734|281|21|174 |1.6.0_13 64 bit |english|162|81|9|113 |1.6.0_13 64 bit |french|192|92|10|122 |1.6.0_13 64 bit |german|204|99|14|124 |1.6.0_13 64 bit |ukranian|273|202|21|39
smartchineseanalyz javadoc improv chines english correct match realiti remov sever javadoc warn
keywordtoken proper set end offset keywordtoken set token 's term length attribut appear omit end offset issu discov use highlight keywordanalyz keywordanalyz deleg keywordtoken propag bug junit test sourc also attach exercis various analyz via highlight instanc everi analyz keywordanazlyz success wrap text highlight tag b thetext /b use keywordanalyz tag appear text exampl b /b thetext pleas note newkeywordanalyz newkeywordtoken class use newkeywordanalyz tag proper place around text newkeywordtoken overrid next method keywordtoken set end offset return token newkeywordanalyz util keywordtoken produc proper token unless object glad post patch near futur packag lucen import java.io.ioexcept import java.io.read import org.apache.lucene.analysis.analyz import org.apache.lucene.analysis.keywordanalyz import org.apache.lucene.analysis.keywordtoken import org.apache.lucene.analysis.simpleanalyz import org.apache.lucene.analysis.stopanalyz import org.apache.lucene.analysis.token import org.apache.lucene.analysis.tokenstream import org.apache.lucene.analysis.token import org.apache.lucene.analysis.whitespaceanalyz import org.apache.lucene.analysis.standard.standardanalyz import org.apache.lucene.search.highlight.highlight import org.apache.lucene.search.highlight.queryscor import org.apache.lucene.search.highlight.simplehtmlformatt import org.apache.lucene.search.highlight.weightedterm import org.junit.test import static org.junit.assert public class analyzerbug test public void testwithhighlight throw ioexcept string text thetext weightedterm term new weightedterm 1.0f text highlight highlight new highlight new simplehtmlformatt b /b new queryscor term analyz analaz new standardanalyz new simpleanalyz new stopanalyz new whitespaceanalyz new newkeywordanalyz new keywordanalyz analyz pass except keywordanalyz analyz analaz analaz string highight highlighter.getbestfrag analaz content text assertequ fail analazer.getclass .getnam b text /b highight system.out.println analazer.getclass .getnam pass valu highlight highight class newkeywordanalyz extend keywordanalyz overrid public tokenstream reusabletokenstream string fieldnam reader reader throw ioexcept token token token getprevioustokenstream token null token new newkeywordtoken reader setprevioustokenstream token els tokenizer.reset reader return token overrid public tokenstream tokenstream string fieldnam reader reader return new newkeywordtoken reader class newkeywordtoken extend keywordtoken public newkeywordtoken reader input super input overrid public token next token throw ioexcept token result super.next result null result.setendoffset result.termlength return result
analysi packag call java 1.5 api found compil error tri compil trunk 1.4 jvm org.apache.lucene.analysis.normalizecharmap org.apache.lucene.analysis.mappingcharfilt use character.valueof ad 1.5 ad charactercach testcas valueof method replac quit use method org.apache.lucene.analysis.basetokentestcas use stringbuild instead synchron version stringbuff avail 1.4 attach patch short
benchmark packag use new topfieldcollector also still use auto without resolv result sort algorithm wo n't run auto work topfieldcollector want use auto topfieldcollector convien method call detecttyp sortfield packag protect use stop gap user want mix auto topfieldcollector lucen still handl back compat intern solr got bit switch use topfieldcollector auto resolut ad detecttyp help could n't use due visibl result plugin code use abl use auto would blow n't use auto solr anyway though benchmark packag got bit well move topfieldcollector sort algorithm allow auto specifi left type sort alg fail n't specifi type ll chang requir type specifi get alg work think put auto resolut stop gap till 3.0 auto remov sinc detectfieldtyp packag protect n't want repeat disallow auto seem best way go
order store field maintain note thread http //www.nabble.com/order-of-fields-returned-by-document.getfield 28 29-to21034652.html http //www.nabble.com/order-of-fields-within-a-document-in-lucene-2.4 2b-to24210597.html somewher prior lucen 2.4.1 chang introduc prevent store field document return order origin ad caus serious perform problem peopl attempt use loadfirstfieldselector custom fieldselector load_and_break size_and_break option sinc field n't come back order expect specul email thread origin bug code introduc lucene-1301 purpos issu refactor realli caus chang would seem bug side affect conscious implement chang someon understand index intern investig minimum 's decid actual bug prior resolv bug wiki doc fieldselector javadoc updat make clear order field return
move smartchineseanalyz resourc contrib project smartchineseanalyz depend larg dictionari caus analyz jar grow 3mb dictionari quit big compar resouc class file contain jar separ analyzer-cn contrib project enabl footprint-sensit user e.g use lucen mobil phone includ analyzer.jar without get troubl disk space move smartchineseanalyz separ project could also includ small refactor robert mention lucene-1722|http //issues.apache.org/jira/browse/lucene-1722 sever class packag protect member class could final comment syserr log code remov etc set issu target 2.9 make feel free move 3.0
treccontentsourc use fix encod rather system depend treccontentsourc open inputstreamread w/o fix encod window mean cp1252 least machin ok howev open linux machin w/ default utf-8 fail read file patch chang use iso-8859-1 seem right one http //mg4j.dsi.unimi.it/man/manual/ch01s04.html mention encod exampl script read data patch follow short
charread deleg reset/mark/marksupport final class charread deleg reset/mark/marksupport wrap reader otherwis client get reset support except
datetools.java general improv appli attach patch show improv datetools.java think done logic anyth move instanc method inner class resolut argu object-ori 1 case resolut argument method simpli invok appropri call resolut object former big branch if/els 2 instead synchron use seem everywher synchron use sync object threadsaf dateformat calendar instanc 3 sinc differ dateformat calendar instanc creat per-resolut less lock content sinc thread use differ resolut use lock 4 old implement timetostr round time format 's unnecessari sinc format includ resolut desir 5. round use switch statement benefit fall-through break anoth debat improv could made put resolut instanc array index format length would mean could remov switch lookupresolutionbylength avoid length constant mayb would bit over-engin switch fine
alway use bulk-copi merg store field term vector lucen nice optim place merg store field lucene-1043 term vector lucene-1120 wherebi byte bulk copi new segmetn much faster decod rewrit one document time howev optim rather brittl reli map field name number congruent segment merg unfortun field map congruent app add field precis order document think fix indexwrit assign field number given field assign past ie write new segment pre-se field number base past segment aspect fieldinfo would remain fulli dynam
2.4.x index open 2.9-dev sorri lack proper testcas 2.4.1 creat index stupid option creat .prx file 2.9 expect file open index reason use stupid option chang field indexed=y indexed=no forgot remov .setomittf code public class testcas public static void main string arg throw except run part lucen 2.4.1 indexwrit iw new indexwrit test new whitespaceanalyz indexwriter.maxfieldlength.limit iw.setusecompoundfil fals document doc new document field field1 new field field1 foo field.store.y field.index.no field1.setomittf true 2.9 creat 0-byte .prx file 2.4.x problem 2.9 expect file doc.add field1 iw.adddocu doc iw.clos run lucen 2.9 indexread ir indexreader.open fsdirectory.getdirectori test true code
luc command chang analyz current luc hardcod use standardanalyz provid patch introduc command analyz specifi differ analyz class someth fail standardanalyz fall-back
make mmapdirectory.max_bbuf user configur support chunk index file smaller part followup java-us thred http //www.lucidimagination.com/search/document/9ba9137bb5d8cb78/oom_with_2_9 9bf3b5b8f3b1fb9b easi implement add setter method paramet mmapdir
wrap segmentinfo public class wrap segmentinfo public class subclass mergepolici need org.apache.lucene.index packag
booleanscorer2 fail updat this.doc top scorer booleanscorer2 run top collect loop one score collector method use local doc var ie code public void score collector collector throw ioexcept collector.setscor int doc doc countingsumscorer.nextdoc no_more_doc collector.collect doc code problem child collector call scorer.doc alway get -1 collector n't actual call scorer.doc one import one scorecachingwrapperscor use doc know invalid cach sinc alway return -1 scorecachingwrapperscor keep return score=0.0 caller thus mess sortfield.scor compar instanc 's includ sort field
add abil specifi compilation/match flag regexcapabiltii implement jakarta regexp java util regex packag support abil provid flag alter match behavior given regular express java.util.regex.pattern implement support provid flag part regular express string jakarta regexp implement therefor improv request add capabl provid modif flag either implement ve develop work implement make minor addit exist code default constructor explicit defin argument new constructor addit int flag argument provid provid complet backward compat regexcapabilti implement appropri flag regular express packag defin flags_xxx static field pass under implement re-defin avoid bleed actual implement class caller namespac propos chang javautilregexcapabilities.java follow chang made privat int flag 0 defin option flag pattern use keep pattern contain within class public final int flag_canon_eq pattern.canon_eq public final int flag_case_insens pattern.case_insens public final int flag_com pattern.com public final int flag_dotal pattern.dotal public final int flag_liter pattern.liter public final int flag_multilin pattern.multilin public final int flag_unicode_cas pattern.unicode_cas public final int flag_unix_lin pattern.unix_lin default constructor use java.util.regex.pattern default flag public javautilregexcap this.flag 0 constructor allow modif flag java.util.regex.pattern use compil regular express give user abil fine-tun regular express match functionl need link java.util.regex.pattern pattern class support specifi field via regular express text give caller anoth option modifi behavior use case regular express text modifi undesir flag flag ore togeth public javautilregexcap int flag this.flag flag public void compil string pattern this.pattern pattern.compil pattern this.flag jakartaregexpcapabilties.java follow chang privat int flag re.match_norm flag specifi normal case-sensit match behaviour default public static final int flag_match_norm re.match_norm flag specifi match case-independ fold public static final int flag_match_caseindepend re.match_caseindepend contruct regexcap default match_norm match style public jakartaregexpcap construct regexcap provid match flag multipl flag ore togeth param flag match style public jakartaregexpcap int flag this.flag flag public void compil string pattern regexp new re pattern this.flag
getpayloadspan org.apache.lucene.search.spans.spanqueri abstract spent long time track bug result upgrad lucen 2.4.1 project implement spanqueri written 2.3 sinc project 's spanqueri n't implement getpayloadspan call method went spanquery.getpayloadspan return null caus nullpointerexcept lucen code far away actual sourc problem would much better kind thing show compil time think thank
fieldcach introspect api fieldcach expos expert level api runtim introspect fieldcach provid info fieldcach given moment also provid util method saniti check fieldcach n't contain anyth odd entri reader/field differ types/pars entri field/type/pars reader 's subread etc
incorrect snippet return spanscor problem report custom use solr 1.3 uni-gram reproduc lucen 2.9 whitespaceanalyz panel title=queri f1 b c d f2 b c d f1 b c g f2 b c g panel snippet expect panel x y z b /b b b /b b c /b b d /b e f g b b /b b c /b b g /b panel got panel x y z b /b b c b d /b e f g b b /b b c /b b g /b panel program reproduc problem code public class testhighlight static final string content x y z b c d e f g b c g static final string ph1 b c d\ static final string ph2 b c g\ static final string f1 f1 static final string f2 f2 static final string f1c f1 static final string f2c f2 static final string query_str f1c ph1 f2c ph1 f1c ph2 f2c ph2 static analyz analyz new whitespaceanalyz public static void main string arg throw except querypars qp new querypars f1 analyz queri queri qp.pars query_str cachingtokenfilt stream new cachingtokenfilt analyzer.tokenstream f1 new stringread content scorer scorer new spanscor queri f1 stream fals highlight h new highlight scorer system.out.println queri query_str system.out.println h.getbestfrag analyz f1 content code
make yet final core/contrib tokenstream/filt implement final lucen 's analysi packag design way plug differ *implementations* analysi chain tokenstream tokenfilt analyz build sever tokenstreams/filt token text want modifi behaviour token implement new subclass tokenstream/-filter/token class core correct implement like itsself final implement method final chartoken lot problem backwards-compat lucene-1693 class lucen 's core/contrib yet final keywordtoken declar final implement method final standardtoken declar final implement method final isolatin1filt deprec remov 3.0 noth chartoken abstract base class sever class design correct child class overrid implement chang behaviour final implement contrib check implement class least final design way like chartoken
get rid nonmatchingscor booleanscorer2 lucene-1614 mike made comment remov nonmatchinscor bs2 return null booleanweight.scor ve check easili done 'm go post patch short refer https //issues.apache.org/jira/browse/lucene-1614 focusedcommentid=12715064 page=com.atlassian.jira.plugin.system.issuetabpanel 3acomment-tabpanel action_12715064 ve mark issu 2.9 's small kind relat search enhanc done 2.9
writelinedoctask keep doc w/ titl bodi writelinedoctask throw away document bodi element howev document titl kept document email may bodi legitim ll post patch test case
contrib/memori patternanalyzertest bad unit test work someth els start get consist illegalstateexcept patternanalyzertest run test top level dig test ve found numer thing scari instead use assert test token stream match throw illegalstateexcept n't log bunch info token stream system.out assert messag tell *exactly* doens't match would make lot sens build list file analyz use patsh thta evalu relat current work directori mean get differ file depend wether run test fro mthe contrib level top level build file list file look includ ../../*.txt ../../*.html ../../*.xml get differ result run test contrib vs top level differ peopl rune test via top level build file get differ result depend type text html xml file happen two directori check lucen test comment indic 's purpos show patternanalyz produc token analyz point fail whitespaceanalyz 255 charact token limit whitespacetoken impos test proceed compar paternanalyz whitespacetoken garunte test failur anyon happen text file contain 255 charact non-whitespac row somewher case bookmarks.html file hex encod favicon.gif imag
improv arab analyz light8 light10 someon mention java user list arab analysi good would like patch add ??- prefix light10 algorithm versus light8 algorithm light10 paper improv precis .390 .413 mention statist signific make linguist sens least shown hurt futur hope openrelev allow us tri approach
implement tokenstream.end contrib tokenstream see lucene-1448 mike 's patch alreadi contain necessari fix ll attach patch soon lucene-1460 commit
tokenstream api javadoc improv chang remov experiment warn new tokenstream api improv javadoc deprec token constructor javadoc teesinktokenstream.sinkfilt
slight readabl code token/termattributeimpl big deal growtermbuff int newsiz use correct slight hard follow code method return null hint current termbuff enough space upstream code realloc buffer patch simplifi logic make method realloc buffer noth reduc number null check method reduc amount code test pass also add test new basic attribut impl copi token test
mergepolici requir indexwrit upon construct mergepolici requir iw upon construct requir one pass method arg various method give impress singl mp instanc share across various iw instanc true mps addit logmergepolici use iw instanc pass method incosist current expos potenti npes issu chang mp requir iw instanc howev back-compat reason follow chang made new mp ctor w/ iw arg introduc addit back-compat default ctor also declar assign null member iw method requir iw deprec new one declar back-compat new one made abstract throw uoe comment becom abstract 3.0 current mp impl move use member instanc code call mp method continu use deprec method pass iw even wo n't necessari strict back-compat 3.0 ll remov deprec default ctor method chang code call iw method variant anymor hope n't leav anyth 'm sure ll find work patch
samplecompar n't work well contrib/remot test discov lucene-1749 use ident instanc sortcompar get multipl entri fieldcach demonstr bug current requir patch lucene-1749 see markmil 's comment https //issues.apache.org/jira/browse/lucene-1749 focusedcommentid=12735190 action_12735190
add thread-safeti note indexwrit javadoc indexwrit javadoc contain note thread-safeti alreadi mention wiki faq page essenti inform part modul document
numericrang support new queri parser would good specifi type schema queri parser futur automat creat numericrangequeri differ numer type would possibl index numer valu doubl float long int use numericfield queri parser know type field correct creat numericrangequeri string like 1.567..* 1.787..19.5 current way extract field numer index user configur fieldconfig object confighandl done difficult implement rest differ current handl rangequeri instanti correct queri type convers enter numer valu simpl number.valueof cast user enter number eveneryth els ident numericrangequeri also support mtq rewrit mode mtq anoth thing chang date semant strang flag current parser tell handl date
fix wrong clover analysi backwards-test upgrad clover 2.6.3 better followup http //www.lucidimagination.com/search/document/6248d6eafbe10ef4/build_failed_in_hudson_lucene_trunk_902 problem clover run hudson instrument test ran autodetect clover 1.x abl find file correct test instrument backward test current coverag report backward test run current lucen jar see instal clover start test test-cor clover data ad db backwards-test begin new file creat clover db folder clover 2.x support new ant task testsourc use specifi file test work local clover 2.4.3 produc realli nice coverag report also link test file work tell test fail attach patch chang common-build.xml new clover version initi resourc tell clover find test use test folder include/exclud properti one problem current patch *not* instrument backward branch see coverag core/contrib test get coverag also backward test easi possibl two thing tag test dir easi find add testsourc element may one test name bw branch ident trunk test complet corrupt linkag test code coverag report principl best would generat second coverag report backward branch separ clover db attach patch instrument bw branch trunk test
enwikiquerymak
use explain may doubl ram req fieldcach use valuesourcequery/customscorequeri constantscorequeri use cach filter
add benchmark task fastvectorhighlight
chang remain contrib streams/filt use new tokenstream api contrib streams/filt alreadi convert lucene-1460 two shingl filter last one need convert
nearspansord lazi load payload payloadspan javadoc impli best would lazi load n't see current algorithm short add option ignor payload otherwis non payload search payload present needless load alreadi ad lucene-1748 spin issu patch follow lucene-1748 commit
add log.step support per task follow lucene-1774 add support log.step per task name rather singl log.step set task .alg file support log.step task log.step. task class name specif task exampl log.step.adddoc log.step.deletedoc post patch soon
remov unus numslotsful fieldcomparator.setnextread param relic older optim ve sinc turn 's quit confus n't think need n't releas api yet re free remov
deprec scorer.explain spinoff lucene-1749 alreadi queryweight.explain direct invok indexsearcher.explain queri turn defer scorer impl 's explain mani scorer.explain simpli throw uoe deprec remov scorer.explain leav individu queri defin method need
larg distanc spatial go beyond prime meridian http //amidev.kaango.com/solr/core0/select fl=* json.nl=map wt=json radius=5000 rows=20 lat=39.5500507 q=honda qt=geo long=-105.7820674 get error use solr distanc calcul boundari box past 90 degre aug 4 2009 1:54:00 pm org.apache.solr.common.solrexcept log sever java.lang.illegalargumentexcept illeg lattitud valu 93.1558669413734 org.apache.lucene.spatial.geometry.floatlatlng. init floatlatlng.java:26 org.apache.lucene.spatial.geometry.shape.llrect.createbox llrect.java:93 org.apache.lucene.spatial.tier.distanceutils.getboundari distanceutils.java:50 org.apache.lucene.spatial.tier.cartesianpolyfilterbuilder.getboxshap cartesianpolyfilterbuilder.java:47 org.apache.lucene.spatial.tier.cartesianpolyfilterbuilder.getboundingarea cartesianpolyfilterbuilder.java:109 org.apache.lucene.spatial.tier.distancequerybuilder. init distancequerybuilder.java:61 com.pjaol.search.solr.component.localsolrquerycomponent.prepar localsolrquerycomponent.java:151 org.apache.solr.handler.component.searchhandler.handlerequestbodi searchhandler.java:174 org.apache.solr.handler.requesthandlerbase.handlerequest requesthandlerbase.java:131 org.apache.solr.core.solrcore.execut solrcore.java:1328 org.apache.solr.servlet.solrdispatchfilter.execut solrdispatchfilter.java:341 org.apache.solr.servlet.solrdispatchfilter.dofilt solrdispatchfilter.java:244 org.apache.catalina.core.applicationfilterchain.internaldofilt applicationfilterchain.java:235 org.apache.catalina.core.applicationfilterchain.dofilt applicationfilterchain.java:206 org.apache.catalina.core.standardwrappervalve.invok standardwrappervalve.java:233 org.apache.catalina.core.standardcontextvalve.invok standardcontextvalve.java:191 org.apache.catalina.core.standardhostvalve.invok standardhostvalve.java:128 org.apache.catalina.valves.errorreportvalve.invok errorreportvalve.java:102 org.apache.catalina.core.standardenginevalve.invok standardenginevalve.java:109 org.apache.catalina.connector.coyoteadapter.servic coyoteadapter.java:286 org.apache.coyote.http11.http11aprprocessor.process http11aprprocessor.java:857 org.apache.coyote.http11.http11aprprotocol http11connectionhandler.process http11aprprotocol.java:565 org.apache.tomcat.util.net.aprendpoint worker.run aprendpoint.java:1509 java.lang.thread.run thread.java:619
renam originalqueryparserhelp renam new querypars 's clearer it lucen 's default querypars go forward temporari bridg futur new querypars renam oal.queryparser.origin oal.queryparser.standard ca n't use default 's java keyword leav originalqueryparserhelp packag simpli renam querypars way creat sub-packag futur eg complexphrasequerypars querypars class make clear 's top class use pars queri
make booleanweight disjunctionmaxweight protect current booleanweight privat yet 2 protect member similar weight unaccess custom code use case would use crawl booleanweight get sub weight object howev sinc booleanweight privat way booleanweight protect subclass booleanqueri hook wrap booleanweight subclass facilit walk weight object would also want disjunctionmaxweight protect along weight member would even better weight made public accessor sub weight object subclass would necessari part realli trivial would great get 2.9 general would nice weight class public nice accessor relev sub weight /etc custom code get hook desir
improv perform contrib/testcompoundwordtokenfilt contrib/analyzers/compound test use hyphen grammar file test current german actual nice show combin hyphen rule dictionari work tandem issu german grammar file apach licens http //offo.sourceforge.net/hyphenation/licenses.html test must download entir offo zip file sourceforg execut happen think test great exampl thing work languag matter could consid use differ grammar file languag apach licens way could includ sourc test would practic
cleanup highlight test class cleanup highlight test class anoth issu bit
getdocvalu provid multiread docvalu abstract score valuesourcequeri score code call valuesource.getvalu reader *each* leaf level subread docvalu instanc back individu fieldcach entri subread client code inadvert call getvalu multiread directoryread would wind use outer fieldcach sinc getvalu indexread return docvalu advantag n't fieldcach api requir provid direct array access getvalu indexread could impliment *if* caller inadvert pass reader non-nul subread getvalu could generat docvalu instanc subread wrap composit multidocvalu
add boost function term queri payload queri refactor similar boostingtermqueri boostingfunctiontermqueri spantermqueri differ payload score doc averag payload appli function instead boostingtermqueri becom boostingfunctiontermqueri averagepayloadfunct appli also add marker interfac indic payloadqueri type refactor similarity.scorepayload also take doc id
enhanc queryutil checkhit wrap everyth check multireader/multisearch method checkhit queryutil good posit take searcher given test also test multiread multisearch construct built around
new querypars fail set auto rewrit multi-term queri old querypars default constant score rewrit prefix fuzzi wildcard termrangequeri new one seem
remov custom encod support greek/russian analyz greek russian analyz support custom encod koi-8 defin thing like lowercas token think analyz support unicod conversion/handl charset belong somewher els would like deprecate/remov support encod
implement reusabletokenstream contrib analyz contrib analyz impl reusabletokenstream regardless expens back compat reflect index speed think mitig perform cost hey overal might even improv back compat code non-fin analyz alreadi place easi money opinion
new querypars allow lead wildcard default current querypars disallow lead wildcard charact default
speed repeat tokenstream init cach ismethodoverridden result
new querypars over-incr posit multiphrasequeri new qp pars phrase analyz run text within phrase produc token posincr=0 multiphrasequeri produc posit ad term over-incr n't match current querypars
fieldcachesanitycheck call direct fieldcache.get* suggest mccandless lucene-1749 make fieldcacheimpl client fieldcachesanitycheck saniti check time creat new cach entri log warn think problem although 'd probabl want caller set sort infostream/warningstream type properti fieldcach object
querypars use reusabl token stream like index queri parser use reusabl token stream
token sourc token call attributesource.clearattribut first followup lucene-1796 quot token.clear use call consum switch produc lucene-1101 n't know token lucen ever chang case look like least bug introduc switch attribut api exampl standardtoken clear 's reusabletoken n't quot altern chang core/contrib token call clearattribut first could index would overhead old token stream itsself clear reusabl token issu also updat javadoc clear state insid tokenizer.java sourc tokenstream normal token clear *all* attribut e.g positionincr chang 0 tokenfilt filter chang back 1 tokenstream would stay 0 tokenfilt would call positionincrementattribute.clear respons could also break tokenstream clear general method whole attribut instanc e.g token use attributeimpl call clear would also clear offset termlength want sourc token rest attribut default valu lucene-1796 remov iter creation cost clearattribut run fast addit cost token done consist small speed degradion caus noth new tokenstream api
un-deprec querypars remov document say replac 3.0 look like consensus move first blush cours re-evalu thing chang
wrong javadoc lowercasetokenizer.norm javadoc lowercasetokenizer.norm seem copy/past lettertokenizer.istokenchar
ca n't specifi attributesourc token one ca n't current specifi attribut sourc token like one tokenstream
closeablethreadloc allow null object closeablethreadloc allow null object get method noth prevent set object comment get assert v null irrelev applic might pass null null import valu analyz sinc tokenstream threadloc privat member analyz access extend class way analyz reset tokenstream call setprevioustokenstream null post patch w/ test
add arg test-macro add pass arg junit like solr main debug
add conveni constructor perfieldanalyzerwrapp depend inject would good perfieldanalyzerwrapp constructor took analyz map rather repeat call addanalyz would make much easier/clean use class e.g spring xml configur relat trivial chang patch attach
make query.createweight public add back query.createqueryweight queryweight class remov public queryweight createqueryweight method queri also remov case want creat weight sub queri outsid org.apache.lucene.search packag n't want weight normal think booleanqueri outsid o.a.l.search packag order creat static util class insid o.a.l.search pass queri searcher static method call protect createweight method necessari could fix one 2 way 1. make createweight public queri break back compat 2. add follow method code public weight createqueryweight searcher searcher throw ioexcept return createweight searcher code createweight searcher deprect favor public access method
highlight-vs-vector-highlight.alg unfair highlight-vs-vector-highlight.alg use enwikiquerymak make spanqueri fastvectorhighlight simpli ignor spanqueri
add latent fieldselectorresult propos ad latent fieldselectorresult would similar lazy_load except would never cach store valu use larg field alway go direct disk take much memori cach document return searcher larg field may initi request lazy_load howev someon read field get lock memori document other like cach start use larg amount memori field contract fieldselectorresult.lat alway pull direct indexinput never persist memori part fieldabl could prepar patch desir
testindexreaderreopen night build failur interest failur last night 's build http //hudson.zones.apache.org/hudson/job/lucene-trunk/920 think root caus wast aioob except lock obtain time except look like cascad code junit testsuit org.apache.lucene.index.testindexreaderreopen junit lock obtain time org.apache.lucene.store.singleinstancelock 6ac615 write.lock junit test run 15 failur 1 error 0 time elaps 31.087 sec junit junit standard output junit java.lang.arrayindexoutofboundsexcept array index rang 148 junit org.apache.lucene.util.bitvector.getandset bitvector.java:74 junit org.apache.lucene.index.segmentreader.dodelet segmentreader.java:908 junit org.apache.lucene.index.indexreader.deletedocu indexreader.java:1122 junit org.apache.lucene.index.directoryreader.dodelet directoryreader.java:521 junit org.apache.lucene.index.indexreader.deletedocu indexreader.java:1122 junit org.apache.lucene.index.testindexreaderreopen 8.modifyindex testindexreaderreopen.java:638 junit org.apache.lucene.index.testindexreaderreopen.refreshread testindexreaderreopen.java:840 junit org.apache.lucene.index.testindexreaderreopen.access 400 testindexreaderreopen.java:47 junit org.apache.lucene.index.testindexreaderreopen 9.run testindexreaderreopen.java:681 junit org.apache.lucene.index.testindexreaderreopen readerthread.run testindexreaderreopen.java:822 junit org.apache.lucene.store.lockobtainfailedexcept lock obtain time org.apache.lucene.store.singleinstancelock 88d319 write.lock junit org.apache.lucene.store.lock.obtain lock.java:85 junit org.apache.lucene.index.directoryreader.acquirewritelock directoryreader.java:666 junit org.apache.lucene.index.indexreader.setnorm indexreader.java:994 junit org.apache.lucene.index.indexreader.setnorm indexreader.java:1020 junit org.apache.lucene.index.testindexreaderreopen 8.modifyindex testindexreaderreopen.java:634 junit org.apache.lucene.index.testindexreaderreopen.refreshread testindexreaderreopen.java:840 junit org.apache.lucene.index.testindexreaderreopen.access 400 testindexreaderreopen.java:47 junit org.apache.lucene.index.testindexreaderreopen 9.run testindexreaderreopen.java:681 junit org.apache.lucene.index.testindexreaderreopen readerthread.run testindexreaderreopen.java:822 junit junit testcas testthreadsafeti org.apache.lucene.index.testindexreaderreopen fail junit error occur thread thread-36 junit lock obtain time org.apache.lucene.store.singleinstancelock 6ac615 write.lock junit junit.framework.assertionfailederror error occur thread thread-36 junit lock obtain time org.apache.lucene.store.singleinstancelock 6ac615 write.lock junit org.apache.lucene.index.testindexreaderreopen.testthreadsafeti testindexreaderreopen.java:764 junit junit code
static index prune in-docu term frequenc carmel prune modul provid tool produc subset input index remov post data term in-docu frequenc specifi threshold net effect process much smaller index common type queri return near ident top-n result compar origin index increas perform option store valu term vector also remov function larg independ use without term prune term freq threshold set 1 threshold valu increas total size index decreas search perform increas recal decreas i.e search qualiti deterior note especi phrase recal deterior signific higher threshold valu primari purpos class produc small first-tier index fit complet ram store index use indexwriter.addindex indexread usual perform class suffici use result index view on-the-fli prune search note input index optim i.e n't contain delet index produc via indexwriter.addindex indexread preserv intern document id- sync origin index mean auxiliari inform necessari first-tier process store field also remov quick retriev on-demand origin index use intern document id threshold valu specifi global term field use defaultthreshold paramet overriden use per-field per-term valu suppli threshold map key map either field name term field text format preced valu follow first per-term threshold use present per-field threshold present final default threshold command-lin tool pruningtool provid conveni moment n't support function avail api
add option reversestringfilt mark revers token patch implement addit function filter mark revers token special marker charact unicod 0001 use index straight revers token e.g implement effici lead wildcard search
lucen test tri use junit assert new thread case lucen test junit assert use insid new thread run method wo n't work junit throw except call assert fail kill thread except propag junit unless failur caus later thread termin assert invalid testthreadsaf teststressindexing2 teststringintern
imposs use custom dictionari smartchineseanalyz possibl use custom dictionari even though lot code javadoc allow custom dictionari load load built-in one cours jar file load code public synchron static worddictionari getinst singleinst null singleinst new worddictionari load jar file tri singleinstance.load catch ioexcept e load jar file must fail check analyzerprofil configur string worddictroot analyzerprofile.analysis_data_dir singleinstance.load worddictroot catch classnotfoundexcept e throw new runtimeexcept e return singleinst code think either correct document disabl custom dictionari support
contrib-spati java.lang.unsupportedoperationexcept querywrapperfilter.getdocidset use project devel phase latest snapshot releas lucen updat latest snapshot day ago one junit test fail throw follow error java.lang.unsupportedoperationexcept org.apache.lucene.search.query.createweight query.java:91 org.apache.lucene.search.querywrapperfilter.getdocidset querywrapperfilter.java:72 org.apache.lucene.misc.chainedfilter.getdisi chainedfilter.java:150 org.apache.lucene.misc.chainedfilter.initialresult chainedfilter.java:173 org.apache.lucene.misc.chainedfilter.getdocidset chainedfilter.java:211 org.apache.lucene.misc.chainedfilter.getdocidset chainedfilter.java:141 org.apache.lucene.search.constantscorequeri constantscorer. init constantscorequery.java:116 org.apache.lucene.search.constantscorequeri constantweight.scor constantscorequery.java:81 org.apache.lucene.search.indexsearcher.search indexsearcher.java:244 org.apache.lucene.search.indexsearcher.search indexsearcher.java:172 org.apache.lucene.search.searcher.search searcher.java:183 org.hibernate.search.query.queryhits.updatetopdoc queryhits.java:100 org.hibernate.search.query.queryhits. init queryhits.java:61 org.hibernate.search.query.queryhits. init queryhits.java:51 org.hibernate.search.query.fulltextqueryimpl.getqueryhit fulltextqueryimpl.java:373 org.hibernate.search.query.fulltextqueryimpl.list fulltextqueryimpl.java:293 think appear hudson build 917 follow commit query.java http //hudson.zones.apache.org/hudson/job/lucene-trunk/917/chang detail4 connect jira issu lucene-1771 hope 'm right place fix thank
matchalldocsquery.tostr string field honor javadoc contract public string tostr string field return querypars need abl pars string form queri
weight.scor pass doc offset sub reader search done per segment basi way scorer know actual doc id document 's match relat doc offset segment use cach scorer base entir index segment way index proper insid scorer scorer pass need offset calcul real docid suggest weight.scor method also take integ doc offset abstract weight class constructor take offset well method get offset weight sub weight must pass offset creat sub weight detail workaround order work around must follow subclass indexsearch add int getindexreaderbas indexread method subclass weight creation weight must hold onto refer pass searcher cast sub class scorer creation scorer must pass result yoursearcher.getindexreaderbas reader scorer rebas collect docid use offset exampl implement getindexreaderbas code note effici implement done cach result gathersubread constructor public int getindexreaderbas indexread reader reader getread return 0 els list reader new arraylist gathersubread reader iter iter readers.iter int maxdoc 0 iter.hasnext indexread r indexread iter.next r reader return maxdoc maxdoc += r.maxdoc return -1 reader searcher code note workaround make serial custom weight implement
fastvectorhighlight truncat word begin end fragment fastvectorhighlight take word boundari consider build fragment case first last word fragment truncat make highlight less legibl attach patch basefragmentbuild resolv expand start end boundari fragment first whitespac charact either side fragment begin end sourc text whichev come first signific improv legibl cost return slight larger number charact specifi fragment size
incorrect usag attributesource.addattribute/getattribut lead failur onlyusenewapi=tru sete use new api tokenstream receiv follow except code junit caus java.lang.illegalargumentexcept attributesourc attribut interfac org.apache.lucene.analysis.tokenattributes.termattribut junit org.apache.lucene.util.attributesource.getattribut attributesource.java:249 junit org.apache.lucene.index.termshashperfield.start termshashperfield.java:252 junit org.apache.lucene.index.docinverterperfield.processfield docinverterperfield.java:145 junit org.apache.lucene.index.docfieldprocessorperthread.processdocu docfieldprocessorperthread.java:244 junit org.apache.lucene.index.documentswriter.updatedocu documentswriter.java:772 junit org.apache.lucene.index.documentswriter.updatedocu documentswriter.java:755 junit org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:2613 code howev ca n't actual see culprit caus except suggest illegalargumentexcept includ getclass .getnam order abl identifi tokenstream implement actual caus
token implement constructor take attributesourc attributefactori tokenstream implement join togeth multipl sub tokenstream addit filter top ca n't index merg 2.4 work fine one sub stream exhaust start use next stream howev 2.9 difficult requir copi term buffer everi token aggreg howev sub tokenstream share attributesourc concat tokenstream share attributesourc goe back simpl effici exampl would like see follow constructor ad standardtoken code public standardtoken attributesourc sourc reader input boolean replaceinvalidacronym super sourc code would likewis want similar constructor ad token sub class provid lucen
make payload boost queri consist boostingfunctiontermqueri consist boostingnearqueri renam payloadnearqueri payloadtermqueri
memoryindex n't call tokenstream.reset tokenstream.end memoryindex contrib/memori honor contract consum tokenstream work patch right quick
ant javacc root project also proper creat contrib/querypars java file ant javacc project root n't run javacc contrib/querypars ant javacc contrib/querypars proper creat java file still need done hand part describ contrib/queryparser/readme.javacc think process autom patch provid
boostingnearqueri n't hashcode/equ
tokenwrapperattributefactori cachingwrapperfilterhelp implement equal also implement hashcod part contract object bq two object equal accord equal object method call hashcod method two object must produc integ result
minor/nitpick terminforead bug code flag bytecod static analyz guess nitpick drop null check null fall code throw nullpoint except anyway keep nullpoint check impli expect possibl n't handl correct code return nth term set final term get int posit throw ioexcept size 0 return null segmenttermenum enumer getthreadresourc .termenum enumer null enumerator.term null posit enumerator.posit posit enumerator.posit totalindexinterv return scanenum enumer posit avoid seek seekenum enumer position/totalindexinterv must seek return scanenum enumer posit code
move java 1.5 3.0 replac interg long etc construct .valueof -128 128 guarante cach use valueof case 3.5 time faster use contructor
remov unus code smartchineseanalyz hmm pkg unus code hmm packag would like remov suppli fix lucene-1817 refactor analyz otherwis risk break custom dictionari support
signatur chang attributesourc better generic support addattribute/getattribut last updat attribut api use attributeimpl implement oif attribut chang api littl bit chang lead fact java 1.5 use generic longer abl add attribut without cast addattribut getattribut return attribut interfac implement attribut interest caller 1.5 use generic one could add termattribut without cast use code termattribut termatt addattribut termattribute.class code signatur code public extend attribut addattribut class code attach patch appli mention chang signatur without generic return attribut code chang need current code alway cast result request interfac also ad 1.5 method signatur method javadoc test pass
flexibl querypars fail local differ en_us get follow error mention testcas comput use local de_d window 32 code junit testsuit org.apache.lucene.queryparser.standard.testqphelp junit test run 29 failur 1 error 0 time elaps 1,156 sec junit junit standard output junit result fieldx xxxxx fieldi xxxxxxxx ^2.0 junit junit testcas testlocaldateformat org.apache.lucene.queryparser.standard.testqphelp fail junit expect 1 0 junit junit.framework.assertionfailederror expect 1 0 junit org.apache.lucene.queryparser.standard.testqphelper.asserthit testqphelper.java:1148 junit org.apache.lucene.queryparser.standard.testqphelper.testlocaldateformat testqphelper.java:1005 junit org.apache.lucene.util.lucenetestcase.runtest lucenetestcase.java:201 junit junit junit test org.apache.lucene.queryparser.standard.testqphelp fail junit testsuit org.apache.lucene.queryparser.standard.testqueryparserwrapp junit test run 27 failur 1 error 0 time elaps 1,219 sec junit junit standard output junit result fieldx xxxxx fieldi xxxxxxxx ^2.0 junit junit testcas testlocaldateformat org.apache.lucene.queryparser.standard.testqueryparserwrapp fail junit expect 1 0 junit junit.framework.assertionfailederror expect 1 0 junit org.apache.lucene.queryparser.standard.testqueryparserwrapper.asserthit testqueryparserwrapper.java:1120 junit org.apache.lucene.queryparser.standard.testqueryparserwrapper.testlocaldateformat testqueryparserwrapper.java:985 junit org.apache.lucene.util.lucenetestcase.runtest lucenetestcase.java:201 junit junit junit test org.apache.lucene.queryparser.standard.testqueryparserwrapp fail code en_us local work
remov searcher weight explain explain need calcul corpus wide stat way consist multisearch
boostingnearqueri must implement clone clone nearspanqueri clone requir span contain class
scorer.explain deprec abstract impl throw unsupportedoperationexcept suggest scorer implement explain throw unsupportedoperationexcept right implement method abstract javac yell overrid deprec method follow implement scorer remov empti implement explain scorer code return explan score document br method use link next link skipto int link score hitcollector method use param doc document number explan deprec pleas use link indexsearch explain link weight explain instead public explan explain int doc throw ioexcept throw new unsupportedoperationexcept code best figur n't break back compat peopl alreadi recompil anyway 2.9 definit binari compat 2.4
queryutil check equal proper handl null part equal contract mani class current violat
provid summari inform file lucen index find often rememb file extens particular index file inform contain file format summar patch provid simpl tabl describ extens provid link relev section
convert test new tokenstream api better support cross-impl attributeimpl.copyto patch convert remain test new tokenstream api non-deprec class patch also enhanc attributeimpl.copyto token tokenwrapp also support copi e.g termattributeimpl token target impl must support interfac must type token tokenwrapp use optim cope without cast 6 interfac possibl mayb special token contrib shingl matrix use token cach may enhanc also yonik 's request optim copi state incompat attributesourc may enhanc possibl new issu
speed junit test lucen grow number junit test obvious good thing come longer longer test time also run back compat test standard test run problem essenti doubl way may get better includ run parallel test need hardwar fulli take advantag nice gain alreadi issu junit 4.6 4.7 begin someth might abl count soon 4.6 buggi 4.7 still n't come nice ant integr parallel test come though beyond parallel test think also need concentr keep test lean n't want sacrific coverag qualiti 'm sure plenti fat skim ve start make list longer test think work make test much faster parallel think could see realli great gain
build fail download jar contrib/db skip test everi often night build fail contrib/db unabl download necessari bdb jar http //downloads.osafoundation.org think case simpli skip contrib/db 's test 's night build 's run sinc 's fals posit failur
local problem lucen followup lucene-1836 found local problem lucen date format even simpl date format consist number like iso date alway give us local date datetool sort accord string.compar import decim digit western one strang local may differ whenev want format date intern format exspect behav somehow least set local us use ascii date enter user display user format accord default custom specifi local also look decimalformat especi use pad number found problem
phrasequery/termquery/spanqueri use indexread specif stat explain phrasequeri use indexread explainfor top level stat mention mike mccandless lucene-1837 termqueri use indexread explain top level stat alway bug multisearch per segment search make wors
remov refer older version lucen per-releas document document per releas contain refer older version often confus notic file format doc might place
updat overview exampl code see http //lucene.apache.org/java/2_4_1/api/core/overview-summary.html need updat non-deprec best-practices/recommend api usag also double-check demo app work document
ant javacc root project also proper creat contrib/surround java file consist lucene-1829 contrib/querypars
fix remain local test failur lucen see also lucene-1836 lucene-1846 test pass differ local fix run ant test differ local look fix problem use localizedtestcas lucene-1836 keep come back approach lucene-1836 fix core querypars run ant test local look problem
build.xml 's tar task use longfile= gnu default use get nasti fals warn fill screen
chang attributesourc api use generic attributesourc api easier use jdk 1.5 generic uwe start work patch alreadi feel free assign
remov hit lucene-1290 remov refer hit core work done remov refer contrib modul new one crept core 1290
chang numericrangequeri generic numer type numericrangequery/filt use generic type-safeti numericrangequeri extend number
updat site level document ugg fun one brain slide bottom skull excit must updat site level page current api usag
switch multitermqueri constant score auto rewrit default right default score booleanqueri 's inconsist w/ querypars constant score auto new multi-term queri alreadi set default core queri impact prefixqueri wildcardqueri fuzzyqueri rewrit booleanqueri keep
add contrib lib classpath javadoc n't know ant well enough easili ve label wish would nice get rid errors/warn find class generat build javadoc
duplic package.html file querypars analsysis.cn packag file conflict eachoth build javadoc one code hossman brunner ~/lucene/java find src contrib -name package.html perl -ple 's *src/java/ sort uniq -c grep -v 1 2 org/apache/lucene/analysis/cn/package.html 2 org/apache/lucene/queryparser/package.html hossman brunner ~/lucene/java find src contrib -path \*queryparser/package.html src/java/org/apache/lucene/queryparser/package.html contrib/queryparser/src/java/org/apache/lucene/queryparser/package.html hossman brunner ~/lucene/java find src contrib -path \*cn/package.html contrib/analyzers/common/src/java/org/apache/lucene/analysis/cn/package.html contrib/analyzers/smartcn/src/java/org/apache/lucene/analysis/cn/package.html code
snowballanalyz link net.sf packag empti need remov need remov net.sf point org.tartarus.snowball.ext n't work link though ll also remov link lose javadoc error broken link
bogus javadoc fieldvaluehitquery.fillfield fieldvaluehitquery.fillfield javadoc seem left complet differ method code given fielddoc object store valu use sort given document valu raw valu index intern represent given search hit collat multisearch search hit param doc fielddoc store sort valu return fielddoc pass see searchabl search weight filter int sort fielddoc fillfield final entri entri final int n comparators.length final compar field new compar n int 0 n ++i field compar .valu entry.slot //if maxscor 1.0f doc.scor maxscor normal score return new fielddoc entry.docid entry.scor field code
add ton miss licens header throughout test/demo/contrib
replac collation/lib/icu4j.jar smaller icu jar collat need icu data shrink jar file bit use data custom exclud thing like charact set convers tabl
updat notice.txt java-dev discuss notice.txt up-to-d one thing know persian stopword file analyzers/fa came sourc arab stopword file bsd-licens might other think icu alreadi ad
check tvx/fdx size mismatch also includ whether file exist indexwrit check flush merg size index file store field *.fdx term vector *.tvx match mani byte written origin ad lucene-1282 ie safeti catch nasti 1 jre hotspot bug would otherwis silent corrupt index howev check also seem catch differ case size file zero recent exampl lucene-1521 'd like improv messag except includ whether file exist help understand user sometim hit except best theori point someth extern remov file indexwrit
dist includ analyz contrib src dist binari dist dist includ analyz contrib src dist binari dist
highlight wrap cach token filter cachingtokenfilt cachingtokenfilt figur fine rare case would anoth cach tokenstream feed highlight guess happen especi depend ideal situat
improv javadoc numeric* 'm work improv numeric* javadoc
updat site lucene-sandbox page page misleading/bad info one thing would like wo n't attempt prob good modul issu commit one word contrib sandbox think sandbox purg current page say sandbox kind rat nest various earli stage softwar one day may make core info outdat think replac also specifi back compat polici work contrib eg contrib polici default polici also drop piec open lucen 's committ other bit outdat also either includ contrib chang word indic list sampl mani contrib
updat site score page updat site score page see appendix quot class diagram karl wettin 's uml wiki quot karl 's diagram outdat think link pull 2.9 quot sequenc diagram fill volunt quot think pull say put someth like task jira publish site doc
javadoc tokenstream.end somehow confus javadoc tokenstream.end somehow confus also refer old tokenstream api next return null one implement tokenstream old api make use end featur would use attribut updat end offset could rewrit whole tokenstream conform old api must end token method add would drop old api doc
contrib packag miss package.html dunno get one releas contrib n't package.html good overview would work replac n't think huge import think import abl easili quick read quick overview contrib think far identifi collat spatial
use nativefslockfactori default new api direct ctor fsdir.open user request add note indexwrit alert avail nativefslockfactori allow avoid retain lock abnorm jvm exit seem reason want user abl easili stumbl upon class code look like good spot add note could also improv what bit open indexwrit necessarili creat lock file would depend lockfactori use code p open code indexwrit /code creat lock file directori use tri open anoth code indexwrit /code directori lead link lockobtainfailedexcept link lockobtainfailedexcept also thrown indexread directori use delet document index. /p code anyon rememb nativefslockfactori default simplefslockfactori
remov deprec class spatial spatial releas remov deprec class
make contrib/collation/ icu collationkeyanalyz constructor public contrib/col constructor collationkeyanalyz icucollationkeyanalyz packag privat effect unus
move smartchineseanalyz smartcn packag offshoot lucene-1862 org.apache.lucene.analysis.cn.smartchineseanalyz becom org.apache.lucene.analysis.cn.smartcn.smartchineseanalyz
fix typo changes.txt contrib/changes.txt prior 2.9 releas notic typo changes.txt contrib/changes.txt make past releas re set stone attach patch short
javadoc cleanup basic cleanup core/contrib typo apach licens header javadoc miss period screw packag summari etc
nativefslockfactory.makelock .islock work indexwriter.islock indexreader.islock work nativefslockfactori problem method nativefslock.islock check lock instanc lock lock null lockfactori creat new lock instanc alway return fals even lock
improv javadoc
o.a.l.messag move core contrib/querypars contain org.apache.lucene.messag packag contain general code claim 's javadoc specif querypars trueli general purpos code probabl move hte querypars contrib either 's contrib core 's small *edit altern suggest renam packag fall o.a.l.querypars namespac retract due comment favor eventu promot 's contrib
fastvectorhighlight support addit queri use fastvectorhighlight strang languag work well one thing notic immedi mani queri type highlight multitermqueri multiphrasequeri etc one thing michael m post origin ticket quot think nice eventu model would could simpli re-run scorer singl document use instantiatedindex mayb simpli sort wrapper term vector alreadi mini-inverted-index singl doc extend scorer api tell us exact term occurr particip match n't think expos today quot due strang requir use someth similar special case strang thing like forc multitermqueri rewrit boolean queri highlight flatten multiphrasequeri boolean or' phrasequeri think thing would fast idea might help look contrib/highlight support filteredqueri flatten call getqueri right mayb last resort tri query.extractterm
spatial use java util log caus needless minor work multipl string concat method call due check log level sure log use two spot look debug go check isfineen
demo htmlparser compar stringbuff empti string .equal
spatial contrib shape class implement equal hashcod violat contract min need implement return constant
spatial check string int doubl map code privat map integ doubl distanc code code precis null doubl xlat getprecis lat precis doubl xlng getprecis lng precis string k new doubl xlat .tostr new doubl xlng .tostr doubl d distances.get k d null return d.doublevalu code someth eh
modifi confus javadoc querynorm see http //markmail.org/message/arai6silfiktwc javadoc confus well
decid remov line number latest chang lucen dev grown new issu arisen mani time new chang invalid old chang proper chang file list chang last version document dev life issu keep chang proper order requir lot renumb sometim number real mean could ad rich version html version automat desir think make good replac issu alreadi id stabl rather current decor number subject chang dev cycl think replac number asterix 2.9 section go forward ie 4. becom n't get consensus quick issu wo n't block
ineffici growth openbitset hi found potenti serious effici problem openbitset one typic think way build bit set set bit one one e.g. hitcollector set bit match document under array long need grow bit set cours look code appear array grow ineeffici worst case doc id sort would normal hitcollector case exampl copi array everi ad bit relev code openbitset.java public void set long index int wordnum expandingwordnum index protect int expandingwordnum long index int wordnum int index 6 wordnum =wlen ensurecapac index+1 public void ensurecapacityword int numword bits.length numword long newbit new long numword system.arraycopi bits,0 newbits,0 wlen bit newbit see bit array long enough new one alloc exact right size worst case grow one word everi time n't growth exponenti natur e.g. grow maximum index+1 twice exist size altern growth ineffici document recommend use variant constructor correct initi size e.g. hitcollector case number document index fastset method instead set thank nadav
confus javadoc searchable.java searchable.java javadoc maxdoc expert return one greater largest possibl document number call search code comput term weight see org.apache.lucene.index.indexread maxdoc qualif expert statement call search code comput term weight bit confus impli maxdoc somehow comput weight obvious true explain sentenc mayb use one factor weight realli need mention
termattributeimpl.equ check termlength look code equal think miss check other.termlength==this.termlength check must comparison array
changes.html explicit includ releas none releas relat ant target explicit call cahnges-to-html seem like oversight current 's call part night target
incorrect shinglefilt behavior outputunigram fals shinglefilt n't work expect outputunigram fals particular output unigram least time outputunigrams==fals ll attach patch shinglefiltertest.java add test case demonstr problem n't check hypothes behavior outputunigram fals got chang class upgrad new tokenstream api
move wordnet base synonym code contrib/memori contrib/wordnet somewher els see lucene-387 synonym relat code live contrib/memori long time refactor
instanti simplefslockfactori string param constructor throw illegalstateexcept
backward problem charstream token custom reset reader method review new charstream code ad token found serious problem backward compat token overrid reset charstream problem e.g chartoken overrid reset reader code public void reset reader input throw ioexcept super.reset input bufferindex 0 offset 0 datalen 0 code reset token anoth charstream reader method never call break whole token charstream extend reader propos remov reset charstream method simpli instanceof check detect suppli reader charstream wrap could also remov extra ctor token support pass charstream ctor also check instanceof warp need code backward compat need add addit ctor subclass instanceof check alway done charreader.get remov ctor charstream reset charstream complet thought would like fix somehow rc4 'm sorri
similar javadoc score function relat tight score model effect see discuss relat issu
use querywrapperfilt cachingwrapperfilt querywrapperfilt return docidset creat scorer get cach rather bit set larg perform cost old impl type thing queryfilt recommend deprec use cachingwrapperfilt querywrapperfilt deprec queryfilt also suffer problem implement use cachingwrapperfilt querywrapperfilt see http //search.lucidimagination.com/search/document/7f54715f14b8b7a/lucene_2_9_0rc4_slower_than_2_4_1
fastvectorhighlight latter term highlight two term concaten custom found bug fastvectorhighlight 'm work fix ll post soon possibl hope fix 2.9
fastvectorhighlight aioob occur one phrasequeri contain anoth phrasequeri 'm sorri anoth one q= b c d b c arrayindexoutofboundsexcept occur fieldquery.checkoverlap 'm work fix test case soon post thank patient
smartcn hhmm doc translat cowork patricia peng translat document code comment smartcn hhmm packag
ad empti parallelread index indexwrit may caus arrayindexoutofboundsexcept nosuchelementexcept hi recent stumbl upon possibl perfect legal add empti index indexread indexwrit howev use parallelread context two situat runtimeexcept may occur good reason condit 1 index within parallelread empti ad indexwrit get java.util.nosuchelementexcept trigger paralleltermenum 's constructor reason treemap firstkey method assum return null entri true appar return null first key map null condit 2 assum aforement bug fix index within parallelread origin contain one field termvector document mark delet ad index indexwrit get java.lang.arrayindexoutofboundsexcept trigger termvectorswrit addalldocvector reason termvectorswrit assum index mark termvector least one field actual exist unfortun true either patch testcas demonstr two bug provid cheer christian
analysi back compat break old new style token stream n't mix well
add tostr getnam method indexread would use debug indexread either getnam method tostr implement would get string identif reader segmentread would return getsegmentnam directori reader would return generat id multiread could return someth like multi sub reader name sub reader name sub reader name right check instanceof segmentread call getsegmentnam indexread type would someth like get indexcommit get generat may throw unsupportedoperationexcept point would recurs walk sub reader tri could work patch other like idea
balancedsegmentmergepolici contribut zoie project realtim index written yasuhiro matsuda zoie realtim index system use handl high updat rate avoid larg segment merg detail write-up http //code.google.com/p/zoie/wiki/zoiemergepolici
indexsearch class make subread doccount array protect sub class access pleas make two member variabl protect subclass access e.g protect indexread subread protect int docstart thank
lucene-cor 2.9.0 miss maven central repositori sub-project like lucene-demo lucene-contrib etc exist central depend 2.9.0 lucene-cor howev lucene-cor 2.9.0 artifact miss
payloadtermqueri refer deprec document redirect payloadtermqueri refer function score similar refer overrid deprec method similar scorepayload string byte int int method deprec similar scorepayload int string int int byte int int javadoc patch address class level javadoc class provid right signatur similar overridden
highlight n't support numericrangequeri deprec rangequeri suck throw nullpoint except numericrangequeri throw except rangequeri wo n't highlight
convert precedencequerypars new tokenstream api adriano crestani provid patch updat pqp use new tokenstream api test still pass hope help keep pqp
provid conveni attributefactori implement default attribut token found place contrib test token.class ad use addattributeimpl problem sure attribut realli ad may fail later updat local instanc test contrib partial fail 3.0 without backward layer backward layer use token/tokenwrapp intern copyto work correct way achiev use attributefactori attributefactori current privat singletokentokenstream want move token.java static class static member case test rewritten also want mark addattributeimpl expert must realli know what happen trap
generifi priorityqueu prioriti queue use generic like java 5 collect api class simpl make code readabl
remov deprec charset support greek russian analyz remov deprec support custom charset one thing found charset remov russianlowercasefilt lowercasefilt mark deprec remov 3.1
add method manipul querynodeprocessorpipelin element querynodeprocessorpipelin allow user defin list processor process queri tree howev 's flexibl user want extend/modifi alreadi creat pipelin provid add method allow user append new processor pipelin propos add new method manipul processor pipelin think method consid index posit modifi pipelin henc index posit pipelin mean anyth processor mean 's anoth processor therefor suggest method alway consid anoth processor inserting/modifi pipelin exampl insertaft processor newprocessor insert newprocessor processor
preced queri parser use contrib/querypars framework extend current standardquerypars contrib support boolean preced
indexoutofboundsexcept shinglematrixfilt 's iter hasnext method tri use shinglematrixfilt within solr test function etc. first use built-in field analysi view.th filter configur use queri time analysi spacer charact min max shingl size 2 generat shingl queri string filter seem work view turn highlight index term match queri term except thrown also time tri queri index except immedi thrown stacktrac code java.lang.indexoutofboundsexcept index 1 size 1 java.util.arraylist.rangecheck unknown sourc java.util.arraylist.get unknown sourc org.apache.lucene.analysis.shingle.shinglematrixfilt matrix 1.hasnext shinglematrixfilter.java:729 org.apache.lucene.analysis.shingle.shinglematrixfilter.next shinglematrixfilter.java:380 org.apache.lucene.analysis.stopfilter.next stopfilter.java:120 org.apache.lucene.analysis.tokenstream.next tokenstream.java:47 code within hasnext method s-1 -th column arraylist column request n't entri within column creat patch check column contain enough entri
minpayloadfunct return 0 one payload present experi payload score payloadtermqueri 'm see 0 return use minpayloadfunct believ bug time moment flesh unit test want report track
chinesefilt ineffici trivial patch use chararrayset use termbuff instead term
remov deprec directori stuff ir/iw open/ctor hell patch remov primarili deprec directori stuff also remov part ctor/open hell ir iw indexmodifi complet remov deprec
make class close method instanceof closeabl java 1.5 simpl
remov deprec tokenstream api look clover analysi seem longer use sinc remov test yesterday happi
snowbal packag contain bsd licens code asl header class org.tartarus.snowbal org.tartarus.snowball.ext reason given asl header class licens bsd thus asl header remov suppos misstak possibl due asl header autom tool
deprec instantiatedindexwrit http //markmail.org/message/j6ip266fpzuaibf7 suppos suggest 2.9 rather least three reason want code base behaviour directori indexwrit 2.3 touch sinc chang futur one keep iiw sync someth 's easi forget lock caus concurr modif except access index via searcher/read commit use old token stream api upgrad case stay java- packag level doc sinc commit suggest one consid use ii immut due lockless suggest make immut real sinc ii ment small corpora littl time lost use constructor built index indexread i.e rather use instantiatedindexwrit one would use directori indexwrit pass indexread new instantiatedindex object
remov autocommit indexwrit indexwrit 's autocommit deprec 3.0 hardwir fals
wildcardqueri rewrit improv wildcardqueri logic rewrit termqueri wildcard charact need pass along boost user ask constant score rewritemethod rewrit constant score queri consist addit queri realli prefixqueri would nice rewrit prefix queri enumer number term prefixqueri simpler comparison function
fastvectorhighlight small fragchars caus stringindexoutofboundsexcept fragchars smaller queri string stringindexoutofboundsexcept thrown
initiatedindex cce cast numericfield field uncheck cast list field throw classcastexcept appli exampl numericfield appear fix trunk 2.9.1 releas could help patch appli 2.9.0 tag
fix hit deprec notic need commit 2.9 branch sinc hit remov
remov deprec filter.bit make filter.getdocidset abstract
index splitter index multipl segment tool allow split segment separ directori
remov deprec field.store.compress also remov fieldformerg relat code
remov remain deprec document packag remov differ deprec api field.index.no_norm etc field.binaryvalu getomittf /setomittf
persian arab analyz cleanup brows code found place minor improv new arab persian analyz code prevent default stopword load time default constructor call replac block singl switch mark privat member final need chang protect visibl final final class
arabicanalyz lowercas stopfilt arabicanalyz lowercas text case non-arab text around also allow set custom stopword list might augment arab list english one exampl case help non-arab stopword lowercas stopfilt
lazi atom load stopword smartcn default constructor smartchineseanalyz load default jar embed stopword time constructor invok atom load unmodifi set
arab analyz stopword list need enhanc provid arab stopword list need enhanc e.g contain lot word stopword cleanup patch provid issu
make easier access default stopword languag analyz dm smith made follow comment sometim hard dig stop set analyz look around analyz differ way store default list one idea consid general someth like simon lucene-1965 lucene-1962 stopword list store .txt file resourc folder code return unmodifi instanc default stop-word set return unmodifi instanc default stop-word set public static set string getdefaultstopset code
remov deprec method priorityqueu
remov deprec docidsetiter method
remov deprec rangequeri class remov deprec rangequeri class
remov deprec extendedfieldcach auto/custom cach lot 's deprec sort logic remov deprec extendedfieldcach auto/custom cach sort
remov deprec queri compon remov rest deprec queri compon
booleanqueri find match special condit queri name tang* doc=5137 score=1.0 doc document store index name tangfulin doc=11377 score=1.0 doc document store index name tangfulin queri name tang* name notexistnam doc=5137 score=0.048133932 doc document store index name tangfulin two queri index one prefix queri boolean queri prefix queri plus term queri boolean queri occur.should wonder later queri find doc=11377 doc problem repreduc code attach
remov deprec spanquery.getterm generifi query.extractterm set term
iscurr getvers nrt reader broken right iscurr alway return true nrt reader getvers alway return version last commit nrt reader hold live segmentinfo think iscurr return fals chang occur writer els true actual fair easi determin sinc writer track mani doc delet buffer ram counter increas chang getvers return version reader creat
remov multitermquery.getterm remov field method mtq return pattern term
remov hitcollector remov rest hitcollector
remov remain deprec index packag
fix javadoc deprec remov lot link javadoc methods/class longer exist javadoc target print ton warn fix
disjunctionmaxqueri type safeti disjunctionmaxqueri code contain type-saf comment indic type-safeti though better express api intern explicit type oppos type-less contain patch attach comment backward compat concern welcom
disjunctionmaxqueri iter code contain construct better readabl convert iter contain construct intuit read
npe nearspansunord payloadnearqueri follow queri caus npe nearspansunord reproduc attach unit test failur occur last document score
remov rest analysi deprec token charactercach remov rest deprec analysi packag -token 's termtext field done -eventu un-deprec ctor token take string still use yes remov deprec 2.9.1- done -remov charactercach use character.valueof java5- done stopword list remov backward set analyz acronym posincr deprec still version constant know proceed keep set aliv index compat remov togeth version constant undeprec
charactercach refer delet charactercach deprec character.valueof c henc latter chosen former
chararrayset made generic violat set char interfac tri make chararrayset use generic extend abstractset char possibl e.g return sometim string instanc iter instead also addal method accept string char think class complet mis-design violat almost everyth sorri make set place big suppresswarn uncheck front problem also lot set declar insid stopanalyz made generic never know what insid
add unsign pack int impl oal.util various place lucen could take advantag effici pack unsign int/long impl eg term dict index standard codec lucene-1458 could subsanti reduc 's ram usag fieldcache.stringindex could well think load ram codec like one testexternalcodec could use 'm pictur someth basic like code interfac packedunsignedlong long get long index void set long index long valu code plus mayb iter get mayb also set help usag insid lucen write eg set could make assumption/requir factori somewher code packedunsignedlong creat int count long maxvalu code think simpli autogen code start autogen code lucene-1410 good exist impl compat licens 'd great n't time near-term anyon itch pleas jump
similar score deprec method javadoc refer similaritydeleg old method public float scorepayload string fieldnam byte payload int offset int length deprec public float scorepayload int docid string fieldnam int start int end byte payload int offset int length refer payloadnearqueri javadoc chang also similaritydeleg overrid new method oppos deprec old one
intermitt failur testindexwrit testexceptionduringsync code common.test mkdir creat dir c \projects\lucene\trunk-full1\build\test junit testsuit org.apache.lucene.index.testindexwrit junit test run 102 failur 0 error 1 time elaps 100,297sec junit junit testcas testexceptionduringsync org.apache.lucene.index.testindexwrit caus error junit _a.fnm junit java.io.filenotfoundexcept _a.fnm junit org.apache.lucene.store.mockramdirectory.openinput mockramdirectory.java:226 junit org.apache.lucene.index.fieldinfos. init fieldinfos.java:68 junit org.apache.lucene.index.segmentread corereaders. init segmentreader.java:116 junit org.apache.lucene.index.segmentreader.get segmentreader.java:620 junit org.apache.lucene.index.segmentreader.get segmentreader.java:590 junit org.apache.lucene.index.directoryreader. init directoryreader.java:104 junit org.apache.lucene.index.readonlydirectoryreader. init readonlydirectoryreader.java:27 junit org.apache.lucene.index.directoryread 1.dobodi directoryreader.java:74 junit org.apache.lucene.index.segmentinfo findsegmentsfile.run segmentinfos.java:704 junit org.apache.lucene.index.directoryreader.open directoryreader.java:69 junit org.apache.lucene.index.indexreader.open indexreader.java:307 junit org.apache.lucene.index.indexreader.open indexreader.java:193 junit org.apache.lucene.index.testindexwriter.testexceptionduringsync testindexwriter.java:2723 junit org.apache.lucene.util.lucenetestcase.runbar lucenetestcase.java:206 junit junit junit test org.apache.lucene.index.testindexwrit fail code
morelikethi allow exclud term appear mani document patch includ morelikethi class allow generat like queri base given document far imposs suppress word like queri appear almost document make necessari use extens list stop word therefor suggest allow exclud word certain absolut document count certain percentag document exceed depend corpus text word appear 50 even 70 document usual consid insignific classifi document
enwikiconentsourc work parallel task
arrayindexoutofboundsexcept index http //search.lucidimagination.com/search/document/f29fc52348ab9b63/arrayindexoutofboundsexception_during_index
use java 5 enum replac use o.a.l.util.paramet java 5 enum deprec paramet replac custom enum pattern java 5 enum
use covari clone return type *paul cowan wrote lucene-1257 ok thought 'd jump help one java 5 favourit n't seen anyon discuss n't believ patch address thought 'd throw patch svn head revis 827821 use java 5 covari return type almost object clone implement core i.e public object clone chang public spannotqueri clone let us get rid whole bunch now-unnecessari cast e.g clone null clone spannotqueri this.clon becom clone null clone this.clon almost everyth done downcast remov core except spanqueri stuff 's assum 's safe cast clone spanqueri spanqueri ca n't made covari without declar abstract spanqueri clone spanqueri break spanqueri n't declar clone indexread e.g directoryread ca n't specif chang .clone return indexread return result indexreader.clon boolean could use covari type would work fine n't follow pattern other could later commit two chang also made contrib/ make chang would broken code tri widen indexinput clone back return object permit contrib/ otherwis left untouch let know think question
wordnet pars bug user report wordnet pars prolog file incorrect also need check wordnet parser memori contrib problem fals alarm 'm worri test first unit test wordnet packag ever noformat exampl look synset word king get java synlookup wnindex king baron magnat mogul power queen rex scrofula struma tycoon scrofula struma extran happen line parser code syns2index.java interpret two consecut singl quot entri 114144247,3 king evil n,1,1 wn_s.pl file termin string separ king entri concern synset word scrofula struma thus get insert synset king *there 1382 entri wn_s.pl* wordnet prolog data-bas file use two consecut singl quot appear resolv ad statement line pars portion syns2index.java follow pars line line line.substr 2 line line.replaceal \'\ ad statement* int comma line.indexof string num line.substr 0 comma etc short replac back-quot recreat index get java synlookup zwnindex king baron magnat mogul power queen rex tycoon noformat
add oal.util.vers ctor querypars followup lucene-1987 somebodi use standardanalyz version.lucene_curr use querypars phrase queri work stopfilt enabl posit increment stop word querypars ignor per default user explicit enabl issu would add ctor take version constant automat enabl set appli contrib querypars eventu also stopanalyz add version ctor abl remov default ctor 3.0 remov possibl trap user querypars must deprec new one also ad 2.9.1
highlight problem use standardanalyz lucene_29 simplier stopfilt stopwordsposincr mode switch followup lucene-1987 set highligtertest constant static final version test_vers version.lucene_24 lucene_29 lucene_curr test testsimplequeryscorerphrasehighlight fail pleas note current lucene-2002 fix must also set querypars respect posincr
constants.lucene_main_vers inlin code compil lucen jar version detect incorrect compil code lucen 2.9 version jar use lucene_main_vers constant run code 3.0 jar constant still contain 2.9 javac inlin primit string class file public static final generat constant method attach fix fix use ident string function return string itsself prevent inlin appli 2.9 trunk 2.9 bw branch also reenabl one test remov
add lusql project apach lucen contribut wiki page add lusql|http //lab.cisti-icist.nrc-cnrc.gc.ca/cistilabswiki/index.php/lusql apach lucen contribut page http //lucene.apache.org/java/2_9_0/contributions.html author lusql suppli text need perhap new head need captur database/jdbc orient lucen tool other
optim fielddocsortedhitqueu updat core generic found follow optim fielddocsortedhitqueu fielddoc valu compar also score docid appear sortfield multisearch parallelmultisearch code lessthan seem ineffect big switch statement sortfield type cast valu under numer type object call number.xxxvalu co compar manual j.l.number compar see reason call compareto compar interfac happi big deal prevent cast two method call xxxvalu number.compareto work effici intern special case string sort local may use score sort backward two statement instead whole switch test perform opinion faster multisearch test still pass
tokenstream/tokenizer/tokenfilter/token javadoc improv javadoc new tokenstream/tokenizer/tokenfilter/token api javadoc error best knowledg correct refin copi bit
remov segment document delet commit/flush/clos indexwrit instead wait merg occur know bug 2.9.0 seem segment document delet automat remov noformat 4 14 name=_dlo doccount=5 compound=tru hasprox=tru numfiles=2 size mb =0.059 diagnost java.version=1.5.0_21 lucene.version=2.9.0 817268p 2009-09-21 10:25:09 os=suno os.arch=amd64 java.vendor=sun microsystem inc. os.version=5.10 source=flush delet delfilename=_dlo_1.del test open reader ok 5 delet doc test field ..ok 136 field test field norm ok 136 field test term freq prox ok 1698 term 4236 terms/doc pair 0 token test store field .ok 0 total field count avg field per doc test term vector ..ok 0 total vector count avg term/freq vector field per doc noformat n't segment remov automat next commit/clos indexwrit *mike mccandless lucen n't actual short-circuit case ie everi singl doc given segment delet still merg away like normal rather simpli drop immedi index agre would simpl optim open new issu would think iw drop segment immedi ie wait merg optim flush new delet
remov deprec scorer.explain int method remain deprec core easi handl lot 's code core still use explain method scorer e.g phrasequeri explain method move scorer weight
add overrid annot remov deprec api most problem remov method abstract base class e.g scorer.explain also remov sub class overrid easili forget especi method mark deprec subclass ad overrid annot everywher lucen remov simpl compil throw error messag subclass longer overrid method also help prevent well-known trap like overrid hashcod instead hashcod patch generat automat rather larg appli would break mani patch think trunk chang much minimum addit work merg
queryscor spanregexqueri incompat sinc resolut lucene-1685 user suppos rewrit queri submit queryscor bq. bq.r800796 markrmil 2009-08-04 06:56:11 -0700 tue 04 aug 2009 1 line bq bq.lucene-1685 posit awar spanscor becom default scorer highlight spanscor implement replac queryscor old term highlight queryscor renam querytermscor multi-term queri also expand default previous rewrit queri multi-term queri highlight longer unless switch use querytermscor spanscor api queryscor also improv close match api previous queryscor implement bq. great conveni part 's caus difficulti spanregexqueri weightedspantermextractor use query.extractterm collect field use queri spanregexqueri implement method highlight queri spanregexqueri throw unsupportedopertationexcept issu circumv still issu spanregexqueri throw except someon call getspan method provid patch current use 'm sure solut optim add two method spanqueri extractfield set string field equival fields.add getfield except maskedfieldqueri get involv mustberewrittentogetspan return true spanqueri fals spantermqueri overridden composit spanqueri return valu depend compon way spanregexqueri custom spanqueri need adjust current collect field non-weight term done singl step propos patch weightedspanterm extract spanqueri proceed two step first queryscor 's field null field collect spanqueri use extractfield method second term collect use extractterm rewrit queri field mustberewrittentogetspan return true
posit increment bug smartcn use lucene_vers 2.9 smart chines analyz crash indexwrit reason amount chines text especi annoy happen 2.9.1 rc well posit increment token stopword bogus 's exampl test case posit increment 2 instead 91975314 code public void testchinesestopwords2 throw except analyz ca new smartchineseanalyz version.lucene_curr load stopword string sentenc titl san stopword string result titl san int startoffset 0 6 int endoffset 5 9 int posincr 1 2 assertanalyzesto ca sentenc result startoffset endoffset posincr code junit.framework.assertionfailederror posincr 1 expect 2 91975314 junit.framework.assert.fail assert.java:47 junit.framework.assert.failnotequ assert.java:280 junit.framework.assert.assertequ assert.java:64 junit.framework.assert.assertequ assert.java:198 org.apache.lucene.analysis.basetokenstreamtestcase.asserttokenstreamcont basetokenstreamtestcase.java:83
asciifoldingfilt expos fold logic small improv isolatin1accentfilt patch add coupl non-ascii char isolatin1accentfilt name left right singl quotat mark en dash em dash frequent encount project know class deprec improv legaci code n't migrat yet also enabl easi access ascii fold techniqu use asciifoldingfilt potenti re-us non-lucene-rel code
replac invalid u+ffff charact index invalid u+ffff charact embed token actual caus index silent corrupt index write duplic term term dict checkindex catch error merg hit except think alreadi replac invalid surrog pair replac charact u+fffd ll u+ffff
closeablethreadloc obsolet sinc lucen 3 depend java 5 use threadloc remov take care resourc manag
remov unus import churn recent seem like opportun time import cleanup
french elis filter use chararrayset french elis filter creat new string lowercas etc check set string trivial patch use chararrayset instead
remov contrib deprec n't mani deprec contrib remov 3.0 get rid
ant dist longer generat md5 's top-level artifact mark hit 2.9.0 hit 2.9.1 use work
deprec directory.touchfil lucen n't use method findbug report fsdirectori 's impl n't swallow return result file.setlastmodifi
allow separ control whether bodi store analyz simpl enhanc docmak
cachingspanfilt synchron none final protect object cachingspanfilt cachingwrapperfilt expos intern cach via protect member lazili instanti getdocsetid method current code yield chanc doubl instanti cach intern synchron protect none final member first guess member expos test purpos rather chang packag privat patch break backward compat guess cleanup kind worth break
move patternanalyz contrib/memori contrib/analyz memori index contrib patternanalyz think analyz belong contrib/analyz instead relat memori index
spatial filter serializ use lucen distribut setup filter spatial project n't serializ even though inherit filter filter serializ class distancefilt contain non-serializ class weakhashmap cartesianshapefilt contain non-serializ class java.util.logging.logg
massiv code duplic contrib analyz unifli analyz ctor due various tokenstream api lucen analyz subclass need implement least one method return tokenstream look code appear almost ident implement analyz analyz defn inner class savedstream unnecessari contrib almost everi analyz use stopword creat way load defin larg number ctor load stopword file set array etc.. ctor remov deprec eventu remov
tokensources.gettokenstream assign positionincr tokensources.storedtokenstream assign positionincr inform mean token stream consid adjac implic phrase highlight queryscor use non-contigu token exampl consid token stream creat token stem unstem version word fox jump|jump retriev index use tokensources.gettokenstream tpv fals token stream fox jump jump tri search highlight phrase queri fox jump search correct find document highlight fail highlight phrase think addit word fox jump use origin analyz token stream highlight work also consid convers fox jump stop word option increment posit account stop word the,0 fox,1 did,2 jump,4 retriev index use tokensources.gettokenstream tpv fals token stream the,0 fox,1 did,2 jump,3 phrase queri jump caus jump term text jump highlight use origin analyz token stream highlight work correct
allow junit4 test environ re drop java 1.4 compat 3.0 incorpor junit4 test junit3 junit4 test coexist test rewritten start 3.1 releas get clean 3.0 smooth 's probabl worthwhil convert small set test exemplar
systemrequir say 1.5 instead 1.4 websit still say java 1.4 say 1.5
regex support beyond javacc querypars sinc earli day standard queri parser limit queri live core ad queri extend parser way alway forc peopl chang grammar file regener even chang grammar extrem care modifi parser part standard parser affect customis chang eventu live limit current parser like token whitespac token analyz chanc look token think overcom limit add regex support queri parser without introduc depend core ad new special charact basic prevent parser interpret charact enclos new special charact choos forward slash '/ delimit everyth two forward slash basic escap ignor parser char embed within forward slash treat one token even contain special char like whitespac token subsequ pass pluggabl parser extens build queri embed string interpret embed string way leav subsequ work parser extens extens could anoth full featur queri parser simpli ctor call regex queri interfac remain quiet simpl make parser extend easi way compar modifi javacc sourc downsid patch clear introduc new special char syntax guess would much deal reflect escap method though would truli nice extens even flexibl treat patch kickoff though anoth way solv problem regexqueri would move jdk version regex core simpli anoth method like code protect queri newregexqueri term code would like better would consist idea queri parser strict defin parser upload patch second implement extens base approach guess add second patch regex core soon
complet parallelizaton parallelmultisearch parallelmultisearch parallel method signatur search part queri process call method docfreq todo comment parallel parallel method actual increas perform queri multipl index especi remot
allow control print hit add print.hits.field properti alg set hit retriev search* task print along valu specifi field doc
fix commitindextask also commit indexread chang 'm set benchmark lucene-1458 one limit hit commitindextask n't commit pend chang indexread eg via deletebyperc use name commit point
allow random seed set deletebypercenttask need make index ident multipl run
fnfe hit creat empti index infostream shai report dev list simpl test code directori dir new ramdirectori indexwrit writer new indexwrit dir new simpleanalyz maxfieldlength.unlimit writer.setinfostream system.out writer.adddocu new document writer.commit writer.clos code hit code except thread main java.io.filenotfoundexcept _0.prx org.apache.lucene.store.ramdirectory.filelength ramdirectory.java:149 org.apache.lucene.index.documentswriter.segments documentswriter.java:1150 org.apache.lucene.index.documentswriter.flush documentswriter.java:587 org.apache.lucene.index.indexwriter.doflushintern indexwriter.java:3572 org.apache.lucene.index.indexwriter.doflush indexwriter.java:3483 org.apache.lucene.index.indexwriter.flush indexwriter.java:3474 org.apache.lucene.index.indexwriter.adddocu indexwriter.java:1940 org.apache.lucene.index.indexwriter.adddocu indexwriter.java:1894 code turn 's silli actual issu ve alreadi fix flex lucene-1458 branch documentswrit method enumer flush file comput size realli n't use segmentinfo 's method instead
indexreader.iscurr incorrect return fals writer.preparecommit call spinoff thread 2 phase commit extern data java-us indexread see index chang preparecommit call commit call
omit posit keep termfreq would use option discard posit inform still keep term frequenc current setomittermfreqandposit discard even though position-depend queri would n't work case still queri would work fine would get right score
improv contrib/benchmark test near-real-tim search perform 's easi test nrt perform right w/ contrib/benchmark ve made initi fix improv ad new follow task within serial sequenc background task like shell test run bg end serial task still run bg task stop join ad waittask simpli wait use control long bg 'd task get run ad rollbackindex task real handi use given index nrt test bunch updat revert next run use start index fix exist nearrealtimereadertask simpli period open new reader previous also run fix search remov thread sinc period wake open new reader swap perfrundata schedul specifi switch usag perfrundata 's get/setindexread api use ref count chang make simpl power alg eg code openindex nearrealtimeread 0.5 warm search index1 adddoc 100/sec search search 4 wait 30.0 closeread rollbackindex repsumbynam code alg first open indexwrit spawn bg thread reopen nrt reader twice per second one warm search fg span new thread index document rate 100 per second spawn 4 search thread mani search wait 30 second stop thread revert index report patch work progress general work re nocommit may want improv report though think 's separ issu
contrib analyz setter deprec replac ctor argument analyz contrib provid setter stopword stem exclus set hashtabl etc setter deprec yield unexpect behaviour way work set reusabl token stream instanc null thread local cach affect tokenstream current thread analyz immut except threadloc attach patch soon
scan method signatur add vararg possibl chang lot signatur may import one like multiread multisearch alreadi done appli also contrib vararg backward break stay array
thread interrupt throw clear except 3.0 followon lucene-1573 throw dedic except runtimeexcept recent discuss java-dev thread.interrupt subject http //www.lucidimagination.com/search/document/8423f9f0b085034e/thread_interrupt
remov system properti page releas specif doc longer use system properti configur lucen version 3.0 page obsolet remov releas
fix buggi stemmer remov duplic analysi function would like remov stemmer follow packag instead analyz use snowballstemfilt instead analyzers/fr analyzers/nl analyzers/ru excerpt code proud proclaim use snowbal algorithm think delet custom stem code favor actual snowbal packag noformat stemmer french word p algorithm base work dr martin porter snowbal project br refer http //snowball.sourceforge.net/french/stemmer.html br french stem algorithm detail /p public class frenchstemm stemmer dutch word p algorithm implement href= http //snowball.tartarus.org/algorithms/dutch/stemmer.html dutch stem /a algorithm martin porter 's snowbal project /p public class dutchstemm russian stem algorithm implement see http //snowball.sourceforge.net detail descript class russianstemm noformat
topdocscollector bound generic extend scoredoc topdocscollector chang topdocscollector howev method specif assum pq store scoredoc therefor someon extend defin type scoredoc thing break n't put topdocscollector rather chang ctor *protect topdocscollector priorityqueu extend scoredoc pq topdocscollector handl scoredoc type ll need chang fieldvaluehitqueu 's entri extend scoredoc well
benchmark pkg specifi trec_ev submiss output command line querydriv trec benchmark current requir 4 command line argument third argument ignor typic popul bogus instead allow third argument specifi submission.txt file trec_ev add usag document argument driver program
benchmark pkg allow treccontentsourc chang docnam treccontentsourc current append iter number docnam field exampl origin docnam doc0001 index doc0001_0 present problem relev test judg result expect docnam never present patch add option disabl behavior default exist behavior append iter number
cms default maxthreadcount 1 3 rough experi think current default 3 larg think get bang buck go 0 1 think especi impact optim index mani segment case mergepolici happili expos concurr multipl pend merg cms happili launch 3 thread carri
bulgarian analyz someon ask bulgarian analysi solr-us today http //www.lucidimagination.com/search/document/e1e7a5636edb1db2/non_english_languag surpris anyth analyz implement algorithm specifi http //members.unine.ch/jacques.savoy/papers/buir.pdf measur improv map approx 34
highlight support multitermqueri subclass without cast order support multitermqueri subclass highlight compon appli instanceof check concret class lucen core prevent class like regexqueri contrib support introduc depend contrib feasibl support highlight instanceof check subsequ cast might hope go somehow away futur support multterm queri altern approach use fake indexread use rewritemethod forc mtq pass field name given reader without real work easier explain see patch upload short
java 5 port phase ii lucene-1257 address public api chang generic main j.u.c packag chang relat api chang frozen close 3.0 would placehold jira 3.0+ version address pend chang test generic etc intern api chang necessari
add highlight test regexqueri
czech stemmer current czechanalyz mere stopword n't czech stemmer snowbal patch implement light stem algorithm describ http //portal.acm.org/citation.cfm id=1598600 measur improv map 42 analyz use stemmer lucene_vers 3.0 back compat
fix reversestringfilt unicod 4.0 reversestringfilt awar supplementari charact revers creat unpair surrog replac u+fffd index queri time wrong word conflat right word wo n't match basic whole thing fall apart patch implement in-plac revers algorithm apach harmoni abstractstringbuilder.reverse0
fix lowercasefilt unicod 4.0 lowercas suppl charact correct fix filter lowercasetoken part complex issu chartoken
document lengthfilt wrt unicod 4.0 lengthfilt calcul min/max length termattribute.termlength charact instead utf-16 code unit opinion chang mere document chang would advers perform impact would actual calcul character.codepointcount text feel strong otherwis fix count codepoint would trivial patch 'd rather hurt perform admit n't fulli understand use case filter
use separ jflex generat unicod 4 java 5 compat standardtoken current trunk version standardtokenizerimpl generat java 1.4 accord warn java 3.0 switch java 1.5 regener file regener token behav differ charact use new tokenizerimpl version.lucene_30 lucene_31 use matchvers
share term terminfo cach across thread right thread creat thread privat simplelrucach hold 1024 term rather wast sinc high number thread come lucen re multipli ram usag you'r also cut way back likelihood cach hit except known multipl time lookup term within-queri use one thread nrt search open new segmentread tini segment often thread must spend cpu/ram creat popul 1.5 use java.util.concurr eg concurrenthashmap one simpl approach could double-barrel lru cach use 2 map primari secondari check cach first check primari 's miss check secondari get hit promot primari primari full clear secondari swap suggest approach
add org.apache.lucene.store.fsdirectory.getdirectori apach lucene.net side done clean upcom 2.9.1 depreci improp use paramet type public api releas 3.0 depreci code remov one area difficulti requir us add new method like lucene.net.store.fsdirectory.getdirectori method thing lucene.net.store.fsdirectory.getfil necessari switch use system.io.fileinfo system.io.directoryinfo .net world file directori two differ thing add lucene.net.store.fsdirectory.getdirectori ca n't chang return type lucene.net.store.fsdirectory.getfil still remain backward compat api wise depreci next releas ask java lucen add org.apache.lucene.store.fsdirectory.getdirectori keep api 1-to-1 par java lucen lucene.net
changes-to-html better handl bullet list changes.txt bullet list render output html
improv contrib/benchmark test nrt small chang allow specifi prioriti bg thread charact prioriti increment int 's ad main thread 's prioriti set child thread 's nrt test make reopen thread +2 index thread +1 leav search thread default ad test case nearrealtimereopentask report end full array msec reopen latenc ad option breakout count time step set log.time.step.msec eg 1000 report count serial task sequenc broken 1 second window eg use measur slowdown time
improv document version opinion elabor effect chang version paramet particular chang valu even recompil code like involv reindex data think adequ clear current javadoc
remov byte/charbuff wrap collat key generat remov overhead bytebuff charbuff wrap collationkeyfilt icucollationkeyfilt patch move logic indexablebinarystringtool char int int byte int int base method previous byte/charbuff method deleg previous byte/charbuff method requir back array anyway
resolv delet iw resolv term sort order see java-dev thread indexwriter.updatedocu perform improv
remov recurs numericrangetermenum current filteredtermenum nrq use setenum itsself call next may lead recurs overflow stack index empti larg rang low precstep use 64 bit number precstep 1 may 127 recurs sub-rang would hit term empti index setenum call would call next itsself call setenum lead recurs depth 256 attach patch convert iter approach setenum unus throw uoe like endenum
attributesource.addattribut accept interfac miss test lead problem token.token_attribute_factori blocker call addattribut token.class without get error messag commit fix restart vote 3.0 also appli 2.9 token attribut factori merg 2.9 2.9.2 come
explor use automaton fuzzyqueri optim fuzzyqueri use automatontermsenum idea speed core fuzzyqueri similar fashion wildcard regex speedup maintain backward compat advantag seek term use instead brute-forc entir term dict determin match faster true/fals dfa array lookup n't even need run levenshtein build levenshtein dfas linear time respect length word http //citeseerx.ist.psu.edu/viewdoc/summari doi=10.1.1.16.652 implement support prefix length simpli concaten two dfas n't requir us nfa- dfa convers prefix portion singleton concaten also constant time respect size fuzzi dfa need examin start state algorithm parametr tabl precomput dfas construct quick requir number edit larg n't tabl use dumb mode first seek dfa brute forc like prioriti queue fill enumer similar score requir competit term increas enum get faster faster happen term core fuzzyqueri sort boost valu term lexicograph order larg term dictionari low minim similar fill pq quick sinc match mani term provid mechan switch effici dfas edit distanc 2 edit distanc 1 edit distanc 0 enumer also switch dumb mode smart mode design add dfas time ad addit tabl tradeoff tabl get rather larg high k would start increas size lucen 's jar file idea n't includ larg tabl high k use competit boost attribut prioriti queue inform see http //en.wikipedia.org/wiki/levenshtein_automaton
convert automaton char base process termref termsenum api automaton process current done string most termenum base string easi chang process work char sinc behind scene use anyway general think make sure char base process expos automaton pkg anyway thing like pattern-bas token
booleanquery.hashcod equal ignor iscoorddis booleanquery.iscoorddis consid booleanqueri 's hashcod equal method caus serious bad happen cach booleanqueri bug trace back least 1.9
prepar chararrayset unicod 4.0 chararrayset lowercas creat correspond flag caus string char uncod 4 char set retriev ignorecas mode
document guarante found write commit email develop list develop stress test assert new document contain specif term x alway found commit indexwrit work time fail load rare occas 'm test 40 thread serialmergeschedul concurrentmergeschedul share common indexwrit attach testcas use ramdirectori verifi fsdirectori behav way n't believ 's directori implement mergeschedul test slow n't consid function unit test might give fals posit n't alway fail sorri could n't find make like happen besid schedul run longer time test affect version 2.4.1 2.9.1
nrt mode cfs enabl indexwrit incorrect tie disk space spinoff java-us thread titl search optim indexwrit nrt mode ve call getread least cfs enabl intern writer pool reader howev merg complet open reader het non-cf segment file pool build cfs file well thus tie storag segment twice function bug harmless 's disk space issu also segment merg disk space releas though newli merg segment also double-tied-up simpl workaround use non-cf mode n't use getread
make basecharfilt effici perform perform degrad solr 1.4 report see http //www.lucidimagination.com/search/document/43c4bdaf5c9ec98d/html_stripping_slower_in_solr_1_4 ineffici point basecharfilt javadoc mike panel note class particular effici exampl new class instanc creat everi call addoffcorrectmap int int append privat list panel
make contrib analyz final analyz contrib/analyz mark final none analyz ever subclass user build analyz differ combin filter token desir
lowercasefilt turkish languag java.lang.character.tolowercas convert howev turkish alphabet lowercas latin small letter dotless
nolockfactori privat constructor nolockfactori document javadoc one use static getnolockfactori method howev class declar privat empti constructor break singleton purpos add empti privat constructor 'd break break-compat even though think 's low chanc someon actual instanti class therefor ll add deprec warn class add method 4.0 person prefer add empti constructor w/ deprec method fine either way n't know patch need trivial chang
indexwriter.unlock noth nativefslockfactori use nativefslockfactori use indexwriter.unlock return silent noth reason nativefslockfactori 's makelock alway creat new nativefslock nativefslock 's releas first check lock null howev obtain call lock null releas actual noth indexwriter.unlock delet lock fail w/ except problem nativefslock lock implement least abl see need think first reproduc test fix ll work
benchmark close reader openreader/closeread use searcher close reader pass searcher searcher close reader caus resourc leak
add contrib/fast-vector-highlight maven central repo 'm familiar lucen build/deploy process would nice releas fast vector highlight push maven central repositori done contrib modul issu file request grant ingersol
spellcheck file descriptor leak way close indexsearch use spellcheck intern ca n't find way close indexsearch indexread use spellcheck intern ve work around issu keep singl spellcheck open index 'd realli like abl close reopen demand without leak file descriptor could add close method spellcheck close indexsearch null refer perhap add code reopen searcher refer null would break thread safeti spellcheck attach patch add close method leav user call setspellindex reopen searcher desir
make docsenum subclass docidsetiter spinoff lucene-1458 one thing came along long time ago new api get 's interest docsenum extend docidsetiter would make simplier use implement e.g matchalldocquery.scor fieldcacherangefilt could e.g write filter document simpli return doc enumer indexread abstract class extend docidsetiter method method must littl bit renam problem java support multipl inheritac also extend attributesourc would docidsetiter interfac would work one case interfac realli simpl pattern use like iter problem multipl inherit could solv addit method attribut creat new attributesourc first access construct attributesourc cost appli *enum separ lazi init docsenum could look like code public abstract class docsenum extend docidsetiter privat attributesourc att null public int freq public dontknowclassnam posit public final attributesourc attribut atts==nul atts=new attributesourc return att default impl bulk access use abstract method docidsetiter code
refactor filteredtermsenum multitermqueri filteredtermsenum confus initi posit first term instead work like uniniti termsenum field first call next seek filteredtermsenum implement seek eg nrq automaton abl support seek also need mtq seek throw uoe issu chang intern behaviour mtq filteredtermsenum allow also seek nrq automaton see comment
wrapup flexibl index spinoff lucene-1458 flex branch fair good shape test pass initi search perform test look good surviv sever visit unicod policeman still number nocommit could use scrutini especi emul old api flex index vice/versa code path still need perform test ll issu open separ issu self contain fix end sight
flex non-flex emul termsenum incorrect seeks/next beyond current field spinoff lucene-2111 uwe found issu flex non-flex emul
singletermsenum singletermsenum flex like exist singletermenum filteredtermsenum match one term preserv multitermqueri semant
improv org.apache.lucene.search.filt document test reflect per segment reader filter javadoc mention reader pass getdocidset reader could per-seg basi caus confus users-list see http //lucene.markmail.org/message/6knz2mkqbpxjz5po q=date:200912+list org.apache.lucene.java-us page=1 improv javadoc also add testcas reflect filter per-seg basi
port generic test case contrib lucene-1257 lucen 3.0 address port generic across public api- lucene-2065 address across src/test would placehold jira remain pend generic convers across code base pleas keep open commit close near 3.1 releas could placehold ticket
add link irc channel lucen websit add link lucen irc channel chat.freenode.org
fix snowballanalyz case behavior turkish languag lucene-2102 ad new tokenfilt handl turkish uniqu case behavior correct fix case behavior snowballanalyz support turkishstemm
intermitt failur testindexwritermergepolicy.testmaxbuffereddocschang last night 's build fail http //hudson.zones.apache.org/hudson/job/lucene-trunk/1019/chang 's exc code junit testcas testmaxbuffereddocschang org.apache.lucene.index.testindexwritermergepolici fail junit maxmergedocs=2147483647 numsegments=11 upperbound=10 mergefactor=10 junit junit.framework.assertionfailederror maxmergedocs=2147483647 numsegments=11 upperbound=10 mergefactor=10 junit org.apache.lucene.index.testindexwritermergepolicy.checkinvari testindexwritermergepolicy.java:234 junit org.apache.lucene.index.testindexwritermergepolicy.testmaxbuffereddocschang testindexwritermergepolicy.java:164 junit org.apache.lucene.util.lucenetestcase.runbar lucenetestcase.java:208 code test n't fail run opensolari os x machin
pass integer.max_valu 2nd param search queri int hit unexpect negativearraysizeexcept note nonsens valu pass sinc pq impl alloc array front 's pq take 1+ valu wrap -1 attempt alloc bound check drop pq size one case better mayb indexsearch n ever maxdoc set maxdoc trip user fair often assum pq n't static pre-alloc reason assumpt
add unicodeutil.nextvalidutf16str flex branch termref must contain unpair surrog etc trunk/previ releas peopl could seek also lucen multitermqueri generat invalid seek locat even separ fix think common case alreadi handl hack segmentreader.legacytermenum clean hack handl case would also like use nextvalidutf16str lucene-1606 might place could use better bw compat
move fuzzyqueri rewrit separ rewritemod mtq highlight fail highlight fuzzyqueri fuzzyqueri allow chang rewrit mode highlight fail uoe flex sinc lucene-2110 chang rewrit mode boolean queri fix allow mtq chang rewrit method make fuzzy_rewrit public rewrit mode live mtq top_terms_scoring_boolean_rewrit also code refactor make heavi reus term enumer code plug pq filter top term
move jdk collat core icu collat icu contrib mention list propos move jdk-base collationkeyfilter/collationkeyanalyz current locat contrib/col core collat support language-sensit sort much code heavi duti stuff alreadi core indexablebinarystr would also like move icucollationkeyfilter/icucollationkeyanalyz along jar file depend also current locat contrib/col contrib/icu way start look integr function icu fully-flesh icu contrib
split indexinput indexoutput datainput dataoutput 'd like introduc two new class datainput dataoutput contain method indexinput indexoutput actual decod encod data readbyt /writebyt readvint /writevint method like getfilepoint seek close etc. relat data encod file input/output sourc stay indexinput/indexoutput patch also chang byteslicereader/byteslicewrit extend datainput/dataoutput previous bytesliceread implement method stay indexinput throw runtimeexcept see also lucene-2125 test pass
parallelizaton parallelmultisearch call search queri filter int parallelmultisearch createweight function multisearch call sequenti call docfreq everi sub-search take signific amount time lot remot sub-search
standard codec 's term dict seek scan new term index block terminfosread trunk alreadi optim case need flex
demo applic work 3.0 demo applic work querypars need version argument remov author
patch ant-task javadocs-al fail outofmemoryerror hi current night build 's ant dist fail outofmemoryerror ant task javadocs-al see appar javadoc need memori similar case report hadoop-5561 add maxmemori statement javadoc task propos chang lucen well cheer christian javadocs-al javadoc generat javadoc javadoc javadoc execut javadoc load sourc file packag org.apache.lucen javadoc load sourc file packag org.apache.lucene.analysi javadoc load sourc file packag org.apache.lucene.queryparser.standard.config javadoc load sourc file packag org.apache.lucene.queryparser.standard.nod javadoc load sourc file packag org.apache.lucene.queryparser.standard.pars javadoc load sourc file packag org.apache.lucene.queryparser.standard.processor javadoc construct javadoc inform javadoc standard doclet version 1.6.0_15 javadoc build tree packag class take long time oom javadoc java.lang.outofmemoryerror java heap space javadoc java.lang.outofmemoryerror java heap space javadoc java.lang.throwable.getstacktraceel nativ method javadoc java.lang.throwable.getourstacktrac throwable.java:591 javadoc java.lang.throwable.printstacktrac throwable.java:462 javadoc java.lang.throwable.printstacktrac throwable.java:451 javadoc com.sun.tools.doclets.internal.toolkit.builders.abstractbuilder.build abstractbuilder.java:103 javadoc com.sun.tools.doclets.internal.toolkit.builders.abstractmemberbuilder.build abstractmemberbuilder.java:56 javadoc com.sun.tools.doclets.internal.toolkit.builders.classbuilder.buildmembersummari classbuilder.java:279 javadoc sun.reflect.nativemethodaccessorimpl.invoke0 nativ method javadoc sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:39 javadoc sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:25 javadoc java.lang.reflect.method.invok method.java:597 javadoc com.sun.tools.doclets.internal.toolkit.builders.classbuilder.invokemethod classbuilder.java:101 javadoc com.sun.tools.doclets.internal.toolkit.builders.abstractbuilder.build abstractbuilder.java:90 javadoc com.sun.tools.doclets.internal.toolkit.builders.classbuilder.buildclassdoc classbuilder.java:124 javadoc sun.reflect.nativemethodaccessorimpl.invoke0 nativ method javadoc sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:39 javadoc sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:25 javadoc java.lang.reflect.method.invok method.java:597 javadoc com.sun.tools.doclets.internal.toolkit.builders.classbuilder.invokemethod classbuilder.java:101 javadoc com.sun.tools.doclets.internal.toolkit.builders.abstractbuilder.build abstractbuilder.java:90 javadoc com.sun.tools.doclets.internal.toolkit.builders.classbuilder.build classbuilder.java:108 javadoc com.sun.tools.doclets.formats.html.htmldoclet.generateclassfil htmldoclet.java:155 javadoc com.sun.tools.doclets.internal.toolkit.abstractdoclet.generateclassfil abstractdoclet.java:164 javadoc com.sun.tools.doclets.internal.toolkit.abstractdoclet.startgener abstractdoclet.java:106 javadoc com.sun.tools.doclets.internal.toolkit.abstractdoclet.start abstractdoclet.java:64 javadoc com.sun.tools.doclets.formats.html.htmldoclet.start htmldoclet.java:42 javadoc com.sun.tools.doclets.standard.standard.start standard.java:23 javadoc sun.reflect.nativemethodaccessorimpl.invoke0 nativ method javadoc sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:39 javadoc sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:25 javadoc java.lang.reflect.method.invok method.java:597 javadoc com.sun.tools.javadoc.docletinvoker.invok docletinvoker.java:269 javadoc java.lang.outofmemoryerror java heap space javadoc java.util.arrays.copyofrang arrays.java:3209 javadoc java.lang.string. init string.java:215 javadoc com.sun.tools.javac.util.convert.utf2str convert.java:131 javadoc com.sun.tools.javac.util.name.tostr name.java:164 javadoc com.sun.tools.javadoc.classdocimpl.getclassnam classdocimpl.java:341 javadoc com.sun.tools.javadoc.typemaker.gettypenam typemaker.java:100 javadoc com.sun.tools.javadoc.parameterizedtypeimpl.parameterizedtypetostr parameterizedtypeimpl.java:117 javadoc com.sun.tools.javadoc.typemaker.gettypestr typemaker.java:121 javadoc com.sun.tools.javadoc.executablememberdocimpl.makesignatur executablememberdocimpl.java:217 javadoc com.sun.tools.javadoc.executablememberdocimpl.signatur executablememberdocimpl.java:198 javadoc com.sun.tools.doclets.internal.toolkit.util.visiblemembermap.getmemberkey visiblemembermap.java:485 javadoc com.sun.tools.doclets.internal.toolkit.util.visiblemembermap.access 1000 visiblemembermap.java:28 javadoc com.sun.tools.doclets.internal.toolkit.util.visiblemembermap classmembers.isoverridden visiblemembermap.java:442 javadoc com.sun.tools.doclets.internal.toolkit.util.visiblemembermap classmembers.addmemb visiblemembermap.java:316 javadoc com.sun.tools.doclets.internal.toolkit.util.visiblemembermap classmembers.build visiblemembermap.java:278 javadoc com.sun.tools.doclets.internal.toolkit.util.visiblemembermap classmembers.access 100 visiblemembermap.java:230 javadoc com.sun.tools.doclets.internal.toolkit.util.visiblemembermap. init visiblemembermap.java:93 javadoc com.sun.tools.doclets.formats.html.constructorwriterimpl. init constructorwriterimpl.java:38 javadoc com.sun.tools.doclets.formats.html.writerfactoryimpl.getconstructorwrit writerfactoryimpl.java:129 javadoc com.sun.tools.doclets.formats.html.writerfactoryimpl.getmembersummarywrit writerfactoryimpl.java:141 javadoc com.sun.tools.doclets.internal.toolkit.builders.membersummarybuilder.init membersummarybuilder.java:104 javadoc com.sun.tools.doclets.internal.toolkit.builders.membersummarybuilder.getinst membersummarybuilder.java:64 javadoc com.sun.tools.doclets.internal.toolkit.builders.builderfactory.getmembersummarybuild builderfactory.java:191 javadoc com.sun.tools.doclets.formats.html.classwriterimpl.navsummarylink classwriterimpl.java:474 javadoc com.sun.tools.doclets.formats.html.classwriterimpl.printsummarydetaillink classwriterimpl.java:456 javadoc com.sun.tools.doclets.formats.html.htmldocletwriter.navlink htmldocletwriter.java:462 javadoc com.sun.tools.doclets.formats.html.classwriterimpl.writefoot classwriterimpl.java:146 javadoc com.sun.tools.doclets.internal.toolkit.builders.classbuilder.buildclassfoot classbuilder.java:330 javadoc sun.reflect.nativemethodaccessorimpl.invoke0 nativ method javadoc sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:39 javadoc sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:25 javadoc java.lang.reflect.method.invok method.java:597 javadoc java.lang.outofmemoryerror java heap space javadoc java.util.linkedhashmap.createentri linkedhashmap.java:424 javadoc java.util.linkedhashmap.addentri linkedhashmap.java:406 javadoc java.util.hashmap.put hashmap.java:385 javadoc sun.util.resources.openlistresourcebundle.loadlookup openlistresourcebundle.java:118 javadoc sun.util.resources.openlistresourcebundle.loadlookuptablesifnecessari openlistresourcebundle.java:97 javadoc sun.util.resources.openlistresourcebundle.handlegetobject openlistresourcebundle.java:58 javadoc sun.util.resources.timezonenamesbundle.handlegetobject timezonenamesbundle.java:59 javadoc java.util.resourcebundle.getobject resourcebundle.java:378 javadoc java.util.resourcebundle.getobject resourcebundle.java:381 javadoc java.util.resourcebundle.getstringarray resourcebundle.java:361 javadoc sun.util.timezonenameutility.retrievedisplaynam timezonenameutility.java:100 javadoc sun.util.timezonenameutility.retrievedisplaynam timezonenameutility.java:81 javadoc java.util.timezone.getdisplaynam timezone.java:399 javadoc java.util.timezone.getdisplaynam timezone.java:350 javadoc java.util.date.tostr date.java:1025 javadoc com.sun.tools.doclets.formats.html.markup.htmldocwriter.today htmldocwriter.java:337 javadoc com.sun.tools.doclets.formats.html.htmldocletwriter.printhtmlhead htmldocletwriter.java:281 javadoc com.sun.tools.doclets.formats.html.classwriterimpl.writehead classwriterimpl.java:122 javadoc com.sun.tools.doclets.internal.toolkit.builders.classbuilder.buildclasshead classbuilder.java:164 javadoc sun.reflect.nativemethodaccessorimpl.invoke0 nativ method javadoc sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:39 javadoc sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:25 javadoc java.lang.reflect.method.invok method.java:597 javadoc com.sun.tools.doclets.internal.toolkit.builders.classbuilder.invokemethod classbuilder.java:101 javadoc com.sun.tools.doclets.internal.toolkit.builders.abstractbuilder.build abstractbuilder.java:90 javadoc com.sun.tools.doclets.internal.toolkit.builders.classbuilder.buildclassdoc classbuilder.java:124 javadoc sun.reflect.nativemethodaccessorimpl.invoke0 nativ method javadoc sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:39 javadoc sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:25 javadoc java.lang.reflect.method.invok method.java:597 javadoc com.sun.tools.doclets.internal.toolkit.builders.classbuilder.invokemethod classbuilder.java:101 javadoc com.sun.tools.doclets.internal.toolkit.builders.abstractbuilder.build abstractbuilder.java:90 javadoc java.lang.outofmemoryerror java heap space javadoc java.lang.outofmemoryerror java heap space javadoc java.lang.outofmemoryerror java heap space javadoc java.lang.outofmemoryerror java heap space javadoc java.lang.outofmemoryerror java heap space
indexreader.clos forc evict entri fieldcach spinoff java-us thread heap memori issu sort string field reli weakhashmap hold fieldcach key reader lack immediaci releas refer reader close weakhashmap ca n't free key reader longer referenc app appar weakhashmap impl detail requir invok one method notic key becom weak reachabl fix think ir.clos evict entri fieldcach long sub-read truli close refcount drop 0
multiread use pq term/senum 1 reader relat lucene-2130 even though ve switch segment-bas search still time term/senum use top-level reader think solr lucene-2130 certain rewrit mode mtq well current optim index mtq still use pq present term silli add sizabl amount overhead case simpli delec singl segment note singl segment delet still deleg ie index need optim singl segment
replac segmentreader.ref atomicinteg think patch appli backcompat tag entireti
toptermsscoringbooleanqueryrewrit minscor use toptermsscoringbooleanqueryrewrit lucene-2123 would nice multitermqueri could set attribut specifi minimum requir score prioriti queue fill way filteredtermsenum could adjust behavior accord base minim score need actual use term i.e pass thru pq exampl fuzzytermsenum point bottom prioriti queue contain word edit distanc 1 enumer term simpli wast time term compar score termtext case fuzzytermsenum could simpli seek exact match end behavior could also general n differ impl fuzzyqueri look term dictionari word within edit distanc n lowest score term pq adjust behavior enumer term depend upon attribut filteredtermsenum could make use minim score way drive effici behavior wast time enumer useless term
fieldcache.getstringindex throw except term count exceed doc count spinoff lucene-2133/lucene-831 current fieldcach handl one valu per field may someday want fix day fieldcache.getstringindex current simplist check tri catch ve accident allow one term per field test number uniqu term exceed number document problem perfect check allow fals negat could one term per field doc check wo n't catch except thrown uncheck runtimeexcept mean could happili think good day well product ve updat enough doc sudden check catch throw unhandl except stop search need sort string field track 's grace degrad think simpli remov test ie term doc term simpli overwrit one anoth
instantiatedindexread handl termdoc null correct alltermdoc patch contain core chang someon els need commit due incompat termdoc null behaviour least matchalldocsqueri fieldcacherangefilt valuesourcequeri fail use ii sinc 2.9 alltermdoc superclass abstractalltermdoc also instantiatedalltermdoc extend also ii-test made less plausabl pass futur incompat chang termdoc termenum iitermdoc skipto next mimic behaviour document posis segmenttermdoc dito return fals ii use bitvector rather set delet document
improv spatial util like class distanceunit improv give function enum abl convert differ unit ad test geohashutil improv code tidi document test spatialconst allow us move constant radii circumfer earth singl consist locat use throughout contrib also allow us improv transpar calcul done contrib user contrib easili see valu use current issu migrat class use constant happen issu relat appropri class
build enabl uncheck warn javac uncom code generic java 1.5 compilerarg line= -xlint uncheck code common-build.xml test core clean contrib still mani warn either fix contrib issu condition anyon anti contrib fix
indexreader.open take codec need make public 's privat
random local test failur test fail random hard reproduc appear caus uniniti date field exampl uwe report failur today test testquerypars code test legaci datefield support public void testlegacydaterang throw except string startdat getlocalizedd 2002 1 1 fals string enddat getlocalizedd 2002 1 4 fals code look helper getlocalizedd see 4th argument fals initi date field function code privat string getlocalizedd int year int month int day boolean extendlastd calendar calendar new gregoriancalendar calendar.set year month day extendlastd calendar.set calendar.hour_of_day 23 calendar.set calendar.minut 59 calendar.set calendar.second 59 code think solut test whereev creat new gregoriancalendar follow call calendar.clear ensur alway initi unus calendar field zero rather depend local time
use atomicinteger/boolean track ir.refcount iw.clos less cost synchron method
delimitedpayloadtokenfilt copi bufer itsself instead set length also optim logic small improv found look around also bad idea copi array itsself test pass commit later
nrt temporarili lose delet high index rate ok found sneaki case nrt temporarili lose delet delet n't perman lost seen next open nrt reader happen like iw.getread first flush call flush ad doc materi delet next statement enter sync 'd block open reader index rate high thread get schedul appropri natur flush due ram buffer full flush doc count reach could hit sync block enter case 2nd flush wo n't materi delet associ return nrt reader see add 's next reopen fix simpl materi delet insid sync block flush
concurr improv nrt concurr improv nrt found fix silli thread bottleneck affect nrt multi/directoryreader.numdoc synchron think 1 thread comput numdoc 's -1 remov sync made numdoc volatil instead yes multipl thread may comput numdoc first time think 's harmless fix bitvector 's ctor set count 0 creat new bv clone copi count save cpu comput count unecessarili also strengthen assert done sr test delet doc count also found annoy thread bottleneck happen due cms whenev cms hit max run merg default chang 3 1 recent merg polici want launch anoth merg forc incom thread wait one bg thread finish basic crude throttl mechan forc mutat whoever caus new segment appear stop merg catch unfortun stress nrt thread one that open new nrt reader first serious problem happen call .reopen nrt reader call simpli forward iw.getread reader nrt reader directoryreader.doreopen synchron horribl effect hold monitor lock main ir test block search sinc search use incref/decref still sync 'd lucene-2156 least fix make doreopen sync 'd 's simpli forward getwrit 's good step forward prevent search block tri reopen new nrt howev n't fix problem immens merg run open nrt reader could hit tremend delay cms block balancedsegmentmergepolici help avoid immens merg think also pursu improv cms eg 2 merg run one huge one tini ought increas thread prioriti tini one think chang could increas max thread count prevent starvat ll open separ issu
extendablequerypars allow extens access toplevel parser settings/ properti base latest discuss lucene-2039 issu expos toplevel parser via extensionqueri extensionpars access properti like getallowleadingwildcard top level parser
make cms smarter thread prioriti spinoff lucene-2161 hard throttl cms block incom thread want launch new merg devast strike nrt reopen easili happen huge merg run tini merg need clean recent creat segment due frequent reopen think small chang cms wherebi assign higher thread prioriti tini merg big merg allow us increas max merg thread count great reduc chanc nrt 's reopen would hit
snowballanalyz lack constructor take set stop word discuss java-us list snowballanalyz updat use set stop word howev constructor accept set 's origin string one issu common sourc stop word eg stopanalyz deprec string stop word list move set eg stopanalyzer.english_stop_words_set either use deprec field stopanalyz manual turn set array pass snowballanalyz would suggest constructor ad snowballanalyz accept set sure old string one deprec sampl patch 2.9.1 add constructor snowballanalyzer.java.orig 2009-12-15 11:14:08.000000000 +0000 +++ snowballanalyzer.java 2009-12-14 12:58:37.000000000 +0000 -67,6 +67,12 stopset stopfilter.makestopset stopword build name analyz given stop word public snowballanalyz version matchvers string name set stopwordsset matchvers name stopset stopwordsset
hit max term prefix warn index never goe away silli bug iw 's infostream warn whenev hit ridicul long term 16 kb length problem never reset warn one doc contain massiv term keep warn term futur doc
implement standardtoken uax 29 standard would realli nice standardtoken adher straight standard much jflex name would actual make sens transit would involv renam old standardtoken europeantoken javadoc claim bq good token european-languag document new standardtoken could say bq good token languag english/euro-centr stuff like acronym/company/apostroph stuff stay europeantoken could use european analyz
benchmark alg ca n't handl negat relat prioriti set thread relat prioriti run bg task use negat number 's pars 0
speedup chararrayset copi chararrayset instanc pass copi copi method use entri array copi set intern instead iter valu would speedup copi even small set
thread starvat problem test test time limit set test intim loop creation thread heavi load slow task done test use task least done would even fail thread chang loop task run least one time
field ctor take byte n't take store sinc must yes api silli make think set store.no binari field use meaning also accept compress 's orphan
benchmark contrib allow multipl locat ext.classpath ant run-task invok -dbenchmark.ext.classpath= option singl locat may specifi classpath one locat specifi none locat put classpath invok jvm
chararrayset.clear need chararrayset.clear someth work solr tokenstream instead end use chararraymap boolean support .clear would better use set though current throw uoe .clear abstractset call iterator.remov throw uoe solr similar chararraymap.clear look like code overrid public void clear count 0 arrays.fil key null arrays.fil valu null code think similar thing long throw uoe unmodifiablechararrayset submit patch later tonight unless someon bore noth better
deprec api call o.a.l.stor directori ran niofsdirectori other still call getfil instead getdirectori
benchmark collat steven row attach contrib/benchmark-bas benchmark collat jdk icu lucene-2084 along instruct run think would nice could turn committ patch add benchmark
default_attribute_factori faill load implement class iterfac come differ classload followup http //www.lucidimagination.com/search/document/1724fcb3712bafba/using_the_new_tokenizer_api_from_a_jar_fil default_attribute_factori load implement class given attribut interfac classload like attribut interfac current code load classload lucene-core.jar file solr fail interfac jar file come plugin folder interfac load correct addattribut fooattribute.class load fooattribute.class plugin code success addattribut tri load class local lucene-core.jar classload find attribut fix tell class.fornam use classload correspond interfac correct way handl impl attribut alway classload file hope somehow add test
supplementari charact handl chartoken chartoken abstract base class token oper charact level yet token still use char primit instead int codepoint chartoken oper codepoint preserv bw compat
cartesianpolyfilterbuild n't proper account tier actual exist index cartesianshapefilterbuild logic determin best fit tier creat filter howev account field actual exist index instanc index tier 1 10 choos small radius restrict space like choos tier like 15 16 cours exist
add deprec annot discuss lucene-2084 think consist use deprec annot use patch add miss annot unfortun commit time internet connect support heavi commit difficult even upload larg patch someon want take fun otherwis week commit nobodi object
first cut column-strid field index valu storag creat initi basic impl store index valu ie column-strid valu storag still work progress approach look compel 'm post current status/patch get feedback/iter etc code standalon live new packag oal.index.valu plus util chang refactor yet integr lucen eg mark given field 's valu store index valu sort use valu instead field cach etc handl 3 type valu six variant byte per doc combin fix vs variabl length store either straight good eg titl field deref good mani doc share valu wo n't sort sort integ variabl bit precis use necessari ie store byte/short/int/long precis float 4 8 byte precis string field store utf8 byte patch add bytesref thing flex 's termref merg patch also add basic initi impl packedint lucene-1990 swap if/when get better impl storag dens like field cach 's appropri field occur all/most doc 's like field cach except read api get method invoc per document next step basic integr lucen compar sort perform vs field cach sort string valu case think ram usag gc load index valu api much better field caach sinc creat object per document instead share big long byte across doc valu store ram utf8 byte abstract writer/read class current reader impl entir ram resid like field cach api think agnost ie one could make mmap impl instead think first babi step toward lucene-1231 ie yet updat valu read api fulli random-access docid like field cach like post list though think add iter api return flex 's docsenum eg think would good way track avg doc/field length bm25/lnu.ltc score
handi util class track deprec overridden method issu provid new handi util class keep track overridden deprec method non-fin sub class class use new deprec see javadoc exampl
customscorequeri function queri broken due per-seg search spinoff http //lucene.markmail.org/message/psw2m3adzibaixbq cutov per-seg search customscorequeri realli usabl anymor per-doc custom score method customscor receiv per-seg docid yet way figur segment current search think fix must also notifi subclass whenev new segment switch think copi collector.setnextread would suffici would default noth customscorequeri subclass could overrid
get rid backward tag followup http //www.lucidimagination.com/search/document/bb6c23b6e87c0b63/back_compat_folders_in_tags_when_i_svn_upd 3000a2232c678031 current use tag specifi revis number backward branch match current develop branch revis common-build.xml idea specifi correspond revis backward branch common-build.xml backwards-test target automat handl up/down/co give rev number common-build common-build.xml properti backwards-rev= xxxx properti use also build command line also properti backwards-svn-args= -r backwards-rev use ant -dbackwards-svn-args= forc test-backward checkout/upd head branch recommen develop renam target test-backward keep test-tag depend compat checkout backward creat directori backwards/ backwards-branch use svn co backwards-svn-arg http //svn backwards-branch backwards/ backwards-branch cool thing dir check non exist checkout alreadi exist svn co implicit svn given revis also downgrad merg newer test-backward target alway updat checkout correct revis tri local chang simpli merg svn workflow commit fix bw would first use svn upgrad backward work copi head commit chang copi past messag commit revis xxxx common-build.xml commit chang trunk
improv effici snowballfilt snowbal stem current creat 2 new string 1 new stringbuild everi word unnecessari n't
speedup chararrayset set empti chararrayset contain alway creat hashcod string char charsequ even set empti contain return fals set empti
spellcheck implement java.io.clos lucen class implement closabl indexwrit spellcheck
stopfilt creat new chararrayset given set alreadi instanc chararrayset lucene-2094 new chararrayset creat matter type set pass stopfilt behav document could introduc serious perform problem yet accord javadoc instanc chararrayset pass chararrayset.copi fast chararrayset instanc instead copi via new chararrayset
support protect word stem tokenfilt lucene-1515 propos stem tokenfilt exclus set bypass stem word set stem tokenfilt would one way karl implement new swedish stemmer text file ignor word addit would remov duplic lucen solr reimplement snowballfilt sinc function final think pretti common use case peopl want ignor thing like proper noun stem altern design consid case general chararraymap ignor word would mean map would also provid mechan overrid stem algorithm think expert could filter exampl find dutch stemmer think provid ignor chararrayset feel otherwis pleas comment
shinglefilt skip trie-shingl outputunigram set fals spinoff http //lucene.markmail.org/message/uq4xdjk26yduvnpa quot notic set outputunigram fals give output maxshinglesize=2 maxshinglesize=3 pleas divid divid sentenc set maxshingles 4 output pleas divid pleas divid sentenc divid sentenc expect output follow maxshinglesize=3 outputunigrams=fals pleas divid divid sentenc quot
sever final class non-overrid protect member protect member access final class except protect method overrid superclass 's protect method make littl sens attach patch convert final class protect access field privat remov two final class unus protect constructor convert one final class 's protect final method privat
perform improv snowbal took serious look snowbal lucene-2194 give great improv perform note minor break snowbal intern among. becom char instead string snowballprogram.curr becom char instead stringbuild snowballprogram.eq_ int string becom eq_ int charsequ eq_v stringbuild doesnt need creat extra string eq_s_b eq_v_b replace_ int int string becom replace_ int int charsequ stringbuilder-bas slice insert method n't need creat extra string break imho theoret problem pretti much everyth public protect snowbal intern perform improv depend heavili upon snowbal languag use way signific lucene-2194
improv snowbal test snowbal project test vocabulari file languag svn repositori along expect output use test ensur languag work correct might help futur identifi back breaks/chang ever want upgrad snowbal etc
fastvectorhighlight class member public access implement fragmentsbuild intend design custom fragmentsbuild written pluggabl though tri write fvh packag came class member public access
rework terminfosread class remov term terminfo index pointer long creat memori effici data structur basic pack three array byte array int array index offset perform benefit stager test index size 6.2 gb ~1,000,000 document ~175,000,000 term memori need load terminfo memori reduc 17 origin size 291.5 mb 49.7 mb random access speed made better 1-2 load time segment ~40 faster well full gc 's jvm made 7 time faster alreadi perform work offer code patch current test trunk pass new code enabl write system properti switch allow origin implement use well -dorg.apache.lucene.index.terminfosreader=default small also written blog patch link http //www.nearinfinity.com/blogs/aaron_mccurry/my_first_lucene_patch.html
integr snowbal stopword list snowbal project creat stopword list well stemmer exampl http //svn.tartarus.org/snowball/trunk/website/algorithms/english/stop.txt view=markup patch includ follow snowbal stopword list 13 languag contrib/snowball/resourc stoplist unmodifi ad licens header convert one whatev encod utf-8 ad getsnowballwordset wordlistload format file differ exampl support multipl word per line embed comment add chang snowballanalyz actual automat use list yet would like us discuss futur issu propos integr snowbal contrib/analyz
cjktoken generat token incorrect offset index japanes *multi-valued* document cjktoken highlight term fastvectorhighlight output snippet incorrect highlight string ll attach program reproduc problem soon
token div exceed length provid text size 4114 doc contain html code want strip html tag make test clear appli highlight clear text highlight throw except strip html charact n't strip work fine confus moment copi past 3 thing consol may contain special charact might caus problem 1 html text h2 starter /h2 div id= tab1-cont class= tabcont select div class= head /div div class= bodi div class= subject-head learn path histori /div h3 key question /h3 p transport fuel industri revolut /p h3 learn object /h3 ul li categoris point argument /li /ul p h3 /h3 ul li watch clip em transport fuell industri revolution. /em /li /ul p clip claim transport fuell industri revolut historian argu industri revolut happen develop transport. /p ul li read statement decid point em /em point em /em argument industri expand 18th 19th centuri develop transport. /li /ul ol type= li industri expand invent discoveri steam power. /li li improv transport allow good sold countri world custom develop industri for. /li li develop transport allow resourc coal mine cotton america come togeth manufactur products. /li li transport develop industri need slow develop money spent improv road build canal replac railway order keep industry. /li /ol p tri think 2 statement own. /p /div div class= foot /div /div h2 main activ /h2 div id= tab2-cont class= tabcont div class= head /div div class= bodi div class= subject-head learn path histori /div h3 learn object /h3 ul li select evid support point /li /ul h3 /h3 ul li watch clip em windmil water mill /em /li /ul ul li choos 4 point think import tri balanc two strong /strong two strong /strong /li li write one point box paragraph sheet href= lp_history_industry_transport_ws1.html class= link-intern construct balanc argument /a /li /ul p might like re write point word use connect link paragraphs. /p p histori argument need evid support points. /p ul li find evid sourc knowledg support point /li /ul ol li href= ../servlet/link template=vid macro=setresourc resourceid=2044 class= link-intern toll gate /a /li li href= ../servlet/link macro=setresourc template=vid resourceid=2046 class= link-intern canal /a /li li href= ../servlet/link macro=setresourc template=vid resourceid=2043 class= link-intern grow citi traffic /a /li li href= ../servlet/link macro=setresourc template=vid resourceid=2047 class= link-intern impact railway /a /li li href= ../servlet/link macro=setresourc template=vid resourceid=2048 class= link-intern sail ship /a /li li href= ../servlet/link macro=setresourc template=vid resourceid=2050 class= link-intern liverpool capit cultur /a /li /ol p tri specif evid use name exampl place peopl use date can. /p /div div class= foot /div /div h2 plenari /h2 div id= tab3-cont class= tabcont div class= head /div div class= bodi div class= subject-head learn path histori /div h3 learn object /h3 ul li judg argument valid /li /ul h3 /h3 ul li watch clip em food rich /em /li /ul p order good historian get good mark exam need show evalu skill make judgement evid point think import evid evid convinc /p ul li final box worksheet write conclus explain whether balanc evid enough convinc transport fuell industri revolution. /li /ul /div div class= foot /div /div h2 extens /h2 div id= tab4-cont class= tabcont div class= head /div div class= bodi div class= subject-head learn path histori /div h3 /h3 p watch clip em stress ski resort /em /p p new industri tourism said fuell transport improvements. /p ul li search clipbank use relat clip list well search function find exampl around world transport help industry. /li /ul /div div class= foot /div /div 2- text strip html tag starter learn path histori key question transport fuel industri revolut learn object categoris point argument watch clip transport fuell industri revolut clip claim transport fuell industri revolut historian argu industri revolut happen develop transport read statement decid point point argument industri expand 18th 19th centuri develop transport industri expand invent discoveri steam power improv transport allow good sold countri world custom develop industri develop transport allow resourc coal mine cotton america come togeth manufactur product transport develop industri need slow develop money spent improv road build canal replac railway order keep industri tri think 2 statement main activ learn path histori learn object select evid support point choos 4 point think import tri balanc two two write one point box paragraph sheet construct balanc argument might like re write point word use connect link paragraph histori argument need evid support point find evid sourc knowledg support point toll gate canal grow citi traffic impact railway sail ship liverpool capit cultur tri specif evid use name exampl place peopl use date plenari learn path histori learn object judg argument valid order good historian get good mark exam need show evalu skill make judgement evid point think import evid evid convinc final box worksheet write conclus explain whether balanc evid enough convinc transport fuell industri revolut extens learn path histori watch clip stress ski resort new industri tourism said fuell transport improv search clipbank use relat clip list well search function find exampl around world transport help industri 3- except get org.apache.lucene.search.highlight.invalidtokenoffsetsexcept token div exceed length provid text size 4114 org.apache.lucene.search.highlight.highlighter.getbesttextfrag highlighter.java:228 org.apache.lucene.search.highlight.highlighter.getbestfrag highlighter.java:158 org.apache.lucene.search.highlight.highlighter.getbestfrag highlighter.java:462
add experiment javadoc tag lot thing mark experiment api subject chang etc lucen patch simpli add experiment tag common-build.xml use consist
trectopicsread n't proper read descript narrat trectopicsread read field correct demonstr test case
improv basetokenstreamtestcas use fake attribut check clearattribut call correct found bug contrib/analyz robert idea use fake attribut insid basetokenstreamtestcas record clear method call case incrementtoken assertokenstreamcont fail also use attribut teesinktokenfilt lot copi capturest restorest use attribut track wonder save/restor clearattribut correct implement also verifi *before* capturest also clear state also contain clear call consum token filter captur consum token insert capturedst must also clear contrib analyz test fail pass addit assert fix attach patch
add test porterstemfilt test porterstemfilt yet svn histori reveal minor cleanup etc thing execut code test test two smartchines test patch run stemfilt martin porter 's test data set stemmer check expect output zip file 100kb ad src/test larg chang download data instead
small improv arrayutil.getnexts spinoff java-dev thread dynam array realloc algorithm start jan 12 2010 's keep +3 small size ad 2nd arg number byte per element round 4 8 byte boundari 's 32 64 bit jre respect still grow 1/8th 0 pass return 0 back also remov assert test check actual valu return method n't think test 's impl detail
page collector http //issues.apache.org/jira/browse/lucene-2127 focusedcommentid=12796898 page=com.atlassian.jira.plugin.system.issuetabpanel 3acomment-tabpanel action_12796898 somebodi assign aaron mccurri ll see get enough vote issu convinc upload patch
openbitset hashcod may return fals ident set openbitset use intern buffer long variabl store set bit addit wlen index point highest use compon insid link bit buffer unlik jdk wlen field continu maintain clear bit exampl lead situat wlen may point far beyond last set bit hashcod implement iter long compon bit buffer rotat hash even empti compon contract hashcode-equ follow test case illustr code initi two bitset differ capac bit length bitset bs1 new bitset 200 bitset bs2 new bitset 64 set bit bs1.set 3 bs2.set 3 equal return true pass assertequ bs1 bs2 hashcod return fals contract assertequ bs1.hashcod bs2.hashcod code fix test case attach
remain realloc use arrayutil.getnexts see recent discuss arrayutils.getnexts
shinglefilt improv shinglefilt allow configur minimum shingl size addit maximum shingl size 's possibl e.g output trigram instead bigram mix trigram token separ use compos shingl configur
improv basetokenstreamtestcas test end offsetatt/end implement correct problem highlight see lucene-2207 exampl cjktoken opinion current write much code test patch follow add option integ finaloffset null check asserttokenstreamcont assertanalyzesto automat fill string length opinion correct asserttokenstreamcont behavior option may even token use asserttokenstreamcont token simpli provid extra expect valu check assertanalyzesto impli token check test pass core failur contrib even besid cjktoken appli koji 's patch lucene-2207 correct specif chinesetoken similar problem
stackoverflow call deprec chararrayset.copi call chararrayset copi set without version argument deprec instanc chararrayset result stack overflow method check given set chararrayset call accidenti introduc due overload altern method lucene-2169 use final patch
fixedintblockindexinput.read initialis pend int array fixedintblockindexinput.reader.pend int array initialis consequ fixedintblockindexinput.read next method return alway 0 call fixedintblockindexinput.read blockreader.readblock reader initialis may solv issu test
shinglefilt benchmark spawn lucene-2218 benchmark shinglefilt along new task instanti non-default-constructor shingleanalyzerwrapp newshingleanalyzertask includ shingle.alg run shingleanalyzerwrapp wrap default standardanalyz 4 differ configur 10,000 reuter document allow shinglefilt time isol rest pipelin standardanalyz also run set reuter document set 5 run run 5 time patch includ two perl script first output jira tabl format time inform minimum elaps time 4 shingleanalyzerwrapp run standardanalyz run second compar two run jira output produc anoth jira tabl show improv
move contrib/snowbal contrib/analyz fix bug duplic handcod impl stemmer nl fr ru etc simpli merg snowbal analyz replac buggi impl proper snowbal stemfilt
hindi analyz analyz hindi map valu fire 2008 test collect qe mean expans morelikethi default top 5 doc ||setup||t||t qe ||td||td qe ||tdn||tdn qe || |word only|0.1646|0.1979|0.2241|0.2513|0.2468|0.2735| |hindianalyzer|0.2875|0.3071|0.3387|*0.3791**|0.3837|0.3810| |improvement|74.67 |55.18 |51.14 |50.86 |55.47 |39.31 td offici measur highest score collect fire 2008 0.3487 http //www.isical.ac.in/~fire/paper/mcnamee-jhu-fire2008.pdf need bit cleanup test
implement perfieldanalyzerwrapper.getoffsetgap perfieldanalyzerwrapp deleg call getoffsetgap fieldabl instead return default valu implement analyz similar lucene-659 perfieldanalyzerwrapp fail implement getpositionincrementgap
similar set per index may want adjust score behaviour field level similar set per index may want adjust score behaviour field level facili could pass make field name avail score method current pass lengthnorm other tf
deprec chineseanalyz chineseanalyz chinesetoken chinesefilt smart one cjk index chines text individu charact remov english stopword etc opinion simpli deprec favor standardanalyz standardtoken stopfilt thing
revis niofsdirectori usag due nio limit thread.interrupt creat issu spin http //mail-archives.apache.org/mod_mbox/lucene-java-dev/201001.mbox/ 3cf18c9dde1001280051w4af2bc50u1cfd55f85e50914f mail.gmail.com 3e decid niofsdirectori want keep default none-window platform want document
simpleanalyz whitespaceanalyz version ctor due chang chartoken lucene-2183 whitespaceanalyz simpleanalyz need version ctor default ctor must deprec
core test call version base ctor instead deprec default ctor lucene-2183 introduc new ctor chartoken subclass core test use ctor version.lucene_curr instead deprec ctor yet lucene-2240 introduc version ctor whitespaceanalyz simpleanalyz test also use version ctor instead default one
contrib chartoken class instanti use new version base ctor contrib chartoken class instanti use new version base ctor introduc lucene-2183 lucene-2240
fastvectorhighlight support disjunctionmaxqueri add disjunctionmaxqueri support fvh
improv standardtoken 's understand non ascii punctuat quot vein lucene-1126 lucene-1390 standardtokenizerimpl.jflex better job understand non-ascii punctuat charact exampl understand single-quot charact current limit charact set token 's type apostroph use patch attach ad charact asciifoldingfilt would chang 'm sure right approach n't write complet patch hardcod charact use jflex rule variant asciifoldingfilt could use well mayb better approach would make possibl asciifoldingfilter-lik reader charact filter could insert front standardtoken
remain contrib testcas use version base ctor instead deprec one mani testcas contrib use deprec ctor whitespacetoken analyz etc
index turkish web page pars abort lexic error occur tri index turkish page turkish specif charact html specif tag html parser give pars abort lexic error.on line error case img src= ../images/head.jpg width=570 height=47 border=0 alt= ? except address ? charact 351 ascii valu error ? charact titl tag title= ??? turkish charact content creat problem
add chararraymap lucen make chararayset proxi keyset patch add chararraymap v lucen 's analysi packag compagnon chararrayset support fast retriev char key like chararrayset import stemmer place lucen stemer general use chararraymap string get char return string string compact easili copi termbuff map string string would slow termbuff would first convert string look return valu string perfect legal copi easili termbuff class borrow lot code solr 's pendant addit featur consist api accord chararrayset key alway chararrayset anyth tostr represent use key cours overhead also defin unmodifi map correct iter return nativ char chararrayset made consist return matchvers =3.1 also iter char chararrayset 's code almost complet copi chararraymap remov set chararrayset simpl proxi keyset futur think make chararrayset/chararraymap/chararraycollect interfac whole api would consist java collect api would backward break would possibl use better impl instead hash like prefix tree
test use version.lucene_curr produc problem backward branch develop 3.2 start lot test most-rec function lucen use version.lucene_curr fine trunk use recent version without hassl chang later version problem copi test backward branch 3.1 start improv analyz mainten hell backward test loos backward compat test older version would specifi specif version like lucene_31 test move backward must work without chang alway modifi test new version come e.g switch 3.2 dev propos follow declar static final version test_vers version.lucene_curr better version.lucene_31 lucenetestcas 4j chang test use version.lucene_curr use eclips refactor use constant remov unneed import statement move test backward must chang one line depend defin constant trunk lucenetestcas 's version.lucene_curr chang backward branch use version numer releas thing trunk alreadi use lucene_31 constant prefer need chang backward instead switch version number move trunk forward next major version ad version enum
parallelmultisearch shut thread pool close parallelmultisearch shut intern thread pool close result program creat multipl instanc class lifetim end leak thread
chang contrib test use special lucenetestcas j4 constant current version use matchvers paramet sub issu contrib chang
support queri titl trec qualiti pkg proper pars descript narrat trec queri lucene-2210 would nice allow user easili run qualiti evalu titl patch add option commandlin argument querydriv default titl specifi someth like title-on d description-on n narrative-on td titl descript tdn title+description+narr dn description+narr simpleqqpars addit constructor simpli accept string field form booleanqueri across
indexwriter.getread alloc file handl sure bug realli read javadoc right ir return iw.getread leak file handl close lead starvat avail file handles/process clear doc *new* reader refer own writer would probabl ok read doc reader intern manag iw first shot lead believ n't close perhap doc amend clear state caller-own reader *must* close attach simpl app illustr problem
relax per-seg max uniqu term limit lucen ca n't handl 2.1b limit sign 32 bit int uniqu term singl segment think improv termindexinterv default 128 2.1b one place intern api lucen use int use long
remov synchon fuzzytermenum similar final string target similar method fuzzytermenum synchron stupid termenum iter pattern single-thread per definit method privat nobodi could ever creat fake fuzzytermenum method use multithread method static static field instanc affect root come lucene-296 never reviewd simpli commit argument make synchron wrong
add indexwriter.removeunferencedfil app immedi delet index file reader close come sever time user 's list window prevent delet still-open file indexwrit remov file in-us open indexread fine indexwrit period retri delet n't retri often open flush new segment commit merg lack immediaci expert method app want faster delet call method
attributesourc hold strong refer class instanc prevent unload e.g solr webappl reload custom attribut separ classload use e.g solr plugin classload work dynmaic proxi class use cglib/javaassist recogn problem cach code insid attributesourc attributesourc static cach map hold implement class attribut faster creat new attribut reflect cost attributesourc static cach map hold list interfac implement specif attributeimpl also virtualmethod 3.1 hold map implement distanc key subclass deprec api problem strong refer insid lucen 's classload persist long lucen live class referenc never unload therefor would fine live classload soon attribut implement class subclass deprec api load differ classlod e.g lucen live bootclasspath tomcat lucene-consum custom attribut live webapp never unload refer exist lib like cglib javaassist jdk 's reflect.proxi similar cach generat class file also manag weakhashmap cach alway work perfect class evict without reason class unload classload goe happen request e.g tomcat
configur multitermqueri toptermsscoringbooleanrewrit pq size multitermqueri toptermsscoringbooleanrewrit use prioriti queue expand queri top-n term current n hardcod booleanquery.getmaxclausecount would nice abl set top-n multitermqueri e.g expand fuzzi queri 50 closest term glanc seem one way would expos toptermsscoringbooleanrewrit privat right add ctor multitermqueri instanti one limit
improv automaton perform run byte current enumer term automaton must convert entir term flex 's nativ utf-8 byte char first step char thru state machin make effici allow state machin run byte return true/fals faster
problem edgengramtokenfilt highlight ran problem use edgengramtokenfilt seem report incorrect offset generat token specif token offset 0 term length start end lead goofi highlight behavior creat edg gram token beyond first one creat small patch take account start origin token add report start/end offset
add solr 's artifact sign script lucen 's build.xml/common-build.xml solr nice artifact sign script common-build.xml build.xml releas manag 3.0 would good also build lucen artifact investig add src artifact maven artifact
add test check maven artifact pom releas manag hard find maven artifact work correct would good ant task execut maven .pom file requir contrib/cor artifact one contrib download artifact local dist/maven folder build test project would requir maven execut build script also pass version ant properti pom.xml
n't download/extract 20,000 file build build lucen download extract data contrib/benchmark especi 20,000+ file reuter corpus need one test 20,000 file drive ide crazi instead default download/extract data specif ask like wikipedia collat etc qualityrun test instead use linedoc format 587-line text file similar reuters.first20.lines.txt alreadi use benchmark
queri zero boost n't work queri consist zero boost result incorrect result
payloadnearqueri hardwir explan averagepayloadfunct explain method payloadnearspanscor assum averagepayloadfunct use patch add explain method payloadfunct interfac scorer call ad unit test explain min max payloadfunct
fieldcacheimpl 's getcacheentri buggi use weakhashmap incorrect lead concurrentmodexcept way weakhashmap work intern lead fact allow iter whm.keyset get valu get oper inspect referencequeu weak key may sudden disappear use entryset iter get key valu need call get contain inspect referencequeu
catch except thread creat junit task hudson sever assert fail testramdirectori never caught error reporti junit test itsself fail patch add handler uncaught except lucenetestcas j4 let test fail teardown
documentswriter.applydelet creat termdoc indexsearch need documentswriter.applydelet indexread int alway creat termdoc indexsearch even delet term queri attach patch wrap creation w/ check whether delet two addit searcher n't close final block fix well ll attach patch short
querynodeimpl throw concurrentmodificationexcept add list querynod ad list children querynodeimplement concurrentmodificationexcept thrown due fact querynodeimpl instead iter suppli list iter intern claus list patch index querynodeimpl.java querynodeimpl.java revis 911642 +++ querynodeimpl.java work copi -74,7 +74,7 .getlocalizedmessag queryparsermessages.node_action_not_support querynod child getchildren querynod child children add child
fastvectorhighlight highlight term align multi-valu not_analyz field
add dobeforeflush indexwrit indexwrit doafterflush overridden extens order perform oper flush call sinc flush final one overrid doafterflush issu handl two thing make doafterflush protect instead package-priv allow easier extend iw add dobeforeflush call flush start allow extens perform oper flush bege post patch short btw chanc get 3.0.1
expos indexfilenam public make use method code indexfilenam use applic extend lucen particular extend directori indexwrit provid use constant method queri whether certain file core lucen file addit indexfilenam use lucen 's code generat segment file name queri whether certain file match certain extens ll post patch short
possibl memori leak storedfieldswrit storedfieldswrit creat pool perdoc instanc pool grow never reclaim mechan furthermor perdoc instanc contain ramfil ramfil also never truncat ever grow far tell feed document larg number store field one larg domin store field result memori consum ramfil never reclaim eventu pool perdoc could grow larg even larg document rare seem like attempt reclaim memori perdoc instanc pool otherwis limit size ramfil cach etc
matchalldocsquerynod tostr creat invalid xml-tag matchalldocsquerynode.tostr return matchalldoc field='* term='* inavlid xml read matchalldoc field='* term='*
code cleanup sort trivial warn would like code cleanup remov sort trivial warn like unnecessari cast problem w/ javadoc unus variabl redund null check unnecessari semicolon etc trivial pose problem ll creat anoth issu get rid deprec code usag like lucenetestcas sort deprec constructor 's also trivial affect lucen code 's differ type chang anoth issu 'd like creat introduc generic code 's miss today chang exist api mani place code like permiss ll start trivial one first move other
enabl defaultsimilarity.setdiscountoverlap default think enabl setdiscountoverlap defaultsimilar default use synonym commongram number 0-posinc-term-inject method current screw length normal term posit increment zero shouldnt count toward length document ve done relev test persian show differ signific think big trap anyon use synonym etc relev actual get wors n't flip boolean flag
creat empty_arg constsant snowballprogram instead alloc new object 0 instead alloc new object 0 creat proper constant snowballprogram new class 0 creat among although 's less critic among call static initi patch follow short
call segmentinfos.messag wrap w/ infostream null check avoid expens messag creation involv '+ oper string call messag wrap w/ infostream null check rather insid messag ll attach patch
remov unnecessari string concaten indexwrit ve notic coupl place indexwrit boolean string creat bool integ int place setdiagonst string concaten empti string patch use boolean.tostr integer.tostr well remov unnecessari str
indexwrit hard limit max concurr documentswrit nasti hardwir constant code privat final static int max_thread_st 5 code probabl attach //nocommit moment wrote constant set max number thread state 5 mean 5 thread enter indexwrit share 5 thread state mean gate cpu concurr 5 run thread insid iw thread must first wait last thread finish use thread state grab bad modern hardwar make use 5 thread think immedi fix make settabl expert increas default 8 's tricki though thread state less ram effici mean wors index throughput n't set 50 ll flush often think better fix re-think thread write state documentswrit today singl docid stream assign across thread eg one thread get docid=0 next one docid=1 etc thread write privat ram buffer live thread state flush merg sort merg sort ineffici current use pq wast must re-decod everi post byte think could chang thread write privat ram buffer privat docid stream instead merg flush direct flush thread segment alloc privat docid thread leav merg cms alreadi run merg bg without block ongo index unlik merg flush today would also allow us separ flush thread state ie need flush thread state flush one get big let other keep run good concurr gain sinc use io cpu resourc throughout index instead big burst cpu big burst io today flush today stop world one downsid think docid would less monoton mean n thread index ll rough get in-time-ord assign docid chang one thread state would get 0..n docid next thread state 'd get n+1 m docid etc howev singl thread would still get monoton assign docid
creat indexwriterconfigur store iw configur would like factor iw configur paramet singl configur class propos name indexwriterconfigur indexwriterconfig want store almost everyth besid directori reduc ctor one indexwrit directori indexwriterconfigur think store follow paramet ctor paramet except directori differ setter make sens exampl still think infostream set iw direct 'm think iwc expos everyth setter/gett method default whatev iw default today except analyz need defin ctor iwc wo n't setter sure maxfieldlength requir iw ctor yet iw declar default int maxfieldlength still think 10000 default default unlimit otherwis let applic decid limit mean would like make mfl option iwc default someth hope default unlimit document iwc anyon choos move new api awar plan deprec ctor getters/sett replac one ctor describ getindexwriterconfigur simpli getconfig queri set interest setter think mayb introduc setconfig method overrid everyth overrid today except analyz someon could iw.getconfig .setsometh iw.setconfig newconfig setter iwc return iwc allow chain set call turn iw.setconfig iw.getconfig .setsomething1 .setsomething2 btw need parallel index see lucene-1879 think great simplifi iw 's api ll start work patch
creat maxfieldlengthanalyz wrap analyz provid function maxfieldlength provid indexwrit spinoff lucene-2294 instead ask user specifi indexwrit request mfl limit get rid set entir provid analyz wrap analyz tokenstream tokenfilt keep track number token produc stop limit reach remov count track iw 's index done even specifi unlimit mfl let 's tri 3.1
indexwrit let option enabl reader pool app use larg index frequent need commit resolv delet cost open segmentread demand everi commit prohibit alreadi pool reader nrt turn nrt reader use allow separ control lucene-2294
polish analyz andrzej bialecki written polish stemmer provid stem tabl apach licens read http //www.getopt.org/stempel/ realiti stemmer general code could use languag perhap
open nrt reader addindexes* run may miss segment earwin spot pend ongo refactor dir/multiread want open separ make sure fix 3.1 fix code index src/java/org/apache/lucene/index/directoryreader.java src/java/org/apache/lucene/index/directoryreader.java revis 919119 +++ src/java/org/apache/lucene/index/directoryreader.java work copi -145,7 +145,7 int i=0 numseg i++ boolean success fals tri final segmentinfo info infos.info upto final segmentinfo info infos.info info.dir dir reader upto++ writer.readerpool.getreadonlyclon info true terminfosindexdivisor code
indexwrit never pool reader extern segment eg addindex call enrol extern segment info merg merg simpli ask pool reader writer pool nrt reader pool incorrect pool reader n't break anyth 's wast reader use merg open nrt reader
replac termattribute+impl extend capabl byte support charsequ append flexibl index term simpl byte array current termattribut support char fine plain text e.g numerictokenstream direct work byte array also termattribut lack interfac would make simplier user work append charsequ propos creat new interfac chartermattribut clean new api concentr charsequ append implement class simpli support old new interfac work term buffer default_attribute_factori take care somebodi add termattribut get implement class also use chartermattribut attribut creat impl instanc call addattribut equal tokenfilt add chartermattribut sourc work instanc token request deprec termattribut also support byte term like collat numericfield need separ getter-on interfac ad return reusabl bytesref e.g bytesrefgetterattribut default implement class also support interfac backward compat old self-made-termattribut implement index check hasattribut bytesref getter interfac wrap old-styl termattribut deprec wrapper class provid new bytesrefgetterattributewrapp termattribut use index
remov code duplic token class extend termattributeimpl issu remov code duplic token share whole char buffer handl code termattributeimpl issu remov duplic extend termattributeimpl parent issu lucene-2302 extend termattribut support charsequ append also new bytesrefattribut get ad token automat provid code duplic code also commit trunk noth flex
fuzzylikethisqueri set maxnoncompetitiveboost faster speed fuzzylikethisqueri use fuzzytermsenum direct maintain prioriti queue purpos like toptermsrewrit method set maxnoncompetitiveboost attribut fuzzytermsenum run faster alreadi track minscor updat attribut would especi nice appear nice default alreadi pq size 50
fulli decoupl indexwrit analyz indexwrit need attributesourc index yet today interact field instanc hold privat analyz invok analyzer.reusabletokenstream deal wide varieti 's analyz analyz 's reader string 's pre-analyz 'd like iw interact attr sourc alreadi arriv field would power decoupl mean other free make attr sourc need even use lucen 's analysi impl eg integr thing like openpipeline|http //www.openpipeline.org make someth complet custom lucene-2302 alreadi big step toward make iw agnost attr term requir provid bytesref flex think lucene-2308 would get us remain way ie fieldtyp know analyz use could simpli creat getattrsourc method say move logic iw today onto 'd still need exist iw code back-compat
reduc fieldabl abstractfield field complex order move field type like function class realli need tri tackl hierarchi fieldabl abstractfield field current abstractfield depend field provid much function store field move fieldtyp therefor seem ideal tri deprec abstractfield possibl fieldabl move much function field fieldtyp
pass potent sr irwarmer.warm also call warm new segment current warm receiv segmentread without term index docstor would arguabl use app receiv fulli load reader actual fire cach warmer undefin iw probabl leav thing also arguabl concis clear call warm newli creat segment singl point warm reader nrt context everi subread come getread guarante warm n't introduc even mess code recheck
add verbos lucenetestcas lucenetestcasej4 component-build.xml allow defin tests.verbos system properti run test lucenetestcas lucenetestcasej4 n't read properti use overrid test access one place set believ current test separ issu move test n't check paramet print verbos true post patch soon
add attributesource.copyto attributesourc one problem attributesourc moment miss insight attributesource.st want creat tokenstream inspect cpatur state chanc make content state public bad idea help inspect link list iter attributesourc current contain cloneattribut call return new attrubutesourc current attribut clone expens capturest problem copi back clone restorest use behaviour way shinglematrix use one altern use cloneattribut copyto easili chang clone attribut store list copi back problem lower perform call state optim class one use case could code attributesourc state cloneattribut someth state.getattribut termattribute.class .settermbuff foobar work state.copyto code
attributesourc 's method access attribut final els easi corrupt intern state method oper modifi intern map attributesourc final backward break anybodi overrid method simpli creat buggi either case want makeal impl final general class final made extens tokenstream import implement final
defin clear semant directory.filelength thread http //mail-archives.apache.org/mod_mbox/lucene-java-dev/201003.mbox/ 3c126142c1003121525v24499625u1589bbef4c0792e7 mail.gmail.com 3e mention directori 's filelength behavior consist directori implement given file name exist fsdirectori return 0 length ramdirectori throw fnfe problem semant filelength defin propos thread ll defin follow semant return length file denot code name /code file exist return valu may anyth 0 long.max_valu throw filenotfoundexcept file exist note call dir.fileexist name sure whether file exist backward ll creat new method w/ clear semant someth like code deprec method becom abstract filelength name remov public long getfilelength string name throw ioexcept long len filelength name len 0 fileexist name throw new filenotfoundexcept name return len code first line call current impl throw except non-exist file re ok second line verifi whether 0 length exist file throw except appropri
add system.getproperti tempdir final static lucenetestcas j4 almost everi test call system.getproperti tempdir check return valu null case test simpli fail within eclips add lucenetestcas j4 static final constant enabl test run eclips add fallback sysprop defin
indexread docommit typo nit v3.0 trunk trunk alreadi 3.0.1+ document say 3.0 becom sinc alreadi 3.0 might well remov
add mergepolici indexwriterconfig indexwriterconfig place 'd like move mergepolici well chang straightforward ve kept separ issu mergepolici requir ctor indexwrit howev none pass indexwrit actual exist today iw may creat mp overridden applic one line afterward n't want make iw member mp non-fin settabl extend class howev need remain protect access direct propos chang add setonc object o.a.l.util immut set henc name ll signatur setonc w/ *synchron set *t get declar volatil get wo n't synchron mp defin *protect final setonc indexwrit writer* instead current writer *note bw break* suggest welcom mp offer public default ctor togeth set indexwrit indexwrit set mp use set note set call throw except alreadysetexcept someon better suggest prefer alreadi exist java except 's core idea 'd like post patch soon 'd appreci review propos
use pack int term dict index term dict index need store larg ram resid array int size bound variabl depend segment/doc use pack int
remov verbos test make configur parent issu ad function lucenetestcas j4 patch appli test
reorgan contrib modul would nice reorgan contrib modul bundl togeth function exampl wikipedia contrib token think realli belong contrib/analyz two highlight think could one highlight packag mani querypars queri differ place contrib
per thread documentswrit write privat segment see lucene-2293 motiv detail 'm copi mike 's summari post 2293 chang approach buffer ram isol approach wherebi iw n fulli independ ram segment in-process doc need index 's ad one segment would also write doc store normal segment merg ineffici merg flush would merg good simplif chain eg mayb remov *perthread class segment flush independ let us make much better concurr use io cpu
investig solr test failur use flex branch solr locat https //svn.apache.org/repos/asf/lucene/solr/branches/solr current test pass lucen trunk jar plop flex jar thought might interest look
remov svn.ex revis number build.xml svn-copi backward branch link snowbal test svn extern often need updat backward test togeth trunk alway updat branch first record rev updat build xml would simpli like svn copy/mov backward branch releas simpli also done code svn rm backward svn cp releasebranch backward code simpli commit one pass creat patch one pass snowbal test current download svn.ex need fix version checkout would like chang use svn extern provid patch soon
indexwriter.sync field accumul data lead memori leak run strang outofmemoryerror small test applic index delet file repeat 60k time optim run everi 2k time file index index size 50kb analyz heapdumpfil realiz indexwriter.sync field occupi half heap field privat hashset without getter task hold file sync alreadi two call addal one call add sync remov clear throughout lifecycl indexwrit instanc accord eclips memori analyz sync contain 32618 entri look like file name _e065_1.del _e067.cf index directori contain 10 file guess sync hold obsolet data
use parallel array instead postinglist object mike 's idea discuss lucene-2293 lucene-2324 order avoid mani long-liv postinglist object termshashperfield want switch parallel array termshash simpli int map term dens termid data postinglist class current hold place parallel array termid index array avoid need object pool remov overhead object initi garbag collect especi garbag collect benefit signific jvm run memori situat gc mark time get long big number long-liv object memori anoth benefit could build effici termvector could avoid need store term string per document termvector instead could store segment-wid termid would reduc size also make easier implement effici algorithm use termvector term map across document segment would necessari though improv make separ jira issu
add noopmergepolici 'd like add simpl use mp implement noth ve came across mani place either follow document implement want prevent merg set mergefactor high enough valu think noopmergepolici good realli allow disabl merg except mayb set mergefactor int.max_v noopmergepolici introduc singleton use conveni purpos also parallel index 's import 'd like slice never merg unless parallelwrit decid set w/ mp patch readi wait lucene-2320 go n't need chang afterward name like name suggest welcom thought nullmergepolici n't like null use noop
merg chartermattribut deprec stabl merg trunk flex land analyz port new api
failur contrib build class core chang without ant clean java-dev shai erera quot ve notic sometim run test-cor test-contrib chang core code test-contrib fail nosuchmethoderror stuff like ve notic core.jar exist build assum 's use test-contrib probabl recreat core code chang verifi look contrib-build.xml defin properti lucene.jar.pres set true jar well present believ reason failur ve think resolv think two way 1 test-cor alway delet file two issu 1.1 's redund code n't chang 1.2 forc either jar-cor test-cor test-contrib want make sure run w/ latest jar 2 test-contrib alway call jar-cor first delet file re-creat compil first compil anyth code n't chang wast would creat .jar think 's quit fast anyon ant skill know better way detect test-contrib core code chang rebuild jar quot
allow directory.copi accept collect file name copi par exampl want copi file pertain certain commit everyth directori
explor morfologik integr dawid weiss mention lucene-2298 anoth polish stemmer avail http //sourceforge.net/projects/morfologik/ work differ lucene-2298 ideal would anoth option user
add support benchmark collector titl say
postingsconsum merg call finishdoc discov current merg function postingsconsum call finishdoc method consequ standard codec sinc lastposit set 0 startdoc finishdoc method empti sepcodec result posit file corrupt lastposit set 0 finishdoc sepcodec
optim automatonqueri mike found case flex bad behavior automatonqueri problem similar databas queri planner sometim simpli full tabl scan faster use index optim automatonqueri littl bit get better perform fuzzi wildcard regex queri list idea creat commonsuffixref infinit automata really-bad linear scan case null check rather popul empti commonsuffixref local linear case seek instead scan ping-pong loop state machin add mechan enable/dis term dict cach e.g disabl infinit case mayb fuzzi n 1 also chang use bitset openbitset long gen path-track optim backtrack code say string good go as-i need full run think
add new testbackwardscompat index flex backward 3.0 one also numer field flex chang also encode/decod numer field numerictokensteam use bytesref also collat filter add test index 3.0 contain field valid field content chang read flex
config incorrect handl window absolut pathnam idea one ran far tri execut .alg file use reuterscontentsourc referenc docs.dir work.dir window absolut pathnam e.g d \someth surpris run report error miss content benchmark\work\someth ve trace problem back config get string string includ follow code code sval.indexof 0 return sval first time prop extract round int k sval.indexof string colnam sval.substr 0 k sval sval.substr k 1 code detect valu think 's per-round properti thus strip d valu fix simpl code sval.indexof 0 return sval els sval.indexof \\ 0 previous mess absolut path name window assum real valu start \\ return sval first time prop extract round int k sval.indexof string colnam sval.substr 0 k sval sval.substr k 1 code ll post patch w/ fix test short
convert numericutil numerictokenstream use bytesref instead strings/char lucene-2302 use termtobytesrefattribut index use numerictokenstream also convert whole numericutil use bytesref convert numer
enabl set term index divisor use indexwrit whenev open intern reader open place holder issu refactor discuss n't make possibl add set iwc app larg number uniqu term must set term index divisor control ram usag note flex 's ram term dict index ram usag effici help app iw resolv delet intern alway use default 1 term index divisor app chang though one workaround call getread terminfosindexdivisor pool reader right divisor
renam keywordmarkertokenfilt would like renam keywordmarkertokenfilt keywordmarkerfilt havent releas yet good time keep name brief consist
cartesianpolyfilterbuild n't handl edg case around 180 meridian test case point around globe plus two point 0 179.9 0 -179.9 side meridian cartesian tier filter point right near two return point return two flaw logic els claus code longx2 0.0 //we around prime meridian longx 0.0 longx longx2 longi 0.0 shape getshapeloop shape ctp latx longx lati longi els //we around 180th longitud longx longx2 longi -180.0 shape getshapeloop shape ctp lati longi latx longx code basic y x valu transpos current say go longi -180 way around longx lower left longitud box form instead go lower left long -180
speedup recycl per-doc ram robert found one sourc slow index tini doc use list.toarray recycl byte buffer use per-doc doc store state store field term vector ad lucene-2283 yet releas
add support term bytesref format term termqueri termrangequeri co would good direct allow bytesref termqueri termrangequeri queri convert string bytesref intern numericrang support solr need support numer byteref single-term queri ad n't forget chang testnumericrangequeryxx use bytesref ctor trq
find newest segment empti index extend index writer discov newestseg method check see segment access segment info vector specif call indexwrit newestseg method brand-new index essenti empti throw java.lang.arrayindexoutofboundsexcept except propos fix return null segment exist shown lucene/src/java/org/apache/lucene/index/indexwriter.java revis 930788 +++ lucene/src/java/org/apache/lucene/index/indexwriter.java work copi -4587,7 +4587,7 util routin test segmentinfo newestseg return segmentinfos.info segmentinfos.s -1 return segmentinfos.s 0 segmentinfos.info segmentinfos.s -1 null
llrect.createbox return box contain point center distanc disc llrect createbox comput boud box disc given center distanc doest contain point distanc exampl point north distanc doest lat inferior lat upperright corner return box
reintegr flex branch trunk issu reintegr flex branch current trunk post patch review commit contributor flex review patch commit tag trunk flex
replac deprec termattribut new chartermattribut lucene-2302 merg trunk flex need carri token consum tokenstream new chartermattribut also think ad attributefactori creat subclass chartermattributeimpl return collat key tobytesref accessor collationkeyfilt obsolet instead simpli convert everi tokenstream index collationkey chang attribut implement
creat codec work stream append-on filesystem sinc earli 2.x time lucen use skip/seek/writ trick patch length term dict place near start output data file howev made imposs use lucen append-on filesystem hdfs post-flex trunk follow code standardtermsdictwrit initi code count index field front codecutil.writehead codec_nam version_curr out.writelong 0 leav space end index pointer code complet close code out.seek codecutil.headerlength codec_nam out.writelong dirstart code propos chang layout pointer store simpli end file 's alway 8 byte long known final length file directori 's singl addit seek length 8 read much consid benefit
add reflect api attributesource/attributeimpl attributesource/tokenstream inspect solr need insight content attributeimpl lucene-2302 problem tostr structur conflict charsequ 's definit chartermattribut propos simpl api get default implement attributeimpl like tostr current iter map.entri string attributeimpl.contentsiter return iter attribut singleton key-valu pair e.g term foobar startoffset integer.valueof 0 attributesourc get method concat iter getattributeimplsiter attributeimpl backward problem occur default tostr method work like get iter list simpli remov document format char termattribut get special impl fo tostr accord charsequ correspond iter also want remov abstract hashcod equal method attributeimpl need creat work implementor
enabl use nomergepolici nomergeschedul benchmark benchmark allow one set mp ms use defin class name use reflect instanti howev nomp nom singleton therefor reflect work easi fix createindextask ll post patch soon
cutov remain usag pre-flex api number place still use pre-flex api actual healthi sinc give us ongo test back compat emul layer point cut flex latest 4.0 'm sure 3.1 still mark 3.1 remind us
add fieldcache.gettermbyt load term data byte flex term opaqu byte typic utf8 encod unicod string necessarili need push search stack fieldcach getstr getstringindex need correspond method load term nativ byte sinc general may represent string quit bit ram effici us ascii content sinc charact would use 1 byte 2
merg implement codec must catch abort merg regress lost function land flex close iw fals mean abort run merg iw ask merg thread abort thread suppos period check abort throw except cutov flex codec overrid merg done default impl base enum class lost
small fix flex merg chang re-introduc special optim fieldcacherangequeri also fix bug fail check delet advanc chang 2 checkindex method protect public add miss null check call multifields.getfield indexreader.field tweak 'd chang bit remov small dead code
reset zzbuffer standardtokenizerimpl* lexer reset index larg document lexer buffer may stay larg forev sub-issu reset lexer buffer back default reset reader done enclos issu
move nodeletionpolici benchmark core subject say ll also make singleton add unit test well document ll post patch hope today
indexwrit commit unnecessarili fresh directori ve notic indexwrit 's ctor commit first commit empti one fresh directori pass w/ openmode.cr create_or_append seem unnecessarili kind bring back autocommit mode strang way need commit realli expect peopl open indexread empti directori pass iw w/ create=tru want simpli call commit right away iw creat ran write test commit n time compar number commit via indexreader.listcommit surpris see n+1 commit tri chang docommit fals iw ctor got indexfiledelet jump chang might simpl think 's manag ll tri attack ifd specif back
indexwrit retain refer reader use field memori leak describ 1 indexwrit retain refer reader use field lead big memori leak use tika 's parsingread take 1mb per parsingread 2 show screenshot refer chain reader indexwrit taken eclips mat memori analysi tool chain follow indexwrit documentswrit documentswriterthreadst docfieldprocessorperthread docfieldprocessorperfield fieldabl field fieldsdata 1 http //markmail.org/thread/ndmcgffg2mnwjo47 2 http //skitch.com/ecerulm/n7643/eclipse-memory-analyz
unvers site point dead trunk unvers site need point new merg trunk current point closed-off dead trunk two differ place
enforc tokenstream impl analyz final assert note lucene-1753 issu tokenstream analyz base decor pattern least tokenstream analyz implement lucen solr final attach patch add assert ctor class correspond check analyz must final privat class anonym inner class tokenstream must final privat class anonym inner class final incrementtoken commit robert fix solr stream
contrib/remot test fail random contrib/remot test fail random use _testutil.getrandomsocketport simpli generat random number alreadi use fail addit duplic rmi logic across 3 test class
spellcheck use default iw mergefactor/rammb set 300/10 set seem odd 'd like investig make sens
enabl flexibl score first step nowher near committ implement design iter recent babi step toward make lucen score flexibl java-dev thread idea turn field 's default store full stat index new _x.sts file per doc x field index fieldsimilarityprovid impl comput doc 's boost byte norm stat patch abl index stat merg segment merg provid iterator-on api also start point per-field sim use stat iter api comput boost byte 's tie actual search 's still ton left eg one configur via field/fieldtyp stat one want index test pass ad one new teststat unit test stat record field 's boost field 's uniqu term count b c b 3 field 's total term count b c b 6 total term count per-term sum total term count doc term still need least total term count field
util output total term frequenc df lucen index pair command line util provid inform total number occurr term lucen index first take field name term index directori output document frequenc term total number occurr term index i.e sum tf term document second read index determin top n frequent term document frequenc output list term along document frequenc total number occurr term util use estim size term 's entri *prx file consequ disk i/o demand
snapshotdeletionpolicy.snapshot throw npe commit happen sdp throw npe commit occur snapshot call replac w/ throw illegalstateexcept ll also move testsdp o.a.l o.a.l index ll post patch soon
improv test work easier ide report paolo castagna mail list test fail run eclips failur report actual code problem base test class abstract fix thing like
add support icu 's normalizer2 separ case fold normal ignorable-remov filter lucene-1488 new icu normalizer2 api nfkc_cf base new nfkc_casefold properti unicod great provid ton unicod function realli need new normalizer2 api take charsequ write append
shinglefilt n't output all-fil shingles/unigram also convert termattribut chartermattribut input token stream shinglefilt posit increment greater one filler token insert posit token input token stream result unigram configur shingl filler-on filler-on output token make sens remov also termattribut deprec favor chartermattribut patch also convert termattribut usag chartermattribut shinglefilt
improv perform chartermattribut impl also fulli implement append appendable.append charsequ method chartermattribut good general use like stringbuild common use case special method add separ append method string stringbuild chartermattribut itsself method enabl compil direct link special method n't use instanceof check unspeci method instanceof check longer charsequ 8 char els simpli iter patch also fix requir special null handl append method requir append append null argument null dont like requir mayb document dont dont support otherwis jdk 's formatt fail format null
add explicit method invok indexdeletionpolici today one use idp hold onto segment snapshotdeletionpolici idp test segment left index even idp longer refer iw.commit call actual someth 'd like add specif method iw invok idp 's logic get rid unus segment w/o forc user call iw.commit coupl reason segment take sometim valuabl hd space applic may wish reclaim space immedi scenario index updat sever hour even day wait may accept think 's cleaner solut wait next commit happen one still wait one want otherwis give abil immedi get rid segment testsnapshotdeletionpolici includ code strengthen imo need method code add one document forc writer commit final segment delet polici chanc delet document doc new document doc.add new field content aaa field.store.y field.index.analyz field.termvector.with_positions_offset writer.adddocu doc code iw explicit method code would need exist come fun part name babi invokedeletionpolici describ exact go happen howev user set idp reli default think mani user wo n't understand deleteunusedseg user-friend assum user understand segment btw iw alreadi deleteunusedfil tri delet unreferenc file fail delet window due e.g open reader perhap instead invent new name chang iw.deleteunusedfil call indexfiledeleter.checkpoint instead deletependingfil delet file call idp.oncommit
improv speed thaiwordfilt characteriter factor lowercas also fix bug empti token stop iter thaiwordfilt creat new string term buffer pass breakiterator. breakiter take characteriter direct process without buffer copi java itsself provid characteriter implement java.text use javax.swing.text.seg class oper char even reuseabl class strang work jdk 1.4+ deprec filter also bug stop iter token empti token occur also lowercas non-thai word remov put analyz ad lowercasefilt
add tokenfilt icu transform pull icutransformfilt lucene-1488 creat issu tokenfilt appli icu transliter context-sensit way transform text typic rule-bas use one includ icu traditional-simplifi make set rule user 's guid http //userguide.icu-project.org/transforms/gener rule tutori http //userguide.icu-project.org/transforms/general/rul
optim phrasequeri look scorer phrasequeri think speedup could part scorer advanc next doc term phrasescorer.donext optim booleanqueri 's conjunctionscor ie sort term rarest frequent n't think use link list/firsttolast today way much work .score call go find occurr phrase doc wherea stop find first go count rest .score call exact case think use two int array find match first array hold count mani time term phrase match phrase start posit count number term phrase 's match 2nd gen array hold docid count last touch avoid clear ie increment count docid gen reset count 0 think 'd faster pq use downsid immens doc posit get larg 'd need 2 immens array 'd great lucene-1252 along ie factor phrasescor two 'd sub-scor lucene-1252 open first one conjunctionscor 2nd one check posit ie either exact sloppi scorer would mean phrasequeri 'd w/ claus filter appli would save cpu check posit doc unless 'd claus accept doc
architectur diagram need lucen solr nutch
consolid solr 's lucen 's analyz modules/analysi ve want quit time think solr/lucen merg re look open unstabl line develop solr/lucen right time standalon modul analyz also empow app separ version analyz version solr/lucen use possibl enabl us remov version entir analyz also lucene-2309 decoupl much possibl index analysi api n't think issu need block consolid one place user find analyz solr/lucen provid
add icu-bas token unicod text segment pull last part lucene-1488 token clean idea simpl first step divid text write system boundari script suppli icutokenizerconfig use default let tailor segment per-writ system basi tailor breakiter rule-bas dictionary-bas default implement custom uax 29 tailor stuff clear word divis thai use dictionary-bas word break khmer myanmar lao use custom rule syllabif addit exampl tailor hebrew treat punctuat special peopl ask way make standardanalyz treat dash differ etc
remov jakarteregexcap shim access packag protect field access prefix jakarta regex use shim class packag jakarta remov replac reflect like robert icutoken rule compil shim class problem wth sign artifact insert new class foreign packag sign regex class shim-remov also allow user use later jakarta regex version classpath remov even bug perform problem prefix get per termenum
improv benchmark ve notic writelinedoctask declar support multi-thread take closer look think realli good reason work done read contentsourc construct document two mult-thread think contentsourc synchron around write actual document line file investig ve notic 1.5 todo minor improv made ve want make minor improv benchmark let know intend includ minor trivial one
fix indexcommit hashcod equal consist indexcommit 's impl hashcod equal inconsist one use dir version use dir equal accord hashcod 's javadoc o1.equ o2 o1.hashcod o2.hashcod simpl fix ll add test case
improv parallel test mention dev mail list http //www.lucidimagination.com/search/document/93432a677917b9bd/lucenejunitresultformatter_sometimes_fails_to_lock would use creat lockfactori test suit run sequenti separ jvm addit creat lot jvms 26 batch run one letter instead use techniqu divid test custom selector http //blog.code-cop.org/2009/09/parallel-junit.html email blog author receiv permiss use code give nice boost speed overal test especi solr test mani start longer problem
harden nativefslock nativefslock creat test lock file name might collid w/ anoth jvm run unlik still happen coupl time alreadi sinc test parallel may result fals except thrown releas lock file 's delet call return fals file exist delet anoth jvm alreadi addit releas give second attempt delet fail sinc file may held temporarili anoth process like antivirus fail propos chang 1 use managementfactory.getruntimemxbean .getnam part test lock name includ process id 2 releas delet fail check file inde exist let 's attempt re-delet ms later 3 3 still fail throw except altern attempt deleteonexit ll post patch later today
n't reus byte indexinput/output read/writestr indexinput hold privat byte byte re-us read string likewis indexoutput hold utf8result hold byte byte re-us write string danger sinc read write immens string never free storag n't use read/writestr perf sensit part code think reus byte think like caus recent indexwrit memori usag thread start ross woolf java-us
fielddoc.tostr return super.tostr fielddoc.tostr method care build stringbuff sb contain inform fielddoc instanc return super.tostr instead sb.tostr
chang sort order binari order sinc flexibl index term repres byte backward compat reason sort byte instead char think time look sort term byte would yield follow improv term opaqu default byte sort byte think would make lucen friendlier custom numer collat free use encod full byte rather avoid use certain bit remain compat char sort order automaton get simpler lucene-2265 use byte special hack term sort char
indonesian analyz implement http //www.illc.uva.nl/publications/researchreports/mol-2003-02.text.pdf chang ad option disabl deriv stem case want remov inflect particl possess pronoun
add support custom executorservic parallelmultisearch right parallelmultisearch use cachedthreadpool limitless poor choic web applic given thread natur request say webapp tomcat-default 200 thread 100 index could look 2000 search thread pretti easili support ad custom executorservic pretti trivial patch forthcom
move contrib/analyz modules/analysi patch move contrib/analyz modules/analyz continu consolid lucene-2413 truth sorta ongo thing anyway tri distanc index analysi etc
improv random test quit random test 's way crank idea add multipli increas sysprop exampl could set someth higher 1 hudson
remov dead code oal.util.cach dead cach impl oal.util.cache* use dblrucach intern api 'd like remov dblrucach
hous clean addindexes* today use addindex addindexesnooptim confus especi invok also addindex call optim begin target index also includ follow jdoc statement understand code wrong _after complet index optimized._ optim call begin end hand addindexesnooptim call optim reli mergeschedul mergepolici handl merg short discuss list thank mike clarif understand realli two core differ two addindex support indexread extens addindexesnooptim perform better issu propos follow clear document spell pros/con call clear javadoc renam addindexesnooptim addindex remov optim call addindex indexread document clear w/ recommend call optim directories/index 's concern way maintain flexibl api addindex indexread allow use ir extens addindex directori consid effici allow merg happen concurr depend ms also factor mp unless ir extens adddirectori realli one use freedom call optim care n't n't care either way incur cost optim entir user 's hand btw addindex indexread use neither mergeschedul mergepolici rather call segmentmerg direct might anoth place improv ll look 's complic may cover issu well hint give good head start pleas n't shi
querypars make cjk queri phrase queri regardless analyz querypars automat make *all* cjk thai lao myanmar tibetan queri phrase queri even though n't ask one n't way turn complet break lucen languag treat queri like grep exampl queri f abcd standardanalyz b c d chines charact get phrasequeri b c d use cjk analyz better phrasequeri ab bc cd use smartchines analyz get phrasequeri like ab cd user n't ask one turn reason code form phrase queri intern appropri assum whitespac token one token come whitespac delimit text automat phrase queri matter propos patch fix core querypars backward compat kept form phrase queri doubl quot oper use implement subclass alway extend qp auto-gener whatev kind queri want might complet break search languag n't care core general-purpos qps languag independ
filterindexread n't work correct post-flex segmentmerg indexwriter.addindex indexread intern use segmentmerg add data input index reader howev segmentmerg use new post-flex api bypass pre-flex termenum/termposit api filterindexread implement result filter appli
remov docsandpositionsenum.getpayloadlength accident leftov getpayload return bytesref method need
improv greek analysi chang tokenstream chartermattribut move stopword privat string txt file use solr etc remov todo fix unicod conform greeklowercasefilt reformat touch file normal indent ad inflect stemmer ntai algorithm chang backward compat version
fastvectorhighlight add fragmentbuild return entir field content highlightr nullfragment requir counterpart fastvectorhighlight
fix local problem lucene/solr set ant_args= -dargs=-duser.language=tr -duser.country=tr ant clean test make sure work across lucene/solr
indexwrit memori leak larg doc index spinoff java-us thread indexwrit memori usag indexwrit long stand memori leak sinc lucene-843 byte/char/int block recycl common pool per-thread dw class incorrect still hold refer normal problem sinc buffer re-us index massiv document caus iw alloc ram buffer alloc leak happen could 16 mb ram buffer set huge doc requir alloc 200 mb worth array 200 mb never freed well close iw deref app 's even wors use multipl thread thread ever index massiv document thread incorrect hold onto extra array
reopen nrt reader share reader w/ unchang segment repoen nrt reader n't seem share reader segment unchang http //search.lucidimagination.com/search/document/9f0335d480d2e637/nrt_and_caching_based_on_indexread
term index divisor iw set via iwc via getread getread call give fals sens secur sinc delet alreadi appli iw pool reader alreadi load divisor 1 better set divisor front iwc
click result link luceneweb.war demo result arrayindexoutofboundsexcept summari say
allow plug cach evict listen indexread eager clean custom cach use indexread getfieldcachekey allow plug cach evict listen indexread eager clean custom cach use indexread getfieldcachekey spin https //issues.apache.org/jira/browse/lucene-2468 basic make lot sens cach thing base indexread getfieldcachekey even lucen use exampl cachingwrapperfilt fieldcach enjoy call explicit purg cach possibl tricki know outsid especi use nrt reader attack clone provid patch allow plug cacheevictionlisten call cach purg indexread
constructor indexwrit let 's runtim except pop keep writelock obtain constructor indexwrit let 's runtim except pop keep writelock obtain init method indexwrit catch ioexcept got negativearrays read _corrupt_ index way recov sinc writelock kept obtain moreov n't indexwrit instanc either grab lock somehow sinc init method call indexwrit constructor either broaden catch except least provid circumvent clear case 'd like fallback delet corrupt index disk recreat imposs sinc lock_held nativefslockfactori 's entri obtain writelock _never_ clean least appar way clean forcibl ca n't creat new indexwrit sinc alway fail lockobtainfailedexcept
remov morelikethi 's default analyz morelikethi follow code public static final analyz default_analyz new standardanalyz version.lucene_curr code
cachingwrapperfilt throw npe filter.getdocidset return null followup http //www.lucidimagination.com/search/document/1014ea92f15677bd/filter_getdocidset_returning_null_and_what_this_means_for_cachingwrapperfilt daniel noll see except like noformat java.lang.nullpointerexcept org.apache.lucene.search.cachingwrapperfilter.docidsettocach cachingwrapperfilter.java:84 org.apache.lucene.search.cachingwrapperfilter.getdocidset cachingwrapperfilter.java:112 com.nuix.storage.search.lazyconstantscorequeri lazyfilterwrapper.getdocidset sourcefile:91 org.apache.lucene.search.constantscorequeri constantscorer. init constantscorequery.java:116 org.apache.lucene.search.constantscorequeri constantweight.scor constantscorequery.java:81 org.apache.lucene.search.booleanqueri booleanweight.scor booleanquery.java:297 org.apache.lucene.search.booleanqueri booleanweight.scor booleanquery.java:297 org.apache.lucene.search.querywrapperfilt 2.iter querywrapperfilter.java:75 noformat class intermediari delay creat filter object code overrid public docidset getdocidset indexread reader throw ioexcept deleg null deleg factory.createfilt return delegate.getdocidset reader code trace code cachingwrapperfilt see npe would occur getdocidset return null javadoc filter say null return document accept filter n't seem lucen handl null return valu correct correct code javadoc suppos null realli ok caus problem cachingwrapperfilt implement cach notic 's call get compar null would n't appear distinguish entri n't cach entri cach 's null
need abil also sort spellcheck result freq instead edit distance+freq issu first notic report solr thread http //lucene.472066.n3.nabble.com/spellcheck-issues-td489776.html a489788 basic situat would use sort freq first instead current sort edit distanc subsort freq edit distanc equal author thread suggest think would work even better allow custom compareto function would incorpor frequenc direct distanc function would allow greater control trade-off frequenc edit distanc howev custom compareto function alway possibl ie certain version lucen must use releas solr incorpor freq direct distanc function may overkil ie depend implement suggest simpl modif exist compareto function lucen allow user specifi want exist sort method want sort freq
remov support pre-3.0 index remov support 2.x 1.9 index 4.0 seem noth done 3x special code handl 1.9 ll leav issu cover remov .zip index remov unnecessari code segmentinfo segmentinfo mike suggest compar version header top segmentinfo 2.9.x vs 3.0.x see one go remov format_pr fieldinfo remov old format termvectorsread know place code remov pleas post comment n't know ll time handl definit next day someon want take stab guest
enhanc snapshotdeletionpolici allow take multipl snapshot spin http //www.gossamer-threads.com/lists/lucene/java-dev/99161 do=post_view_thread 99161 replac snapshot snapshot string one name/identifi snapshot add support method like releas string getsnapshot etc unit test cours most written alreadi want contribut ve also written persistentsdp persist snapshot stabl storag lucen index case support open iw exist snapshot alreadi n't get delet 's interest contribut well port patch new api post soon
index sorter tool sort index accord float document weight document high weight given low document number mean first evalu use strategi earli termin queri see timelimitedcollector sort signific improv qualiti partial result origin tool creat doug cut nutch use norm document weight thus order limit limit resolut norm pure lucen version tool use arbitrari float specifi store field
remov deprec termattribut tokenattribut legaci support index titl say remov interfac termattribut remov empti fake implement termattributeimpl extend chartermattributeimpl remov method chartermattributeimpl indirect token remov sophisticated? backwards? layer termshash* remov iae numerictokenstream ta avail fix rest core test testtoken
open merg segmentread iw attempt open store file delet issu happen merg run merg doc store doc store still written iw use cfs merg run doc store get close turn cfx file tri open reader warm lucene-2311 correct open doc store hit fnfe segmentinfo merg realiz doc store turn cfx issu affect trunk crank doc test happen consist tie _testutil.getrandommultipli
indexread subclass must implement flex api fix trunk made indexread 's base flex api abstract fix core/contrib/solr place subclass ir n't alreadi implement flex includ contrib/memori contrib/instanti remov class back-compat layer emul flex api top pre-flex api
fix 2.9 contrib build succeed jdk 1.4 use leav contrib requir 1.5 build test lucen 2.9 java 1.4 build test contrib fail patch fix repect current compil version disabl contrib need java 1.5 check javac.sourc properti patch port 3.x trunk 1.6 contrib appear
promot testexternalcodecs.perfieldcodecwrapp core perfieldcodecwrapp let set codec field ll promot core mark experiment
ant generate-maven-artifact work lucene+solr 3.x+ maven build script need updat solr use artifact lucen consist abl differ maven_vers version want build 3.1-snapshot jar file 3.1-dev
extend codec segmentinfo writer reader 'm tri implement codec work append-on filesystem hdfs 's _almost_ done except segmentinfos.writ dir use checksumindexoutput turn use indexoutput.seek seek support append-on output propos extend codec interfac encapsul also detail segmentinfo write read patch follow feedback
renam lucene/solr dev jar file -snapshot.jar current lucen dev jar file end -dev.jar fine make peopl use maven jump hoop get -snapshot name convent requir maven want publish snapshot build hudson would need either write crazi script run build twice suggest switch -snapshot.jar hope 3.x branch /trunk 4.x branch
modifi parallelmultisearch use completionservic instead slowli poll result right parallel multi searcher creat array/list futur v repres searchabl 's concurr search correspond search task stand task submit executor array iter fifo future.get call iter obvious work n't ideal 's entir possibl situat ve run one first searchabl repres larg index take long time search result searchabl ca n't process larg index done search case two index sever million record get search front index smallest ten thousand entri n't think ideal result index wait ve modifi parallelmultisearch use completionservic instead result process order complet rather order submit test still pass best knowledg wo n't break anyth sever advantag 1 speed thread own executor n't wait first submit task finish order process result task may finish first 2 remov sever warn even annot away due ugli typecast generic array 3 decreas complex code case usual remov necess alloc fill array prime cach searchabl get 700-1200 ms per search use phrase patch get 400-500ms per search patch attach
npe open iw creat index segment file simpl test case hit npe noformat junit java.lang.nullpointerexcept junit java.io.file. init file.java:305 junit org.apache.lucene.store.niofsdirectory.openinput niofsdirectory.java:67 junit org.apache.lucene.store.fsdirectory.openinput fsdirectory.java:333 junit org.apache.lucene.index.segmentinfos.read segmentinfos.java:213 junit org.apache.lucene.index.indexfiledeleter. init indexfiledeleter.java:218 junit org.apache.lucene.index.indexwriter. init indexwriter.java:1113 junit org.apache.lucene.index.testindexwriter.testnosegmentfil testindexwriter.java:4975 junit org.apache.lucene.util.lucenetestcase.runbar lucenetestcase.java:277 noformat happen abort index ie segment file *.frq *.tis etc segments_n file tri open iw creat index
revis 949509 lucene-2480 caus ioe read past eof process older format segmentinfo data jvm assert process disabl revis 949509 org.apache.lucene.index.segmentinfo line 155 follow code noformat format segmentinfos.format_4_0 pre-4.0 index write byte singl norm file assert 1 input.readbyt noformat note assert statement invok input.readbyt assert disabl jvm input.readbyt invok caus follow readint return bogus valu caus ioe mistaken enter loop line 165 occur process old format format -9 index data tomcat whose startup script default turn assert full stacktrac noformat sever java.lang.runtimeexcept java.io.ioexcept read past eof org.apache.solr.core.solrcore.getsearch solrcore.java:1066 org.apache.solr.core.solrcore. init solrcore.java:581 org.apache.solr.core.corecontainer.cr corecontainer.java:431 org.apache.solr.core.corecontainer.load corecontainer.java:286 org.apache.solr.core.corecontain initializer.initi corecontainer.java:125 org.apache.solr.servlet.solrdispatchfilter.init solrdispatchfilter.java:86 org.apache.catalina.core.applicationfilterconfig.getfilt applicationfilterconfig.java:275 org.apache.catalina.core.applicationfilterconfig.setfilterdef applicationfilterconfig.java:397 org.apache.catalina.core.applicationfilterconfig. init applicationfilterconfig.java:108 org.apache.catalina.core.standardcontext.filterstart standardcontext.java:3800 org.apache.catalina.core.standardcontext.start standardcontext.java:4450 org.apache.catalina.core.containerbase.addchildintern containerbase.java:791 org.apache.catalina.core.containerbase.addchild containerbase.java:771 org.apache.catalina.core.standardhost.addchild standardhost.java:526 org.apache.catalina.startup.hostconfig.deploywar hostconfig.java:850 org.apache.catalina.startup.hostconfig.deploywar hostconfig.java:724 org.apache.catalina.startup.hostconfig.deployapp hostconfig.java:493 org.apache.catalina.startup.hostconfig.start hostconfig.java:1206 org.apache.catalina.startup.hostconfig.lifecycleev hostconfig.java:314 org.apache.catalina.util.lifecyclesupport.firelifecycleev lifecyclesupport.java:119 org.apache.catalina.core.containerbase.start containerbase.java:1053 org.apache.catalina.core.standardhost.start standardhost.java:722 org.apache.catalina.core.containerbase.start containerbase.java:1045 org.apache.catalina.core.standardengine.start standardengine.java:443 org.apache.catalina.core.standardservice.start standardservice.java:516 org.apache.catalina.core.standardserver.start standardserver.java:710 org.apache.catalina.startup.catalina.start catalina.java:583 sun.reflect.nativemethodaccessorimpl.invoke0 nativ method sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:39 sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:25 java.lang.reflect.method.invok method.java:597 org.apache.catalina.startup.bootstrap.start bootstrap.java:288 org.apache.catalina.startup.bootstrap.main bootstrap.java:413 caus java.io.ioexcept read past eof org.apache.lucene.store.bufferedindexinput.refil bufferedindexinput.java:154 org.apache.lucene.store.bufferedindexinput.readbyt bufferedindexinput.java:39 org.apache.lucene.store.checksumindexinput.readbyt checksumindexinput.java:40 org.apache.lucene.store.datainput.readint datainput.java:76 org.apache.lucene.store.datainput.readlong datainput.java:99 org.apache.lucene.index.segmentinfo. init segmentinfo.java:165 org.apache.lucene.index.segmentinfos.read segmentinfos.java:230 org.apache.lucene.index.directoryread 1.dobodi directoryreader.java:91 org.apache.lucene.index.segmentinfo findsegmentsfile.run segmentinfos.java:649 org.apache.lucene.index.directoryreader.open directoryreader.java:87 org.apache.lucene.index.indexreader.open indexreader.java:415 org.apache.lucene.index.indexreader.open indexreader.java:294 org.apache.solr.core.standardindexreaderfactory.newread standardindexreaderfactory.java:38 org.apache.solr.core.solrcore.getsearch solrcore.java:1055 32 noformat
linux-specif directori impl bypass buffer cach ve test could prevent lucen 's merg evict page os 's buffer cach tri fadvise/madvis via jni frustrat could get work detail http //chbits.blogspot.com/2010/06/lucene-and-fadvisemadvise.html thing work use linux 's o_direct flag forc io bypass buffer cach entir creat linux-specif directori impl
remov unus code surround queri parser
light/minim stem euro languag snowbal stemmer aggress would nice lighter altern applic may want perform less aggress stem exampl http //www.lucidimagination.com/search/document/5d16391e21ca6faf/plural_only_stemm good relev test algorithm exist think provid altern
automaton spellcheck current spellcheck make n-gram index term queri spellcheck term come back n-gram queri re-rank algorithm levenshtein altern could levenshtein queri direct index would n't need separ index rebuild
improv readabl standardtermsdictwrit one variabl name indexwrit termsindexwrit also layout
deletebypercenttask hit npe 'm build wiki indic test search perf across 3.x/4.0 hit npe creat delet 4.0 due flex cutov
indexread overwrit futur commit open past commit hit tri build test index perf test indexread writer accept indexcommit open quit power use delet polici keep multipl commit around open not-curr commit make chang write new commit without alter futur commit use first build big wikipedia index includ one commit w/ multipl segment anoth commit optim open writabl ir perform delet commit give singl test index four combin singl vs multi segment delet vs delet indexread bug wherebi overwrit segments_n file indexwrit work correct
chang term use byte lucene-2426 sort order chang codepoint order unfortun term still use string intern import compareto use wrong order utf-16 multitermqueri etc especi prioriti queue current wrong chang term use byte also support term encod byte numer instead use strang string encod
clarif improv correct behaviour backward test backward test use sinc 2.9 assert new lucen version support drop-in-replac previous version test previous version compil old version run new jar file begin test suit check anoth branch replac 3.1 direct embed previous sourc tree previous test backwards/ subdirectori svn sourc whole idea sever problem test check *public* api also check intern sometim even field package-priv method allow chang later version must abl chang test support behaviour done modifi backward test pass still use public api unchang sometim simpli comment test test intern public api test would like propos java annot trunk test like luceneinternaltest tell test runner backward test move backward layer e.g 4.1 run test *but* mark one done easili junit3/4 lucenetestcas j4 part issu good idea sometim break backward compat current best chang test reflect unneed stupi bring two problem backward test compil old version lucen chang old version backward folder sudden becom nonsens least jar artifact previous version stay *unchanged* case break backward correct way simpli disabl corespond test need make work broke backward wy test plugin trunk test alreadi check function backward test check api fix break backward contra propos follow implement patch 3.x branch includ *tests* noth els backward branch sourc file previous lucen core add latest releas jar artifact lucene-core.jar backwards/lib optim checksum md5/sh1 enforc chang exact compil previous test reason jar file break backward simpli *disable* test comment ideal short note jira issu show break chang inner behaviour class public dont fix disabl test simpl backward test api compat tests public api test use intern run use new annot trunk see sever good thing packag backward test src zip full distrib core test jar file enabl peopl doenload src zip file also run backwrad test svn checkout big backward test run faster problem one exampl attach patch mock class test e.g mockramdirectori extend lucen class access intern api chang api make fail work unchang exampl mockramdir use lot test use intern ramdir field chang type 3.1 disabl test use dir test surviv chang previous version jar reflect use trick interb test class case remov static link field replac reflect enabl compil old jar support run new version realli special case work good comment
changes-to-html fix improv lucen hudson changes.html|http //hudson.zones.apache.org/hudson/job/lucene-trunk/lastsuccessfulbuild/artifact/lucene/build/docs/changes/changes.html look bad changes2html.pl n't proper handl new usag changes.txt
index old hit except say creat index 2.3.x use demo 's indexfil tri read 4.0.x use checkindex hit confus except like noformat java.io.ioexcept read past eof org.apache.lucene.store.bufferedindexinput.refil bufferedindexinput.java:154 org.apache.lucene.store.bufferedindexinput.readbyt bufferedindexinput.java:39 org.apache.lucene.store.checksumindexinput.readbyt checksumindexinput.java:40 org.apache.lucene.store.datainput.readint datainput.java:76 org.apache.lucene.index.segmentinfo. init segmentinfo.java:171 org.apache.lucene.index.segmentinfos.read segmentinfos.java:230 org.apache.lucene.index.segmentinfo 1.dobodi segmentinfos.java:269 org.apache.lucene.index.segmentinfo findsegmentsfile.run segmentinfos.java:649 org.apache.lucene.index.segmentinfo findsegmentsfile.run segmentinfos.java:484 org.apache.lucene.index.segmentinfos.read segmentinfos.java:265 org.apache.lucene.index.checkindex.checkindex checkindex.java:308 org.apache.lucene.index.checkindex.checkindex checkindex.java:287 org.apache.lucene.index.checkindex.main checkindex.java:930 noformat think instead throw indextoooldexcept someth like
mani queri clase specifi boolean dismax queri highlight term alway yellow multi-color featur use problem follow snippet code protect string getpretag int num return pretags.length num pretag num pretag 0 code code protect string getpretag int num int n num pretags.length return pretag n code
.tostr empti multiphrasequeri hit npe ross woolf hit java-us thread multiphrasequery.tostr throw null pointer except 's still present trunk
alway appli posit increment gap valu 'm fanci stuff span queri sensit term posit discov posit increment gap index appli valu exist term index document suspect logic n't deliber 's alway particular reason think alway appli gap field refer docinverterperfield.java line 82 fieldstate.length 0 fieldstate.posit += docstate.analyzer.getpositionincrementgap fieldinfo.nam check fieldstate.length think condit simpli 0 n't think chang affect anyon certain help present either chang line lucen put hack first valu document dummi valu wast
fieldcomparator.termordvalcompar compar valu unnecessarili dig lucene-2504 notic termordvalcompar 's comparebottom method fall back compare-by-valu need n't specif know current bottom ord match current segment skip valu comparison ord ie return 0 ord exact compar hurt string sort perf especi optim indic also unoptim indic especi high redund mani uniqu valu field affect releas 2.9.x trunk like sever affect sinc look valu cost
improv test coverag multi-seg indic simpl patch add test-on helper class randomindexwrit let add doc random thing like use differ merg policy/schedul flush doc count instead ram flush random get multi-seg indic also random optim end also sometim test singl segment indic
fileswitchdirectori uniqueifi string file name return listal right blind concaten 's return primari secondari legit use fsd point under fsdir w/ differ impl open inputs/output simpl patch uniqueifi use set string
multitermsenum over-shar differ docs/andpositionsenum robert found work lucene-2352 multitermsenum incorrect share sub-enum two differ invoc .docs/andpositionsenum
rollback n't preserv integr origin index sever updatedocu call rollback call return index prior state seem occur number updat exceed ram buffer size i.e flush updat occur test fail lucen 2.4 2.9 3.0.1 3.0.2 junit follow
fsdirectory.copi impl unsaf coupl issu filechannel.transferfrom document may copi number byte request howev n't check return valu need fix code read loop byte copied.. call addindex w/ larg segment hundr mbs size ran follow except java 1.6 java 1.5 's except cryptic code except thread main java.io.ioexcept map fail sun.nio.ch.filechannelimpl.map filechannelimpl.java:770 sun.nio.ch.filechannelimpl.transfertotrustedchannel filechannelimpl.java:450 sun.nio.ch.filechannelimpl.transferto filechannelimpl.java:523 org.apache.lucene.store.fsdirectory.copi fsdirectory.java:450 org.apache.lucene.index.indexwriter.addindex indexwriter.java:3019 caus java.lang.outofmemoryerror map fail sun.nio.ch.filechannelimpl.map0 nativ method sun.nio.ch.filechannelimpl.map filechannelimpl.java:767 7 code chang impl someth like code long numwritten 0 long numtowrit input.s long bufsiz 1 26 numwritten numtowrit numwritten += output.transferfrom input numwritten bufsiz code code success add index code use chunk 64mb howev might larg applic definit need smaller one question small perform wo n't affect 'd great let configur howev sinc api call api addindex sure 's easili control also read somewher ca n't rememb linux nativ impl better copi chunk perhap make linux specif impl
numericrangequeri error endpoint near long min max valu problem first report solr http //lucene.472066.n3.nabble.com/range-query-on-trielongfield-strange-result-tt970974.html a970974
topdocscollector abstract super class real topdocscollector contract subclass implement priority-queu logic e.g pqtopdocscollector topdocscollector abstract interfac produc topdoc well priorityqueu base implement collector could produc topdoc must use priorityqueu would advantag allow topdocscollector interfac type abstract class pqtopdocscollector sub-class 'd good clean generic use class 's odd creat topfieldcollector case topdoc object fix generic
remov intern field name flex api previous version lucen intern field import minim string comparison cost iter termenum detect chang field name separ field name term flex queri compar field name anymor whole perform problemat intern remov start need care review place e.g preflex codec mayb issu remov term class complet robert
timelimitingcollector 's timeexceededexcept contain useless relat docid found anoth bug randomindexwrit timelimitingcollector break collect timeout record last/next collect docid without rebas docid useless testtimelimitingcollector check docid correct rebas make sens randomindexwrit use differ merg set index sometim optim test fail correct docid useless non-optim index attach patch fix pleas tell backport 2.9 3.0
3.x backward test use version.lucene_curr n't test backward 3.x backward test most use version.lucene_curr therefor n't alway test behavior ad test_version_curr 3.0 backwards/lucenetestcas think fix backward test use test_version_curr instead
chang jdk icu collat use byte term byte switch collat use byte instead indexablebinarystr faster result much smaller sort key figur work fix termrangequeri use byte parallel alreadi test sort etc
preflex codec n't order term correct surrog danc preflex codec must dynam remap term utf16 order unicod code point order buggi better test want add test-on codec preflexrw abl write indic pre-flex format also fix test random pick codec includ preflexrw better test codec
remov share doc store per-thread documentswrit share doc store across segment n't make much sens anymor see also lucene-2324
char termattribut clone memori consumpt memori consumpt problem clone char termattributeimpl object rais thread http //markmail.org/thread/bybuerugbk5w2u6z
reopen support segmentread reopen segmentread support simpli follow overrid public synchron indexread reopen throw corruptindexexcept ioexcept return reopenseg this.si fals readon overrid public synchron indexread reopen boolean openreadon throw corruptindexexcept ioexcept return reopenseg this.si fals openreadon
random analyz test finding+fix lot bug random lucen test r966878 ad variant random unicod string give random string within unicod block purpos think use test analyz better exampl pound ton random greek string greek analyz least make sure n't except
fix except handl thread safeti realtim branch sever test current fail realtim branch due thread safeti problem often except concurrentmergeschedul test test abort non-abort except
wordlistload ineffici wordlistload basic use load stopword list stem dictionari etc unfortun api return set string sometim even hashset string hashmap string string think break return chararrayset chararraymap leav return valu generic set map someon object break 3.1 4.0 think would good fix place reason someon new fooanalyz lot probabl uncommon think bunch useless copi think slap lucene.intern api sinc that most use
testutf32toutf8 run forev stress test particular test uncov testrandomrang testcas run forev depend random number pick
oper allow amount whitespac exampl foo bar treat like foo -bar seem like +- treat unari oper immedi follow operand
testutf32toutf8 fail ibm 's jre automatontestutil.randomacceptedstr return invalid utf32 int unpair surrog ibm 's jre handl differ oracl 's
testparalleltermenum fail sep codec reproduc preflexfix branch sinc test codec ant test-cor -dtestcase=testparalleltermenum -dtests.codec=sep think probabl test like run standard might find like n't think block lucene-2554 noformat junit testsuit org.apache.lucene.index.testparalleltermenum junit testcas test1 org.apache.lucene.index.testparalleltermenum caus error junit read past eof junit java.io.ioexcept read past eof junit org.apache.lucene.store.bufferedindexinput.refil bufferedindexinput.java:154 junit org.apache.lucene.store.bufferedindexinput.readbyt bufferedindexinput.java:39 junit org.apache.lucene.store.datainput.readvint datainput.java:86 junit org.apache.lucene.index.codecs.sep.singleintindexinput reader.next singleintindexinput.java:64 junit org.apache.lucene.index.codecs.sep.seppostingsreaderimpl sepdocsenum.nextdoc seppostingsreaderimpl.java:316 junit org.apache.lucene.index.testparalleltermenum.test1 testparalleltermenum.java:188 junit org.apache.lucene.util.lucenetestcase.runbar lucenetestcase.java:316 junit junit test run 1 failur 0 error 1 time elaps 0.009 sec junit junit standard output junit note random codec testcas test1 sep junit noformat
improv _testutil usag ve start issu ve notic _testutil.getrandommultipli call mani loop condit check sometim hundr thousand time time integer.parseint call system.getproperti realli becom constant imo either lucenetestcas j4 _testutil 's expect chang test run review class spot thing think fixed/improv gettestcodec becom constant well arraytostr mark deprec ve check one call ll delet 4.0 code branch test-on class need deprec anyth gettempdir call new random instead newrandom lucenetestcasej4 mean someth fail wo n't know random seed use regard might want output class obtain static seed reportadditionalfailur instead class ran test rmdir string remov imo leav rmdir file suggest includ recurs rmdir file handl delet nest directori also check whether dir delet succeed file bite us window test close thing proper ll work patch
index perform test realtim branch run index perform test dwpt chang compar trunk need test single-thread multi-thread perform note flush ram n't implement yet either wait test flush doc count
maven artifact lucen 4 store correct path hello would like use maven artifact lucen 4.0 produc hudson build machin artifact correct produc http //hudson.zones.apache.org/hudson/view/lucene/job/lucene-trunk/lastsuccessfulbuild/artifact/maven_artifacts/lucene/ howev artifact store path org/apache/lucene/ current store lucen prevent project use maven correct download lucen 4.0 artifact thank help
tier flush dwpts ram low/high water mark documentswriterperthread need track total consum ram across dwpts flush strategi idea discuss lucene-2324 use tier approach flush first dwpt low water mark e.g 90 allow ram flush dwpts high water mark e.g 110 use linear step high low watermark e.g 5 dwpts use flush 90 95 100 105 110 allow user configur low high water mark valu explicit use total valu e.g low water mark 120mb high water mark 140mb shall keep simplic singl setrambuffersizemb config method use someth like 90 110 water mark
optim copi indexinput output ve creat optim copi file directori directori ve also optim copybyt recent howev re miss opposit side copi indexinput output 'd like mimic filechannel api copyto indexinput copyfrom indexoutput way side optim copi process depend type indexinput/output need copi to/from fsindexinput/output use filechannel two fs type raminput/outputstream copi to/from buffer direct w/o go intermedi one actual ramin/out might big win n't care type indexinput/output given need copi buffer direct think consolid dir.copi impl one directori reli in/out one optim copi plus enabl someon optim copi in/out outsid scope directori somehow turn imposs wo n't make sens 'd like optim ramdirectory.copi dir src dest use intermedi buffer
intermitt failur testindexwriter.testcommitthreadsafeti mark 's 1 hudson box found failur repro noformat error messag mockramdirectori close still open file _1m.cfs=1 _1k.cfs=1 _14.cfs=1 _1g.cfs=1 _1h.cfs=1 _1f.cfs=1 _1n.cfs=1 _1i.cfs=1 _1j.cfs=1 _1l.cfs=1 stacktrac java.lang.runtimeexcept mockramdirectori close still open file _1m.cfs=1 _1k.cfs=1 _14.cfs=1 _1g.cfs=1 _1h.cfs=1 _1f.cfs=1 _1n.cfs=1 _1i.cfs=1 _1j.cfs=1 _1l.cfs=1 org.apache.lucene.store.mockramdirectory.clos mockramdirectory.java:282 org.apache.lucene.index.testindexwriter.testcommitthreadsafeti testindexwriter.java:4616 org.apache.lucene.util.lucenetestcase.runbar lucenetestcase.java:328 standard output note random codec testcas testcommitthreadsafeti sep standard error follow except thrown thread thread thread-1784 java.lang.runtimeexcept junit.framework.assertionfailederror null org.apache.lucene.index.testindexwrit 9.run testindexwriter.java:4606 caus junit.framework.assertionfailederror null junit.framework.assert.fail assert.java:47 junit.framework.assert.asserttru assert.java:20 junit.framework.assert.asserttru assert.java:27 org.apache.lucene.index.testindexwrit 9.run testindexwriter.java:4597 noformat
cutov functionqueri test use randomindexwrit better test
small imprecis search packag javadoc search packag javadoc state scorer score collector abstract lucen 3.0 accur anymor
multiphrasequeri throw aioob see thread multiphrasequeri throw arrayindexoutofbound except dev jayendra patil
fastvectorhighlight make fragmentsbuild use encod make fragmentsbuild use encod highlight
allow alg file specifi default codec alreadi commit one accid better open issu ad default.codec puls alg file specifi codec use write new segment index
concurr issu segmentinfo.fil could lead concurrentmodificationexcept multi-thread call file segmentinfo could lead concurrentmodificationexcept one thread finish addit arraylist file yet thread alreadi obtain cach see rare except would nice fix see code longer problemat trunk other port flex_1458 look fix implement post 3.x featur fix 3.x 2.9.x branch could creat file set first popul assign member variabl end method resolv issu could prepar patch 2.9.4 3.x need info 19 webapp= path=/repl params= command=fetchindex wt=javabin status=0 qtime=1 jul 30 2010 9:13:05 org.apache.solr.core.solrcor execut info 19 webapp= path=/repl params= command=detail wt=javabin status=0 qtime=24 jul 30 2010 9:13:05 org.apache.solr.handler.replicationhandl dofetch sever snappul fail java.util.concurrentmodificationexcept java.util.abstractlist itr.checkforcomodif abstractlist.java:372 java.util.abstractlist itr.next abstractlist.java:343 java.util.abstractcollection.addal abstractcollection.java:305 org.apache.lucene.index.segmentinfos.fil segmentinfos.java:826 org.apache.lucene.index.directoryread readercommit. init directoryreader.java:916 org.apache.lucene.index.directoryreader.getindexcommit directoryreader.java:856 org.apache.solr.search.solrindexreader.getindexcommit solrindexreader.java:454 org.apache.solr.handler.snappuller.fetchlatestindex snappuller.java:261 org.apache.solr.handler.replicationhandler.dofetch replicationhandler.java:264 org.apache.solr.handler.replicationhandl 1.run replicationhandler.java:146
move intblock/sep codec test intblock sep codec core exist make easi peopl tri differ low-level algo encod int sep break doc freq pos skip data payload 5 separ file vs 2 file standard codec use intblock enabl doc freq pos file encod fixed-s block int time app easili subclass codec use int encod codec concret use dummi low-level block int encod eg encod 128 int separ vint 'd like chang abstract move dummi codec test test would still test dummi codec rotat random test 'd also like renam intblock fixedintblock 'm tri get variableintblock work well int encod like simple9 simple16 whose block size vari depend particular valu
term index store useless suffix idea came discuss w/ robert improv term index term dict index today simpli grab whatev term 0 mod 128 index default wast often n't need suffix term point eg 127th term aa 128th index term abcd123456789 instead store full term need store ab suffix useless use ram sinc load term index ram patch simpl optim particular easi term byte sort binari order test first 10m 1kb wikipedia doc reduc term index tii file 3.9 mb 3.3 mb 16 smaller use standardanalyz index bodi field token titl date field untoken expect noisier term dict especi one w/ bad term accident index save even futur could crazier thing eg 's real reason index term must regular everi n term could instead pick term care say approxim everi n favor term smaller net prefix also index spars region net docfreq lowish sinc afford somewhat higher seek+scan time term sinc enum doc much faster
add variable-s int block codec alreadi support fix block size int block codec make simpl creat codec int encod algorithm like for/pfor algorithm like simple9/16 fix encod variabl number adjac int depend specif valu int
enabl access freq inform queri 's sub-scor abil gather detail score given doc match current queri come number time user 's list recent thread queri match count ryan mcv java-us eg simpl termqueri foo hit 'd like know mani time foo occur doc booleanqueri +foo +bar abl separ see freq foo bar current hit lucen n't make possibl today shame lucen fact comput exact inform 's access collector
testnl fail ja local set ant_args= -dargs=-duser.language=ja -duser.country=jp ant test-cor -dtestcase=testnl test 2 set messag one fallback one ja test assum ask non-ja local get fallback messag resourcebundle.getbundl work noformat otherwis follow sequenc generat attribut valu specifi local language1 country1 variant1 default local language2 country2 variant2 basenam language1 country1 variant1 basenam language1 country1 basenam language1 basenam language2 country2 variant2 basenam language2 country2 basenam language2 basenam noformat case ja default local get japanes messag instead basenam language2 match
add static readsnapshotsinfo persistentsnapshotdeletionpolici psdp persist snapshot inform directori open psdp obtain write lock snapshot dir keep open indexwrit updat directori snapshot created/releas caus problem follow scenario two process one updat content index keep psdp open also take snapshot anoth process want read exist snapshot inform open read-on indexread content index process read exist snapshot inform p1 keep write lock snapshot directori two possibl solut psdp open indexwrit directori snapshot/releas bit expens unnecessari introduc static readsnapshotsinfo psdp accept directori return snapshot inform imo 's cleaner wo n't perform overhead opening/clos iw ll post patch implement 2nd approach short 'd appreci comment
disk full caus index corrupt certain case robert uncov nasti bug ad random oal.index test got standalon test show issu corrupt path follow merg hit initi except eg disk full merg post handl except iw close sub-read suppress except one sub-read pend delet happen reader pool iw flush flush hit 2nd except eg disk full segmentread incorrect leav segmentinfo 's delgen advanc 1 referenc corrupt file yet segmentread still forc close enough disk free later iw.commit/clos succeed result segment file refer invalid delet file
cutov oal.index test use random iwc teas bug
test use mockramdirectori ramdirectori
impl tostr mergepolici extens import see debug lost cutov iwc open issu remind us get back releas
queri scorer use multifield lucen searching/filt per-seg today number test direct invok scorer.scor filter.getdocidset composit reader
allow test use differ directori impl test use mockramdirectori instead ramdirectori picki like window forc test close reader etc close directori think follow chang new mockramdirectori test .newdirectori random lucenetestcas j4 track dir close teardown also clean temp dir like solr factor mockish stuff mockramdirectori mockdirectorywrapp allow -dtests.directoryimpl simpler specifi default directori use test default random think there chanc might find bug havent yet surfac easier trigger fsdir furthermor would benefici directory-implementor could run entir testsuit directori impl like codec-implementor
deprec spatial contrib spatial contrib blight bug latest seri found grant discuss here|http //search.lucidimagination.com/search/document/c32e81783642df47/spatial_rethinking_cartesian_tiers_implement show need re-think cartesian tier implement given need creat spatial modul contain code taken lucen solr make sens deprec spatial contrib start scratch new modul
n't tri cach composit reader 's multibit deleteddoc multifields.getdeleteddoc build multibit instanc one check top-level docid delet stuff privat cach indexread invalid composit reader read/writ result multiread fals claim doc delet
make getattribut class attclass generic org.apache.lucene.util.attributesourc current public attribut getattribut class attclass final attribut att attribut this.attributes.get attclass att null throw new illegalargumentexcept attributesourc attribut attclass.getnam return att sampl usag termattribut termatt termattribut ts.getattribut termattribute.class improv suppresswarn uncheck public getattribute2 class extend attribut attclass final att this.attributes.get attclass att null throw new illegalargumentexcept attributesourc attribut attclass.getnam return att sampl usag termattribut termatt ts.getattribut termattribute.class
default merg polici take delet account lucene-1634 ad calibratesizebydelet todo default true 3.0 miss ll fix 3.1 4.0 technic chang back-compat 3.x think 's fine make except big win indic high doc turnov time
fastvectorhighlight add method set arbitrari char use concaten multivalu data follow multivalu name author field michael mccandless erik hatcher oti gospodneti? sinc fragmentsbuild concaten multivalu data space basefragmentsbuilder.getfragmentsourc code buffer.length endoffset index 0 values.length index 0 0 valu index 0 .istoken valu index 0 .stringvalu .length 0 buffer.append buffer.append valu index 0 ++ .stringvalu code entir field snippet use lucene-2464 michael mccandless erik hatcher oti gospodneti? requir arbitrari char e.g '/ set client separ snippet easili i.e michael mccandless/erik hatcher/oti gospodneti?
optim contrib/regex flex chang regexcap match string match bytesref jakarta jdk impl use characteriterator/charsequ match utf16result instead also reus matcher jdk n't see didnt make sens esp sinc reus csq
allow specif spell checker accuraci call suggestsimilar realli need accuraci class variabl spellcheck
generat jar contain test class test class use write unit test code extern lucen project would help build jar class publish maven depend
addindex directori trigger merg flush indexwriter.addindex directory.. call flush w/ triggermerge=tru beat purpos chang done addindex merg segment leav applic 's choic chang simpl pass fals instead true n't plan post patch howev open issu case want comment
intellij idea eclips setup set lucene/solr intellij idea eclips time-consum attach patch add new top level directori dev-tools/ sub-dir idea/ eclipse/ contain basic setup file trunk well top-level ant target name idea eclips copi file proper locat arrang avoid messi attend in-plac project configur file direct check sourc control idea configur includ modul lucen solr lucen solr contrib analysi modul junit run configur per modul includ eclips configur includ sourc entri source/test/resourc locat classpath setup librari entri jar idea ant idea run configur must perform manual configur project-level jdk eclips ant eclips run user refresh project right-click project choos refresh patch commit subvers svn ignor properti added/modifi ignor destin idea eclips configur locat iam jambour written lucen wiki detail set instruct appli 3.x branch patch idea http //wiki.apache.org/lucene-java/howtoconfigureintellij
directiolinuxdirectori hardwir buffer size creat file invalid permiss testdemo fail use directiolinuxdirectori use robert 's new -dtests.directory=xxx o_creat file fail specifi mode depend c stack get permiss deni also current hardwir buffer size 1 mb mark found plan add forcedbuffers directiolinuxdir 's ctor option overrid lucen 's default buffer size way small direct io get bare ok perform pass 0 get lucen 's default buffer size
fastvectorhighlight align first valu empti multivalu field
coord still appli miss terms/claus miss term boolean queri disappear i.e n't even affect coord factor
intermitt failur testthreadedoptim failur look like noformat junit testsuit org.apache.lucene.index.testthreadedoptim junit testcas testthreadedoptim org.apache.lucene.index.testthreadedoptim fail junit null junit junit.framework.assertionfailederror null junit org.apache.lucene.index.testthreadedoptimize.runtest testthreadedoptimize.java:125 junit org.apache.lucene.index.testthreadedoptimize.testthreadedoptim testthreadedoptimize.java:149 junit org.apache.lucene.util.lucenetestcase.runbar lucenetestcase.java:253 noformat commit verbos next time strike ll detail
simpl improv test simon request doc test option let clean doc propos chang var tests.xxx e.g tests.threadspercpu tests.multipli ensur 6 build system lucen solr solr contrib respect add simpl wiki page list
queri mani asterisk caus 100 cpu usag search queri mani adjac asterisk e.g fo**************obar get webapp caught loop seem end reason amount time may fact infinit asterisk queri eventu return result add take longer longer amount time six seven asterisk queri never seem finish even abort search thread handl troublesom queri continu run background pin cpu found problem src/java/org/apache/lucene/search/wildcardtermenum.java lucen 3.0.1 look like 3.0.2 ought affect well 'm sure trunk though patch fix problem 3.0.1
extend codec handl also store field term vector current codec api handl writing/read term-rel data store field data term frequenc vector data writing/read handl elsewher propos extend codec api handl data well
random test failur org.apache.lucene.testexternalcodecs.testperfieldcodec testexternalcodec error messag state.ord=54 startord=0 ir.isindexterm=tru state.docfreq=1 stacktrac junit.framework.assertionfailederror state.ord=54 startord=0 ir.isindexterm=tru state.docfreq=1 org.apache.lucene.index.codecs.standard.standardtermsdictread fieldread segmenttermsenum.seek standardtermsdictreader.java:395 org.apache.lucene.index.documentswriter.applydelet documentswriter.java:1099 org.apache.lucene.index.documentswriter.applydelet documentswriter.java:1028 org.apache.lucene.index.indexwriter.applydelet indexwriter.java:4213 org.apache.lucene.index.indexwriter.doflushintern indexwriter.java:3381 org.apache.lucene.index.indexwriter.doflush indexwriter.java:3221 org.apache.lucene.index.indexwriter.flush indexwriter.java:3211 org.apache.lucene.index.indexwriter.optim indexwriter.java:2345 org.apache.lucene.index.indexwriter.optim indexwriter.java:2323 org.apache.lucene.index.indexwriter.optim indexwriter.java:2293 org.apache.lucene.testexternalcodecs.testperfieldcodec testexternalcodecs.java:645 org.apache.lucene.util.lucenetestcase.runbar lucenetestcase.java:381 org.apache.lucene.util.lucenetestcase.run lucenetestcase.java:373 standard output note random codec testcas testperfieldcodec mockfixedintblock blocksize=1327 note random local testcas testperfieldcodec lt_lt note random timezon testcas testperfieldcodec africa/lusaka note random seed testcas testperfieldcodec 812019387131615618
add new snowbal languag snowbal ad new languag patch add support http //snowball.tartarus.org/algorithms/armenian/stemmer.html http //snowball.tartarus.org/algorithms/catalan/stemmer.html http //snowball.tartarus.org/algorithms/basque/stemmer.html
indexreader.termdoc retriev document termdoc object return indexreader.termdoc retriev document howerv document retriev correct use indexreader.termdoc term indexreader.termdoc null indexsearcher.search queri
fastvectorhighlight enabl fraglistbuild fragmentsbuild set per-field overrid
mmapdirectori chunk buggi mmapdirectori use chunk multimmapindexinput java 's bytebuff use int address valu 's necessari access file integer.max_valu size use multipl byte buffer notic clover report entir multimmapindexinput class complet untest surpris sinc test make tini index
modules/analysys/icu ant gennorm2 work command run gennorm2 work present also icupkg need call convert binari file big-endian attach patch
make build friend apach harmoni part improv test thought would good idea make build ant test friend work apach harmoni 'm suggest de-optim code sun jvms anyth crazi like use tool exampl bug tests/cod exampl found test expect arrayioob realli javadoc contract method ioob happen pass alway sun jvm that implement alway throw better reproduct bug exampl 2 month year|http //en.wikipedia.org/wiki/unusual_software_bug phase_of_the_moon_bug seem testquerypars fail thai local difficult-to-reproduc way *always* get similar failur like harmoni test class better stabil portabl tri reason avoid depend upon intern detail kind thing fail harmoni might sudden fail futur sun jdk differ impl bring lot interest stuff moment current lot failur think lot might caus http //permalink.gmane.org/gmane.comp.java.harmony.devel/39484
fix small perf issu string/termordvalcompar uncov silli work lucene-2504 eg unnecessari binarysearch single-seg reader
packedint support structur 256mb packedint packed32 packed64 fail intern structur exceed 256mb due miss cast result bit posit calcul limit integer.max_valu 256mb 8 2gb
indexreader.iscurr lie document remov latest commit usecas follow 1 get indexread via indexwrit 2 delet document term via indexwrit 3 commit indexwrit 4. indexreader.iscurr return true usual check index reader current reopen re-obtain via writer ect. caus problem document still found search delet testcas attach
bq provid explan non-match plug seed -6336594106867842617l testexplan run testsimpleexplanationsofnonmatch ll hit noformat junit testsuit org.apache.lucene.search.testsimpleexplanationsofnonmatch junit testcas testbq2 org.apache.lucene.search.testsimpleexplanationsofnonmatch fail junit explan +yy +w3 0 n't indic non-match 0.08778467 match product junit 0.17556934 match sum junit 0.17556934 match weight field w3 0 product junit 0.5165708 queryweight field w3 product junit 0.7768564 idf docfreq=4 maxdocs=4 junit 0.6649502 querynorm junit 0.33987468 match fieldweight field w3 0 product junit 1.0 tf termfreq field w3 =1 junit 0.7768564 idf docfreq=4 maxdocs=4 junit 0.4375 fieldnorm field=field doc=0 junit 0.5 coord 1/2 junit expect 0.0 0.08778467 junit junit.framework.assertionfailederror explan +yy +w3 0 n't indic non-match 0.08778467 match product junit 0.17556934 match sum junit 0.17556934 match weight field w3 0 product junit 0.5165708 queryweight field w3 product junit 0.7768564 idf docfreq=4 maxdocs=4 junit 0.6649502 querynorm junit 0.33987468 match fieldweight field w3 0 product junit 1.0 tf termfreq field w3 =1 junit 0.7768564 idf docfreq=4 maxdocs=4 junit 0.4375 fieldnorm field=field doc=0 junit 0.5 coord 1/2 junit expect 0.0 0.08778467 junit org.apache.lucene.search.checkhits.checknomatchexplan checkhits.java:60 junit org.apache.lucene.search.testsimpleexplanationsofnonmatches.qtest testsimpleexplanationsofnonmatches.java:36 junit org.apache.lucene.search.testexplanations.qtest testexplanations.java:101 junit org.apache.lucene.search.testsimpleexplanations.testbq2 testsimpleexplanations.java:235 junit org.apache.lucene.util.lucenetestcase.runbar lucenetestcase.java:397 junit org.apache.lucene.util.lucenetestcase.run lucenetestcase.java:389 noformat bug real bq 's explain method fail proper enforc requir claus sub-scor null thank random test
creat chainingcollector chainingcollector allow chain bunch collector w/o need know care pass lucen 's search api sinc collector conveni yet use class post patch w/ short
fsdirectory.copybyt n't safe simplefsdirectori copybyt optim lucene-2574 safe simplefsdirectori work fine niofsdirectori simplefsdirectori copybyt optim caus index corrupt see http //www.lucidimagination.com/search/document/36d2dbfc691909d5/bug_triggered_by_testindexwriter_testrandomstoredfield background step reproduc time least window noformat 1. edit line 87 testindexwrit plugin seed random newrandom 3312389322103990899l 2. edit line 5138 testindexwrit forc simplefsdirectori directori dir new simplefsdirectori index 3. run command ant clean test-cor -dtestcase=testindexwrit -dtestmethod=testrandomstoredfield -dtests.iter=10 -dtests.codec= mockvariableintblock 29 noformat
make highfreqterms.termstat class public 's possibl use public method contrib/misc/ /highfreqterm outsid packag return type packag visibl propos move termstat class separ file make public
remov random juggl test add -dtests.se sinc ad newindexwriterconfig/newdirectori etc lot test juggl random around instead patch chang lucenetestcas j4 manag random allow set -dtests.seed=23432432432 reproduc test rather edit code remov random argument newindexwriterconfig newdirectori want look thing like newfield vari term vector etc also fix solr contrib build arent hide except note solr-2002
add lucenetestcas j4 .newfield think would good vari differ field option test exampl iw set newindexwriterconfig directori newdirectori patch add newfield work like new field except sometim turn extra option store field term vector addit term vector data etc
basetestrangefilt extrem slow test extend basetestrangefilt sometim slow testfieldcacherangefilt testmultitermconstantscor testtermrangefilt exampl testfieldcacherangefilt ran 10 minut comput kill notic test frequent run minut think least chang junit4 index built beforeclass
merg lucenetestcas lucenetestcasej4 ad junit4 support separ test class unfortun two separ base class maintain lucenetestcas lucenetestcasej4 creat mess difficult manag instead propos singl base test class work junit3 junit4 style modifi lucenetestcasej4 follow way method run limit one annot test also void no-arg method start test like junit3 mean dont sprinkl test everywher cours ignor work expect everywher lucenetestcasej4 extend testcas dont import static assert get assert test chang requir minor thing chang setup teardown must public protect useless ctor must remov testfoo string name super name localizedtestcas gone instead code public class testquerypars extend localizedtestcas code code runwith lucenetestcase.localizedtestcaserunner.class public class testquerypars extend lucenetestcas code multicodectestcas lucenetestcase.multicodectestcaserunner.class core test patch start made empti lucenetestcas extend lucenetestcasej4 'd like contrib solr renam lucenetestcasej4 singl class lucenetestcas
stringhelp stringdiffer wrong supplementari char stringhelp stringdiffer take supplementari charact account sinc use intern think remov guess sinc complex fix bwcompat reason releas version realli fix sinc folk might use though trunk could drop
fals assert 0 posit delta standardpostingswriterimpl standardpostingswriterimpl line 159 code java assert delta 0 || posit 0 || posit -1 position= posit lastposition= lastposit quit right pos=0 repeat twice n't catch code enabl assert run unit test ve found assert fail delta 0 occur posit valu sent twice arrow ad removeduplicatestokenfilt problem went away realli forc add filter think delta 0 would better assert
move renam term dict index abstract post oal.index.codecs.standard term dict compon current live standard codec oal.index.codecs.standard fact generic way particular standard codec alreadi mani codec sep fix int block var int block puls append re-us term dict writer/read compon 'd like move oal.index.codec renam standardtermsdictwriter/read prefixcodedtermswriter/read standardtermsindexwriter/read abstracttermsindexwriter/read simplestandardtermsindexwriter/read simpletermsindexwriter/read standardpostingswriter/read abstractpostingswriter/read standardpostingswriterimpl/readerimpl standardpostingswriter/read move nice reusabl term dict impl term index impl still well-decoupl eg could theori explor variabl gap term index mani codec expect n't need/want implement term dict code/index format chang besid renam fix imports/usag renam class
allow packedints.readeriter advanc one valu iterator-lik api lucene-2186 make effect use packedints.readeriter frequent skip multipl valu readeriter current requir loop readerinter next advanc certain valu allow readeriter expos advanc ord method make use-cas like effici issu somewhat part effort make lucene-2186 smaller break littl issu part general use
fieldcach includ bitset match doc fieldcach return array repres valu doc howev way know doc actual valu chang return object repres valu *and* bitset valid doc
improv window default fsdirectori current window default simplefsdirectori problem due synchron benchmark queri *sequentially* pretti surpris much faster mmapdirectori exampl case mani seek think chang default window window unmap_support 64-bit use mmapdirectori els use simplefsdirectori think consid 4.0 see goe
rethink localizedtestcaserunn junit 4 clover oom spinn conversation|http //www.lucidimagination.com/search/document/ae20885bf5baedc5/build_failed_in_hudson_lucene_3_x_116 7ed351341152ee2d rethink way execut testcas differ local sinc glover report appear throw oom error b/c junit treat local singl test case run option select local random run test singl local set local via system properti -dtest.locale=en.en run default local -dtest.skiplocale=tru one instrument clover let common test run local
thaianalyz assum thing jre thaianalyzer/thaiwordfilt depend fact breakiterator.getwordinst new local th return dictionary-bas break iter segment thai phrase word use whitespac non-standard jre special local way nice ca n't depend exampl run ibm jre analyzer/wordfilt complet broken sens wo n't claim minimum need document suggest user look icutoken thai alway breakiter jre-depend better would check static thing actual work creat new thaiwordfilt could clone breakiter often cheaper make new one anyway could throw except support add boolean user know work could refer boolean assert.assum test
test fail n't report unclos resourc lucenetestcas ensur afterclass close directori turn check close open file good test fail resourc leak test truli fail confus usual go make part code would call .close test fail think omit check afterclass
replac maven pom templat full pom chang document accord current maven pom templat contain depend inform bare bone necessari upload artifact maven repositori full maven pom attach patch includ inform necessari run multi-modul maven build addit serv purpos current pom templat sever depend avail public maven repositori profil top-level pom activ instal depend various lib/ directori local repositori top-level directori code mvn -n -pbootstrap instal code non-maven depend instal run lucene/solr test via maven 's surefir plugin popul local repositori artifact top level directori run code mvn instal code one lucene/solr modul depend anoth depend declar *artifact produc modul deposit local repositori rather modul 's un-jar compil output build/ directori must run mvn instal modul chang visibl modul depend creat artifact without run test code mvn -dskiptest instal code almost alway includ clean phase build e.g code mvn -dskiptest clean instal code
testindexwriterexcept random failur aioob byteblockpool.allocslic testindexwriterexcept threw today reproduc
lucenetestcas eas use improv start work lucene-2658 finish patch problem lucenetestcas test beforeclass test befor method might random behavior latter reproduc -dtests.se want thing beforeclass use differ api newdirectori random instead newdirectori etc new user current output verbos confus overwhelm refactor class address problem class still need 2 seed intern beforeclass run method setup might run mani time especi increas iter lucenetestcas deal seed 128-bit uuid msb initi beforeclass lsb vari method run provid seed -d fix uuid provid fix api consist abl migrat test setup beforeclass junit3 junit4 without chang paramet codec local timezon print end test fail per-class anyway setup beforeclass final test fail get singl reproduc command line copi past reproduc way dont spend time tri figur command line noformat junit test run 2 failur 2 error 0 time elaps 0.197 sec junit junit standard output junit note reproduc ant test -dtestcase=testexampl -dtestmethod=testmethoda -dtests.seed=a51e707b-6550-7800-9f8c-72622d14bf5f junit note reproduc ant test -dtestcase=testexampl -dtestmethod=testmethodb -dtests.seed=a51e707b-6550-7800-f7eb-2efca3820738 junit note test param codec=preflex locale=ar_li timezone=etc/uct junit junit test org.apache.lucene.util.testexampl fail noformat
byteshash issu byteshash separ lucene-2186
wrong except nativefslockfactori lia2 test case part integr lucen action 2 test case lucene-2661 found one test case fail test pretti simpl pass 3.0 except get instead lockreleasefailedexcept pretti confus think fix
add simpletext codec inspir sahin buyrukbilen 's question http //www.lucidimagination.com/search/document/b68846e383824653/how_to_export_lucene_index_to_a_simple_text_fil b68846e383824653 made simpl read/writ codec store post data singl text file _x.pst look like noformat field content term file doc 0 pos 5 term doc 0 pos 1 term second doc 0 pos 3 term test doc 0 pos 4 term doc 0 pos 2 term doc 0 pos 0 end noformat codec fulli funtion lucen solr test pass -dtests.codec=simpletext perform obvious poor howev use debug transpar understand lucen store index etc 's quick way gain understand codec work
fix fuzzyqueri 's default fast work lot fuzzyqueri need rocket scientist ensur good result main problem default distanc 0.5f n't take account length string add insult injuri default number expans 1024 tradit booleanqueri maxclausecount propos syntax fuzzyqueri enhanc specifi raw edit foobar~2 term within 2 levenshtein edit foobar previous specifi amount =1 got illegalargumentexcept wo n't break anyon still use foobar~0.5 work default minimumsimilar becom levenshteinautomata.maximum_supported_dist 2 way foobar~ alway fast size prioriti queue reduc default 1024 much reason valu 50 fuzzylikethi use think best chang default queri sinc awe add note migrate.txt care use old valu provid explicit get result
offset gap ad regardless exist token docinverterperfield problem multivalu field contain stop word e.g follow sampl valu analyz stopanalyz index offset subsequ token correct code title=index multivalu field doc.add new field f mike store.y index.analyz termvector.with_offset doc.add new field f store.y index.analyz termvector.with_offset doc.add new field f use store.y index.analyz termvector.with_offset doc.add new field f lucen store.y index.analyz termvector.with_offset code program soon attach use whitespaceanalyz ll get offset start end use lucen use 10,13 lucen 14,20 use stopanalyz offset use 9,12 lucen 13,19 search sinc searcher know analyz use index time problem caus align fvh caus problem stopanalyz filter anytoken flag set fals offset gap ad docinverterperfield code title=docinverterperfield.java anytoken fieldstate.offset += docstate.analyzer.getoffsetgap field code n't understand condit alway gap ad think thing simpl
numericrangequery.numericrangetermsenum sometim seek backward subclass filteredtermsenum suppos seek forward give better perform typic howev n't check ad assert dig test simpletext codec numericrangequeri trip assert mtqs seem trip think know 's happen say nrq term rang a-c e-f seek 's .next ing first rang first term c f. point nrq see rang a-c done tri seek term e f. mayb nrq 's accept method detect case ve accident .next 'd possibl beyond next one seek rang
allow automatontermsenum work full byte rang automatontermsenum realli agnost what byte binari order want use non-utf8 term that fine patch code cleanup remov utf8 refer etc addit chang pkg-privat lucene-intern byte-ori ctor public lucene.experiment
add sort miss first/last abil sortfield valuecompar sortfield valuecompar use entrycr lucene-2649 use special sort valu field miss enabl lucen implement sort miss last sort miss first numer valu fieldcach
speed automaton seek nextstr test found queri e.g wildcard quit lot backtrack nextstr n't handl particular well walk dfa hit dead-end need backtrack increment byte start complet altern could save path inform int backtrack could return posit restart instead boolean
improv mtqs interact term dict cach small improv add termsenum.cachecurrentterm hint codec make no-op remov fte.usetermscach chang mtq 's termcollector api accept termsenum collector eg call .docfreq direct add expert ctor termqueri allow pass docfreq
add support 3.0 index 2.9 branch lot user request abl read lucen 3.0 index also 2.9 would make migrat easier problem new store field version lucen 3.0 use mark segment 's store field file longer contain compress field index format realli chang patch simpli allow fieldsread pass lucen 3.0 version number still write segment 2.9 format could sudden turn compress ad document ad zip file 3.0 index testbackward without patch pass fieldsread complain incorrect version number although could read file easili would releas mayb 2.9.4 releas lucen includ patch
testindexwrit fail simpletextcodec ran failur sinc simpletext obvious take lot disk space though noformat junit testsuit org.apache.lucene.index.testindexwrit junit testcas testcommitonclosediskusag org.apache.lucene.index.testindexwrit fail junit writer use much space ad document mid=608162 start=5293 end=634214 junit junit.framework.assertionfailederror writer use much space ad document mid=608162 start=5293 end=634214 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:795 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:768 junit org.apache.lucene.index.testindexwriter.testcommitonclosediskusag testindexwriter.java:1047 junit junit junit test run 1 failur 1 error 0 time elaps 3.281 sec junit junit standard output junit note reproduc ant test -dtestcase=testindexwrit -dtestmethod=testcommitonclosediskusag -dtests.seed=-7526585723238322940 -1609544650150801239 junit note test param codec=simpletext locale=th_th timezone=uct junit junit test org.apache.lucene.index.testindexwrit fail noformat look simpletext guess need either chang threshold test exclud simpletext idea
test fail run tests.it 1 testmultilevelskiplist testsfieldread fall run -dtests.it 1 valu reset though attach patch second
testcachingspanfilt sometim fail run noformat ant test -dtestcase=testcachingspanfilt -dtestmethod=testenforcedelet -dtests.seed=5015158121350221714 -3342860915127740146 -dtests.iter=100 noformat get two failur machin current trunk noformat junit-sequenti junit testsuit org.apache.lucene.search.testcachingspanfilt junit testcas testenforcedelet org.apache.lucene.search.testcachingspanfilt fail junit expect 2 3 junit junit.framework.assertionfailederror expect 2 3 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:795 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:768 junit org.apache.lucene.search.testcachingspanfilter.testenforcedelet testcachingspanfilter.java:101 junit junit junit testcas testenforcedelet org.apache.lucene.search.testcachingspanfilt fail junit expect 2 3 junit junit.framework.assertionfailederror expect 2 3 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:795 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:768 junit org.apache.lucene.search.testcachingspanfilter.testenforcedelet testcachingspanfilter.java:101 junit junit junit test run 100 failur 2 error 0 time elaps 2.297 sec junit junit standard output junit note reproduc ant test -dtestcase=testcachingspanfilt -dtestmethod=testenforcedelet -dtests.seed=5015158121350221714 -3342860915127740146 junit note reproduc ant test -dtestcase=testcachingspanfilt -dtestmethod=testenforcedelet -dtests.seed=5015158121350221714 -3342860915127740146 junit note test param codec=mockvariableintblock baseblocksize=43 locale=fr timezone=africa/bangui junit junit test org.apache.lucene.search.testcachingspanfilt fail noformat sure seem like weakref gc issu cach
improv indexwrit flush delet exist segment indexwrit buffer delet term queri appli 1 commit nrt getread call 2 merg kickoff larg index 's cost open segmentread everi segment index defer long merg merg elimin delet doc merg small yet big index appli delet segment realli wast instead appli buffer delet segment merg keep buffer around remain segment think 's hard 'd generat pend delet newli merg segment n't need buffer delet appli everi time merg kick pinch current set buffer delet open new set next generat record segment creat generat sizabl gain larg indic mix delet though less flex sinc open term index much faster
fix generic violat contrib/modul generic violat fix
creat test case verifi support 2.1b term creat test case 'm leav ignor take four hour faaast machin beast run think run releas
upgrad icu librari 4.4.2 modules/analysi use 4.4 solr/contrib/extract use 4.2.1 think keep version consist go 4.4.2 sinc bugfix
remov priority-queu size trap multitermquery.toptermsbooleanqueryrewrit api new 3.x backwards-compat issu 3.1 fuzzyqueri intern rewrit method expos 3.x toptermsbooleanqueryrewrit subclass score boost-on variant problem pq default larg size integer.max_valu cours later limit valu booleanqueri 's maxclausecount think trap instead better simpli remov default forc user provid default reason size
nativefslockfactori throw except android 2.2 platform java.lang.manag packag avail android nativefslockfactori throw except android 2.2 platform java.lang.manag packag avail android look like fsdirectori default nativefslockfactori class refer java.lang.manag packag generat uniqu lock java.lang.manag avail android 2.2 henc runtim except rais workaround use anoth custom lockfactori simplefslockfactori fix nativefslockfactroy help thank surind
remov nativefslockfactori 's attempt acquir test lock nativefslockfactori tri acquir test lock first time lock creat 's lf 's caus us hassl lucene-2421 lucene-2688 think remov caller .makelock presum immedi thereaft acquir lock point hit except acquiretestlock would ve hit
multitermqueri boolean rewrit per segment multitermqueri current rewrit fuzzyqueri use toptermsbooleanqueryrewrit auto constant rewrit method scoringbq rewrit method use multifield wrapper top-level reader ineffici patch chang rewrit mode rewrit per segment use addit datastructur hash sets/map exclud duplic term test current pass fuzzyqueri 's test depend minimum score handl term collect order.. robert fix fuzzyqueri issu patch start
consolid near real time reopen api semant consolid indexwriter.getread indexreader.reopen semant sinc peopl alreadi use ir.reopen method simpli add code ir.reopen indexwrit code initi could call iw.getread probabl switch use packag privat method share intern
posit check span queri ve creat bunch new spanqueri class allow one thing like check see spanqueri fall two posit general form spanfirstqueri ve also ad one includ match payload locat span match also match given payload latter one queri item w/ specif payload
add delet term queri need precis record byte use documentswrit 's add delet queri add delet term add number byte use regardless queri term alreadi exist respect map
mtq rewrit weight/scor init singl pass spinoff lucene-2690 see hack patch issu fix mtq rewrit per-seg take make weight/scor init also run singl pass rewrit
disjunctionmaxscor alloc 2 array per score doc noformat overrid public float score throw ioexcept int doc subscor 0 .docid float sum subscor 0 .score max sum 0 int size numscor scoreal 1 size doc sum max scoreal 2 size doc sum max return max 0 sum 0 max 0 tiebreakermultipli noformat thread-priv array possibly/lik jvm optim case alloc stack still think instead privat instanc var score/max
testindexwriterdelet make broken segment payload could simpletext problem case grant ad payload mockanalyz lucene-2692 wonder would happen turn payload filter default test noformat junit testsuit org.apache.lucene.index.testindexwriterdelet junit testcas testdeletesondiskful org.apache.lucene.index.testindexwriterdelet caus error junit checkindex fail junit java.lang.runtimeexcept checkindex fail junit org.apache.lucene.util._testutil.checkindex _testutil.java:80 junit org.apache.lucene.index.testindexwriterdelete.dotestoperationsondiskful testindexwriterdelete.java:5 38 junit org.apache.lucene.index.testindexwriterdelete.testdeletesondiskful testindexwriterdelete.java:401 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:795 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:768 junit junit junit testcas testupdatesondiskful org.apache.lucene.index.testindexwriterdelet caus error junit checkindex fail junit java.lang.runtimeexcept checkindex fail junit org.apache.lucene.util._testutil.checkindex _testutil.java:80 junit org.apache.lucene.index.testindexwriterdelete.dotestoperationsondiskful testindexwriterdelete.java:5 38 junit org.apache.lucene.index.testindexwriterdelete.testupdatesondiskful testindexwriterdelete.java:405 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:795 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:768 junit junit junit test run 14 failur 0 error 2 time elaps 0.322 sec junit junit standard output junit checkindex fail junit segment file=segments_2 numsegments=1 version=format_4_0 lucen 4.0 junit 1 1 name=_0 doccount=157 junit codec=mockfixedintblock junit compound=tru junit hasprox=tru junit numfiles=2 junit size mb =0,017 junit diagnost os.version=6.0 os=window vista lucene.version=4.0-snapshot source=flush os.arch=x86 java.version=1.6.0_21 java.vendor=sun microsystem inc. junit delet delfilename=_0_1.del junit test open reader ok 13 delet doc junit test field ..ok 2 field junit test field norm ok 2 field junit test term freq prox error read past eof junit java.io.ioexcept read past eof junit org.apache.lucene.store.bufferedindexinput.refil bufferedindexinput.java:154 junit org.apache.lucene.store.bufferedindexinput.readbyt bufferedindexinput.java:119 junit org.apache.lucene.store.bufferedindexinput.readbyt bufferedindexinput.java:94 junit org.apache.lucene.index.codecs.sep.seppostingsreaderimpl sepdocsandpositionsenum.getpayload seppostin gsreaderimpl.java:689 junit org.apache.lucene.index.checkindex.testtermindex checkindex.java:693 junit org.apache.lucene.index.checkindex.checkindex checkindex.java:489 junit org.apache.lucene.index.checkindex.checkindex checkindex.java:290 junit org.apache.lucene.index.checkindex.checkindex checkindex.java:286 junit org.apache.lucene.util._testutil.checkindex _testutil.java:76 junit org.apache.lucene.index.testindexwriterdelete.dotestoperationsondiskful testindexwriterdelete.java:5 38 junit org.apache.lucene.index.testindexwriterdelete.testdeletesondiskful testindexwriterdelete.java:401 junit sun.reflect.nativemethodaccessorimpl.invoke0 nativ method junit sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:39 junit sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:25 junit java.lang.reflect.method.invok method.java:597 junit org.junit.runners.model.frameworkmethod 1.runreflectivecal frameworkmethod.java:44 junit org.junit.internal.runners.model.reflectivecallable.run reflectivecallable.java:15 junit org.junit.runners.model.frameworkmethod.invokeexplos frameworkmethod.java:41 junit org.junit.internal.runners.statements.invokemethod.evalu invokemethod.java:20 junit org.junit.rules.testwatchman 1.evalu testwatchman.java:48 junit org.junit.internal.runners.statements.runbefores.evalu runbefores.java:28 junit org.junit.internal.runners.statements.runafters.evalu runafters.java:31 junit org.junit.runners.blockjunit4classrunner.runchild blockjunit4classrunner.java:76 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:795 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:768 junit org.junit.runners.parentrunn 3.run parentrunner.java:193 junit org.junit.runners.parentrunn 1.schedul parentrunner.java:52 junit org.junit.runners.parentrunner.runchildren parentrunner.java:191 junit org.junit.runners.parentrunner.access 000 parentrunner.java:42 junit org.junit.runners.parentrunn 2.evalu parentrunner.java:184 junit org.junit.internal.runners.statements.runbefores.evalu runbefores.java:28 junit org.junit.internal.runners.statements.runafters.evalu runafters.java:31 junit org.junit.runners.parentrunner.run parentrunner.java:236 junit junit.framework.junit4testadapter.run junit4testadapter.java:39 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.run junittestrunner.java:420 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.launch junittestrunner.java:911 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.main junittestrunner.java:743 junit test store field .ok 223 total field count avg 1,549 field per doc junit test term vector ..ok 242 total vector count avg 1,681 term/freq vector field per doc junit fail junit warn fixindex would remov refer segment full except junit java.lang.runtimeexcept term index test fail junit org.apache.lucene.index.checkindex.checkindex checkindex.java:502 junit org.apache.lucene.index.checkindex.checkindex checkindex.java:290 junit org.apache.lucene.index.checkindex.checkindex checkindex.java:286 junit org.apache.lucene.util._testutil.checkindex _testutil.java:76 junit org.apache.lucene.index.testindexwriterdelete.dotestoperationsondiskful testindexwriterdelete.java:5 38 junit org.apache.lucene.index.testindexwriterdelete.testdeletesondiskful testindexwriterdelete.java:401 junit sun.reflect.nativemethodaccessorimpl.invoke0 nativ method junit sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:39 junit sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:25 junit java.lang.reflect.method.invok method.java:597 junit org.junit.runners.model.frameworkmethod 1.runreflectivecal frameworkmethod.java:44 junit org.junit.internal.runners.model.reflectivecallable.run reflectivecallable.java:15 junit org.junit.runners.model.frameworkmethod.invokeexplos frameworkmethod.java:41 junit org.junit.internal.runners.statements.invokemethod.evalu invokemethod.java:20 junit org.junit.rules.testwatchman 1.evalu testwatchman.java:48 junit org.junit.internal.runners.statements.runbefores.evalu runbefores.java:28 junit org.junit.internal.runners.statements.runafters.evalu runafters.java:31 junit org.junit.runners.blockjunit4classrunner.runchild blockjunit4classrunner.java:76 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:795 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:768 junit org.junit.runners.parentrunn 3.run parentrunner.java:193 junit org.junit.runners.parentrunn 1.schedul parentrunner.java:52 junit org.junit.runners.parentrunner.runchildren parentrunner.java:191 junit org.junit.runners.parentrunner.access 000 parentrunner.java:42 junit org.junit.runners.parentrunn 2.evalu parentrunner.java:184 junit org.junit.internal.runners.statements.runbefores.evalu runbefores.java:28 junit org.junit.internal.runners.statements.runafters.evalu runafters.java:31 junit org.junit.runners.parentrunner.run parentrunner.java:236 junit junit.framework.junit4testadapter.run junit4testadapter.java:39 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.run junittestrunner.java:420 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.launch junittestrunner.java:911 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.main junittestrunner.java:743 junit junit warn 1 broken segment contain 144 document detect junit junit note reproduc ant test -dtestcase=testindexwriterdelet -dtestmethod=testdeletesondiskful -dtests. eed=-8128829179004133416 -7192468460505114475 junit checkindex fail junit segment file=segments_1 numsegments=1 version=format_4_0 lucen 4.0 junit 1 1 name=_0 doccount=157 junit codec=mockfixedintblock junit compound=fals junit hasprox=tru junit numfiles=14 junit size mb =0,017 junit diagnost os.version=6.0 os=window vista lucene.version=4.0-snapshot source=flush os.arch=x86 java.version=1.6.0_21 java.vendor=sun microsystem inc. junit delet junit test open reader ok junit test field ..ok 2 field junit test field norm ok 2 field junit test term freq prox error read past eof junit java.io.ioexcept read past eof junit org.apache.lucene.store.raminputstream.switchcurrentbuff raminputstream.java:89 junit org.apache.lucene.store.raminputstream.readbyt raminputstream.java:73 junit org.apache.lucene.store.mockindexinputwrapper.readbyt mockindexinputwrapper.java:109 junit org.apache.lucene.index.codecs.sep.seppostingsreaderimpl sepdocsandpositionsenum.getpayload seppostin gsreaderimpl.java:689 junit org.apache.lucene.index.checkindex.testtermindex checkindex.java:693 junit org.apache.lucene.index.checkindex.checkindex checkindex.java:489 junit org.apache.lucene.index.checkindex.checkindex checkindex.java:290 junit org.apache.lucene.index.checkindex.checkindex checkindex.java:286 junit org.apache.lucene.util._testutil.checkindex _testutil.java:76 junit org.apache.lucene.index.testindexwriterdelete.dotestoperationsondiskful testindexwriterdelete.java:5 38 junit org.apache.lucene.index.testindexwriterdelete.testupdatesondiskful testindexwriterdelete.java:405 junit sun.reflect.nativemethodaccessorimpl.invoke0 nativ method junit sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:39 junit sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:25 junit java.lang.reflect.method.invok method.java:597 junit org.junit.runners.model.frameworkmethod 1.runreflectivecal frameworkmethod.java:44 junit org.junit.internal.runners.model.reflectivecallable.run reflectivecallable.java:15 junit org.junit.runners.model.frameworkmethod.invokeexplos frameworkmethod.java:41 junit org.junit.internal.runners.statements.invokemethod.evalu invokemethod.java:20 junit org.junit.rules.testwatchman 1.evalu testwatchman.java:48 junit org.junit.internal.runners.statements.runbefores.evalu runbefores.java:28 junit org.junit.internal.runners.statements.runafters.evalu runafters.java:31 junit org.junit.runners.blockjunit4classrunner.runchild blockjunit4classrunner.java:76 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:795 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:768 junit org.junit.runners.parentrunn 3.run parentrunner.java:193 junit org.junit.runners.parentrunn 1.schedul parentrunner.java:52 junit org.junit.runners.parentrunner.runchildren parentrunner.java:191 junit org.junit.runners.parentrunner.access 000 parentrunner.java:42 junit org.junit.runners.parentrunn 2.evalu parentrunner.java:184 junit org.junit.internal.runners.statements.runbefores.evalu runbefores.java:28 junit org.junit.internal.runners.statements.runafters.evalu runafters.java:31 junit org.junit.runners.parentrunner.run parentrunner.java:236 junit junit.framework.junit4testadapter.run junit4testadapter.java:39 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.run junittestrunner.java:420 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.launch junittestrunner.java:911 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.main junittestrunner.java:743 junit test store field .ok 237 total field count avg 1,51 field per doc junit test term vector ..ok 254 total vector count avg 1,618 term/freq vector field per doc junit fail junit warn fixindex would remov refer segment full except junit java.lang.runtimeexcept term index test fail junit org.apache.lucene.index.checkindex.checkindex checkindex.java:502 junit org.apache.lucene.index.checkindex.checkindex checkindex.java:290 junit org.apache.lucene.index.checkindex.checkindex checkindex.java:286 junit org.apache.lucene.util._testutil.checkindex _testutil.java:76 junit org.apache.lucene.index.testindexwriterdelete.dotestoperationsondiskful testindexwriterdelete.java:5 38 junit org.apache.lucene.index.testindexwriterdelete.testupdatesondiskful testindexwriterdelete.java:405 junit sun.reflect.nativemethodaccessorimpl.invoke0 nativ method junit sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:39 junit sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:25 junit java.lang.reflect.method.invok method.java:597 junit org.junit.runners.model.frameworkmethod 1.runreflectivecal frameworkmethod.java:44 junit org.junit.internal.runners.model.reflectivecallable.run reflectivecallable.java:15 junit org.junit.runners.model.frameworkmethod.invokeexplos frameworkmethod.java:41 junit org.junit.internal.runners.statements.invokemethod.evalu invokemethod.java:20 junit org.junit.rules.testwatchman 1.evalu testwatchman.java:48 junit org.junit.internal.runners.statements.runbefores.evalu runbefores.java:28 junit org.junit.internal.runners.statements.runafters.evalu runafters.java:31 junit org.junit.runners.blockjunit4classrunner.runchild blockjunit4classrunner.java:76 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:795 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:768 junit org.junit.runners.parentrunn 3.run parentrunner.java:193 junit org.junit.runners.parentrunn 1.schedul parentrunner.java:52 junit org.junit.runners.parentrunner.runchildren parentrunner.java:191 junit org.junit.runners.parentrunner.access 000 parentrunner.java:42 junit org.junit.runners.parentrunn 2.evalu parentrunner.java:184 junit org.junit.internal.runners.statements.runbefores.evalu runbefores.java:28 junit org.junit.internal.runners.statements.runafters.evalu runafters.java:31 junit org.junit.runners.parentrunner.run parentrunner.java:236 junit junit.framework.junit4testadapter.run junit4testadapter.java:39 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.run junittestrunner.java:420 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.launch junittestrunner.java:911 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.main junittestrunner.java:743 junit junit warn 1 broken segment contain 157 document detect junit junit note reproduc ant test -dtestcase=testindexwriterdelet -dtestmethod=testupdatesondiskful -dtests. eed=-8128829179004133416 -5617162412680232634 junit note test param codec=mockfixedintblock blocksize=266 locale=tr_tr timezone=africa/maseru junit junit test org.apache.lucene.index.testindexwriterdelet fail junit testsuit org.apache.lucene.index.testlazyproxskip junit test run 2 failur 0 error 0 time elaps 0.034 sec junit junit standard output junit note reproduc ant test -dtestcase=testlazyproxskip -dtestmethod=testlazyskip -dtests.seed=-7 119541877291237950 -8499388603775233752 junit note test param codec=simpletext locale=da_dk timezone=pacific/guam junit noformat
updat standardtoken uax29token unicod 6.0.0 newli releas unicod 6.0.0 contain charact properti chang previous releas 5.2.0 affect word segment uax 29 jflex 1.5.0-snapshot support unicod 6.0.0 lucen 's uax 29-base token updat accord note uax 29 word break rule chang unicod version 5.2.0 6.0.0
expos docvalu via field docvalu reader current expos access direct via indexread integr new featur nativ way expos docvalu via field perseg level multifield multi reader case docvalu side side fields.term enabl access sourc sortedsourc valuesenum someth like code public abstract class field public docvalu valu public abstract class docvalu disk enum base api public abstract valuesenum getenum throw ioexcept memori random access api enum support first call load valu ram*/ public abstract sourc getsourc throw ioexcept sort memori random access api option oper public sortedsourc getsortedsourc compar bytesref compar throw ioexcept unsupportedoperationexcept unload previous load sourc keep doc valu open public abstract unload close doc valu public abstract close code
factor maxmerges findmergesforoptim logmergepolici logmergepolici allow specifi maxmerges mb taken consider regular merg yet ignor findmergesforoptimz think 'd good take consider even optim allow caller specifi two constraint maxnumseg maxmergemb obvious may satisfi therefor guarante segment threshold threshold constraint take preced therefor may end w/ maxnumseg 's 1 optim otherwis maxnumseg taken consider part chang plan chang method protect privat member well realiz one wish implement lmp extens need either put o.a.l.index copi code impl ll attach patch short
bytesrefhash get expect bytesref instanc consist bytesrefhash get use provid bytesref instanc instead intern use scratch api current work consist
multitermqueri score differ 3x trunk tri patch test appli clean 3x trunk fail trunk modifi test-data-gener use topterms*boostonly* rewrit act like testfuzzyquery2 pass problem toptermsscoringbooleanrewrit booleanqueri somewher els
testindexwriter.testoptimizetempspaceusag fail w/ simpletext codec noformat junit testsuit org.apache.lucene.index.testindexwrit junit testcas testoptimizetempspaceusag org.apache.lucene.index.testindexwrit fail junit optim use much temporari space start usag 117867 byte max temp usag 363474 353601 3x start usag junit junit.framework.assertionfailederror optim use much temporari space start usag 117867 byte max temp usag 363474 353601 3x start usag junit org.apache.lucene.index.testindexwriter.testoptimizetempspaceusag testindexwriter.java:662 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:795 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:768 junit junit junit test run 1 failur 1 error 0 time elaps 5.284 sec junit junit standard output junit note reproduc ant test -dtestcase=testindexwrit -dtestmethod=testoptimizetempspaceusag -dtests.seed=-3299990090561349208:2824386407253661541 junit note test param codec=simpletext locale=el_gr timezone=africa/dar_es_salaam noformat 's simpletext -dtests.codec=simpletext alon sometim pass must someth els riwc set
testthreadsafety.testlazyloadthreadsafeti test failur testthreadsafety.testlazyloadthreadsafeti fail error unabl creat new nativ thread mayb simpletext stacktrac noformat junit testsuit org.apache.lucene.search.testthreadsaf junit testcas testlazyloadthreadsafeti org.apache.lucene.search.testthreadsaf caus error junit unabl creat new nativ thread junit java.lang.outofmemoryerror unabl creat new nativ thread junit java.lang.thread.start0 nativ method junit java.lang.thread.start thread.java:614 junit org.apache.lucene.search.testthreadsafe.dotest testthreadsafe.java:129 junit org.apache.lucene.search.testthreadsafe.testlazyloadthreadsafeti testthreadsafe.java:148 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:795 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:768 junit junit junit test run 1 failur 0 error 1 time elaps 6.051 sec junit junit standard output junit note reproduc ant test -dtestcase=testthreadsaf -dtestmethod=testlazyloadthreadsafeti -dtests.seed=-277698010445513699 -89599297372877779 junit note test param codec=simpletext locale=zh_sg timezone=pacific/tongatapu junit junit test org.apache.lucene.search.testthreadsaf fail noformat
test assum fail display inform current test use assume.assumetru silent pass think output someth *least* verbos set mayb alway 's exampl output might look like noformat junit-sequenti junit testsuit org.apache.solr.servlet.solrrequestparsertest junit test run 4 failur 0 error 0 time elaps 1.582 sec junit junit standard error junit note teststreamurl assum fail ignor junit org.junit.internal.assumptionviolatedexcept got java.io.filenotfoundexcept http //www.apdfgdfgach .org/dist/lucene/solr/ expect null junit org.junit.assume.assumethat assume.java:70 junit org.junit.assume.assumenoexcept assume.java:92 junit org.apache.solr.servlet.solrrequestparsertest.teststreamurl solrrequestparsertest.java:123 junit sun.reflect.nativemethodaccessorimpl.invoke0 nativ method junit sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:39 junit sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:25 junit java.lang.reflect.method.invok method.java:597 junit org.junit.runners.model.frameworkmethod 1.runreflectivecal frameworkmethod.java:44 junit org.junit.internal.runners.model.reflectivecallable.run reflectivecallable.java:15 junit org.junit.runners.model.frameworkmethod.invokeexplos frameworkmethod.java:41 junit org.junit.internal.runners.statements.invokemethod.evalu invokemethod.java:20 junit org.junit.rules.testwatchman 1.evalu testwatchman.java:48 junit org.junit.internal.runners.statements.runbefores.evalu runbefores.java:28 junit org.junit.internal.runners.statements.runafters.evalu runafters.java:31 junit org.junit.runners.blockjunit4classrunner.runchild blockjunit4classrunner.java:76 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:802 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:775 junit org.junit.runners.parentrunn 3.run parentrunner.java:193 junit org.junit.runners.parentrunn 1.schedul parentrunner.java:52 junit org.junit.runners.parentrunner.runchildren parentrunner.java:191 junit org.junit.runners.parentrunner.access 000 parentrunner.java:42 junit org.junit.runners.parentrunn 2.evalu parentrunner.java:184 junit org.junit.internal.runners.statements.runbefores.evalu runbefores.java:28 junit org.junit.internal.runners.statements.runafters.evalu runafters.java:31 junit org.junit.runners.parentrunner.run parentrunner.java:236 junit junit.framework.junit4testadapter.run junit4testadapter.java:39 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.run junittestrunner.java:420 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.launch junittestrunner.java:911 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.main junittestrunner.java:768 junit caus java.io.filenotfoundexcept http //www.apdfgdfgache.org/dist/lucene/solr/ junit sun.net.www.protocol.http.httpurlconnection.getinputstream httpurlconnection.java:1311 junit org.apache.solr.servlet.solrrequestparsertest.teststreamurl solrrequestparsertest.java:120 junit 26 junit noformat
test method ignor print notic current silent pass usual reason ignor sometim good sometim realli todo fix opinion add reason current ignor like mike test2bterm exampl output noformat junit testsuit org.apache.lucene.index.test2bterm junit test run 0 failur 0 error 0 time elaps 0.184 sec junit junit standard error junit note ignor test method test2bterm take ~4 hour run fast machin requir n't use preflex codec junit junit testsuit org.apache.solr.handler.dataimport.testmailentityprocessor junit test run 0 failur 0 error 0 time elaps 0.043 sec junit junit standard error junit note ignor test method testconnect junit note ignor test method testrecurs junit note ignor test method testexclud junit note ignor test method testinclud junit note ignor test method testincludeandexclud junit note ignor test method testfetchtimesinc junit noformat
reproduc test failur n't right manual overrid anyth run test eg -dtests.codec=simpletext fail reproduc fail includ manual overrid -dtests.codec=simpletext ie includ seed test class test method wo n't actual reproduc fail general need fix reproduc add manual overrid
booleanscorer.nextdoc also deleg sub-scor 's bulk score method booleanscor use bulk score method sub scorer ask score chunk 2048 doc howev .nextdoc fail instead manual walk sub 's doc call .nextdoc slower though 'd tini practic far tell deleg bulk scorer like bulk scorer method
fieldboostmapattribut contrib/qp broken look suppresswarn lucen came across two contrib/querypars even wors found revolv around use map charsequ key javadoc charsequ interfac refin general contract equal hashcod method result compar two object implement charsequ therefor general undefin object may implement differ class guarante class capabl test instanc equal color red therefor inappropri use arbitrari charsequ instanc element set key map color
optim fuzzytermsenum per-seg make fuzzyqueri 3 faster creat dfa segment creat dfas still somewhat heavi address easi
improv automaton 's minimizeoperations.minimizehopcroft creat mani object minimizeoperations.minimizehopcroft creat lot object strang array useless arraylist fix length e.g creat list list list patch minim make whole method much gc friendler use simpl array avoid empti linkedlist insid revers array minim call often especi test mockanalyz test method prepar robert found bug somewher els automaton pend issu fix arriv
basicoperations.concaten creat invari start write test lucene-2716 found problem basicoperations.concaten automaton automaton creat automata invari represent never happen unless manipul states/transit manual strang enough basicoperations.concaten list automaton problem
separ java code .jj file would make develop easier move java code .jj file real java file
re-add sortertempl use provid fast arraysort replac bytesrefhash sort patch add back optim rewritten sortertempl back lucen remov releas 3.0 use sever compon automaton automaton need sort state thing use arrays.sort slow clone intern ensur stabl search compon much faster patch add arrays.sort replac arrayutil work natur order use compar choos quicksort mergesort bytesrefhash use anoth quicksort algorithm without insertionsort short ord array class use sortertempl provid insertionsort fallback eleg way ideal class use everywher sort algorithm need separ under data implement swap compar function get slot number instead real valu also appli solr yonik sortertempl provid quicksort mergesort algorithm intern short array automat choos insertionsort like jdk 's array quicksort algorith copi modifi old bytesrefhash new class share mergesort origin cglib sortertempl longer maintain
indexwrit throw indexformattoooldexc open later optimize/getreader/clos spinoff lucene-2618 also relat origin issu lucene-2523 open iw too-old index n't find much later index old iw go open segment reader segment 's time appli delet merg open nrt reader etc serious bug fact succeed commit new major version lucen too-old index catastroph sudden old lucen version longer open index index becom unus
random failur testsizeboundedoptim testfirstsegmenttoolarg see trunk noformat junit testsuit org.apache.lucene.index.testsizeboundedoptim junit testcas testfirstsegmenttoolarg org.apache.lucene.index.testsizeboundedoptim fail junit expect 2 1 junit junit.framework.assertionfailederror expect 2 1 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:882 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:848 junit org.apache.lucene.index.testsizeboundedoptimize.testfirstsegmenttoolarg testsizeboundedoptimize.java:160 junit junit junit test run 1 failur 1 error 0 time elaps 0.658 sec junit junit standard output junit note reproduc ant test -dtestcase=testsizeboundedoptim -dtestmethod=testfirstsegmenttoolarg -dtests.seed=7354441978302993522 -457602792543755447 -dtests.multiplier=3 junit note test param codec=standard locale=sv_s timezone=mexico/bajanort junit junit standard error junit note test run jvm junit testsizeboundedoptim junit junit test org.apache.lucene.index.testsizeboundedoptim fail noformat run seed ant test -dtestcase=testsizeboundedoptim -dtestmethod=testfirstsegmenttoolarg -dtests.seed=7354441978302993522 -457602792543755447 -dtests.multiplier=3
sep codec store less term dict 'm work improv lucen 's perform int block codec for/pfor earli perf test found codec caus big perf hit mtqs need scan mani term don't end accept mani term eg fuzzi wildcard regexp sep codec store much term dict sinc file separ ie seek point doc frq pos pyl skp file 'd like shift seek point instead store doc file except doc seek point sinc given queri alway need seek doc file add extra seek save ton vint decod next/sek intens mtqs
enwikicontentsourc proper identifi name/id wikipedia articl enwikicontentsourc proper identifi id name benchmark parlanc document current produc assign id last id tag see document oppos id document document multipl id tag prevent contentsourc use effect produc document updat exampl doc quot page titl algeria /titl id 5 /id revis id 133452200 /id timestamp 2007-05-25t17:11:48z /timestamp contributor usernam gurch /usernam id 241822 /id /contributor minor comment wp aes|a 86 90 redirect page algeria /comment text xml space= preserv redirect algeria r camelcas /text /revis /page quot case getnam return 241822 instead 5. page/id uniqu accord schema http //www.mediawiki.org/xml/export-0.3.xsd get one
intermitt deadlock testatomicupd testindexwriterexcept backport issu 2.9.x/3.0.x releas hit deadlock two test test-cor test-tag
hyphenationcompoundwordtokenfilt fail load dtd crimson parser jdk 1.4 hyphenationcompoundwordtokenfilt load dtd xml parser memori suppli entityresolv java 1.4 affect lucen 2.9 also later version apach xerc use xml parser work cromson even ask entiti resolv base uri known hyphen file load reader/inputstream base uri known crimson need least non-nul systemid proceed patch lucen 2.9 fake suppli fake systemid inputsourc
fix charset problem xml load hyphenationcompoundwordtokenfilt also solr 's loader schema said lucene-2731 handl xml hyphenationcompoundwordtokenfilt broken break xml 1.0 5th edit spec total never suppli reader xml api unless intern charact data e.g creat programmat also suppli system id resolv extern entiti work loader file much broken alway open file reader pass inputsourc instead point filenam direct inputsourc issu fix trunk use inputsourc solr still suppli reader possibl previous version deprec
add privat ctor static util class develop 3.x trunk ad new class like ioutil codecutil provid static method ctor add default empti public ctor wrong class never instanti add privat dummi ctor prevent creat instanc
use indexwriterconfig benchmark use indexwriterconfig instead deprec method benchmark
wrong implement docidsetiterator.adv implement docidsetiter behav differ advanc call take follow test openbitset docidbitset sortedvintlist sortedvintlist pass test code title=org.apache.lucene.search.testdocidset.java|borderstyle=solid public void testadvancewithopenbitset throw ioexcept docidset idset new openbitset new long 1121 1 bit 0 5 6 10 assertadv idset public void testadvancedocidbitset throw ioexcept bitset bitset new bitset bitset.set 0 bitset.set 5 bitset.set 6 bitset.set 10 docidset idset new docidbitset bitset assertadv idset public void testadvancewithsortedvintlist throw ioexcept docidset idset new sortedvintlist 0 5 6 10 assertadv idset privat void assertadv docidset idset throw ioexcept docidsetiter iter idset.iter int docid iter.nextdoc assertequ first doc id 0 0 docid docid iter.nextdoc assertequ second doc id 5 5 docid docid iter.adv 5 assertequ advanc iter return next doc id 6 docid code javadoc advanc say quot advanc first *beyond* current whose document number greater equal _target_ quot seem indic sortedvintlist behav correct wherea two n't look docidbitset implement advanc implement code bitset.nextsetbit target code doc nextsetbit say quot return index first bit set true occur *on after* specifi start index quot
codec consist pass intern api work solr-1942 ran coupl glitch codec consist pass segmentsinfo friend codec realli consist pass though fix piec lead error solr guess might other patch come
refactor testindexwrit testindexwrit get bit unwieldi 5,315 line code 116 test method runtim frequent 1 2 minut start pretti scari merg chang massiv lot test arguabl belong somewher els e.g addindex* test belong testaddindex start pull *ondiskful test testindexwriterondiskful pull multithread test testindexwriterwiththread
perfieldcodecwrapp caus crash per field code use perfieldcodecwrapp use segmentmerg tri merg two segment one segment subset field perfieldcodecwrapp defin segmentmerg tri open non-exist file sinc codec file directori segmentinfo set string blind copi expect file given set also hit except checkindex addindex reason perfieldcodecwrapp simpli iter codec know add file without check present given directori need mechnan check requir file codec present add file set field realli
sever codec use file perfieldcodecwrapp hold two codec use file current rather simpl file name scheme prevent us use one codec segment reli file instanc puls standard codec use togeth sinc need .frq .tii .tis etc make work either need write distinct per codec file set per field codec file id first solut seem quiet verbos second one seem flexibl one possibl would assign uniqu id segmentswritest open fieldsconsum write id segment file eventu load segment open otherwis perfieldcodec featur realli flexibl use though
enabl nativ per-field codec support current codec name store everi segment perfieldcodecwrapp use enabl codec per field recent brought issu lucene-2740 lucene-2741 codec name store lucen respect actual codec use encod field post rather top-level codec case name top-level codec perfield instead puls standard etc way composit pattern work make index part codec simpler also limit capabl recod top-level codec segment file reli user configur perfieldcodecwrapp correct open segmentread field codec chang meanwhil wo n't abl open segment issu lucene-2741 lucene-2740 actual close relat way pfcw implement right pfcw blind creat codec per field request time n't control file name two codec instanc creat two distinct field even codec instanc fieldsconsum throw except sinc file reli alreadi creat perfieldcodecwrapp codecprovid overcompl thing imo order use per field codec user one hand regist custom codec need build pfcw need maintain user-land must chang incompat new iw ir creat would expect lucen enabl regist codec provid tell field codec use index read lucen determ codec automat segment open codec avail provid differ stori instanti composit codec segmentsread codec realli use segment free turn solv lucene-2740 yet instead reli user configur pfcw suggest move composit codec function insid core record distinct codec per segment segment info realli need distinct codec use segment sinc codec instanc reus prevent addit file creat let say follw codec map noformat field_a puls field_b standard field_c puls noformat creat follow map noformat segmentinfo puls standard perfield field_a:0 field_b:1 field_c:0 noformat way easili determ codec use field build composit codec intern open segmentsread order anoth advantag like case puls standard use realli type file need way distinguish use file per codec within segment turn pass codec 's ord implicit segmentinfo fieldconsum creation creat file segmentname_ord.ext someth similar solvel lucene-2741
simpletext slow unlucki enough get simpletext codec testbas span queri test run slowli
checkindex overst mani field norm enabl simpli tell mani uniqu field instead say mani norm
deprecate/remov language-specif token favor standardtoken lucen 3.1 standardtoken implement uax 29 word boundari rule provid language-neutr token lucen contain sever language-specif token replac uax 29-base standardtoken deprec 3.1 remov 4.0 language-specif *analyzers* contrast remain contain language-specif post-token filter language-specif analyz switch standardtoken 3.1 usag language-specif token need addit work beyond replac token language-specif analyz exampl persiananalyz current use arabiclettertoken depend fact token break token zwnj charact zero-width non-join u+200c uax 29 word boundari rule zwnj word boundari robert muir suggest use char filter convert zwnj space prior standardtoken convert persiananalyz
add lucenetestcase.newsearch test search packag n't care kind searcher use random use multisearch parallelmultisearch sometim test
indexreader.listcommit return list abstract collect spinoff http //www.mail-archive.com/dev lucene.apache.org/msg07509.html
add spanqueri support multitermqueri set fix version 4.0 possibl could 3.x current special spanregexqueri contrib issu like lucene-522 open spanfuzzyqueri spanregexqueri contrib littl messi addit arbitrari multitermqueri work spanqueri 3 requir un-rewritten queri must extend spanqueri includ span claus rewritten queri spanorqueri instead booleanqueri rewritten term claus spantermqueri instead logic like queri suggest ad two rewrit method scoringspanboolean rewrit toptermsspanboolean rewrit start wrote ad spanmultitermquerywrapp use wrap multitermqueri way kink think mtq policeman probabl help get
improv cms run optim larg index ve notic sever thing got read cms code care find issu cms may hold onto merg maxmergecount hit result mergethread take merg indexwrit exhaust block merg run think 's unnecessari merg block cms sort merg segment size doc-bas bytes-bas sinc default mp logbytesizemp hard believ peopl care doc-bas size segment anymor think switch default impl two way make extens want overrid member/method cms extend overrid easi onemerg compar let mp determin order e.g byte doc calibr delet etc. better need tap sever place code riski complic go 'd like add document cms 's easi read follow ll work patch
multisearcher.rewrit incorrect rewrit queri report userlist context rang queri also easi make exist test fail patch lucene-2751 noformat ant test-cor -dtestcase=testboolean2 -dtestmethod=testrandomqueri -dtests.seed=7679849347282878725 -903778383189134045 noformat fundament problem multisearch first rewrit individu sub use query.combin simpli 's sub-claus incorrect expand must_not queri e.g wildcard violat demorgan 's law
refactor rewritemethod multitermqueri policeman work usual
testperfieldcodecsupport intermitt fail noformat junit testsuit org.apache.lucene.index.testperfieldcodecsupport junit testcas testchangecodecandmerg org.apache.lucene.index.testperfieldcodecsupport fail junit expect 4 3 junit junit.framework.assertionfailederror expect 4 3 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:881 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:847 junit org.apache.lucene.index.testperfieldcodecsupport.asserthybridcodecperfield testperfieldcodecsupport.java:189 junit org.apache.lucene.index.testperfieldcodecsupport.testchangecodecandmerg testperfieldcodecsupport.java:145 junit junit junit test run 1 failur 1 error 0 time elaps 0.416 sec junit junit standard output junit note reproduc ant test -dtestcase=testperfieldcodecsupport -dtestmethod=testchangecodecandmerg -dtests.seed=1508266713336297966 -102145263724760840 junit note test param codec=simpletext locale=m timezone=america/winnipeg junit junit standard error junit note test run jvm junit testperfieldcodecsupport junit junit test org.apache.lucene.index.testperfieldcodecsupport fail noformat n't tri figur yet
never open indexinput indexoutput still open modifi mockdirwrapp assert except segments_n/segments.gen 's expect uncov coupl place involv nrt reader open share doc store file 's still open write first instal merg segment warmer fail forc merg doc store case thus potenti open doc store also still open write second re activ ad doc thread call iw.getread thread could sneak flush new segment share doc store return reader open doc store file still open write
optim spanfirstqueri spanpositionrangequeri spanfirstqueri spanpositionrangequeri spanfirst special case current ineffici take worst case exampl spanfirstqueri current code read posit term enumer span pass allow rang move next document skipto
special payload process docsandpositionsenum lucene-2760 start work tri improv speed spanqueri general trick avoid process posit dont improv queri read lot posit clean segmentdocsandpositionsenum nextposit less 3 payloads-rel check howev larg major users/field payload think special case separ implement speed common case edit dyslexia jira issu number
n't leak delet open file handl pool reader cfs enabl today pool enabl either direct ve pull nrt reader indexwrit hold open segmentread non-cf format merg segment even close nrt reader ve pull writer ll still see file handl open file delet count grow unbound sinc 's limit number segment index 's still serious problem sinc app turn cfs first place presum avoid risk too-many-open-fil 's also bad tie disk space sinc file would otherwis delet
swap url+email recogn standardtoken uax29token current addit implement uax 29 word boundari rule standardtoken recogn email adress url n't provid way turn behavior and/or provid overlap token compon usernam email address hostnam url etc. uax29token becom standardtoken current standardtoken renam someth like uax29tokenizerplusplus someth like rational see discuss reopen lucene-2167|http //issues.apache.org/jira/browse/lucene-2167 focusedcommentid=12929325 page=com.atlassian.jira.plugin.system.issuetabpanel 3acomment-tabpanel action_12929325
allow test use random codec per field sinc real per field codec support enabl run test random codec per field chang someth relat codec intern would like ensur whatev combin codec except preflex use code work fine creat randomcodecprovid lucenetestcas random select codec field see first time disabl test default leav old random codec support
miss sync indexwriter.addindex indexread 3.x build hit noformat junit testsuit org.apache.lucene.index.testaddindex junit testcas testaddindexeswiththread org.apache.lucene.index.testaddindex fail junit expect 3160 2701 junit junit.framework.assertionfailederror expect 3160 2701 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:779 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:745 junit org.apache.lucene.index.testaddindexes.testaddindexeswiththread testaddindexes.java:708 junit junit junit test run 15 failur 1 error 0 time elaps 9.28 sec junit junit standard output junit java.lang.assertionerror refcount 0 pre-decr file _8a.tvf junit org.apache.lucene.index.indexfiledelet refcount.decref indexfiledeleter.java:608 junit org.apache.lucene.index.indexfiledeleter.decref indexfiledeleter.java:505 junit org.apache.lucene.index.indexfiledeleter.decref indexfiledeleter.java:496 junit org.apache.lucene.index.indexwriter.addindex indexwriter.java:2972 junit org.apache.lucene.index.testaddindex commitandaddindexes.dobodi testaddindexes.java:681 junit org.apache.lucene.index.testaddindex runaddindexesthread 1.run testaddindexes.java:624 junit note reproduc ant test -dtestcase=testaddindex -dtestmethod=testaddindexeswiththread -dtests.seed=-6912763261803132408 -5575674032550262483 -dtests.multiplier=3 junit note test param locale=en_au timezone=america/atka noformat look like 's caus long-stand miss sync sinc least 2.9.x think like hit thank ad random thread.yield 's mockdirwrapp
add infrastructur longer run night test case 'm spin lucene-2762 patch add initi infrastructur test pull document line file add longish run test case use line file test nrt 'd like see test run substanti indic base real data start
filterindexread trunk implement getsequentialsubread correct sinc lucene-2459 getsequentialsubread filterindexread return null return atom reader call enum method throw except under reader atom move null-return method slowmultireaderwrapp fix filterindexread 's default return in.getsequentialsubread ideal implement must cours also wrap sub-read chang look impl like multipassindexsplitt need add atom
optim segmentmerg work atom segment reader possibl spin-off lucene-2769 current segmentmerg optim merg segment segmentread e.g normal index optim indexwriter.addindex indexread list indexread may realli per-seg segmentmerg track pass read lowest level segment reader atom reader like slowmultireaderwrapp merg remov multifield usag except term merg itsself clean code especi save lot memori merg norm longer duplic norm array creat multiread use
remov norm support non-atom indexread spin-off lucene-2769 current indexread support norm core lucen never use even danger memori usag like multifield factor throw uoe non-atom reader slowmultireaderwrapp manag norm also parallelread need fix
make slowmultireaderwrapp wrap alway close safe overhead wrap atom reader use slowmultireaderwrapp low work done static wrap method much higher instanti arraylist recus went subread check number reader simpli alway wrap multifield alreadi optim call one-seg atom reader overhead patch remov static wrap method simpli wrap like tokenfilt ctor new slowmultireaderwrapp reader done also risk close segmentread wrap return singl segmentread help parent issu clean case close patch a?lso remov useless mainreader/read variabl simpli close wrapper
n't creat compound file larg segment default spinoff lucene-2762 cfs use keep open file count cost ad time index build also tie temporari disk space caus eg larg spike final merg optim sinc mergepolici dictat segment cfs chang build cfs smallish merg think also set maxmergemb default larg merg n't done
ant generate-maven-artifact target broken contrib execut ant generate-maven-artifact pristin checkout branch_3x/lucen trunk/lucen follow error encount code dist-maven copi copi 1 file /home/drew/lucene/branch_3x/lucene/build/contrib/analyzers/common artifact install-provid instal provid org.apache.maven.wagon wagon-ssh jar:1.0-beta-2 runtim artifact pom error occur process maven artifact task artifact pom diagnosi artifact pom artifact pom unabl initi pom pom.xml.templ find parent org.apache.lucen lucene-contrib project org.apache.lucen lucene-analyz jar:3.1-snapshot project org.apache.lucen lucene-analyz jar:3.1-snapshot artifact pom unabl download artifact repositori code contrib portion ant build execut subant task pick pom definit lucene-par lucene-contrib main build.xml lucene-par lucene-controb pom must load specif part contrib build use artifact pom task
indexwrit creat unwant termvector info notic today build big index solr get unwant termvector info even though n't request happen 3x sure start happen trunk
revis pagedbyt fillusinglengthprefix* method name pagedbyt 3 differ variant fillusinglengthprefix need better name sinc csfbranch alreadi ad 4th one suggest code read length 1 2 byte vint prefix start start public bytesref filllengthandoffset bytesref b long start public bytesref fillusinglengthprefix bytesref b long start lucene.intern read length 1 2 byte vint prefix start start return block number term public int getblockandfil bytesref b long start public bytesref fillusinglengthprefix2 bytesref b long start lucene.intern read length 1 2 byte vint prefix start start return start offset next part suitabl start paramet next call sequenti read bytesref public long getnextoffsetandfil bytesref b long start public bytesref fillusinglengthprefix3 bytesref b long start code
allow easi extens ramdirectori ramdirectori use ramfil store data ramfil offer newbuff method extens overrid alloc buffer differ e.g pool someth howev ramdirectori alway alloc ramfil n't allow alloc ramfil extens make ramfile.newbuff unus think simpli introduc newramfil method ramdirectori make ramfil map protect allow realli extend ramdir post patch later
use concurrenthashmap ramdirectori ramdirectori synchron instanc mani place protect access map ramfil addit updat sizeinbyt member mani place sync done read purpos place need write access look like perfect use case concurrenthashmap also sync around sizeinbyt unnecessari imo sinc 's atomiclong ll post patch short
drop deprec trunk subj also remain deprec add releas version first appear patch incom
possibl rare thread hazard iw.commit see rare intermitt failur testindexwriter.testcommitthreadsafeti issu happen one thread call commit anoth flush exacerb high flush rate eg maxbuffereddocs=2 thread commit first flush sync file howev two thread manag add enough doc trigger anoth flush 2nd new segment sneak segmentinfo sync normal harmless mean commit includ doc ad thread 's fine mean commit segment refer still-open doc store file test catch chang mockdirwrapp throw except case testcommitthreadsafeti fail except hardwir maxbuffereddoc 2 happen quit often 's clear realli problem real app vs anal mockdirwrapp think fix
deadlock indexwrit autocommit true merg usual trigger commit commit preparecommit trigger merg vi flush method synchron mechan commit commitlock separ synchron mechan merg concurrentmergescheduler.wait one thread hold commitlock monitor anoth one hold concurrentmergeschedul monitor deadlock
chang filteredtermsenum impl termsenum decor current filteredtermsenum two ctor filteredtermsenum indexread reader string field filteredtermsenum termsenum tenum concret implement e.g termsrangeenum use indexreader+field ctor opinion remov ctor switch filteredtermsenum implement take termsenum advantag simplifi filteredtermsenum subclass decorator-lik perhap futur could compos remov silli check tenum null everi next allow consum pass enumer howev want e.g respons want use multifield shouldnt buri filteredtermsenum creat quick patch core+contrib+solr test pass think open possibl refactor improv n't yet done patch explor
topfieldcollector throw aioob numhit 0 see solr-us thread arrayindexoutofboundsexcept queri rows=0 sort param think creat null collector talli totalhit numhit 0
disabl atim directiolinuxdirectori linux 's open o_noatim sinc linux 2.6.8 updat file last access time st_atim inod file read 2 flag intend use index backup program use signific reduc amount disk activ flag may effect filesystem one exampl nfs server maintain access time linux-specif directiolinuxdirectori separ offtop would better linuxdirectori use o_direct would nice think option modules/n common platform similar tomcat provid easier test directori like -dtests.directori
indexwrit call mp.usecompoundfil logmp.getusecompoundfil spin http //www.gossamer-threads.com/lists/lucene/java-dev/112311 attach patch short address issu trunk
windowsdirectori use window overlap io pread avoid perform problem simplefs/niofsdir
add simpl fst impl lucen implement algo describ http //citeseerx.ist.psu.edu/viewdoc/summari doi=10.1.1.24.3698 increment build finit state transduc fst sort input fulli general fst impl 's abl build fst increment input/output pair pre-sort current input bytesref output pluggabl nooutput get simpl fsa positiveintoutput map long bytesequenceoutput map bytesref implement low memori overhead handl fair larg set term exampl build fsa 9.8m term 10m document wikipedia index ~8 second beast use ~256 mb peak ram result fsa 's ~60 mb pack fst as-it-build compact byte expos api read nodes/arc direct byte fst quick saved/load to/from directori sinc 's big byte format similar morfologik use http //sourceforge.net/projects/morfologik/ think number possibl place use lucen exampl think mani app could hold entir term dict ram either multi-read level mayb per-seg map file offset someth els custom app may possibl good speedup certain mtqs though format pack byte decod cost visit arc builder also prune goe get prefix trie prune accord mani term run node make faster even less memori consum may use replac current binari search term index sinc achiev higher term densiti ram consumpt current index initi usag make sure exercis cutov simpletext codec current fulli load term treemap caus intermitt oom test use fst instead simpletext use pairoutput abl pair two output sinc need map input term int docfreq long fileposit test pass w/ simpletext forc codec think committ except 'd love get help w/ generic confess policeman add suppresswarn uncheck ideal fst parameter output type integ bytesref etc. even ad new night test make largeish set random term test result fst differ output think would also easi make variant use char instead byte input could eg use analysi robert 's idea 's alreadi easi charsequ output type sinc output pluggabl dawid weiss author hppc http //labs.carrotsearch.com/hppc.html morfologik http //sourceforge.net/projects/morfologik/ help iter thank
directori createoutput openinput take iocontext today merg pass larger readbuffers search get better perform think general class iocontext would hold buffer size could hold flag like direct bypass os 's buffer cach sequenti etc make directiolinuxdirectori fulli usabl would use direct/sequenti merg requir fix iw pool reader reader open merg use search vice/versa realli 's open file handl need differ could theori share del doc norm etc somehow possibl
generic directiolinuxdir unixdir today directiolinuxdir tricky/danger use want use indexwrit indexread search 's trap lucene-2793 make fulli general purpos singl nativ dir impl use 'd also like make generic unic becom unixdirectori
test need clean havent run ant clean random generat temporarili file name pile run test mani time ant clean still run quit long time take logic base solr test case push lucenetestcas test clean temporari stuff
upgrad icu 4.6 version 4.6 support unicod 6 new collat search collat etc
directoryread ignor nrt segmentinfo isoptim directoryread take share iw segmentinfo account directoryread isoptim return true even actual realtim reader see one segment code public boolean isoptim ensureopen segmentsinfo chang iw return fals posit return segmentinfos.s 1 hasdelet code directoryread check reader non-nul segmentinfosstart use instead
fieldcach pay attent delet doc creat entri fieldcach use key ignor delet doc 's actual bug use delet doc creat entri lead incorrect valu entri use differ reader
check test use fsdirectory.open lucene-2471 discuss copybyt issu shai discuss could prevent bug futur one thing lead bug exist code long happen window e.g never fail hudson bug happen copi simplefsdirectori test use fsdirectory.open today situat improv test use newdirectori random default never use fsdir.open alway use simplef niof random seed reproduc across window unix think need review use fsdirectory.open test minim general test use newdirectori test come say zip-fil want explicit open stuff disk think open content say simplefsdir call newdirectori directori copi new random implement actual test method alreadi exist noformat return new dictionari instanc content copi provid directori see link newdirectori inform public static mockdirectorywrapp newdirectori directori d throw ioexcept noformat
segmentinfo n't blind increment version commit segmentinfo current increment version assumpt alway chang dirread iw care track whether chang dirread haschang iw changecount think class notifi sis fact chang fix case simon hit fix lucene-2082 nrt reader thought chang fact n't iw simpli commit exact sis alreadi
intermit failur docvalu branch late ran two random failur csf branch seem relat docvalu ca n't reproduc neither docvalu branch trunk code jerror messag indexfiledelet n't know file _1e.tvx stacktrac junit.framework.assertionfailederror indexfiledelet n't know file _1e.tvx org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:979 org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:917 org.apache.lucene.index.indexwriter.filesexist indexwriter.java:3633 org.apache.lucene.index.indexwriter.startcommit indexwriter.java:3699 org.apache.lucene.index.indexwriter.preparecommit indexwriter.java:2407 org.apache.lucene.index.indexwriter.commitintern indexwriter.java:2478 org.apache.lucene.index.indexwriter.commit indexwriter.java:2460 org.apache.lucene.index.indexwriter.commit indexwriter.java:2444 org.apache.lucene.index.testindexwriterexceptions.testrandomexceptionsthread testindexwriterexceptions.java:213 standard output note reproduc ant test -dtestcase=testindexwriterexcept -dtestmethod=testrandomexceptionsthread -dtests.seed=-6528669668419768890:4860241142852689334 -dtests.codec=randomperfield -dtests.multiplier=3 note test param codec=preflex locale=sv timezone=atlantic/south_georgia standard error note test run jvm testdemo testtoken testbinarydocu testcodec testdirectoryread testindexinput testindexwriterexcept code code junit testsuit org.apache.lucene.index.testindexreaderreopen junit testcas testthreadsafeti org.apache.lucene.index.testindexreaderreopen caus error junit mockdirectorywrapp close still open file _4_3.frq=1 _4_3.pos=1 _4_0.frq=1 _4_0.prx=1 _4.pst=1 _4_3.pyl=1 _4_3.skp=1 _4_0.tis=1 _4_3.doc=1 _4_3.tis=1 junit java.lang.runtimeexcept mockdirectorywrapp close still open file _4_3.frq=1 _4_3.pos=1 _4_0.frq=1 _4_0.prx=1 _4.pst=1 _4_3.pyl=1 _4_3.skp=1 _4_0.tis=1 _4_3.doc=1 _4_3.tis=1 junit org.apache.lucene.store.mockdirectorywrapper.clos mockdirectorywrapper.java:387 junit org.apache.lucene.index.testindexreaderreopen.testthreadsafeti testindexreaderreopen.java:859 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:979 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:917 junit caus java.lang.runtimeexcept unclos indexinput junit org.apache.lucene.store.mockdirectorywrapper.openinput mockdirectorywrapper.java:342 junit org.apache.lucene.store.directory.openinput directory.java:122 junit org.apache.lucene.index.codecs.standard.standardpostingsreader. init standardpostingsreader.java:49 junit org.apache.lucene.index.codecs.standard.standardcodec.fieldsproduc standardcodec.java:87 junit org.apache.lucene.index.perfieldcodecwrapp fieldsreader. init perfieldcodecwrapper.java:119 junit org.apache.lucene.index.perfieldcodecwrapper.fieldsproduc perfieldcodecwrapper.java:211 junit org.apache.lucene.index.segmentread corereaders. init segmentreader.java:137 junit org.apache.lucene.index.segmentreader.get segmentreader.java:532 junit org.apache.lucene.index.segmentreader.get segmentreader.java:509 junit org.apache.lucene.index.directoryreader. init directoryreader.java:238 junit org.apache.lucene.index.directoryreader.doreopen directoryreader.java:500 junit org.apache.lucene.index.directoryreader.access 000 directoryreader.java:48 junit org.apache.lucene.index.directoryread 2.dobodi directoryreader.java:493 junit org.apache.lucene.index.segmentinfo findsegmentsfile.run segmentinfos.java:623 junit org.apache.lucene.index.directoryreader.doreopennowrit directoryreader.java:488 junit org.apache.lucene.index.directoryreader.doreopen directoryreader.java:446 junit org.apache.lucene.index.directoryreader.reopen directoryreader.java:406 junit org.apache.lucene.index.testindexreaderreopen 9.run testindexreaderreopen.java:770 junit org.apache.lucene.index.testindexreaderreopen readerthread.run testindexreaderreopen.java:897 junit junit junit test run 17 failur 0 error 1 time elaps 13.766 sec junit junit standard output junit note reproduc ant test -dtestcase=testindexreaderreopen -dtestmethod=testthreadsafeti -dtests.seed=-5455993123574190959 -1935535300313439968 -dtests.codec=randomperfield -dtests.multiplier=3 junit note test param codec=randomcodecprovid field5=mockvariableintblock baseblocksize=29 id=standard fielda=standard field4=mockfixedintblock blocksize=924 field3=standard field2=simpletext id2=standard field6=mocksep field1=puls freqcutoff=8 locale=zh_cn timezone=asia/hovd code n't seen let know
indexwriter.numdoc n't take account appli flush delet javadoc state buffer delet taken account must call commit first re use cms re unlucki enough background merg commit call commit call .numdoc still get wrong count back fix trivial numdoc also consult pool reader current del count caus intermitt failur new testnrtthread
segmentinfo explicit track whether segment wrote term vector today segmentinfo n't know vector mean file method must check file exist lead subtl bug si.fil cach file fail invalid later term vector file creat also lead sloppi code eg termvectorsread grace handl open file exist n't like open exist also fix intermitt failur ve see noformat junit.framework.assertionfailederror indexfiledelet n't know file _1e.tvx org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:979 org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:917 org.apache.lucene.index.indexwriter.filesexist indexwriter.java:3633 org.apache.lucene.index.indexwriter.startcommit indexwriter.java:3699 org.apache.lucene.index.indexwriter.preparecommit indexwriter.java:2407 org.apache.lucene.index.indexwriter.commitintern indexwriter.java:2478 org.apache.lucene.index.indexwriter.commit indexwriter.java:2460 org.apache.lucene.index.indexwriter.commit indexwriter.java:2444 org.apache.lucene.index.testindexwriterexceptions.testrandomexceptionsthread testindexwriterexceptions.java:213 noformat
indexreader.indexexist sometim return true index n't present open writer new dir preparecommit n't finish commit indexreader.indexexist incorrect return true check whether segments_n file present whether success read
testindexwriterdelet fail random 10 9 run see fail trunk ant test-cor -dtestcase=testindexwriterdelet -dtestmethod=testerrorafterapplydelet -dtests.seed=4269712067829708991:1888184886355172227 -dtests.codec=randomperfield result code junit-sequenti junit testsuit org.apache.lucene.index.testindexwriterdelet junit test run 1 failur 2 error 0 time elaps 1.725 sec junit junit standard output junit note reproduc ant test -dtestcase=testindexwriterdelet -dtestmethod=testerrorafterapplydelet -dtests.seed=4269712067829708991:1888184886355172227 -dtests.codec=randomperfield junit note test param codec=randomcodecprovid id=standard contents=simpletext city=mocksep locale=ar_qa timezone=vst junit junit standard error junit note test run jvm junit testindexwriterdelet junit junit testcas testerrorafterapplydelet org.apache.lucene.index.testindexwriterdelet fail junit junit junit.framework.assertionfailederror junit org.apache.lucene.index.testindexwriterdelete.testerrorafterapplydelet testindexwriterdelete.java:736 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1043 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:981 junit junit junit testcas testerrorafterapplydelet org.apache.lucene.index.testindexwriterdelet fail junit concurrentmergeschedul hit unhandl except junit junit.framework.assertionfailederror concurrentmergeschedul hit unhandl except junit org.apache.lucene.util.lucenetestcase.teardown lucenetestcase.java:503 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1043 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:981 junit junit junit test org.apache.lucene.index.testindexwriterdelet fail code
stop write share doc store across segment share doc store enabl file store field term vector share across multipl segment ve optim sinc 2.1 think work best new index open iw add lot doc close case written segment refer slice singl share doc store segment good optim mean never need merg file open anoth iw index write new set doc store whenev merg take place across doc store must merg howev sinc switch share doc store two optim merg store first bulk-copi byte file field name/numb assign congruent second forc congruent field name/numb map indexwrit mean optim much less potent use furthermor optim add *a lot* hair indexwriter/documentswrit sourc sneaki bug time caus odd behavior like merg possibl forc flush start final dwpt lucene-2324 get us truli concurr flush longer share doc store think turn write-sid share doc store pave path dwpt land trunk simplifi iw/dw still must support read 5.0 read side far less hairi
multifield thread safe multifield look like thread safeti issu
mmapdirectori speedup mmapdirectori perform problem file larger integer.max_valu use multimmapindexinput lot unnecessari bounds-check buffer-switch etc instead like mmapindexinput reli upon contract oper bytebuff bound check alway throw bufferunderflowexcept buffer larg integer.max_valu rare happen bound check slow thing readint /readlong /readshort slow defer bytebuffer.readint etc n't import sinc n't much use think 's reason user e.g codec writer readbyt wrap bytebuff get intbuff view readint almost fast
simpletext bulk enum buffer reus bug testbulkpostingsbufferreus fail simpletext codec
lucenetestcas 's check uncaught except thread caus collater damag eg see failur https //hudson.apache.org/hudson/job/lucene-3.x/214/ multipl test method fail testindexwriterondiskful think 1 test real failur somehow thread hit exc track incorrect blame 3 case 'm sure seem like someth like go one problem lucenetestcase.teardown fail thread exc cms also hit failur fail clear cms 's thread failur think remov cms 's thread failur track 's static definit bleed across test ie reli lucenetestcas 's track
cms fail clean stop thread close iw wait abort wait run merg howev 's wait criteria wrong wait thread done w/ merg thread actual die cms alreadi sync method wait run thread call cms.close howev thread hazard mergethread remov mergethread actual exit sync abl return even merg thread still run uncov lucene-2819 test case testcustomscorequery.testcustomexternalqueri though expect test case would show
timelimitingcollector start thread static way stop see comment lucenetestcas even class.fornam timelimitingcollector start thread static method n't way kill broken
optim bufferedindexinput along line lucene-2816 readvint/readvlong/readshort/readint/readlong optim sinc defer readbyt exampl mean check buffer 's bound per-byt readvint instead per-vint easi win speed even vint case essenti alway faster slower case 1024 single-byt vint row case would singl extra bound check 1025 instead 1024
fsdirectory.open return mmap 64-bit solari mmap 30 faster niof platform
linedocsourc assign stabl id docdat field numericfield small enhanc index doc line doc sourc assign docid line number instead number-of-docs-index make result id stabl use multipl thread docdat field index string possibl creat datetool ad two numer field one index .gettim long msec anoth index second sinc day start give us two numer field play
improv termqueri pk lookup perform thing like primari key n't exist segment worst case primary/uniqu key exist 1 wast seek lucene-2694 tri solv issu termstat 'm concern could everi backport 3.1 exampl simpler solut solv one problem termqueri could revert trunk resolv lucene-2694 n't think leav thing 3.x
use stringbuild instead stringbuff benchmark minor chang use stringbuild instead stringbuff benchmark 's code n't need synchron stringbuff place ve check place _could_ problem htmlparser 's api one method accept stringbuff 's interfac think 's ok chang benchmark 's api back-compat wise 'd like either chang accept string remov method altogeth code benchmark use anyon need pass stringread method
revis weight scorer filter getdocidset api pass reader context spinoff lucene-2694 instead pass reader weight scorer ir boolean boolean could revis api pass struct parent reader sub reader ord sub ord map plus context parent would make sever issu way easier see lucene-2694 lucene-2348 lucene-2829 name
upgrad contrib/ 's tidy.jar contrib/ use tidy.jar also includ class org.w3c.dom org.xml.sax etc problem ant user ide user need care configur order classpath thing compil overrid one solr lib exampl solut upgrad tidy.jar newest one includ org.w3c.tidi n't caus problem
n't spawn thread static fsdirectori mac os x mac creat digest start pkcs11 thread think thread creat static issu timelimitedcollector also filtermanag uwe discuss remov md5 digest n't care remov long n't creat thread long n't use system default local
fieldcach rewrit method multitermqueri multitermqueri like rangequeri fieldcacherangefilt etc case particular optim general case sinc lucene-2784 rewrit method rewrit multitermqueri use fieldcach multitermqueri 's getenum longer take indexread term filteredtermsenum real termsenum decor case like low frequenc queri actual slower think shown numer rang realli high-frequ case like especi ugli wildcard regex fuzzi etc sever time faster use fieldcach instead sinc term ram automaton blast quicker
collaps searcher/searchable/indexsearch remov contrib/remot merg pms indexsearch ve discuss clean *searcher stack time think tri releas 4.0 'm attach initi patch remov searcher searchabl absorb method indexsearch remov contrib/remot remov multisearch absorb parallelmultisearch indexsearch ie pass usethreads=tru custom es ctor patch rough rip stuff search/replac indexsearch etc eg noth direct test use thread indexsearch commit think add newsearch lucenetestcas random choos whether searcher use thread cutov test use instead make indexsearch think multisearch use purpos today it low-level eg n't involv rewrit queri query.combin method scari mayb place make higher level class limit api 's abl feder search across multipl indexsearch 'd also abl option use thread per indexsearch
constantscorequeri direct support wrap queri simpli strip score especi multitermqueri rewrit mode often simpli need strip score queri make constant score current code look quit ugli new constantscorequeri new querywrapperfilt queri name say querywrapperfilt make queri constant score take queri ctor param question aldso ask quit often custom simpli correct think look closer code clear would also speed mtqs one addit wrap method call remov mayb even deprec querywrapperfilt 3.1 's use test use-cas class realli avail lucene-2831 need stupid hack make simon 's assert pass csq support out-of-ord score toplevel score csq top-level direct feed collector small trick use score collector call direct deleg score strip wrap setscor method collector found visibl bug scorer lucene-2839 method boolean score collector collector int max int firstdocid public protect sole intend overridden subclass call class lead compil bug class call main booleanscor 2 that packag visibl wrong open issu fix least trunk backwards-requir
visibl scorer.scor collector int int wrong method score subset scorer wrong visibl mark protect protect method call class protect method intend method overridden subclass call often final method class never call foreign class method call anoth class out-of-scop booleanscor 2 must public 's protect lead compil error bs 2 packag may lead problem subclass packag overrid implement lucene-2838 hit trap thought tis method call class scorer itsself fact call outsid lead bug overridden constantscor use overridden throw uoe sudden booleanqueri broken made clear 's call outsid intent protect method fix 3.x would break backward class overwrit method fix visibl trunk
add galician analyz add analyz galician base upon regra lematizador para o galego |http //bvg.udc.es/recursos_lingua/stemming.jsp set stopword creat usual fashion realli adapt portugues rslp|http //www.inf.ufrgs.br/~viviane/rslp/index.htm ad modifi exist hand-cod rslp-s rslp 's plural-on step plural-on flow rslp
add variable-gap term index impl prefixcodedtermsreader/writ use real core codec alreadi support pluggabl term index impl impl fixedgaptermsindexreader/writ pick everi nth default 32 term hold effici pack int/byt array ram alreadi enorm improv ram reduct init time 3.x patch add anoth impl variablegaptermsindexreader/writ let specifi arbitrari indextermselector pick term index use fst hold index term typic even memori effici pack int/byt array though support ord 's quit fair comparison relax term index plugin api prefixcodedtermsreader/writ assum term index impl support ord also cleanup fst/fstenum api impl broke separ seekceil seekfloor fstenum eg need seekfloor fst use term index seekceil 's hold term index ie simpletext use fsts
move contrib/benchmark modules/benchmark think move lucene/contrib/benchmark share modules/benchmark easili benchmark anyth lucen solr modul like analysi whatev exampl want benchmark someth solr lucene-2844 abl anoth exampl simpli abl benchmark analyz definit schema.xml conveni write equival java analyz benchmark
omittf viral omitnorm anti-vir omittf viral add document 1 field foo omittf document 2 field foo without omittf treat omittf omitnorm opposit million document field foo omitnorm add one document without omit norm sudden million real norm think would good omitnorm viral consist also prevent huge byte 's anoth option make omittf anti-vir schemaless guess
support unicod standardtoken standardtoken current support bmp encount charact outsid bmp discard instead implement fulli implement uax 29 across unicod
raminputstream hit fals eof seek eof seek back readbyt testlazyloadthreadsafeti fail hudson possibl issu ramdirectori hack lucen testcas return anoth directori seed pass
deprec similaritydeleg similarity.lengthnorm similaritydeleg back compat trap see lucene-2828 app static subclass sim defaultsim realli need runtim subclass make app-level deleg also sim.computenorm subsum lengthnorm deprec lengthnorm favor computenorm
contrib querypars use charsequ map key today contrib queri parser use map charsequ mani differ place may lead problem sinc charsequ interfac enforc implement hashcod equal method today 's caus problem querytreebuilder.setbuild charsequ querybuild method work expect
separ segmentread atom reader composit indexread current trunk whenev open indexread directori get back directoryread composit reader interfac indexread lot method simpli throw uoe fact 50 method common use one unus confus user make api hard understand issu split atom reader reader collect separ api longer abl get termsenum without wrap composit reader current helper class wrap slowmultireaderwrapp pleas renam name realli ugli multi* retrofit implement correct class slowmultireaderwrapp would atom reader take composit reader ctor param mayb could also simpli take list atomicread opinion mayb composit reader could implement collect api also readerutil method direct built possibl view util.collect sens general composit reader realli need look like previous indexread could simpli collect segmentread function like reopen side atom reader need reopen logic anymor segment chang need new atom reader mayb delet that best idea investig mayb make whole reopen logic simplier use ast least collect reader level decid good name prefer moment
segmentinfo.sizeinbyt ignor includedocstor cach notic segmentinfo 's sizeinbyt cach potenti buggi n't take account includedocstor i.e. call w/ fals sizeinbyt wo n't includ store file true vice versa wo n't get right sizeinbyt wo n't re-comput store file ll fix add test case demonstr bug
track total term freq per term right track docfreq term mani doc term totaltermfreq total number occurr term ie sum freq doc term also use stat flex score pulsingcodec etc
add maxtf fieldinvertst maximum within-docu tf use score valu expos peopl use score consid follow sim code overrid public float idf int docfreq int numdoc return 1.0f use overrid public float computenorm string field fieldinvertst state return state.getboost float math.sqrt state.getmaxtf code surpris effect interest practic reason
pass context struct weight scorer instead nake boolean weight scorer atomicreadercontext boolean boolean hard extend anoth boolean like needsscor similar flag inform need pass scorer immut struct would make extens trivial way easier
chang contrib qp api use charsequ string identifi api method contrib querypars expect charsequ identifi wrong sinc may lead incorrect mislead behavior shown lucene-2855 avoid problem api chang enforc use string instead charsequ version 4 patch alreadi deprec old api method add new substitut method use string
remov query.getsimilar spinoff lucene-2854 see lucene-2828 lucene-2854 refer general similaritydeleg problemat regard back-compat queri want score differ tri runtim subclass similar caus troubl reason could fix lucene-2854 noformat michael mccandless ad comment 08/jan/11 01:53 pm bq possibl remov method query.getsimilar also n't understand need method would love think 's anoth day look got stuck boostingqueri rewrit anon subclass bq overrid getsimilar turn overrid coord method rather twist differ think could remov query.getsimilar noformat method question noformat expert return similar implement use queri subclass may overrid method specifi similar implement perhap one deleg searcher default searcher 's similar implement return public similar getsimilar indexsearch searcher return searcher.getsimilar noformat
term dict block-encod term prefixcodedtermsreader/writ encod term standalon ie byte metadata detail post frq/prox file pointer etc cost someth want visit mani term pull metadata eg respel certain mtqs particular cost sep codec metadata store per term instead think block-encod term index term metadata store column stride instead make faster enum term
highlight overlap token output doubl word text fox jump generat follow token 0 0-3 fox ,0,0-7 fox,1,4-7 did,2,8-11 not,3,12,15 jump,4,16,18 termvector field store with_offset with_positions_offset highligh would output em fox /em jump join patch 2 addit junit test fix tokensourc class token order offset did'nt manag well overlap token
numerictokenstream.numerictermattribut support clone solr analysi request handler fail convert solr 's analysisrequesthandl lucene-2374 notic current implement numerictokenstream fail cloneattribut need buffer token structur display issu fix refactor inner class
remov scorer.getsimilar origin part patch per-field similar lucene-2236 pull issu realli most unrel also like separ issu appli deprec branch_3x make less surprises/migr hassl 4.0 user current scorer take confus number ctor either similar weight similar also lot scorer n't use similar realli need scorer addit weight argument often null weight make sens scorer parent creat scorer use scorer support lucene-2590 's featur dont think queri work featur correct right pass null final situat get confus start consid deleg like scorecachingwrapperscor arent realli deleg correct 'm unsur featur like lucene-2590 n't work think remov getsimilar scorer use similar alreadi come via ctor weight manag also scorer pass weight parent creat scorer 's ctor fix core/contrib/solr scorer even intern one pass parent weight consist visitor interfac one pass null solr 's valuesourcescor set fix-for 3.1 want backport anyth mark getsimilar deprec
multiphrasequeri sum idf instead similar multiphrasequeri general version phrasequeri comput idf way default sum across term problem n't let similar phrasequeri call similarity.idfexplain collect term term indexsearch searcher multiphrasequeri sum call similarity.idf int int term
track fieldinfo per segment instead per-iw-sess current fieldinfo track per iw session guarante consist global field-nam order iw carri fi instanc previous segment also carri field properti like isindex etc consist field order per iw session appear import due bulk merg store field etc carri properti might becom problemat lucen 's codec support codec reli consist properti fi fail fi properti carri docvaluescodec docvaluesbranch instanc write file per segment field use field id within file name yet segment docvalu index particular segment previous segment iw session docvalu fieldinfo docvalu true sinc valu reus previous segment alreadi work around limit segmentinfo properti like hasvector hasprox realli someth manag per codec segment ideal fieldinfo would manag per segment codec properti valid per segment also seem necessari bind fieldinfo segmentinfo logic sinc realli per segment metadata
cut spanqueri getspan atomicreadercontext followup lucene-2831 spanqueri getspan ir seem last remain artifact n't enforc per-seg context realli work atomicreadercontext spanqueri getspan atomicreadercontext instead nake ir
consolid solr lucen functionqueri modul spin-off dev list http //www.mail-archive.com/dev lucene.apache.org/msg13261.html
standardcodec sometim suppli skip pointer past eof pretti sure 4.0-on ad assert test reproduc ant test-cor -dtestcase=testpayloadnearqueri -dtestmethod=testminfunct -dtests.seed=4841190615781133892:3888521539169738727 -dtests.multiplier=3 noformat junit testcas testminfunct org.apache.lucene.search.payloads.testpayloadnearqueri fail junit invalid skip pointer 404 length=337 junit junit.framework.assertionfailederror invalid skip pointer 404 length=337 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1127 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1059 junit org.apache.lucene.index.codecs.multilevelskiplistreader.init multilevelskiplistreader.java:176 junit org.apache.lucene.index.codecs.standard.defaultskiplistreader.init defaultskiplistreader.java:50 junit org.apache.lucene.index.codecs.standard.standardpostingsread segmentdocsandpositionsandpayloadsenum.adv standardpostingsreader.java:742 junit org.apache.lucene.search.spans.termspans.skipto termspans.java:72 noformat
add waitformergestask build index .close iw may leav merg still need done waitformerg task let alg fix
remove/deprec indexreader.undeleteal api rather danger 's best effort sinc un-delet doc yet merg away drop lucene-2010 given expos impl detail lucen prune delet doc think remov api legitim use case
sever docsenum docsandpositionsenum return wrong docid next advanc int return no_more_doc work lucene-2878 found minor problem preflex puls codec return no_more_doc last docid instead docsenum docid next advanc int return no_more_doc javadoc clear say return no_more_doc
remov lucene.experiment numeric* numericrangequeri numericfield sinc 2.9 still mark experiment api stabil chang public part even lucen trunk chang also lot 's peopl ask experiment mean unstabl general mean unstabl api remov lucene.experiment numeric* class numericutils* stay lucene.intern intend public use peopl use make termqueri numer field done use nrq upper==low included=tru affect score appli also solr
indexwriterconfig allow readertermsindexdivisor -1 latest indic term index load pass -1 ir.open 's document indexwrit 's reader b/c iwc block need allow set well add support test e.g random set -1 robert also suggest randomiw use -1 random open reader ll work patch
add queryparser.newfieldqueri note patch chang behavior make qp subclass current queri getfieldqueri string field string querytext boolean quot contain hairi method produc queri qp 's analyz propos factor newfieldqueri analyz analyz string field string querytext boolean quot getfieldqueri call newfieldqueri this.analyz field querytext quot reason quit use consid doubl quot phrase exact search case user quot term might want analyz text altern analyz n't produc synonym doesnt decompos compound n't use worddelimiterfilt would need use preserveoriginal=tru index time wdf one etc etc similar way googl 's doubl quot oper work defin phrase exact word phrase exampl compar result queri test versus test current without heavi code duplic realli make separ field wast make custom qp lie field exampl list singl field yet still exact phrase search
use google-code-prettifi lucene/solr javadoc compani rondhuit use google-code-prettifi apach licens 2.0 javadoc syntax highlight http //www.rondhuit-demo.com/rcss/api/com/rondhuit/solr/analysis/jareadingsynonymfilterfactory.html think use lucen javadoc java sampl code overview.html etc solr javadoc analyz factori etc improv simplifi life
mockrandomcodec load termsindex even termsindexdivisor set -1 work lucene-2891 trunk found mockrandomcodec use set iwc.readertermsindexdivisor -1 allow seek e.g. termdoc n't codec fail seek expect test need find mockrandomcodec fail expect verifi run ant test-cor -dtestcase=testindexwriterread -dtestmethod=testnotermsindex -dtests.codec=mockrandom comment line add mockrandom list illeg codec test
advanc n't tri skip evid fail todo 's code everywher part mike speed exactphrasescor think codec
appli delete-by-term docid immedi newli flush segment spinoff lucene-2324 flush delet today keep buffer term/query/docid need delet newli flush segment ie fresh dwpt silli flush visit term know docid 's effici appli delet one segment time still must buffer delet prior segment delet n't need map docidupto anymor ie need set issu wait lucene-1076 sinc issu cut buffer delet transact stream
cms merg throttl aggress enough hit crab work nrt benchmark luceneutil cms today forc idl incom thread mani merg pend last line defens sinc also juggl thread prioriti forc idl biggest merg tri reduc outstand merg count keep choic stall thread respons make new segment howev logic wrong place stall happen pull next merg iw poor mean n index thread allow max n outstand merg simpl fix move stall logic pull next merg iw
make appli delet option pull new nrt reader usual pull nrt reader want delet appli expert case may need eg want valid doc index sinc 's cost appli delet trivial add boolean alreadi boolean intern think add delet still buffer alway later pull anoth reader real search delet appli
keywordmarkerfilt reset keyword attribut state fals token protwords.txt keywordmarkerfilt set true fals keywordattribut token eras previous state establish filter chain exampl case custom filter want prevent token stem token alreadi mark keyword keywordattribute.iskeyword true perhap keywordmarkerfilterfactori re-set state fals
test run checkindex index creat think add boolean checkindexesonclos default=tru mockdirectorywrapp test need disabl
non-contigu logmergepolici care select merg alreadi run logmp non-contigu merg fact disregard segment alreadi merg problemat sinc could result return conflict merg thus fail run multipl merg concurr
filter process output icutoken creat overlap bigram cjk icutoken produc unigram cjk would like use icutoken overlap bigram creat cjk cjk analyz filter would take output icutoken read scriptattribut select script han kana would produc overlap bigram
automaton termsenum bug run multithread search one pop hudson test run queri fieldcach filter rewrit compar result howev actual wors unrel fieldcach set filter rewrit still fail
clean serial codebas remov contrib/remot forgot cleanup serial hell everywher longer need never realli work e.g across version slow develop e.g wast long time debug stupid serial similarity.idfexplain tri make patch score system
synchron grammar/token type across standardtoken uax29emailurltoken icutoken add cjk type 'd like lucene-2906 better cjk support token futur target 3.2 3.1 would like littl cleanup first synchron token type etc
remov field param computenorm scorepayload remov uoe 'd lengthnorm switch sweetspot per-field lucene-2236 switch sim per field similarityprovid return per-field similar n't complet cleanup think sweetspotsimilar lose hashmap instead configur one per field return similarityprovid mean exampl tf factor configur per-field length normal factor computenorm scorepayload lose field paramet redund confus uoe 'd obselet lengthnorm remov also updat javadoc point bad
add miss getter method numericfield numerictokenstream numericrangequeri numericrangefilt class miss bean-styl getter method basic properti inconsist fix
indexwrit prune 100 delet seg even nrt case prune 100 delet seg commit iw ir lucene-2010 n't quit aggress enough nrt case rare call commit instead moment delet last doc segment prune in-memori segmentinfo way open nrt reader merg kick commit call 100 delet segment alreadi gone
indexsplitt divid primari key term index splitter divid primari key term contrib multipassindexsplitt divid docid howev guarante extern constraint 's sometim necessari split primari key term id think implement fair trivial chang
deprec remov shinglematrixfilt spin-off lucene-1391 filter unmainatin longer up-to-d bug nobodi understand work attribut issu deprec lucen 3.1 remov trunk
optim blocktermsreader.seek seek first consult term index find right block 32 default term may hold target term scan block look exact match scan use next compar full term actual rather wast first sinc term block share common prefix compar target common prefix compar new suffix term second sinc term suffix alreadi read front byte no-copi comparison vs today first read copi local bytesref compar opto remov abil blocktermswriter/read support arbitrari term sort order 's hardwir bytesref.utf8sortedasunicod
cleanup contrib/demo n't think includ optim demo mani peopl start demo may think must optim search 's clear case think also use buffer reader filedocu 'm tempt remov indexhtml html parser entir 's ancient tika extract text mani doc format
fix get start demo doc open new issu sinc number problem get version right eg explain src checkout point path releas sourc checkout build jar instruct must updat merger analyz jar must classpath demo sourc longer ship binari releas fixup lucene-2923 remov web app new command-lin op indexfil etc
improv lucenetestcas javadoc lucen test-framework javadoc publish get attent
improv javadoc priorityqueu lessthan kill inspect code everi time implement priorityqueu
clean obselet inform websit search inform lucen index speed get back realli date stuff 1. featur page proud proclaim 20mb/minut realli old hardwar think chang 95gb/hour http //blog.mikemccandless.com/2010/09/lucenes-indexing-is-fast.html 2. ancient benchmark result version data link websit list version websit ancient version go back 1.4.3 also notic casual googl api document tend get result go ancient version think remov stuff version prior 2.9
two-stag state expans fst distance-from-root child-count criteria current implement fst state expand binari search label vector transit child count state exceed given predefin threshold num_arcs_fixed_array threshold affect automaton size travers speed turn benchmark degener data set close-to-the-root node could small number children threshold yet travers everi singl seek fix introduc two control threshold expand state distance-from-root min_dist || children-count num_arcs_fixed_array plan creat data set prove first implement workaround
altern depth-bas dot layout order fst 's util utils.todot dump graphviz 's dot file quit difficult read patch provid altern layout probabl littl bit easier eye well far larger fsts
let codec consum entir document current codec api limit consum term post upon segment flush enabl store field docvalu make use codec abstract codec allow pull consum ahead flush time consum valu document 's field though consum api altern consum entir document would extend fieldsconsum return storedvalueconsum docvaluesconsum like done docvalu branch right side side termsconsum yet extend proven tricki error prone sever reason fieldsconsum requir segmentwritest might differ upon flush compar document consum segmentwritest must therefor creat twice 1. first docvalu field index 2. flush fieldsconsum current pull index field matter term index yet use someth like docvaluescodec essenti wrap anoth codec creat fieldconsum demand wrap codec consum might initi even field index caus problem field open miss requir file codec ad harsh logic work around prevent segmentcodec creat segmentwritest might yield wrong codec id depend field number assign current depend fact field segment therefor codec known segmentcodec build enabl consum perdoc valu codec need increment codec instead provid documentconsum side side fieldsconsum creat prior flush also prerequisit lucene-2621
score explain n't match ve face problem recent ll attach program reproduc problem soon program output follow noformat score 0.10003257 explain 0.050016284 match product 0.15004885 match sum 0.15004885 weight f1 note book 0 product 0.3911943 queryweight f1 note book product 0.61370564 idf f1 note=1 book=1 0.6374299 querynorm 0.38356602 fieldweight f1 note book 0 product 1.0 tf phrasefreq=1.0 0.61370564 idf f1 note=1 book=1 0.625 fieldnorm field=f1 doc=0 0.33333334 coord 1/3 noformat
small float underflow detect bug underflow detect small float bug incorrect result byte valu 0 non-zero float
highlight tri use maxdoccharstoanalyz weightedspantermextractor ad new field memoryindex well use cachingtokenstream huge document drastic slower need entir field ad memori index cost great reduc mani case tri respect maxdoccharstoanalyz thing improv even respect set cachingtokenstream
npe testnrtthread hit 1 ing test think 's logic ask segmentread load store field noformat thread lucen merg thread 1 org.apache.lucene.index.mergepolici mergeexcept java.lang.nullpointerexcept org.apache.lucene.index.concurrentmergescheduler.handlemergeexcept concurrentmergescheduler.java:507 org.apache.lucene.index.concurrentmergeschedul mergethread.run concurrentmergescheduler.java:472 caus java.lang.nullpointerexcept org.apache.lucene.index.segmentread fieldsreaderlocal.initialvalu segmentreader.java:245 org.apache.lucene.index.segmentread fieldsreaderlocal.initialvalu segmentreader.java:242 org.apache.lucene.util.closeablethreadlocal.get closeablethreadlocal.java:68 org.apache.lucene.index.segmentreader.getfieldsread segmentreader.java:749 org.apache.lucene.index.segmentreader.docu segmentreader.java:838 org.apache.lucene.index.indexreader.docu indexreader.java:951 org.apache.lucene.index.testnrtthread 1.warm testnrtthreads.java:86 org.apache.lucene.index.indexwriter.mergemiddl indexwriter.java:3311 org.apache.lucene.index.indexwriter.merg indexwriter.java:2875 org.apache.lucene.index.concurrentmergescheduler.domerg concurrentmergescheduler.java:379 org.apache.lucene.index.concurrentmergeschedul mergethread.run concurrentmergescheduler.java:447 noformat
custom sort broken use executorservic
icu collat thread-safeti issu icu collat unlik jdk one n't thread safe http //userguide.icu-project.org/collation/architectur littl non-obvi sinc mention javadoc clear doc appli c code look sourc kind intern state opinion clone icu collat pass outsid creat new tokenstream/attributeimpl prevent problem n't big deal sinc everyth use reusabletokenstream anyway
bytesref reus bug querypars analysis.jsp code use bytesref string case consum termtobytesrefattribut thing general implement work char popul consum bytesref termtobytesrefattribut implement specif icu collat reus byte simpli set pointer noformat overrid public int tobytesref bytesref target collator.getrawcollationkey tostr key target.byt key.byt target.offset 0 target.length key.siz return target.hashcod noformat blame fall ad querypars lucene-2514 attach patch consum re-us spare copi byte go make long last object term
surround queri n't proper handl equals/hashcod look use surround queri solr hit issu caus collis due equals/hashcod implement anonym inner class creat thing like distancequeri branch 3.x near line 76
make licens checking/mainten easier/autom instead wait releas check licens valid make part build process ensur depend proper licens etc
priorityqueu inheri broken subclass attempt use heap w/gener bound anyth object discov solr-2410 fact protect heap variabl priorityqueu initi use object make imposs subclass priorityqueu exist access heap array unless bind generic object
checkindex print wrong version number 3.1 index posibl also trunk run checkindex index created/upd 3.1 print segmentinfo noformat segment file=segments_g19 numsegments=5 version=-11 lucen 1.3 prior noformat fix checkindex also verifi case version number print trunk issu may complic
add utitili class manag nrt reopen creat simpl class nrtmanag tri abstract away reopen logic use nrt reader give iw tell min max nanosecond stale toler privat run reopen thread period reopen searcher subsum searchermanag lia2 besid run reopen thread also add notion generat contain chang ve made eg adddocu return long take long valu pass back getsearch method getsearch return searcher reflect chang made generat give app freedom forc immedi consist ie wait reopen search requir like verifi add doc immedi search also use eventu consist search want also add support new applydelet option pull nrt reader also new 'm sure buggi concurr either wrong overly-lock 's start
support updatedocu dwpts separ documentswriterperthread dwpt current happen delet part updatedocu flush commit separ correspond new document need make sure updatedocu alway atom oper iw.commit iw.getread perspect see lucene-2324 detail
generate-maven-artifact target includ non-maven lucen solr depend current addit deploy artifact lucen solr modul repositori default local generate-maven-artifact target also deploy artifact follow non-maven solr depend lucene_solr_3_1 version given solr/lib/commons-csv-1.0-snapshot-r966014.jar org.apache.solr solr-commons-csv:3.1 solr/lib/apache-solr-noggit-r944541.jar org.apache.solr solr-noggit:3.1 \\ \\ follow .jar 's ad list lucene_solr_3_1 version given \\ \\ lucene/contrib/icu/lib/icu4j-4_6.jar lucene/contrib/benchmark/lib/xercesimpl-2.9.1-patched-xercesj -1257.jar solr/contrib/clustering/lib/carrot2-core-3.4.2.jar solr/contrib/uima/lib/uima-an-alchemy.jar solr/contrib/uima/lib/uima-an-calais.jar solr/contrib/uima/lib/uima-an-tagger.jar solr/contrib/uima/lib/uima-an-wst.jar solr/contrib/uima/lib/uima-core.jar \\ \\ think make sens follow model current non-maven depend \\ \\ groupid org.apache.solr/.lucen artifactid solr-/lucene- original-nam version lucene-solr-release-vers **the carrot2-cor jar n't need includ trunk 's releas artifact sinc alreadi maven java6-compil jar branch_3x lucene_solr_3_1 need solr-specif java5-compil maven artifact though
writelinedoctask improv make writelinedoctask linedocsourc flexible/extend allow emit line also empti doc keep current behavior default allow more/less/oth field
gsoc implement state art rank lucen lucen employ vector space model vsm rank document compar unfavor state art algorithm bm25 moreov architectur tailor specic vsm make addit new rank function non- trivial task project aim bring state art rank method lucen implement queri architectur pluggabl rank function wiki page project found http //wiki.apache.org/lucene-java/summerofcode2011projectrank
allow bring back abil setrambuffersizemb open indexwrit 3.1 abil setrambuffersizemb deprec remov trunk would great abl control live indexwrit possibl two method would great bring back settermindexinterv setreadertermsindexdivisor setter actual set mergepolici need setter think
remov benchmark/lib/xml-apis.jar jvm 1.5 alreadi contain requir jaxp 1.3 implement lucene-2957|http //issues.apache.org/jira/browse/lucene-2957 focusedcommentid=13004991 page=com.atlassian.jira.plugin.system.issuetabpanel comment-tabpanel comment-13004991 uwe wrote quot xml-apis.jar need xerces-2.9 java 5 java 5 alreadi interfac class jaxp 1.3 xerc 2.11 need ship java 6 's jaxp releas contain stax co. avail java 5 quot lucen irc channel uwe also wrote noformat sinc java 5 sinc 3.0 javax api alreadi avail jvm xerc 2.9.x need jaxp 1.3 thing need xercesimpl.jar serializer.jar serializer.jar share apach xml project dont know exact version number ok dont need whan pars xml soon want serial dom tree result xsl transform need upgrad latest xerc need xml-api jar unless java 6 one ship xerc 2.11 1.4 one xerc 2.11 support stax noformat
easier way run benchmark move benchmark.main easili access method exec easili invok extern program
allow benchmark task altern packag relax current limit task packag perftask add properti alt.tasks.packag valu comma separ full packag name task class found default packag attempt made load altern packag specifi properti
segmentreader.docommit sync 'd norm method need sync 'd fix failur testnrtthread process trip assert segmentreader.docommit n't sync 'd sync 'd n't think norm api need sync 'd popul norm front never chang un-sync' import nrt case call iw.commit n't block search tri pull norm also small code refactor
specialoperations.isfinit terribl terribl runtim certain situat applic mine experienc slow queri time finit automata dfas acycl turn slowdown terribl runtim specialoperations.isfinit use determin dfa acycl case talk even minut cpu
intermitt failur testfieldcachetermsfilter.testmissingterm run test 1 hit noformat note reproduc ant test -dtestcase=testfieldcachetermsfilt -dtestmethod=testmissingterm -dtests.seed=-1046382732738729184:5855929314778232889 1 testmissingterm org.apache.lucene.search.testfieldcachetermsfilt java.lang.assertionerror must match 1 expect 1 0 org.junit.assert.fail assert.java:91 org.junit.assert.failnotequ assert.java:645 org.junit.assert.assertequ assert.java:126 org.junit.assert.assertequ assert.java:470 org.apache.lucene.search.testfieldcachetermsfilter.testmissingterm testfieldcachetermsfilter.java:63 sun.reflect.nativemethodaccessorimpl.invoke0 nativ method sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:39 sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:25 java.lang.reflect.method.invok method.java:597 org.junit.runners.model.frameworkmethod 1.runreflectivecal frameworkmethod.java:44 org.junit.internal.runners.model.reflectivecallable.run reflectivecallable.java:15 org.junit.runners.model.frameworkmethod.invokeexplos frameworkmethod.java:41 org.junit.internal.runners.statements.invokemethod.evalu invokemethod.java:20 org.junit.rules.testwatchman 1.evalu testwatchman.java:48 org.junit.internal.runners.statements.runbefores.evalu runbefores.java:28 org.junit.internal.runners.statements.runafters.evalu runafters.java:31 org.junit.runners.blockjunit4classrunner.runchild blockjunit4classrunner.java:76 org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1214 org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1146 org.junit.runners.parentrunn 3.run parentrunner.java:193 org.junit.runners.parentrunn 1.schedul parentrunner.java:52 org.junit.runners.parentrunner.runchildren parentrunner.java:191 org.junit.runners.parentrunner.access 000 parentrunner.java:42 org.junit.runners.parentrunn 2.evalu parentrunner.java:184 org.junit.internal.runners.statements.runbefores.evalu runbefores.java:28 org.junit.internal.runners.statements.runafters.evalu runafters.java:31 org.junit.runners.parentrunner.run parentrunner.java:236 org.junit.runners.suite.runchild suite.java:128 org.junit.runners.suite.runchild suite.java:24 org.junit.runners.parentrunn 3.run parentrunner.java:193 org.junit.runners.parentrunn 1.schedul parentrunner.java:52 org.junit.runners.parentrunner.runchildren parentrunner.java:191 org.junit.runners.parentrunner.access 000 parentrunner.java:42 org.junit.runners.parentrunn 2.evalu parentrunner.java:184 org.junit.runners.parentrunner.run parentrunner.java:236 org.junit.runner.junitcore.run junitcore.java:157 org.junit.runner.junitcore.run junitcore.java:136 org.junit.runner.junitcore.run junitcore.java:117 org.junit.runner.junitcore.runmain junitcore.java:98 org.junit.runner.junitcore.runmainandexit junitcore.java:53 org.junit.runner.junitcore.main junitcore.java:45 noformat unfortun seed n't consist repro
sourc distribut packag target make tarbal svn export instead pick choos stuff includ local work copi lucen 's dist-src/package-tgz-src target solr 's package-src target simpli perform svn export revis url local work copi
hotspot bug readvint give wrong result test 3.1-rc1 made yonik pangaea www.pangaea.d product system figur sudden larg segment 5 gib store fiel sudden produc strang deflat decompress problem compressiontool although store field longer pre-3.0 compress seem header store field read incorrect buffer boundari multimmapdir fieldsread incorrect detect deflate-compress field compressiontool error occur reproduc checkindex mmapdirectori niodir simpledir fdt file segment 2.6 gib solari chunk size integer.max_valu 2 multimmap indexinput robert index readi tar file test local machin hope solv bug mayb introduc robert 's recent chang mmap
writelinedoctask write gzip/bzip2/txt accord extens specifi output file name sinc reader behav way would nice handi also line writer would
upgrad benchmark commons-compress-1.0 commons-compress-1.1 15 time faster gzip decompress lucene-1540 treccontentsourc move java 's gzipinputstream common-compress 1.0 slow gzip decompress factor 15 upgrad 1.1 solv problem verifi problem gzip bzip way 1.1 introduc constant compress method code made bit nicer
simplifi configur api contrib queri parser current configur api complic inherit concept use attribut api store token inform token stream howev requir qp config token stream n't use thing propos simplifi qp config make less scari peopl intend use contrib qp task difficult requir lot code chang figur best way 's 's good candid gsoc project would like hear good propos make api friend less scare
benchmark 's contentsourc reli file suffix lower case detect file type gzip/bzip2/text file.gz correct handl gzip file.gz handl text wrong
review potenti remov unused/unsupport contrib contrib appear lack development/support miss test review whether even pertin day potenti deprec remov one thing mahout bring colt code mark code n't test deprec remov deprec test ad n't get test ad 6 mos period time remov would suggest take hard look ant db luc swing spatial gut extent move modul
fieldinfo read-on load disk current fieldinfo creat privat fieldnumberbimap load directori necessari due limit need face iw addindex dir add index via directori exist index field number conflict global field number iw receiv directori field number conflict remain segment merg stabil base iw global field number yet unnecessarili creat bimap actual enforc read-on semant sinc nobodi modifi fieldinfo instanc load directori somebodi need get modifi copi simpli creat new one fieldinfo instanc
move hasvector hasprox respons segmentinfo fieldinfo spin-off lucene-2881 chang alreadi due random failur relat chang remov part patch make isol easier test
build segmentcodec increment consist codecid index current build segementcodec flush fine long codec need know field handl chang docvalu expos storedfield termvector via codec see lucene-2621 lucene-2935 downsid n't consist view codec belong field index fieldinfo instanc unassign set -1 instead build segmentcodec increment field come matter codec need select process document field right codec id assign
divorc defaultsimilarityprovid defaultsimilar lucene-2236 start made defaultsimilar implement factori interfac similarityprovid also extend similar factori interfac return alway default doron mention would cleaner split two thought would good revisit later today look solr-2338 becam pretti clear make thing lot cleaner think current confus user see two api mix tri subclass
testcollectionutil fail ibm jre junit testcas testemptyarraysort org.apache.lucene.util.testcollectionutil caus error junit collectionutil sort random access list in-plac
improv arrayutil/collectionutil *sort method early-reaturn empti one-el lists/array might good idea make collectionutil arrayutil return earli passed-in list array 's length 1 sort unneed improv mayb automaton place empti one-el list sortertermpl creat
3.1 releas updat backward test 3.x branch releas offici artifact lucen 3.1 final one need follow svn rm backwards/src/test svn cp https //svn.apache.org/repos/asf/lucene/dev/branches/lucene_solr_3_1/lucene/src/test backwards/src/test copi lucene-core-3.1.0.jar last releas tarbal lucene/backwards/lib delet old one check everyth correct backward folder contain src/ folder contain test file one branch run ant test-backward uwe take care
factor share spellcheck modul lucen 's contrib spellcheck support index-bas spellcheck directspellcheck etc also thing like pluggabl compar solr auto-suggest support two implement look like good util like highfrequencydictionari etc think spellcheck realli import googl up ant user expect propos combin stuff share modules/spellcheck make easier refactor improv qualiti
addindex indexread incorrect appli exist delet perform oper deletedocu term new document addindex indexread commit addindex appli previous delet incom index well incorrect call addindex directori instead delet appli beforehand solut mike indic http //osdir.com/ml/general/2011-03/msg20876.html add *flush fals true addindex indexread creat patch match unit test short
add tests.iter.min improv control tests.it 's behavior discuss http //lucene.472066.n3.nabble.com/stop-iterating-if-testsfailed-td2747426.html issu propos add tests.iter.min order allow one better control mani iter run keep tests.it today add tests.iter.min default tests.it denot least n instanc test run 's either failur tests.it reach one want run first failur set tests.iter.min=1 tests.iter=x x instanc test run first failur similar one set tests.iter=n denot least n instanc run regardless failur n run failur occur test stop note unlik 's propos thread tests.iter.max drop propos 's exact like tests.it point two similar paramet work patch tomorrow
move uninvertedfield lucen core solr 's uninvertedfield let quick lookup term ord given doc/field like fieldcach invert index produc creat ram-resid data structur hold bit unlik fieldcach handl multipl valu per doc hold term byte ram rather hold term ord use termsenum resolv ord term great eg facet want use int ord count end need resolv top n ord text think use core function move lucen 's core 's good complement fieldcach first babi step move core refactor solr usag separ issu think thing could explore/improv first-pass alloc lot tini byte look like could ineffici mayb could use byte slice index improv ram effici termindex codec support ord oper one segment use use ram-effici data structur eg fst map ord may abl improv main byte represent use pack int instead delta-vint eventu fold abil docvalu ie we'd write byte imag index time load would fast instead uninvert
fst serial deseri plain datainput/dataoutput stream current automaton save directori instanc indexinput/ indexoutput
use setnorm lucen write headerless separ norm file case sr.rewrit write byte header write alway detect case segment written 3.1 sketchi length maxdoc check
compar api segment version see lucene-3012 exampl thing get ugli want use segmentinfo.getvers exampl commit patch releas 3.2 later releas 3.1.1 3.1.1 what written return function sudden broke index format use string without reason compar api case one abl comput version 3.2 safe n't reli upon version inform intern lucen think go break someth
analyz latvian less aggress form kreslin phd thesi stem algorithm latvian
fst differenti final vs non-fin stop node 'm break one improv lucene-2948 current node outgo edg stop node fst forc mark final node need ie whether node final orthogon whether arc leav
fvh uncontrol color tag multi-color tag featur fvh uncontrol precis unexpect user color use term
better payload test mockanalyz mockanalyz current alway index fixed-length payload instead decid field random rememb field field index payload field index fix length payload field index variabl length payload
random skipinterv test probabl n't test multi-level skip well skipinterv etc privat codec better test coverag parameter post writer random via mockrandomcodec
land dwpt trunk lucene-2956 resolv last remain issu lucene-2324 proceed land dwpt develop trunk soon think one bigger issu make sure javadoc iw etc still correct though start go first
index integer.max_valu term seek aioob due long/int overflow tom hit new long/int overflow case http //markmail.org/thread/toyl2ujcl4suqvf3 regress 3.1 introduc lucene-2075 wors test2bterm fail catch ve fix test show failur
smartcn analyz throw nullpoint except length analys text 32767 's org.apache.lucene.analysis.cn.smart.hhmm.seggraph 's makeindex method public list segtoken makeindex list segtoken result new arraylist segtoken int -1 count 0 size tokenlisttable.s list segtoken tokenlist short index 0 count size isstartexist tokenlist tokenlisttable.get segtoken st tokenlist st.index index result.add st index++ count++ s++ return result short index 0 int index 0 's report http //code.google.com/p/imdict-chinese-analyzer/issues/detail id=2 http //code.google.com/p/imdict-chinese-analyzer/issues/detail id=11 author xiaopinggao alreadi fix bug http //code.google.com/p/imdict-chinese-analyzer/source/browse/trunk/src/org/apache/lucene/analysis/cn/smart/hhmm/seggraph.java
testomittf.testmixedmerg random seed failur version trunk r1091638 ant test -dtests.seed=-6595054217575280191:5576532348905930588 junit standard error junit warn test method testdemorgan left thread run thread nrt search threads-1691-thread-2,5 main junit resourc leak test method testdemorgan left 1 thread run junit note reproduc ant test -dtestcase=testbooleanqueri -dtestmethod=testdemorgan -dtests.seed=-6595054217575280191:5576532348905930588 junit junit testsuit org.apache.lucene.index.testnorm junit test run 2 failur 0 error 0 time elaps 5.064 sec junit junit testsuit org.apache.lucene.index.testomittf junit testcas testmixedmerg org.apache.lucene.index.testomittf caus error junit checkindex fail junit java.lang.runtimeexcept checkindex fail junit org.apache.lucene.util._testutil.checkindex _testutil.java:152 junit org.apache.lucene.util._testutil.checkindex _testutil.java:138 junit org.apache.lucene.index.testomittf.testmixedmerg testomittf.java:155 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1232 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1160 junit junit junit test run 5 failur 0 error 1 time elaps 0.851 sec junit junit standard output junit checkindex fail junit segment file=segments_1 numsegments=1 version=format_4_0 lucen 4.0 junit 1 1 name=_12 doccount=60 junit codec=segmentcodec codecs= mockrandom mockvariableintblock baseblocksize=112 provider=randomcodecprovid f1=mockrandom f2=mockvariableintblock baseblocksize=112 junit compound=fals junit hasprox=fals junit numfiles=16 junit size mb =0,01 junit diagnost optimize=tru mergefactor=2 os.version=2.6.37-gentoo os=linux lucene.version=4.0-snapshot source=merg os.arch=amd64 java.version=1.6.0_24 java.vendor=sun microsystem inc. junit delet junit test open reader ok junit test field ..ok 2 field junit test field norm ok 2 field junit test term freq prox error java.io.ioexcept read past eof junit java.io.ioexcept read past eof junit org.apache.lucene.store.raminputstream.switchcurrentbuff raminputstream.java:90 junit org.apache.lucene.store.raminputstream.readbyt raminputstream.java:63 junit org.apache.lucene.store.mockindexinputwrapper.readbyt mockindexinputwrapper.java:105 junit org.apache.lucene.store.datainput.readvint datainput.java:94 junit org.apache.lucene.index.codecs.sep.sepskiplistreader.readskipdata sepskiplistreader.java:188 junit org.apache.lucene.index.codecs.multilevelskiplistreader.loadnextskip multilevelskiplistreader.java:142 junit org.apache.lucene.index.codecs.multilevelskiplistreader.skipto multilevelskiplistreader.java:112 junit org.apache.lucene.index.codecs.sep.seppostingsreaderimpl sepdocsenum.adv seppostingsreaderimpl.java:454 junit org.apache.lucene.index.checkindex.testtermindex checkindex.java:782 junit org.apache.lucene.index.checkindex.checkindex checkindex.java:495 junit org.apache.lucene.util._testutil.checkindex _testutil.java:148 junit org.apache.lucene.util._testutil.checkindex _testutil.java:138 junit org.apache.lucene.index.testomittf.testmixedmerg testomittf.java:155 junit sun.reflect.nativemethodaccessorimpl.invoke0 nativ method junit sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:39 junit sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:25 junit java.lang.reflect.method.invok method.java:597 junit org.junit.runners.model.frameworkmethod 1.runreflectivecal frameworkmethod.java:44 junit org.junit.internal.runners.model.reflectivecallable.run reflectivecallable.java:15 junit org.junit.runners.model.frameworkmethod.invokeexplos frameworkmethod.java:41 junit org.junit.internal.runners.statements.invokemethod.evalu invokemethod.java:20 junit org.junit.rules.testwatchman 1.evalu testwatchman.java:48 junit org.junit.internal.runners.statements.runbefores.evalu runbefores.java:28 junit org.junit.internal.runners.statements.runafters.evalu runafters.java:31 junit org.junit.runners.blockjunit4classrunner.runchild blockjunit4classrunner.java:76 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1232 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1160 junit org.junit.runners.parentrunn 3.run parentrunner.java:193 junit org.junit.runners.parentrunn 1.schedul parentrunner.java:52 junit org.junit.runners.parentrunner.runchildren parentrunner.java:191 junit org.junit.runners.parentrunner.access 000 parentrunner.java:42 junit org.junit.runners.parentrunn 2.evalu parentrunner.java:184 junit org.junit.internal.runners.statements.runbefores.evalu runbefores.java:28 junit org.junit.internal.runners.statements.runafters.evalu runafters.java:31 junit org.junit.runners.parentrunner.run parentrunner.java:236 junit junit.framework.junit4testadapter.run junit4testadapter.java:39 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.run junittestrunner.java:422 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.launch junittestrunner.java:931 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.main junittestrunner.java:758 junit test store field .ok 60 total field count avg 1 field per doc junit test term vector ..ok 120 total vector count avg 2 term/freq vector field per doc junit fail junit warn fixindex would remov refer segment full except junit java.lang.runtimeexcept term index test fail junit org.apache.lucene.index.checkindex.checkindex checkindex.java:508 junit org.apache.lucene.util._testutil.checkindex _testutil.java:148 junit org.apache.lucene.util._testutil.checkindex _testutil.java:138 junit org.apache.lucene.index.testomittf.testmixedmerg testomittf.java:155 junit sun.reflect.nativemethodaccessorimpl.invoke0 nativ method junit sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:39 junit sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:25 junit java.lang.reflect.method.invok method.java:597 junit org.junit.runners.model.frameworkmethod 1.runreflectivecal frameworkmethod.java:44 junit org.junit.internal.runners.model.reflectivecallable.run reflectivecallable.java:15 junit org.junit.runners.model.frameworkmethod.invokeexplos frameworkmethod.java:41 junit org.junit.internal.runners.statements.invokemethod.evalu invokemethod.java:20 junit org.junit.rules.testwatchman 1.evalu testwatchman.java:48 junit org.junit.internal.runners.statements.runbefores.evalu runbefores.java:28 junit org.junit.internal.runners.statements.runafters.evalu runafters.java:31 junit org.junit.runners.blockjunit4classrunner.runchild blockjunit4classrunner.java:76 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1232 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1160 junit org.junit.runners.parentrunn 3.run parentrunner.java:193 junit org.junit.runners.parentrunn 1.schedul parentrunner.java:52 junit org.junit.runners.parentrunner.runchildren parentrunner.java:191 junit org.junit.runners.parentrunner.access 000 parentrunner.java:42 junit org.junit.runners.parentrunn 2.evalu parentrunner.java:184 junit org.junit.internal.runners.statements.runbefores.evalu runbefores.java:28 junit org.junit.internal.runners.statements.runafters.evalu runafters.java:31 junit org.junit.runners.parentrunner.run parentrunner.java:236 junit junit.framework.junit4testadapter.run junit4testadapter.java:39 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.run junittestrunner.java:422 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.launch junittestrunner.java:931 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.main junittestrunner.java:758 junit junit warn 1 broken segment contain 60 document detect junit junit junit standard error junit note reproduc ant test -dtestcase=testomittf -dtestmethod=testmixedmerg -dtests.seed=-6595054217575280191:5576532348905930588 junit note test param codec=randomcodecprovid notf=mocksep tf=standard f1=mockrandom f2=mockvariableintblock baseblocksize=112 locale=cs_cz timezone=chile/continent junit note test run jvm junit testassert testcachingtokenfilt testdocu testdirectoryread testflex testindexwriterconfig testindexwritermerg testindexwriteronjrecrash testmultiread testnewestseg testnorm testomittf junit note linux 2.6.37-gentoo amd64/sun microsystem inc. 1.6.0_24 64-bit /cpus=8 threads=1 free=94021800 total=126484480 junit
iw.getread return inconsist reader rt branch extend testcas testrollingupd testupdatesamedoc pull nrt reader updat assert alway see one document yet fail current branch sinc problem flush getread case happen flush thread releas lock let flush came enter flushallthread context continu could concurr get new segment transport global delet without correspond add sneak continu open nrt reader turn see inconsist result upload patch soon
multiphrasequeri assign differ score ident doc use 0 pos-incr two ident doc token b c zero pos-incr ie occur posit run multiphrasequeri b c pos incr 0 two doc get differ score despit ident admit 's strang queri think scorer ought count phrase tf=1 doc problem miss tie-break phrasequeri use exactphrasescor pq end flip/flop everi document get score ie even docid get one score odd docid get anoth score ad hard tie-break ord score howev 's separ bug over-count tf creat mpq like noformat mpq.add new term new term field 0 mpq.add new term new term field b new term field c 0 noformat get tf=2 per doc creat like noformat mpq.add new term new term field b new term field c 0 mpq.add new term new term field 0 noformat get tf=1 think correct happen multipletermposit freeli return posit union posit two stream term pos=0 ll get pos=0 twice good lead over-count tf unfortun n't see perform way fix 'm sure realli matter much practic
block tree term dict index default term index today break term block fix size ie everi 32 term new block build index top hold start term block better instead break term accord share prefix result variabl size block mean within block maxim share prefix minim result term index also speedup term dict intens queri term index becom true prefix trie use fast-fail term lookup ie return not_found without seek/scan term block true prefix trie also enabl much faster intersect automaton new issu ve made initi impl call blocktreetermswriter/read 's still work progress lot nocommit hairi code test pass least made two new codec temporarili call standardtre pulsingtre like counterpart use new term dict ad new exacton boolean termsenum.seek 's true term not_found quick return not_found enum unposit ie call next doc etc. approach index dict tight connect support pluggabl index impl like blocktermswriter/read block store certain node prefix trie contain term pointer sub-block ie block leaf block two tree tie one anoth index trie block certain node trie map block block tree think algorithm similar burst tri http //citeseer.ist.psu.edu/viewdoc/summari doi=10.1.1.18.3499 except allow term store inner block leaf block import lucen accident adversari could produc term dict way mani block way much ram use term index still current patch adversari produc too-big block may need fix let term index true prefix trie 's leaf edg exact block pick factor polici n't done yet burst trie one polici current approach anoth etc polici tune term expect distribut eg 's primari key field use base 10 charact want block size size 10 make sizabl differ lookup cost modifi fst builder allow plugin freez tail chang suffix ad term use find block
setflushpend fail concurr hit abort except select dwpt flush dwpt current flight hit except select flush num doc reset 0 trip except rather check 0 assert noformat junit testsuit org.apache.lucene.index.testindexwriterexcept junit testcas testrandomexceptionsthread org.apache.lucene.index.testindexwriterexcept fail junit thread index 3 hit unexpect failur junit junit.framework.assertionfailederror thread index 3 hit unexpect failur junit org.apache.lucene.index.testindexwriterexceptions.testrandomexceptionsthread testindexwriterexceptions.java:227 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1226 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1154 junit junit junit test run 18 failur 1 error 0 time elaps 30.287 sec junit junit standard output junit index 3 unexpect exception2 junit java.lang.assertionerror junit org.apache.lucene.index.documentswriterflushcontrol.setflushpend documentswriterflushcontrol.java:170 junit org.apache.lucene.index.flushpolicy.marklargestwriterpend flushpolicy.java:108 junit org.apache.lucene.index.flushbyramorcountspolicy.oninsert flushbyramorcountspolicy.java:61 junit org.apache.lucene.index.flushpolicy.onupd flushpolicy.java:77 junit org.apache.lucene.index.documentswriterflushcontrol.doafterdocu documentswriterflushcontrol.java:115 junit org.apache.lucene.index.documentswriter.updatedocu documentswriter.java:341 junit org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1367 junit org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1339 junit org.apache.lucene.index.testindexwriterexcept indexerthread.run testindexwriterexceptions.java:92 junit junit standard error junit note reproduc ant test -dtestcase=testindexwriterexcept -dtestmethod=testrandomexceptionsthread -dtests.seed=3493970007652348212:2010109588873167237 junit warn test method testrandomexceptionsthread left thread run merg thread _1v 4.0 cv2 _27 4.0 cv1 _2h junit warn test method testrandomexceptionsthread left thread run merg thread _2c 4.0 cv1 _2m junit resourc leak test method testrandomexceptionsthread left 2 thread run junit note test param codec=randomcodecprovid content=mockfixedintblock blocksize=421 field=mocksep id=simpletext other=mocksep contents=mockrandom content1=puls freqcutoff=11 content2=mocksep content4=simpletext content5=simpletext content6=mockrandom crash=mockrandom content7=mockvariableintblock baseblocksize=109 locale=mk_mk timezone=europe/malta junit note test run jvm junit testtoken testdatetool test2bterm testaddindex testfilterindexread testindexwriterexcept junit note linux 2.6.37-gentoo amd64/sun microsystem inc. 1.6.0_24 64-bit /cpus=8 threads=1 free=78897400 total=195821568 noformat
testindexwriterexcept fail npe realtim noformat junit testsuit org.apache.lucene.index.testindexwriterexcept junit testcas testrandomexceptionsthread org.apache.lucene.index.testindexwriterexcept caus error junit null junit java.lang.nullpointerexcept junit org.apache.lucene.index.documentswriterperthread.prepareflush documentswriterperthread.java:329 junit org.apache.lucene.index.documentswriter.doflush documentswriter.java:378 junit org.apache.lucene.index.documentswriter.flushallthread documentswriter.java:512 junit org.apache.lucene.index.indexwriter.doflush indexwriter.java:2619 junit org.apache.lucene.index.indexwriter.flush indexwriter.java:2594 junit org.apache.lucene.index.indexwriter.preparecommit indexwriter.java:2464 junit org.apache.lucene.index.indexwriter.commitintern indexwriter.java:2537 junit org.apache.lucene.index.indexwriter.commit indexwriter.java:2519 junit org.apache.lucene.index.indexwriter.commit indexwriter.java:2503 junit org.apache.lucene.index.testindexwriterexceptions.testrandomexceptionsthread testindexwriterexceptions.java:230 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1226 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1154 junit junit junit test run 18 failur 0 error 1 time elaps 22.548 sec junit junit standard error junit note reproduc ant test -dtestcase=testindexwriterexcept -dtestmethod=testrandomexceptionsthread -dtests.seed=-5079747362001734044:1572064802119081373 junit warn test method testrandomexceptionsthread left thread run merg thread _25 4.0 cv2/1 _29 4.0 cv2/1 _20 4.0 cv3/1 _2m junit resourc leak test method testrandomexceptionsthread left 1 thread run junit note test param codec=randomcodecprovid content=puls freqcutoff=2 field=mocksep id=puls freqcutoff=2 other=mocksep contents=simpletext content1=mocksep content2=simpletext content4=mockrandom content5=mockrandom content6=mockvariableintblock baseblocksize=41 crash=standard content7=mockfixedintblock blocksize=1633 locale=en_gb timezone=europe/vaduz junit note test run jvm junit testtoken testdatetool test2bterm testaddindex testfilterindexread testindexwriterexcept junit note linux 2.6.37-gentoo amd64/sun microsystem inc. 1.6.0_24 64-bit /cpus=8 threads=1 free=155417240 total=292945920 junit noformat
testaddindex testaddindexeswiththread fail realtim selckin report two failur lucene-3023 unfortun reproduc trace noformat junit testsuit org.apache.lucene.index.testaddindex junit testcas testaddindexeswiththread org.apache.lucene.index.testaddindex fail junit expect 3160 3060 junit junit.framework.assertionfailederror expect 3160 3060 junit org.apache.lucene.index.testaddindexes.testaddindexeswiththread testaddindexes.java:783 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1226 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1154 junit junit junit test run 18 failur 1 error 0 time elaps 14.272 sec junit junit standard error junit note reproduc ant test -dtestcase=testaddindex -dtestmethod=testaddindexeswiththread -dtests.seed=6128854208955988865:2552774338676281184 junit note test param codec=preflex locale=no_no_ni timezone=america/edmonton junit note test run jvm junit testtoken testdatetool test2bterm testaddindex junit note linux 2.6.37-gentoo amd64/sun microsystem inc. 1.6.0_24 64-bit /cpus=8 threads=1 free=84731792 total=258080768 junit noformat noformat junit testsuit org.apache.lucene.index.testaddindex junit testcas testaddindexeswiththread org.apache.lucene.index.testaddindex fail junit expect 3160 3060 junit junit.framework.assertionfailederror expect 3160 3060 junit org.apache.lucene.index.testaddindexes.testaddindexeswiththread testaddindexes.java:783 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1226 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1154 junit junit junit test run 18 failur 1 error 0 time elaps 14.841 sec junit junit standard error junit note reproduc ant test -dtestcase=testaddindex -dtestmethod=testaddindexeswiththread -dtests.seed=4502815121171887759 -6764285049309266272 junit note test param codec=preflex locale=tr_tr timezone=mexico/bajanort junit note test run jvm junit testtoken testdatetool test2bterm testaddindex junit note linux 2.6.37-gentoo amd64/sun microsystem inc. 1.6.0_24 64-bit /cpus=8 threads=1 free=163663416 total=243335168 junit noformat
testindexwriter.testcommitthreadsafeti fail realtime_search branch hudson fail rt error n't abl reproduc yet noformat note reproduc ant test -dtestcase=testindexwrit -dtestmethod=testcommitthreadsafeti -dtests.seed=410261592077577885 -4099127561715488589 -dtests.multiplier=3 note reproduc ant test -dtestcase=testindexwrit -dtestmethod=testcommitthreadsafeti -dtests.seed=410261592077577885 -4099127561715488589 -dtests.multiplier=3 follow except thrown thread thread thread-331 java.lang.runtimeexcept java.lang.assertionerror term=f:2_0 r=directoryread segments_6 _8 4.0 cv7 expect 1 0 org.apache.lucene.index.testindexwrit 5.run testindexwriter.java:2416 caus java.lang.assertionerror term=f:2_0 r=directoryread segments_6 _8 4.0 cv7 expect 1 0 org.junit.assert.fail assert.java:91 org.junit.assert.failnotequ assert.java:645 org.junit.assert.assertequ assert.java:126 org.junit.assert.assertequ assert.java:470 org.apache.lucene.index.testindexwrit 5.run testindexwriter.java:2410 note test param codec=randomcodecprovid =simpletext f6=mockvariableintblock baseblocksize=91 f7=mockfixedintblock blocksize=1289 f8=standard f9=mockrandom f1=mocksep f0=puls freqcutoff=15 f3=puls freqcutoff=15 f2=mockfixedintblock blocksize=1289 f5=mockvariableintblock baseblocksize=91 f4=mockrandom f=mocksep c=mockvariableintblock baseblocksize=91 termvector=simpletext d9=simpletext d8=mocksep d5=mockvariableintblock baseblocksize=91 d4=mockrandom d7=standard d6=simpletext d25=standard d0=mockvariableintblock baseblocksize=91 c29=standard d24=simpletext d1=mockfixedintblock blocksize=1289 c28=mockfixedintblock blocksize=1289 d23=mockvariableintblock baseblocksize=91 d2=standard c27=mockvariableintblock baseblocksize=91 d22=mockrandom d3=mockrandom d21=mockfixedintblock blocksize=1289 d20=mockvariableintblock baseblocksize=91 c22=mockvariableintblock baseblocksize=91 c21=mockrandom c20=puls freqcutoff=15 d29=mockvariableintblock baseblocksize=91 c26=simpletext d28=mockrandom c25=mocksep d27=puls freqcutoff=15 c24=mockrandom d26=mockfixedintblock blocksize=1289 c23=standard e9=mockrandom e8=mockfixedintblock blocksize=1289 e7=mockvariableintblock baseblocksize=91 e6=mocksep e5=puls freqcutoff=15 c17=standard e3=mockfixedintblock blocksize=1289 d12=simpletext c16=simpletext e4=puls freqcutoff=15 d11=mocksep c19=mocksep e1=mocksep d14=puls freqcutoff=15 c18=puls freqcutoff=15 e2=simpletext d13=mockfixedintblock blocksize=1289 e0=standard d10=standard d19=puls freqcutoff=15 c11=simpletext c10=mocksep d16=mockrandom c13=mocksep c12=puls freqcutoff=15 d15=standard d18=simpletext c15=mockfixedintblock blocksize=1289 d17=mocksep c14=mockvariableintblock baseblocksize=91 b3=mockrandom b2=standard b5=simpletext b4=mocksep b7=mocksep b6=puls freqcutoff=15 d50=mockvariableintblock baseblocksize=91 b9=mockfixedintblock blocksize=1289 b8=mockvariableintblock baseblocksize=91 d43=puls freqcutoff=15 d42=mockfixedintblock blocksize=1289 d41=simpletext d40=mocksep d47=mockrandom d46=standard b0=simpletext d45=mockfixedintblock blocksize=1289 b1=standard d44=mockvariableintblock baseblocksize=91 d49=mocksep d48=puls freqcutoff=15 c6=mockvariableintblock baseblocksize=91 c5=mockrandom c4=puls freqcutoff=15 c3=mockfixedintblock blocksize=1289 c9=mocksep c8=mockrandom c7=standard d30=mockfixedintblock blocksize=1289 d32=mockrandom d31=standard c1=mockvariableintblock baseblocksize=91 d34=standard c2=mockfixedintblock blocksize=1289 d33=simpletext d36=mocksep c0=mocksep d35=puls freqcutoff=15 d38=mockvariableintblock baseblocksize=91 d37=mockrandom d39=simpletext e92=mockfixedintblock blocksize=1289 e93=puls freqcutoff=15 e90=mocksep e91=simpletext e89=mockvariableintblock baseblocksize=91 e88=mocksep e87=puls freqcutoff=15 e86=simpletext e85=mocksep e84=mockrandom e83=standard e80=mockfixedintblock blocksize=1289 e81=standard e82=mockrandom e77=mockvariableintblock baseblocksize=91 e76=mockrandom e79=standard e78=simpletext e73=mocksep e72=puls freqcutoff=15 e75=mockfixedintblock blocksize=1289 e74=mockvariableintblock baseblocksize=91 binary=mockvariableintblock baseblocksize=91 f98=puls freqcutoff=15 f97=mockfixedintblock blocksize=1289 f99=mockrandom f94=standard f93=simpletext f96=mocksep f95=puls freqcutoff=15 e95=simpletext e94=mocksep e97=puls freqcutoff=15 e96=mockfixedintblock blocksize=1289 e99=mockfixedintblock blocksize=1289 e98=mockvariableintblock baseblocksize=91 id=mockrandom f34=standard f33=simpletext f32=mockvariableintblock baseblocksize=91 f31=mockrandom f30=mockfixedintblock blocksize=1289 f39=standard f38=mockvariableintblock baseblocksize=91 f37=mockrandom f36=puls freqcutoff=15 f35=mockfixedintblock blocksize=1289 f43=mocksep f42=puls freqcutoff=15 f45=mockfixedintblock blocksize=1289 f44=mockvariableintblock baseblocksize=91 f41=simpletext f40=mocksep f47=standard f46=simpletext f49=mocksep f48=puls freqcutoff=15 content=mocksep e19=simpletext e18=mocksep e17=standard f12=simpletext e16=simpletext f11=mocksep f10=mockrandom e15=mockvariableintblock baseblocksize=91 e14=mockrandom f16=mockrandom e13=mocksep f15=standard e12=puls freqcutoff=15 e11=standard f14=mockfixedintblock blocksize=1289 e10=simpletext f13=mockvariableintblock baseblocksize=91 f19=puls freqcutoff=15 f18=standard f17=simpletext e29=mockrandom e26=mocksep f21=puls freqcutoff=15 e25=puls freqcutoff=15 f20=mockfixedintblock blocksize=1289 e28=mockfixedintblock blocksize=1289 f23=mockvariableintblock baseblocksize=91 e27=mockvariableintblock baseblocksize=91 f22=mockrandom f25=simpletext e22=mockfixedintblock blocksize=1289 f24=mocksep e21=mockvariableintblock baseblocksize=91 f27=puls freqcutoff=15 e24=mockrandom f26=mockfixedintblock blocksize=1289 e23=standard f29=mockfixedintblock blocksize=1289 f28=mockvariableintblock baseblocksize=91 e20=puls freqcutoff=15 field=mockrandom string=standard e30=mockrandom e31=mockvariableintblock baseblocksize=91 a98=standard e34=mocksep a99=mockrandom e35=simpletext f79=mocksep e32=standard e33=mockrandom b97=mockrandom f77=mockrandom e38=standard b98=mockvariableintblock baseblocksize=91 f78=mockvariableintblock baseblocksize=91 e39=mockrandom b99=simpletext f75=mockfixedintblock blocksize=1289 e36=mockvariableintblock baseblocksize=91 f76=puls freqcutoff=15 e37=mockfixedintblock blocksize=1289 f73=puls freqcutoff=15 f74=mocksep f71=simpletext f72=standard f81=mockfixedintblock blocksize=1289 f80=mockvariableintblock baseblocksize=91 e40=standard e41=puls freqcutoff=15 e42=mocksep e43=mockfixedintblock blocksize=1289 e44=puls freqcutoff=15 e45=mockrandom e46=mockvariableintblock baseblocksize=91 f86=simpletext e47=mocksep f87=standard e48=simpletext f88=puls freqcutoff=15 e49=mockfixedintblock blocksize=1289 f89=mocksep f82=mockvariableintblock baseblocksize=91 f83=mockfixedintblock blocksize=1289 f84=standard f85=mockrandom f90=mockrandom f92=simpletext f91=mocksep str=mocksep a76=simpletext e56=simpletext f59=mockvariableintblock baseblocksize=91 a77=standard e57=standard a78=puls freqcutoff=15 e54=mockrandom f57=puls freqcutoff=15 a79=mocksep e55=mockvariableintblock baseblocksize=91 f58=mocksep e52=mockvariableintblock baseblocksize=91 e53=mockfixedintblock blocksize=1289 e50=puls freqcutoff=15 e51=mocksep f51=mockfixedintblock blocksize=1289 f52=puls freqcutoff=15 f50=simpletext f55=standard f56=mockrandom f53=mockvariableintblock baseblocksize=91 e58=mockfixedintblock blocksize=1289 f54=mockfixedintblock blocksize=1289 e59=puls freqcutoff=15 a80=mockrandom e60=mockrandom a82=simpletext a81=mocksep a84=mocksep a83=puls freqcutoff=15 a86=mockfixedintblock blocksize=1289 a85=mockvariableintblock baseblocksize=91 a89=standard f68=standard e65=puls freqcutoff=15 f69=mockrandom e66=mocksep a87=mockvariableintblock baseblocksize=91 e67=mockvariableintblock baseblocksize=91 a88=mockfixedintblock blocksize=1289 e68=mockfixedintblock blocksize=1289 e61=standard e62=mockrandom e63=mocksep e64=simpletext f60=mockrandom f61=mockvariableintblock baseblocksize=91 f62=simpletext f63=standard e69=simpletext f64=mocksep f65=simpletext f66=mockfixedintblock blocksize=1289 f67=puls freqcutoff=15 f70=mocksep a93=mockvariableintblock baseblocksize=91 a92=mockrandom a91=puls freqcutoff=15 e71=puls freqcutoff=15 a90=mockfixedintblock blocksize=1289 e70=mockfixedintblock blocksize=1289 a97=simpletext a96=mocksep a95=mockrandom a94=standard c58=mockfixedintblock blocksize=1289 a63=mockvariableintblock baseblocksize=91 a64=mockfixedintblock blocksize=1289 c59=puls freqcutoff=15 c56=mocksep d59=mockrandom a61=puls freqcutoff=15 c57=simpletext a62=mocksep c54=simpletext c55=standard a60=simpletext c52=mockrandom c53=mockvariableintblock baseblocksize=91 d53=standard d54=mockrandom d51=mockvariableintblock baseblocksize=91 d52=mockfixedintblock blocksize=1289 d57=puls freqcutoff=15 b62=mockfixedintblock blocksize=1289 d58=mocksep b63=puls freqcutoff=15 d55=simpletext b60=mocksep d56=standard b61=simpletext b56=simpletext b55=mocksep b54=mockrandom b53=standard d61=simpletext b59=mockvariableintblock baseblocksize=91 d60=mocksep b58=mocksep b57=puls freqcutoff=15 c62=mocksep c61=puls freqcutoff=15 a59=puls freqcutoff=15 c60=standard a58=mockfixedintblock blocksize=1289 a57=mocksep a56=puls freqcutoff=15 a55=standard a54=simpletext a72=standard c67=mockrandom a73=mockrandom c68=mockvariableintblock baseblocksize=91 a74=mocksep c69=simpletext a75=simpletext c63=puls freqcutoff=15 c64=mocksep a70=mockrandom c65=mockvariableintblock baseblocksize=91 a71=mockvariableintblock baseblocksize=91 c66=mockfixedintblock blocksize=1289 d62=mocksep d63=simpletext d64=mockfixedintblock blocksize=1289 b70=mockfixedintblock blocksize=1289 d65=puls freqcutoff=15 b71=mockrandom d66=mockvariableintblock baseblocksize=91 b72=mockvariableintblock baseblocksize=91 d67=mockfixedintblock blocksize=1289 b73=simpletext d68=standard b74=standard d69=mockrandom b65=puls freqcutoff=15 b64=mockfixedintblock blocksize=1289 b67=mockvariableintblock baseblocksize=91 b66=mockrandom d70=puls freqcutoff=15 b69=mockrandom b68=standard d72=mockvariableintblock baseblocksize=91 d71=mockrandom c71=mockfixedintblock blocksize=1289 c70=mockvariableintblock baseblocksize=91 a69=simpletext c73=mockrandom c72=standard a66=mockfixedintblock blocksize=1289 a65=mockvariableintblock baseblocksize=91 a68=mockrandom a67=standard c32=mocksep c33=simpletext c30=standard c31=mockrandom c36=mockvariableintblock baseblocksize=91 a41=mockrandom c37=mockfixedintblock blocksize=1289 a42=mockvariableintblock baseblocksize=91 a0=simpletext c34=puls freqcutoff=15 c35=mocksep a40=puls freqcutoff=15 b84=puls freqcutoff=15 d79=mocksep b85=mocksep b82=simpletext d77=standard c38=simpletext b83=standard d78=mockrandom c39=standard b80=standard d75=mockrandom b81=mockrandom d76=mockvariableintblock baseblocksize=91 d73=mockfixedintblock blocksize=1289 d74=puls freqcutoff=15 d83=standard a9=mocksep d82=simpletext d81=mockvariableintblock baseblocksize=91 d80=mockrandom b79=mocksep b78=standard b77=simpletext b76=mockvariableintblock baseblocksize=91 b75=mockrandom a1=simpletext a35=puls freqcutoff=15 a2=standard a34=mockfixedintblock blocksize=1289 a3=puls freqcutoff=15 a33=simpletext a4=mocksep a32=mocksep a5=mockfixedintblock blocksize=1289 a39=mockrandom c40=puls freqcutoff=15 a6=puls freqcutoff=15 a38=standard a7=mockrandom a37=mockfixedintblock blocksize=1289 a8=mockvariableintblock baseblocksize=91 a36=mockvariableintblock baseblocksize=91 c41=mockfixedintblock blocksize=1289 c42=puls freqcutoff=15 c43=mockrandom c44=mockvariableintblock baseblocksize=91 c45=standard a50=simpletext c46=mockrandom a51=standard c47=mocksep a52=puls freqcutoff=15 c48=simpletext a53=mocksep b93=mockvariableintblock baseblocksize=91 d88=mockfixedintblock blocksize=1289 c49=mockvariableintblock baseblocksize=91 b94=mockfixedintblock blocksize=1289 d89=puls freqcutoff=15 b95=standard b96=mockrandom d84=simpletext b90=simpletext d85=standard b91=mockfixedintblock blocksize=1289 d86=puls freqcutoff=15 b92=puls freqcutoff=15 d87=mocksep d92=mocksep d91=puls freqcutoff=15 d94=mockfixedintblock blocksize=1289 d93=mockvariableintblock baseblocksize=91 b87=mocksep b86=puls freqcutoff=15 d90=simpletext b89=mockfixedintblock blocksize=1289 b88=mockvariableintblock baseblocksize=91 a44=mockvariableintblock baseblocksize=91 a43=mockrandom a46=standard a45=simpletext a48=simpletext a47=mocksep c51=standard a49=mockfixedintblock blocksize=1289 c50=simpletext d98=mockfixedintblock blocksize=1289 d97=mockvariableintblock baseblocksize=91 d96=mocksep d95=puls freqcutoff=15 d99=mockrandom a20=mockrandom c99=mockvariableintblock baseblocksize=91 c98=mockrandom c97=puls freqcutoff=15 c96=mockfixedintblock blocksize=1289 b19=mockvariableintblock baseblocksize=91 a16=simpletext a17=standard b17=puls freqcutoff=15 a14=mockrandom b18=mocksep a15=mockvariableintblock baseblocksize=91 a12=mockvariableintblock baseblocksize=91 a13=mockfixedintblock blocksize=1289 a10=puls freqcutoff=15 a11=mocksep b11=mockfixedintblock blocksize=1289 b12=puls freqcutoff=15 b10=simpletext b15=standard b16=mockrandom a18=mockfixedintblock blocksize=1289 b13=mockvariableintblock baseblocksize=91 a19=puls freqcutoff=15 b14=mockfixedintblock blocksize=1289 b30=mocksep a31=puls freqcutoff=15 a30=mockfixedintblock blocksize=1289 b28=standard a25=puls freqcutoff=15 b29=mockrandom a26=mocksep a27=mockvariableintblock baseblocksize=91 a28=mockfixedintblock blocksize=1289 a21=standard a22=mockrandom a23=mocksep a24=simpletext b20=mockrandom b21=mockvariableintblock baseblocksize=91 b22=simpletext b23=standard a29=simpletext b24=mocksep b25=simpletext b26=mockfixedintblock blocksize=1289 b27=puls freqcutoff=15 b41=mockfixedintblock blocksize=1289 b40=mockvariableintblock baseblocksize=91 c77=mockrandom c76=standard c75=mockfixedintblock blocksize=1289 c74=mockvariableintblock baseblocksize=91 c79=standard c78=simpletext c80=mockvariableintblock baseblocksize=91 c83=mocksep c84=simpletext c81=standard b39=mocksep c82=mockrandom b37=mockrandom b38=mockvariableintblock baseblocksize=91 b35=mockfixedintblock blocksize=1289 b36=puls freqcutoff=15 b33=puls freqcutoff=15 b34=mocksep b31=simpletext b32=standard str2=puls freqcutoff=15 b50=mockrandom b52=simpletext str3=mockrandom b51=mocksep c86=simpletext tvtest=mocksep c85=mocksep c88=puls freqcutoff=15 c87=mockfixedintblock blocksize=1289 c89=mockvariableintblock baseblocksize=91 c90=puls freqcutoff=15 c91=mocksep c92=mockfixedintblock blocksize=1289 c93=puls freqcutoff=15 c94=mockrandom c95=mockvariableintblock baseblocksize=91 content1=mocksep b46=simpletext b47=standard content3=standard b48=puls freqcutoff=15 content4=simpletext b49=mocksep content5=mockrandom b42=mockvariableintblock baseblocksize=91 b43=mockfixedintblock blocksize=1289 b44=standard b45=mockrandom locale=lv_lv timezone=australia/lindeman note test run jvm testnumerictokenstream testindexfiledelet testindexinput testindexreaderclonenorm testindexreaderreopen testindexwrit note freebsd 8.2-releas amd64/sun microsystem inc. 1.6.0 64-bit /cpus=16 threads=1 free=44228576 total=213778432 noformat
testfsts.testrealterm produc corrupt index seem prox/skip relat test pass checkindex upon close fail ant test-cor -dtestcase=testfst -dtests.seed=-4012305283315171209:0 -dtests.multiplier=3 -dtests.nightly=tru -dtests.linedocsfile=c /data/enwiki.random.lines.txt.gz note get enwiki.random.lines.txt.gz fetch hudson warn 1 gigabyt file also run test time trigger ill upload index thing make issu
analysi consum use reusabl tokenstream analysi consum highlight like memori index contrib querypars use analyzer.tokenstream use analyzer.reusabletokenstream instead better perform
attributesourc invalid comput state work tokenstream consum reus add attribut comput state wrong thus exampl clearattribut actual clear attribut ad situat addattribut actual clear comput state
o.a.l.analysis.de.germanstemm crash input see test lucene-2560 germananalyz longer use stemmer default fix
thaiwordfilt use attributesource.copyto incorrect bug seen https //builds.apache.org/hudson/job/lucene-solr-tests-only-3.x/7367/ look like issu lazi initi clone token tokenstream reus consum interest differ set attribut could problem one probably-probably-not-totally-correct fix would add clonedtoken null reset least would solv case
querynodeimpl.containstag string lowercas tag key querynodeimpl.containstag string key tag key suppos case insensit howev querynodeimpl.containstag method consid case look tag *bug found karsten fissmer
n't call segmentinfo.sizeinbyt merg segment selckin run lucen 's test rt branch hit noformat junit testsuit org.apache.lucene.index.testindexwrit junit testcas testdeleteallslowli org.apache.lucene.index.testindexwrit fail junit thread threw uncaught except junit junit.framework.assertionfailederror thread threw uncaught except junit org.apache.lucene.util.lucenetestcase.teardown lucenetestcase.java:535 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1246 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1175 junit junit junit test run 67 failur 1 error 0 time elaps 38.357 sec junit junit standard error junit note reproduc ant test -dtestcase=testindexwrit -dtestmethod=testdeleteallslowli -dtests.seed=-4291771462012978364:4550117847390778918 junit follow except thrown thread junit thread lucen merg thread 1 junit org.apache.lucene.index.mergepolici mergeexcept java.io.filenotfoundexcept _4_1.del junit org.apache.lucene.index.concurrentmergescheduler.handlemergeexcept concurrentmergescheduler.java:507 junit org.apache.lucene.index.concurrentmergeschedul mergethread.run concurrentmergescheduler.java:472 junit caus java.io.filenotfoundexcept _4_1.del junit org.apache.lucene.store.fsdirectory.filelength fsdirectory.java:290 junit org.apache.lucene.store.mockdirectorywrapper.filelength mockdirectorywrapper.java:549 junit org.apache.lucene.index.segmentinfo.sizeinbyt segmentinfo.java:287 junit org.apache.lucene.index.indexwriter.mergemiddl indexwriter.java:3280 junit org.apache.lucene.index.indexwriter.merg indexwriter.java:2956 junit org.apache.lucene.index.concurrentmergescheduler.domerg concurrentmergescheduler.java:379 junit org.apache.lucene.index.concurrentmergeschedul mergethread.run concurrentmergescheduler.java:447 junit note test param codec=randomcodecprovid =simpletext f6=puls freqcutoff=15 f7=mockfixedintblock blocksize=1606 f8=simpletext f9=mocksep f1=mockvariableintblock baseblocksize=99 f0=mockfixedintblock blocksize=1606 f3=puls freqcutoff=15 f2=mocksep f5=simpletext f4=standard f=mockfixedintblock blocksize=1606 c=mocksep termvector=mockrandom d9=mockfixedintblock blocksize=1606 d8=puls freqcutoff=15 d5=simpletext d4=standard d7=mockrandom d6=mockvariableintblock baseblocksize=99 d25=mockrandom d0=mockrandom c29=mockfixedintblock blocksize=1606 d24=mockvariableintblock baseblocksize=99 d1=standard c28=standard d23=simpletext d2=mockfixedintblock blocksize=1606 c27=mockrandom d22=standard d3=mockvariableintblock baseblocksize=99 d21=puls freqcutoff=15 d20=mocksep c22=mockfixedintblock blocksize=1606 c21=puls freqcutoff=15 c20=mockrandom d29=mockfixedintblock blocksize=1606 c26=standard d28=puls freqcutoff=15 c25=mockrandom d27=mockrandom c24=mocksep d26=mockvariableintblock baseblocksize=99 c23=simpletext e9=mockrandom e8=mocksep e7=simpletext e6=mockfixedintblock blocksize=1606 e5=puls freqcutoff=15 c17=mockfixedintblock blocksize=1606 e3=standard d12=mockvariableintblock baseblocksize=99 c16=puls freqcutoff=15 e4=simpletext d11=mockfixedintblock blocksize=1606 c19=mocksep e1=mocksep d14=puls freqcutoff=15 c18=simpletext e2=puls freqcutoff=15 d13=mocksep e0=mockvariableintblock baseblocksize=99 d10=standard d19=mockvariableintblock baseblocksize=99 c11=simpletext c10=standard d16=puls freqcutoff=15 c13=mockrandom c12=mockvariableintblock baseblocksize=99 d15=mocksep d18=simpletext c15=mockfixedintblock blocksize=1606 d17=standard c14=puls freqcutoff=15 b3=mocksep b2=simpletext b5=standard b4=mockrandom b7=mockvariableintblock baseblocksize=99 b6=mockfixedintblock blocksize=1606 d50=mockfixedintblock blocksize=1606 b9=puls freqcutoff=15 b8=mocksep d43=mocksep d42=simpletext d41=mockfixedintblock blocksize=1606 d40=puls freqcutoff=15 d47=mockvariableintblock baseblocksize=99 d46=mockfixedintblock blocksize=1606 b0=mockvariableintblock baseblocksize=99 d45=standard b1=mockrandom d44=mockrandom d49=mockvariableintblock baseblocksize=99 d48=mockfixedintblock blocksize=1606 c6=puls freqcutoff=15 c5=mocksep c4=mockvariableintblock baseblocksize=99 c3=mockfixedintblock blocksize=1606 c9=mockvariableintblock baseblocksize=99 c8=simpletext c7=standard d30=simpletext d32=mockrandom d31=mockvariableintblock baseblocksize=99 c1=simpletext d34=mockfixedintblock blocksize=1606 c2=mocksep d33=puls freqcutoff=15 d36=mocksep c0=mockfixedintblock blocksize=1606 d35=simpletext d38=mocksep d37=simpletext d39=mockrandom e92=mockfixedintblock blocksize=1606 e93=mockvariableintblock baseblocksize=99 e90=mockrandom e91=standard e89=mockvariableintblock baseblocksize=99 e88=simpletext e87=standard e86=puls freqcutoff=15 e85=mocksep e84=mockvariableintblock baseblocksize=99 e83=mockfixedintblock blocksize=1606 e80=mockfixedintblock blocksize=1606 e81=simpletext e82=mocksep e77=mockvariableintblock baseblocksize=99 e76=mockfixedintblock blocksize=1606 e79=puls freqcutoff=15 e78=mocksep e73=mocksep e72=simpletext e75=standard e74=mockrandom binary=mockfixedintblock blocksize=1606 f98=puls freqcutoff=15 f97=mocksep f99=standard f94=standard f93=mockrandom f96=mockvariableintblock baseblocksize=99 f95=mockfixedintblock blocksize=1606 e95=simpletext e94=standard e97=mockrandom e96=mockvariableintblock baseblocksize=99 e99=mockfixedintblock blocksize=1606 e98=puls freqcutoff=15 id=mockfixedintblock blocksize=1606 f34=mocksep f33=simpletext f32=mockfixedintblock blocksize=1606 f31=puls freqcutoff=15 f30=mockrandom f39=mockfixedintblock blocksize=1606 f38=standard f37=mockrandom f36=mocksep f35=simpletext f43=standard f42=mockrandom f45=mockvariableintblock baseblocksize=99 f44=mockfixedintblock blocksize=1606 f41=mocksep f40=simpletext f47=mockvariableintblock baseblocksize=99 f46=mockfixedintblock blocksize=1606 f49=puls freqcutoff=15 f48=mocksep content=puls freqcutoff=15 e19=standard e18=mockrandom e17=mocksep f12=puls freqcutoff=15 e16=simpletext f11=mocksep f10=mockvariableintblock baseblocksize=99 e15=mockfixedintblock blocksize=1606 e14=puls freqcutoff=15 f16=simpletext e13=mockfixedintblock blocksize=1606 f15=standard e12=puls freqcutoff=15 e11=mockrandom f14=puls freqcutoff=15 e10=mockvariableintblock baseblocksize=99 f13=mocksep f19=puls freqcutoff=15 f18=mockrandom f17=mockvariableintblock baseblocksize=99 e29=mocksep e26=standard f21=simpletext e25=mockrandom f20=standard e28=mockvariableintblock baseblocksize=99 f23=mockrandom e27=mockfixedintblock blocksize=1606 f22=mockvariableintblock baseblocksize=99 f25=mockrandom e22=mocksep f24=mockvariableintblock baseblocksize=99 e21=simpletext f27=mockfixedintblock blocksize=1606 e24=standard f26=puls freqcutoff=15 e23=mockrandom f29=mocksep f28=simpletext e20=mockfixedintblock blocksize=1606 field=puls freqcutoff=15 string=mockvariableintblock baseblocksize=99 e30=puls freqcutoff=15 e31=mockfixedintblock blocksize=1606 a98=mockfixedintblock blocksize=1606 e34=mockrandom a99=mockvariableintblock baseblocksize=99 e35=standard f79=puls freqcutoff=15 e32=simpletext e33=mocksep b97=puls freqcutoff=15 f77=puls freqcutoff=15 e38=mockfixedintblock blocksize=1606 b98=mockfixedintblock blocksize=1606 f78=mockfixedintblock blocksize=1606 e39=mockvariableintblock baseblocksize=99 b99=simpletext f75=mockvariableintblock baseblocksize=99 e36=mockrandom f76=mockrandom e37=standard f73=standard f74=simpletext f71=mocksep f72=puls freqcutoff=15 f81=puls freqcutoff=15 f80=mocksep e40=mocksep e41=mockrandom e42=standard e43=mockfixedintblock blocksize=1606 e44=mockvariableintblock baseblocksize=99 e45=mocksep e46=puls freqcutoff=15 f86=simpletext e47=mocksep f87=mocksep e48=puls freqcutoff=15 f88=mockrandom e49=standard f89=standard f82=mockvariableintblock baseblocksize=99 f83=mockrandom f84=puls freqcutoff=15 f85=mockfixedintblock blocksize=1606 f90=simpletext f92=mockrandom f91=mockvariableintblock baseblocksize=99 str=mockfixedintblock blocksize=1606 a76=mockvariableintblock baseblocksize=99 e56=mockvariableintblock baseblocksize=99 f59=mocksep a77=mockrandom e57=mockrandom a78=puls freqcutoff=15 e54=standard f57=mockfixedintblock blocksize=1606 a79=mockfixedintblock blocksize=1606 e55=simpletext f58=mockvariableintblock baseblocksize=99 e52=mocksep e53=puls freqcutoff=15 e50=mockfixedintblock blocksize=1606 e51=mockvariableintblock baseblocksize=99 f51=simpletext f52=mocksep f50=mockfixedintblock blocksize=1606 f55=mockfixedintblock blocksize=1606 f56=mockvariableintblock baseblocksize=99 f53=mockrandom e58=mockvariableintblock baseblocksize=99 f54=standard e59=mockrandom a80=mockvariableintblock baseblocksize=99 e60=mockvariableintblock baseblocksize=99 a82=puls freqcutoff=15 a81=mocksep a84=simpletext a83=standard a86=mockrandom a85=mockvariableintblock baseblocksize=99 a89=mockrandom f68=standard e65=puls freqcutoff=15 f69=simpletext e66=mockfixedintblock blocksize=1606 a87=simpletext e67=simpletext a88=mocksep e68=mocksep e61=standard e62=simpletext e63=mockvariableintblock baseblocksize=99 e64=mockrandom f60=mockrandom f61=standard f62=mockfixedintblock blocksize=1606 f63=mockvariableintblock baseblocksize=99 e69=simpletext f64=mocksep f65=puls freqcutoff=15 f66=standard f67=simpletext f70=standard a93=mockrandom a92=mockvariableintblock baseblocksize=99 a91=simpletext e71=simpletext a90=standard e70=standard a97=mocksep a96=simpletext a95=mockfixedintblock blocksize=1606 a94=puls freqcutoff=15 c58=mockrandom a63=puls freqcutoff=15 a64=mockfixedintblock blocksize=1606 c59=standard c56=simpletext d59=mockvariableintblock baseblocksize=99 a61=mockvariableintblock baseblocksize=99 c57=mocksep a62=mockrandom c54=puls freqcutoff=15 c55=mockfixedintblock blocksize=1606 a60=simpletext c52=mockvariableintblock baseblocksize=99 c53=mockrandom d53=mocksep d54=puls freqcutoff=15 d51=mockfixedintblock blocksize=1606 d52=mockvariableintblock baseblocksize=99 d57=mockvariableintblock baseblocksize=99 b62=mocksep d58=mockrandom b63=puls freqcutoff=15 d55=standard b60=mockfixedintblock blocksize=1606 d56=simpletext b61=mockvariableintblock baseblocksize=99 b56=simpletext b55=standard b54=puls freqcutoff=15 b53=mocksep d61=mockvariableintblock baseblocksize=99 b59=puls freqcutoff=15 d60=mockfixedintblock blocksize=1606 b58=mockrandom b57=mockvariableintblock baseblocksize=99 c62=mockrandom c61=mockvariableintblock baseblocksize=99 a59=standard c60=simpletext a58=mockrandom a57=mocksep a56=simpletext a55=mockfixedintblock blocksize=1606 a54=puls freqcutoff=15 a72=simpletext c67=mockfixedintblock blocksize=1606 a73=mocksep c68=mockvariableintblock baseblocksize=99 a74=mockrandom c69=mocksep a75=standard c63=simpletext c64=mocksep a70=puls freqcutoff=15 c65=mockrandom a71=mockfixedintblock blocksize=1606 c66=standard d62=standard d63=simpletext d64=mockvariableintblock baseblocksize=99 b70=puls freqcutoff=15 d65=mockrandom b71=standard d66=puls freqcutoff=15 b72=simpletext d67=mockfixedintblock blocksize=1606 b73=mockvariableintblock baseblocksize=99 d68=simpletext b74=mockrandom d69=mocksep b65=mockrandom b64=mockvariableintblock baseblocksize=99 b67=mockfixedintblock blocksize=1606 b66=puls freqcutoff=15 d70=puls freqcutoff=15 b69=mocksep b68=simpletext d72=simpletext d71=standard c71=mockfixedintblock blocksize=1606 c70=puls freqcutoff=15 a69=mocksep c73=mocksep c72=simpletext a66=standard a65=mockrandom a68=mockvariableintblock baseblocksize=99 a67=mockfixedintblock blocksize=1606 c32=mockfixedintblock blocksize=1606 c33=mockvariableintblock baseblocksize=99 c30=mockrandom c31=standard c36=standard a41=mockfixedintblock blocksize=1606 c37=simpletext a42=mockvariableintblock baseblocksize=99 a0=mocksep c34=mocksep c35=puls freqcutoff=15 a40=standard b84=simpletext d79=mockfixedintblock blocksize=1606 b85=mocksep b82=puls freqcutoff=15 d77=mockrandom c38=standard b83=mockfixedintblock blocksize=1606 d78=standard c39=simpletext b80=mockvariableintblock baseblocksize=99 d75=simpletext b81=mockrandom d76=mocksep d73=puls freqcutoff=15 d74=mockfixedintblock blocksize=1606 d83=mockfixedintblock blocksize=1606 a9=mockvariableintblock baseblocksize=99 d82=puls freqcutoff=15 d81=mockrandom d80=mockvariableintblock baseblocksize=99 b79=mockfixedintblock blocksize=1606 b78=standard b77=mockrandom b76=mocksep b75=simpletext a1=mockfixedintblock blocksize=1606 a35=puls freqcutoff=15 a2=mockvariableintblock baseblocksize=99 a34=mocksep a3=mocksep a33=mockvariableintblock baseblocksize=99 a4=puls freqcutoff=15 a32=mockfixedintblock blocksize=1606 a5=standard a39=mockrandom c40=standard a6=simpletext a38=mockvariableintblock baseblocksize=99 a7=mockvariableintblock baseblocksize=99 a37=simpletext a8=mockrandom a36=standard c41=mocksep c42=puls freqcutoff=15 c43=standard c44=simpletext c45=mockvariableintblock baseblocksize=99 a50=mocksep c46=mockrandom a51=puls freqcutoff=15 c47=puls freqcutoff=15 a52=standard c48=mockfixedintblock blocksize=1606 a53=simpletext b93=mockrandom d88=mocksep c49=puls freqcutoff=15 b94=standard d89=puls freqcutoff=15 b95=mockfixedintblock blocksize=1606 b96=mockvariableintblock baseblocksize=99 d84=mockrandom b90=mockfixedintblock blocksize=1606 d85=standard b91=simpletext d86=mockfixedintblock blocksize=1606 b92=mocksep d87=mockvariableintblock baseblocksize=99 d92=mocksep d91=simpletext d94=standard d93=mockrandom b87=mockvariableintblock baseblocksize=99 b86=mockfixedintblock blocksize=1606 d90=mockfixedintblock blocksize=1606 b89=puls freqcutoff=15 b88=mocksep a44=simpletext a43=standard a46=mockrandom a45=mockvariableintblock baseblocksize=99 a48=mockfixedintblock blocksize=1606 a47=puls freqcutoff=15 c51=puls freqcutoff=15 a49=simpletext c50=mocksep d98=mockvariableintblock baseblocksize=99 d97=mockfixedintblock blocksize=1606 d96=standard d95=mockrandom d99=mocksep a20=mocksep c99=mockrandom c98=mockvariableintblock baseblocksize=99 c97=simpletext c96=standard b19=mockrandom a16=mocksep a17=puls freqcutoff=15 b17=simpletext a14=mockfixedintblock blocksize=1606 b18=mocksep a15=mockvariableintblock baseblocksize=99 a12=mockrandom a13=standard a10=simpletext a11=mocksep b11=mockvariableintblock baseblocksize=99 b12=mockrandom b10=simpletext b15=simpletext b16=mocksep a18=mocksep b13=puls freqcutoff=15 a19=puls freqcutoff=15 b14=mockfixedintblock blocksize=1606 b30=mockfixedintblock blocksize=1606 a31=mockvariableintblock baseblocksize=99 a30=mockfixedintblock blocksize=1606 b28=mockfixedintblock blocksize=1606 a25=standard b29=mockvariableintblock baseblocksize=99 a26=simpletext a27=mockvariableintblock baseblocksize=99 a28=mockrandom a21=mockfixedintblock blocksize=1606 a22=mockvariableintblock baseblocksize=99 a23=mocksep a24=puls freqcutoff=15 b20=puls freqcutoff=15 b21=mockfixedintblock blocksize=1606 b22=simpletext b23=mocksep a29=mockvariableintblock baseblocksize=99 b24=mockrandom b25=standard b26=mockfixedintblock blocksize=1606 b27=mockvariableintblock baseblocksize=99 b41=standard b40=mockrandom c77=standard c76=mockrandom c75=mocksep c74=simpletext c79=mockvariableintblock baseblocksize=99 c78=mockfixedintblock blocksize=1606 c80=mockrandom c83=simpletext c84=mocksep c81=puls freqcutoff=15 b39=standard c82=mockfixedintblock blocksize=1606 b37=standard b38=simpletext b35=mocksep b36=puls freqcutoff=15 b33=mockfixedintblock blocksize=1606 b34=mockvariableintblock baseblocksize=99 b31=mockrandom b32=standard str2=mockfixedintblock blocksize=1606 b50=mockvariableintblock baseblocksize=99 b52=puls freqcutoff=15 str3=simpletext b51=mocksep c86=mockvariableintblock baseblocksize=99 tvtest=mocksep c85=mockfixedintblock blocksize=1606 c88=puls freqcutoff=15 c87=mocksep c89=standard c90=simpletext c91=mocksep c92=mockrandom c93=standard c94=mockfixedintblock blocksize=1606 c95=mockvariableintblock baseblocksize=99 content1=puls freqcutoff=15 b46=mockvariableintblock baseblocksize=99 b47=mockrandom content3=mockvariableintblock baseblocksize=99 b48=puls freqcutoff=15 content4=mockfixedintblock blocksize=1606 b49=mockfixedintblock blocksize=1606 content5=standard b42=mocksep b43=puls freqcutoff=15 b44=standard b45=simpletext locale=tr timezone=met junit note test run jvm junit testmergeschedulerextern testchartoken testcodec testfieldinfo testflushbyramorcountspolici testindexreaderreopen testindexwrit junit note linux 2.6.37-gentoo amd64/sun microsystem inc. 1.6.0_25 64-bit /cpus=8 threads=1 free=69508608 total=127336448 noformat simon dug look like trunk issu caus lucene-1076 commit trunk far
perfieldcodecwrapper.loadtermsindex concurr problem selckin 's 1 test rt branch hit anoth error noformat junit testsuit org.apache.lucene.testexternalcodec junit testcas testperfieldcodec org.apache.lucene.testexternalcodec caus error junit null junit java.lang.nullpointerexcept junit org.apache.lucene.index.perfieldcodecwrapp fieldsreader.loadtermsindex perfieldcodecwrapper.java:202 junit org.apache.lucene.index.segmentreader.loadtermsindex segmentreader.java:1005 junit org.apache.lucene.index.indexwrit readerpool.get indexwriter.java:652 junit org.apache.lucene.index.indexwrit readerpool.get indexwriter.java:609 junit org.apache.lucene.index.buffereddeletesstream.applydelet buffereddeletesstream.java:276 junit org.apache.lucene.index.indexwriter.applyalldelet indexwriter.java:2660 junit org.apache.lucene.index.indexwriter.maybeapplydelet indexwriter.java:2651 junit org.apache.lucene.index.indexwriter.getread indexwriter.java:381 junit org.apache.lucene.index.indexreader.open indexreader.java:316 junit org.apache.lucene.testexternalcodecs.testperfieldcodec testexternalcodecs.java:541 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1246 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1175 junit junit junit test run 1 failur 0 error 1 time elaps 0.909 sec junit junit standard error junit note reproduc ant test -dtestcase=testexternalcodec -dtestmethod=testperfieldcodec -dtests.seed=-7296204858082494534:5010909751437000758 junit warn test method testperfieldcodec left thread run merg thread _i 4.0 cv130 _m 4.0 cv30 _n 4.0 cv10 _o junit resourc leak test method testperfieldcodec left 1 thread run junit note test param codec=preflex locale=zh_tw timezone=america/santo_domingo junit note test run jvm junit testdemo testexternalcodec junit note linux 2.6.37-gentoo amd64/sun microsystem inc. 1.6.0_25 64-bit /cpus=8 threads=2 free=104153512 total=125632512 junit junit test org.apache.lucene.testexternalcodec fail junit except thread lucen merg thread 5 org.apache.lucene.util.threadinterruptedexcept java.lang.interruptedexcept sleep interrupt junit org.apache.lucene.index.concurrentmergescheduler.handlemergeexcept concurrentmergescheduler.java:505 junit org.apache.lucene.index.concurrentmergeschedul mergethread.run concurrentmergescheduler.java:472 junit caus java.lang.interruptedexcept sleep interrupt junit java.lang.thread.sleep nativ method junit org.apache.lucene.index.concurrentmergescheduler.handlemergeexcept concurrentmergescheduler.java:503 junit 1 noformat suspect also trunk issu ca n't reproduc yet think happen codec hashmap chang via anoth thread .loadtermsindex call
improv test coverag multi* seem like easi win test call newsearch sometim wrap reader slowmultireaderwrapp
sortertemplate.quicksort stack overflow broken compar produc disticnt valu larg array look oti 's sort problem mail list said noformat look place call made found multiphrasequeri multiphraseweight chang call arrayutil.quicksort arrayutil.mergesort longer see sortertemplate.quicksort deep recurs thread dump noformat thought interest postingsandfreq 's compar look like need tiebreak think sort add assert tri catch broken compar
lucenetestcas newfsdirectoryimpl miss set lockfactori ctor call throw except selckin report irc run ant test -dtestcase=testlockfactori -dtestmethod=testnativefslockfactoryprefix -dtests.directory=fsdirectori test fail sinc fsdirectori abstract class instanti code fall back fsdirector.open yet miss set given lockfactori though
fst allow one output input block tree term dict turn need case
pulsingtermstate.clon leak memori look heap dump oom morn thank uwe turn think 's real memori leak well realli leak rather clone pulsingtermst cach term dict cach hang onto larg byte unnecessarili
open indexwrit api allow custom mergeschedul implement indexwrit 's getnextmerg merg onemerg package-priv make imposs someon implement mergeschedul open api well use custom ms implement
testbytesrefhash testcompact broken testbytesrefhash testcompact fail run ant test -dtestcase=testbytesrefhash -dtestmethod=testcompact -dtests.seed=-7961072421643387492:5612141247152835360 noformat junit testsuit org.apache.lucene.util.testbytesrefhash junit test run 1 failur 0 error 1 time elaps 0.454 sec junit junit standard error junit note reproduc ant test -dtestcase=testbytesrefhash -dtestmethod=testcompact -dtests.seed=-7961072421643387492:5612141247152835360 junit note test param codec=preflex locale=et timezone=pacific/tah junit note test run jvm junit testbytesrefhash junit note linux 2.6.35-28-gener amd64/sun microsystem inc. 1.6.0_24 64-bit /cpus=12 threads=1 free=363421800 total=379322368 junit junit testcas testcompact org.apache.lucene.util.testbytesrefhash caus error junit bitindex 0 -27 junit java.lang.indexoutofboundsexcept bitindex 0 -27 junit java.util.bitset.set bitset.java:262 junit org.apache.lucene.util.testbytesrefhash.testcompact testbytesrefhash.java:146 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1260 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1189 junit junit junit test org.apache.lucene.util.testbytesrefhash fail noformat test expect _testutil.randomrealisticunicodestr random 1000 never return string upload patch soon
factor chartokenizer/characterutil analyz modul current analysi compon lucen core realli .util analyz modul also mocktoken extend token direct add addit check futur tri ensur consum good consum e.g call reset mention http //wiki.apache.org/lucene-java/testidea n't implement yet factor think tri lucene-3040
add check mocktoken enforc proper consumpt enforc thing like consum proper iter tokenstream lifeycl via mocktoken could catch bug consum n't call reset etc
numericfield store binari format index match solr 's format spinoff lucene-3001 today write store field n't record field numericfield indexread time get back ordinari field number turn string see https //issues.apache.org/jira/browse/lucene-1701 focusedcommentid=12721972 page=com.atlassian.jira.plugin.system.issuetabpanel comment-tabpanel comment-12721972 spare bit alreadi store field use one record field numer encod numer field solr 's more-compact binari format nice side-effect fix long stand issu n't get numericfield back load document
repeat mechan sloppyphrasescor broken doc token posit lucene-736 made fix sloppyphrasescor match doc n't think chang caus fail match doc specif doc token posit
enabl docvalu default everi codec current docvalu enabl wrapper codec codec need docvalu must wrap docvaluescodec docvalu writer reader move codec enabl default
pathhierarchytoken adapt url split revers pathhierarchytoken usabl split url revers way use facet search url www.site.com www.site.com site.com com moreov abl skip given number first last revers token /usr/share/doc/somesoftware/interesting/part give 4 token skip interest interesting/part
3.1 fileformat date 3.1 fileformat miss chang lucene-2811
make compoundfilewrit public compoundfileread public compoundfilewrit propos make public lucene.intern instead case someon els find want manipul cfs file
simpletextcodec need simpletext docvalu impl current simpletextcodec use binari docvalu move simpl text impl
add -dtests.codecprovid current test codec set codec add lucen 's core edit coupl array would nice use test-framework could instead specifi codecprovid classnam possibl contain set huper-dup codec exampl made follow littl codecprovid contrib noformat public class appendingcodecprovid extend codecprovid public appendingcodecprovid regist new appendingcodec regist new simpletextcodec noformat 'm abl run test ant -lib build/contrib/misc/lucene-misc-4.0-snapshot.jar test-cor -dtests.codecprovider=org.apache.lucene.index.codecs.appending.appendingcodecprovid alway pick set codec case append simpletext set -dtests.codec=append want set one
dwpt n't see chang dw infostream dw push infostream chang dwpt sinc dwpt infostream final initi dwptpool initi least initi dwpt push chang infostream dwpt
add generic documentswriterdeletequeue.nod documentswriterdeletequeue.not generic subclass hold differ type item generif littl bit trick generic policeman ca n't wait fix *g*
document maven night build artifact generat use maven build lucene/solr document point peopl ask use maven lucen solr
add tool upgrad segment index last recent support index format without optim current want upgrad old index format current lucen version optim index use addindex indexread see lucene-2893 copi new directori optim approach fail index alreadi optim propos add custom mergepolici upgrad segment last format mergepolici could simpli also ignor segment alreadi up-to-d segment prior format would merg new segment use anoth mergepolici 's optim strategi issu differ lucene-2893 would support upgrad index previous lucen version in-plac use offici path tool end user develop tool addit also go lucen 3.x need make user pre-3.0 index go step 3.x els would abl open index 4.0 tool 3.x user could safe upgrad index without reli optim work already-optim index
mockrandommergepolici optim segment set pass test class mockrandommergepolici shuffl whole segmentinfo pass optim callback return random segment optim fine also return segment list set segmentinfo also pass contain subset segment optim bug found write testcas lucene-3082 wrapper mergepolici wrap around mockrandommergepolici pass subset segment deleg one old index format mockrandom creat onemerg return mergespecif segment outsid set
mergepolicy.onemerge.seg list segmentinfo segmentinfo remov vector si subclass segmentinfo refactor segmentinfo carri bunch field beyond list si merg purpos field unus cutov list si instead also segmentinfo subclass vector si remov collect hidden insid class add unmodifi view aslist asset
add elisionsfilt italiananalyz set french default n't italian enabl standard italian contract e.g definit articl various stemmer languag assum alreadi taken care n't anyth general thing like snowbal assum realli dumb token split word-intern add stoplist
highlight exact phrase overlap token fail field overlap token highlight search result search exact phrase use termvector.with_offset document build memoryindex highlight preserv posit token case overlap token get flatten posit increment alway set 1 spanqueri use search relev fragment fail identifi correct token sequenc posit shift correct ad posit increment calcul sub class storedtokenstream ad junit test cover case use eclips codestyl trunk style add quit format differ repositori work copi file tri reduc linewrap rule still n't match correct patch join
dwflushcontrol take activ dwpt loop fullflush seen sever oom testnrtthread caus dwflushcontrol miss dwpt set flushpend ca n't full due full flush go yet mean dwpt fill background actual check block full flush finish even current stall maxnumthreadst stall num activ thread state attach patch tomorrow
nrtcachingdirectori buffer small segment ramdir creat simpli directori impl whose goal reduc io content frequent reopen nrt use case idea reopen quick index much content wind mani small file creat time possibl stress io system eg merg search also fight io nrtcachingdirectori put newli creat file ramdir merg too-larg segment write-through real deleg directori let spend ram reduc i0
build fail flexscor branch javadoc warn ant build log javadoc standard doclet version 1.6.0_24 javadoc build tree packag class javadoc /home/savior/development/workspaces/java/lucene-gsoc/lucene/src/java/org/apache/lucene/search/similarity.java:93 warn tag link ca n't find tf float org.apache.lucene.search.similar javadoc /home/savior/development/workspaces/java/lucene-gsoc/lucene/src/java/org/apache/lucene/search/tfidfsimilarity.java:588 warn param argument term paramet name javadoc /home/savior/development/workspaces/java/lucene-gsoc/lucene/src/java/org/apache/lucene/search/tfidfsimilarity.java:588 warn param argument docfreq paramet name javadoc /home/savior/development/workspaces/java/lucene-gsoc/lucene/src/java/org/apache/lucene/search/tfidfsimilarity.java:618 warn param argument term paramet name javadoc generat /home/savior/development/workspaces/java/lucene-gsoc/lucene/build/docs/api/all/org/apache/lucene/store/instantiated//package-summary.html javadoc copi file /home/savior/development/workspaces/java/lucene-gsoc/lucene/contrib/instantiated/src/java/org/apache/lucene/store/instantiated/doc-files/classdiagram.png directori /home/savior/development/workspaces/java/lucene-gsoc/lucene/build/docs/api/all/org/apache/lucene/store/instantiated/doc-fil javadoc copi file /home/savior/development/workspaces/java/lucene-gsoc/lucene/contrib/instantiated/src/java/org/apache/lucene/store/instantiated/doc-files/hitcollectionbench.jpg directori /home/savior/development/workspaces/java/lucene-gsoc/lucene/build/docs/api/all/org/apache/lucene/store/instantiated/doc-fil javadoc copi file /home/savior/development/workspaces/java/lucene-gsoc/lucene/contrib/instantiated/src/java/org/apache/lucene/store/instantiated/doc-files/classdiagram.uxf directori /home/savior/development/workspaces/java/lucene-gsoc/lucene/build/docs/api/all/org/apache/lucene/store/instantiated/doc-fil javadoc generat /home/savior/development/workspaces/java/lucene-gsoc/lucene/build/docs/api/all/serialized-form.html javadoc copi file /home/savior/development/workspaces/java/lucene-gsoc/lucene/build/docs/api/prettify/stylesheet+prettify.css file /home/savior/development/workspaces/java/lucene-gsoc/lucene/build/docs/api/all/stylesheet+prettify.css javadoc build index packag class javadoc build index class javadoc generat /home/savior/development/workspaces/java/lucene-gsoc/lucene/build/docs/api/all/help-doc.html javadoc 4 warn
optim lev automata construct lev automata algorithm comput upperbound maximum possibl state true number creat useless unconnect state float around n't harm origin impl automaton simpli pointer initi state algorithm travers list effect useless state drop immedi recent chang automaton cach numberedst set useless state kept around impact perform realli confus debug e.g tostr thank dawid weiss notic time forc extra travers bit scari benchmark realli long string found actual help reduc number transit typic cut half long string speed later algorithm wo n't see speedup short term think easier work simpler automata anyway elimin confus see redund state without slow anyth
testindexwrit testthreadinterruptdeadlock fail oom selckin report repeat fail test throw oom except accord heapdump mockdirectorywrapp createdfil hashset take 400mb heapspac contain 4194304 entri seem kind way mani though noformat junit java.lang.outofmemoryerror java heap space junit dump heap /tmp/java_pid25990.hprof junit heap dump file creat 520807744 byte 4.250 sec junit testsuit org.apache.lucene.index.testindexwrit junit testcas testthreadinterruptdeadlock org.apache.lucene.index.testindexwrit fail junit junit junit.framework.assertionfailederror junit org.apache.lucene.index.testindexwriter.testthreadinterruptdeadlock testindexwriter.java:2249 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1282 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1211 junit junit junit testcas testthreadinterruptdeadlock org.apache.lucene.index.testindexwrit fail junit thread threw uncaught except junit junit.framework.assertionfailederror thread threw uncaught except junit org.apache.lucene.util.lucenetestcase.teardown lucenetestcase.java:557 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1282 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1211 junit junit junit test run 67 failur 2 error 0 time elaps 3,254.884 sec junit junit standard output junit fail unexpect except junit java.lang.outofmemoryerror java heap space junit org.apache.lucene.store.ramfile.newbuff ramfile.java:85 junit org.apache.lucene.store.ramfile.addbuff ramfile.java:58 junit org.apache.lucene.store.ramoutputstream.switchcurrentbuff ramoutputstream.java:132 junit org.apache.lucene.store.ramoutputstream.copybyt ramoutputstream.java:171 junit org.apache.lucene.store.mockindexoutputwrapper.copybyt mockindexoutputwrapper.java:155 junit org.apache.lucene.index.compoundfilewriter.copyfil compoundfilewriter.java:223 junit org.apache.lucene.index.compoundfilewriter.clos compoundfilewriter.java:189 junit org.apache.lucene.index.segmentmerger.createcompoundfil segmentmerger.java:138 junit org.apache.lucene.index.indexwriter.mergemiddl indexwriter.java:3344 junit org.apache.lucene.index.indexwriter.merg indexwriter.java:2959 junit org.apache.lucene.index.serialmergescheduler.merg serialmergescheduler.java:37 junit org.apache.lucene.index.indexwriter.maybemerg indexwriter.java:1763 junit org.apache.lucene.index.indexwriter.maybemerg indexwriter.java:1758 junit org.apache.lucene.index.indexwriter.maybemerg indexwriter.java:1754 junit org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1373 junit org.apache.lucene.index.indexwriter.adddocu indexwriter.java:1230 junit org.apache.lucene.index.indexwriter.adddocu indexwriter.java:1211 junit org.apache.lucene.index.testindexwrit indexerthreadinterrupt.run testindexwriter.java:2154 junit junit standard error junit note reproduc ant test -dtestcase=testindexwrit -dtestmethod=testthreadinterruptdeadlock -dtests.seed=7183538093651149:3431510331342554160 junit note reproduc ant test -dtestcase=testindexwrit -dtestmethod=testthreadinterruptdeadlock -dtests.seed=7183538093651149:3431510331342554160 junit follow except thrown thread junit thread thread-379 junit java.lang.runtimeexcept mockdirectorywrapp close still open file _3r1n_0.tib=1 _3r1n_0.frq=1 _3r1n_0.pos=1 _3r1m.cfs=1 _3r1n_0.doc=1 _3r1n.tvf=1 _3r1n.tvd=1 _3r1n.tvx=1 _3r1n.fdx=1 _3r1n.fdt=1 _3r1q.cfs=1 _3r1o.cfs=1 _3r1n_0.skp=1 _3r1n_0.pyl=1 junit org.apache.lucene.store.mockdirectorywrapper.clos mockdirectorywrapper.java:448 junit org.apache.lucene.index.testindexwrit indexerthreadinterrupt.run testindexwriter.java:2217 junit caus java.lang.runtimeexcept unclos indexoutput junit org.apache.lucene.store.mockdirectorywrapper.createoutput mockdirectorywrapper.java:367 junit org.apache.lucene.index.fieldinfos.writ fieldinfos.java:563 junit org.apache.lucene.index.docfieldprocessor.flush docfieldprocessor.java:82 junit org.apache.lucene.index.documentswriterperthread.flush documentswriterperthread.java:381 junit org.apache.lucene.index.documentswriter.doflush documentswriter.java:378 junit org.apache.lucene.index.documentswriter.flushallthread documentswriter.java:505 junit org.apache.lucene.index.indexwriter.doflush indexwriter.java:2621 junit org.apache.lucene.index.indexwriter.flush indexwriter.java:2598 junit org.apache.lucene.index.indexwriter.preparecommit indexwriter.java:2464 junit org.apache.lucene.index.indexwriter.commitintern indexwriter.java:2537 junit org.apache.lucene.index.indexwriter.commit indexwriter.java:2519 junit org.apache.lucene.index.indexwriter.commit indexwriter.java:2503 junit org.apache.lucene.index.testindexwrit indexerthreadinterrupt.run testindexwriter.java:2156 junit note test param codec=randomcodecprovid =mockvariableintblock baseblocksize=105 f6=mockfixedintblock blocksize=1372 f7=puls freqcutoff=11 f8=mockrandom f9=mockvariableintblock baseblocksize=105 f1=mocksep f0=puls freqcutoff=11 f3=puls freqcutoff=11 f2=mockfixedintblock blocksize=1372 f5=mockvariableintblock baseblocksize=105 f4=mockrandom f=standard c=puls freqcutoff=11 termvector=mockfixedintblock blocksize=1372 d9=mockvariableintblock baseblocksize=105 d8=mockrandom d5=mocksep d4=puls freqcutoff=11 d7=mockfixedintblock blocksize=1372 d6=mockvariableintblock baseblocksize=105 d25=simpletext d0=puls freqcutoff=11 c29=simpletext d24=mocksep d1=mocksep c28=mockvariableintblock baseblocksize=105 d23=mockrandom d2=mockvariableintblock baseblocksize=105 c27=mockrandom d22=standard d3=mockfixedintblock blocksize=1372 d21=mockvariableintblock baseblocksize=105 d20=mockrandom c22=simpletext c21=mocksep c20=mockrandom d29=mockfixedintblock blocksize=1372 c26=mockfixedintblock blocksize=1372 d28=mockvariableintblock baseblocksize=105 c25=mockvariableintblock baseblocksize=105 d27=mocksep c24=mocksep d26=puls freqcutoff=11 c23=puls freqcutoff=11 e9=mocksep e8=standard e7=simpletext e6=mockvariableintblock baseblocksize=105 e5=mockrandom c17=mocksep e3=simpletext d12=puls freqcutoff=11 c16=puls freqcutoff=11 e4=standard d11=mockfixedintblock blocksize=1372 c19=mockfixedintblock blocksize=1372 e1=mockrandom d14=mockvariableintblock baseblocksize=105 c18=mockvariableintblock baseblocksize=105 e2=mockvariableintblock baseblocksize=105 d13=mockrandom e0=mockfixedintblock blocksize=1372 d10=mocksep d19=puls freqcutoff=11 c11=mockvariableintblock baseblocksize=105 c10=mockrandom d16=mockrandom c13=mockrandom c12=standard d15=standard d18=simpletext c15=simpletext d17=mocksep c14=mocksep b3=simpletext b2=mocksep b5=puls freqcutoff=11 b4=mockfixedintblock blocksize=1372 b7=mockfixedintblock blocksize=1372 b6=mockvariableintblock baseblocksize=105 d50=puls freqcutoff=11 b9=mockrandom b8=standard d43=mockrandom d42=standard d41=mockfixedintblock blocksize=1372 d40=mockvariableintblock baseblocksize=105 d47=mocksep d46=puls freqcutoff=11 b0=mockfixedintblock blocksize=1372 d45=standard b1=puls freqcutoff=11 d44=simpletext d49=puls freqcutoff=11 d48=mockfixedintblock blocksize=1372 c6=mockrandom c5=standard c4=mockfixedintblock blocksize=1372 c3=mockvariableintblock baseblocksize=105 c9=puls freqcutoff=11 c8=standard c7=simpletext d30=simpletext d32=puls freqcutoff=11 d31=mockfixedintblock blocksize=1372 c1=standard d34=mockfixedintblock blocksize=1372 c2=mockrandom d33=mockvariableintblock baseblocksize=105 d36=mockrandom c0=mockfixedintblock blocksize=1372 d35=standard d38=standard d37=simpletext d39=puls freqcutoff=11 e92=mockfixedintblock blocksize=1372 e93=puls freqcutoff=11 e90=mocksep e91=simpletext e89=puls freqcutoff=11 e88=standard e87=simpletext e86=mockrandom e85=standard e84=mockfixedintblock blocksize=1372 e83=mockvariableintblock baseblocksize=105 e80=mockvariableintblock baseblocksize=105 e81=simpletext e82=standard e77=mockfixedintblock blocksize=1372 e76=mockvariableintblock baseblocksize=105 e79=mockrandom e78=standard e73=simpletext e72=mocksep e75=puls freqcutoff=11 e74=mockfixedintblock blocksize=1372 binary=puls freqcutoff=11 f98=mocksep f97=puls freqcutoff=11 f99=mockvariableintblock baseblocksize=105 f94=mockrandom f93=standard f96=simpletext f95=mocksep e95=mocksep e94=puls freqcutoff=11 e97=mockfixedintblock blocksize=1372 e96=mockvariableintblock baseblocksize=105 e99=mockvariableintblock baseblocksize=105 e98=mockrandom id=mockrandom f34=simpletext f33=mocksep f32=mockrandom f31=standard f30=mockvariableintblock baseblocksize=105 f39=mockrandom f38=mockfixedintblock blocksize=1372 f37=mockvariableintblock baseblocksize=105 f36=mocksep f35=puls freqcutoff=11 f43=mocksep f42=puls freqcutoff=11 f45=mockfixedintblock blocksize=1372 f44=mockvariableintblock baseblocksize=105 f41=simpletext f40=mocksep f47=mockvariableintblock baseblocksize=105 f46=mockrandom f49=standard f48=simpletext content=mockfixedintblock blocksize=1372 e19=standard e18=simpletext e17=mockrandom f12=standard e16=standard f11=simpletext f10=mockvariableintblock baseblocksize=105 e15=mockfixedintblock blocksize=1372 e14=mockvariableintblock baseblocksize=105 f16=puls freqcutoff=11 e13=puls freqcutoff=11 f15=mockfixedintblock blocksize=1372 e12=mockfixedintblock blocksize=1372 e11=simpletext f14=simpletext e10=mocksep f13=mocksep f19=standard f18=mockfixedintblock blocksize=1372 f17=mockvariableintblock baseblocksize=105 e29=mockfixedintblock blocksize=1372 e26=standard f21=simpletext e25=simpletext f20=mocksep e28=mocksep f23=puls freqcutoff=11 e27=puls freqcutoff=11 f22=mockfixedintblock blocksize=1372 f25=mockfixedintblock blocksize=1372 e22=mockfixedintblock blocksize=1372 f24=mockvariableintblock baseblocksize=105 e21=mockvariableintblock baseblocksize=105 f27=mockrandom e24=mockrandom f26=standard e23=standard f29=standard f28=simpletext e20=puls freqcutoff=11 field=mockrandom string=puls freqcutoff=11 e30=mocksep e31=simpletext a98=mockrandom e34=mockvariableintblock baseblocksize=105 a99=mockvariableintblock baseblocksize=105 e35=mockfixedintblock blocksize=1372 f79=mockvariableintblock baseblocksize=105 e32=puls freqcutoff=11 e33=mocksep b97=puls freqcutoff=11 f77=mockfixedintblock blocksize=1372 e38=simpletext b98=mocksep f78=puls freqcutoff=11 e39=standard b99=mockvariableintblock baseblocksize=105 f75=mocksep e36=mockrandom f76=simpletext e37=mockvariableintblock baseblocksize=105 f73=simpletext f74=standard f71=mockrandom f72=mockvariableintblock baseblocksize=105 f81=mockfixedintblock blocksize=1372 f80=mockvariableintblock baseblocksize=105 e40=mocksep e41=mockvariableintblock baseblocksize=105 e42=mockfixedintblock blocksize=1372 e43=mockrandom e44=mockvariableintblock baseblocksize=105 e45=simpletext e46=standard f86=mockvariableintblock baseblocksize=105 e47=mocksep f87=mockfixedintblock blocksize=1372 e48=simpletext f88=standard e49=mockfixedintblock blocksize=1372 f89=mockrandom f82=mocksep f83=simpletext f84=mockfixedintblock blocksize=1372 f85=puls freqcutoff=11 f90=mockvariableintblock baseblocksize=105 f92=standard f91=simpletext str=mockfixedintblock blocksize=1372 a76=mockvariableintblock baseblocksize=105 e56=mockrandom f59=mockrandom a77=mockfixedintblock blocksize=1372 e57=mockvariableintblock baseblocksize=105 a78=standard e54=mockfixedintblock blocksize=1372 f57=mockfixedintblock blocksize=1372 a79=mockrandom e55=puls freqcutoff=11 f58=puls freqcutoff=11 e52=puls freqcutoff=11 e53=mocksep e50=simpletext e51=standard f51=standard f52=mockrandom f50=mockfixedintblock blocksize=1372 f55=puls freqcutoff=11 f56=mocksep f53=simpletext e58=standard f54=standard e59=mockrandom a80=mockvariableintblock baseblocksize=105 e60=mockrandom a82=standard a81=simpletext a84=simpletext a83=mocksep a86=puls freqcutoff=11 a85=mockfixedintblock blocksize=1372 a89=puls freqcutoff=11 f68=standard e65=standard f69=mockrandom e66=mockrandom a87=simpletext e67=mocksep a88=standard e68=simpletext e61=mockfixedintblock blocksize=1372 e62=puls freqcutoff=11 e63=mockrandom e64=mockvariableintblock baseblocksize=105 f60=simpletext f61=standard f62=puls freqcutoff=11 f63=mocksep e69=puls freqcutoff=11 f64=mockfixedintblock blocksize=1372 f65=puls freqcutoff=11 f66=mockrandom f67=mockvariableintblock baseblocksize=105 f70=mockrandom a93=puls freqcutoff=11 a92=mockfixedintblock blocksize=1372 a91=simpletext e71=mocksep a90=mocksep e70=puls freqcutoff=11 a97=mockrandom a96=standard a95=mockfixedintblock blocksize=1372 a94=mockvariableintblock baseblocksize=105 c58=mockfixedintblock blocksize=1372 a63=puls freqcutoff=11 a64=mocksep c59=puls freqcutoff=11 c56=mocksep d59=mocksep a61=simpletext c57=simpletext a62=standard c54=simpletext c55=standard a60=mockrandom c52=mockrandom c53=mockvariableintblock baseblocksize=105 d53=mockvariableintblock baseblocksize=105 d54=mockfixedintblock blocksize=1372 d51=puls freqcutoff=11 d52=mocksep d57=simpletext b62=standard d58=standard b63=mockrandom d55=mockrandom b60=mockvariableintblock baseblocksize=105 d56=mockvariableintblock baseblocksize=105 b61=mockfixedintblock blocksize=1372 b56=mocksep b55=puls freqcutoff=11 b54=standard b53=simpletext d61=simpletext b59=mockrandom d60=mocksep b58=puls freqcutoff=11 b57=mockfixedintblock blocksize=1372 c62=mockfixedintblock blocksize=1372 c61=mockvariableintblock baseblocksize=105 a59=mockrandom c60=mocksep a58=standard a57=mockvariableintblock baseblocksize=105 a56=mockrandom a55=puls freqcutoff=11 a54=mockfixedintblock blocksize=1372 a72=mockfixedintblock blocksize=1372 c67=mockvariableintblock baseblocksize=105 a73=puls freqcutoff=11 c68=mockfixedintblock blocksize=1372 a74=mockrandom c69=standard a75=mockvariableintblock baseblocksize=105 c63=mocksep c64=simpletext a70=puls freqcutoff=11 c65=mockfixedintblock blocksize=1372 a71=mocksep c66=puls freqcutoff=11 d62=mockrandom d63=mockvariableintblock baseblocksize=105 d64=simpletext b70=mockrandom d65=standard b71=simpletext d66=mocksep b72=standard d67=simpletext b73=puls freqcutoff=11 d68=mockfixedintblock blocksize=1372 b74=mocksep d69=puls freqcutoff=11 b65=puls freqcutoff=11 b64=mockfixedintblock blocksize=1372 b67=mockvariableintblock baseblocksize=105 b66=mockrandom d70=mocksep b69=mockrandom b68=standard d72=mockfixedintblock blocksize=1372 d71=mockvariableintblock baseblocksize=105 c71=mockvariableintblock baseblocksize=105 c70=mockrandom a69=puls freqcutoff=11 c73=standard c72=simpletext a66=mockrandom a65=standard a68=simpletext a67=mocksep c32=standard c33=mockrandom c30=mockvariableintblock baseblocksize=105 c31=mockfixedintblock blocksize=1372 c36=puls freqcutoff=11 a41=mocksep c37=mocksep a42=simpletext a0=mocksep c34=simpletext c35=standard a40=mockrandom b84=simpletext d79=mocksep b85=standard b82=mockrandom d77=standard c38=mockfixedintblock blocksize=1372 b83=mockvariableintblock baseblocksize=105 d78=mockrandom c39=puls freqcutoff=11 b80=mockvariableintblock baseblocksize=105 d75=mockrandom b81=mockfixedintblock blocksize=1372 d76=mockvariableintblock baseblocksize=105 d73=mockfixedintblock blocksize=1372 d74=puls freqcutoff=11 d83=mocksep a9=standard d82=puls freqcutoff=11 d81=standard d80=simpletext b79=mockvariableintblock baseblocksize=105 b78=puls freqcutoff=11 b77=mockfixedintblock blocksize=1372 b76=simpletext b75=mocksep a1=simpletext a35=mockfixedintblock blocksize=1372 a2=standard a34=mockvariableintblock baseblocksize=105 a3=puls freqcutoff=11 a33=mocksep a4=mocksep a32=puls freqcutoff=11 a5=mockfixedintblock blocksize=1372 a39=standard c40=puls freqcutoff=11 a6=puls freqcutoff=11 a38=simpletext a7=mockrandom a37=mockvariableintblock baseblocksize=105 a8=mockvariableintblock baseblocksize=105 a36=mockrandom c41=simpletext c42=standard c43=puls freqcutoff=11 c44=mocksep c45=mockfixedintblock blocksize=1372 a50=puls freqcutoff=11 c46=puls freqcutoff=11 a51=mocksep c47=mockrandom a52=mockvariableintblock baseblocksize=105 c48=mockvariableintblock baseblocksize=105 a53=mockfixedintblock blocksize=1372 b93=mocksep d88=puls freqcutoff=11 c49=standard b94=simpletext d89=mocksep b95=mockfixedintblock blocksize=1372 b96=puls freqcutoff=11 d84=standard b90=mockvariableintblock baseblocksize=105 d85=mockrandom b91=simpletext d86=mocksep b92=standard d87=simpletext d92=puls freqcutoff=11 d91=mockfixedintblock blocksize=1372 d94=mockvariableintblock baseblocksize=105 d93=mockrandom b87=mockfixedintblock blocksize=1372 b86=mockvariableintblock baseblocksize=105 d90=mocksep b89=mockrandom b88=standard a44=mockvariableintblock baseblocksize=105 a43=mockrandom a46=standard a45=simpletext a48=simpletext a47=mocksep c51=mockrandom a49=mockfixedintblock blocksize=1372 c50=standard d98=mockrandom d97=standard d96=mockfixedintblock blocksize=1372 d95=mockvariableintblock baseblocksize=105 d99=simpletext a20=standard c99=mocksep c98=puls freqcutoff=11 c97=standard c96=simpletext b19=standard a16=standard a17=mockrandom b17=mockvariableintblock baseblocksize=105 a14=mockvariableintblock baseblocksize=105 b18=mockfixedintblock blocksize=1372 a15=mockfixedintblock blocksize=1372 a12=mockfixedintblock blocksize=1372 a13=puls freqcutoff=11 a10=mocksep a11=simpletext b11=simpletext b12=standard b10=mockvariableintblock baseblocksize=105 b15=mockfixedintblock blocksize=1372 b16=puls freqcutoff=11 a18=simpletext b13=mocksep a19=standard b14=simpletext b30=standard a31=puls freqcutoff=11 a30=mockfixedintblock blocksize=1372 b28=simpletext a25=simpletext b29=standard a26=standard a27=puls freqcutoff=11 a28=mocksep a21=mockvariableintblock baseblocksize=105 a22=mockfixedintblock blocksize=1372 a23=standard a24=mockrandom b20=mocksep b21=simpletext b22=mockfixedintblock blocksize=1372 b23=puls freqcutoff=11 a29=mockfixedintblock blocksize=1372 b24=mockvariableintblock baseblocksize=105 b25=mockfixedintblock blocksize=1372 b26=standard b27=mockrandom b41=mockvariableintblock baseblocksize=105 b40=mockrandom c77=simpletext c76=mocksep c75=mockrandom c74=standard c79=mocksep c78=puls freqcutoff=11 c80=mocksep c83=mockrandom c84=mockvariableintblock baseblocksize=105 c81=mockfixedintblock blocksize=1372 b39=mockrandom c82=puls freqcutoff=11 b37=mockvariableintblock baseblocksize=105 b38=mockfixedintblock blocksize=1372 b35=puls freqcutoff=11 b36=mocksep b33=mocksep b34=simpletext b31=standard b32=mockrandom str2=standard b50=mockrandom b52=simpletext str3=puls freqcutoff=11 b51=mocksep c86=mocksep tvtest=puls freqcutoff=11 c85=puls freqcutoff=11 c88=mockfixedintblock blocksize=1372 c87=mockvariableintblock baseblocksize=105 c89=mockrandom c90=mockrandom c91=mockvariableintblock baseblocksize=105 c92=standard c93=mockrandom c94=mocksep c95=simpletext content1=simpletext b46=mockrandom b47=mockvariableintblock baseblocksize=105 content3=mockrandom b48=simpletext content4=standard b49=standard content5=mockvariableintblock baseblocksize=105 b42=puls freqcutoff=11 b43=mocksep b44=mockvariableintblock baseblocksize=105 b45=mockfixedintblock blocksize=1372 locale=it_ch timezone=europe/chisinau junit note test run jvm junit testmergeschedulerextern testtoken testcodec testfieldinfo testflushbyramorcountspolici testindexreaderreopen testindexwrit junit note linux 2.6.37-gentoo amd64/sun microsystem inc. 1.6.0_25 64-bit /cpus=8 threads=1 free=275548088 total=309395456 noformat
post group facet issu focus implement post group facet handl multivalu field field valu show facet facet count base facet count base normal document ungroup count facet count base group group count facet count base combin group valu facet valu matrix count proper implement option first two method implement solr-236 patch first option calcul docset base individu document queri result second option calcul docset relev document group docset comput facetcompon statscompon use one docset creat facet statist last one bit complex think best explain exampl let say search travel offer |||hotel||departure_airport||duration|| |hotel a|ams|5 |hotel a|dus|10 |hotel b|ams|5 |hotel b|ams|10 group hotel facet airport end user expect accord experi cours follow airport facet am 2 dus 1 result ca n't achiev first two method either get count ams:3 dus:1 1 airport
group total count group current get two count total hit count count document match queri total group hit count count document group top n group sinc end user get group search result instead plain document group total number group total count make sens mani situat
group modul allow subclass set group key per document new group modul group single-valu index field make getgroupkey method subclass could overrid think could refactor solr modul could function queri normal queri via subclass think also make impl extens app might interest group valu per document
iw.commit write fail fsync n.fnx file make unit test nrtcachingdir lucene-3092 hit surpris bug new n.fnx file written last minut along segment file 's includ sis.fil iw use figur file sync bug mean one could call iw.commit success return machin could crash come back index could corrupt hope first fix testcrash hit bug mayb need more/bett random fix bug
testminimize.testagainstbrzozowski reproduc seed oom code junit testsuit org.apache.lucene.util.automaton.testminim junit test run 1 failur 0 error 1 time elaps 3.792 sec junit junit standard error junit note reproduc ant test -dtestcase=testminim -dtestmethod=testagainstbrzozowski -dtests.seed=-7429820995201119781:1013305000165135537 junit note test param codec=preflex locale=ru timezone=america/pangnirtung junit note test run jvm junit testminim junit note linux 2.6.37-gentoo amd64/sun microsystem inc. 1.6.0_25 64-bit /cpus=8 threads=1 free=294745976 total=310378496 junit junit testcas testagainstbrzozowski org.apache.lucene.util.automaton.testminim caus error junit java heap space junit java.lang.outofmemoryerror java heap space junit java.util.bitset.initword bitset.java:144 junit java.util.bitset. init bitset.java:139 junit org.apache.lucene.util.automaton.minimizationoperations.minimizehopcroft minimizationoperations.java:85 junit org.apache.lucene.util.automaton.minimizationoperations.minim minimizationoperations.java:52 junit org.apache.lucene.util.automaton.regexp.toautomaton regexp.java:502 junit org.apache.lucene.util.automaton.regexp.toautomatonallowmut regexp.java:478 junit org.apache.lucene.util.automaton.regexp.toautomaton regexp.java:428 junit org.apache.lucene.util.automaton.automatontestutil.randomautomaton automatontestutil.java:256 junit org.apache.lucene.util.automaton.testminimize.testagainstbrzozowski testminimize.java:43 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1282 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1211 junit junit junit test org.apache.lucene.util.automaton.testminim fail code
issu cachingcollector cachingcollector introduc lucene-1421 issu sinc wrap collector may support out-of-ord collect document id cach may out-of-ord depend queri thus replay collector forward document id out-of-ord collector may support clear cachedscor cachedseg upon exceed ram limit think instead compar curscor null order determin score request specif boolean clariti check base nextlength maxdocstocach line 168 relax e.g. nextlength say 512k satisfi maxdocstocach constraint 10k would would n't still want tri cach also todo line 64 collector specifi needsscor need cachingcollector ctor alreadi take boolean cachescor think 's better defin explicit implicit let 's introduc factori method creat special version score request i.e. impl todo line 189 think 's use collector stand specif group move core use openbitset instead int doc id number hit big 'd gain ram back abl cach entri note openbitset use in-ord collect use wrap collector support out-of-ord think modifi collector necessarili wrap anoth collector collector store in-memori match doc id score requir later fed sever process oper e.g fetch info index etc. think make cachingcollector *optionally* wrap anoth collector someon reus set ram limit unlimit constant order simpli collect match doc score think set dedic unit test class alon would good 's far perhap thing pop
creat simpl test index search byte term current good test test2bterm disabl default think test capabl also simpler exampl
commongram filter call incrementtoken return fals lucene-3064 beef mocktoken assert start cut analysi test use mocktoken better coverag commongram test fail call incrementtoken alreadi return fals general understand consum know token actual throw except like java iter
land docvalu trunk time move anoth featur branch trunk want start process still coupl issu remain branch current singl nocommit javadoc docvalues.java coupl test todo explicit multithread test unoptim delet think worth separ issu resolv go alreadi creat issu lucene-3075 lucene-3074 block process imo fix trunk quick featur overview implement docvalu implement int base packedint float 32 64 byte fix variabl size sort straight deref variat integr flex-api codec provid perdocconsumer- docvaluesconsum write perdocvalues- docvalu read by-default enabl codec except preflex follow flex-api pattern like non-seg reader throw uoe forc multiperdocvalu dirread etc integr indexwrit fieldinfo etc random-test enabl via randomiw inject random docvalu document basic check checkindex run test fieldcompar int float variant sort current direct integr sortfield might go separ docvaluessortfield eventu extend testsort docvalu ram-resid random access api plus on-disk docvaluesenum current sequenti access source.java docvaluesenum.java extens cach implement ram-resid docvalu by-default load ram freed ir close sourcecache.java ps current ram resid api name sourc source.java seem generic think renam ramdocvalu someth like suggest welcom comment question rant much appreci
testfsts.testrandomword failur run 1 test docvalu branch r1103705 follow test fail code junit testsuit org.apache.lucene.util.automaton.fst.testfst junit testcas testrandomword org.apache.lucene.util.automaton.fst.testfst fail junit expect 771 twolongs:771,771 junit junit.framework.assertionfailederror expect 771 twolongs:771,771 junit org.apache.lucene.util.automaton.fst.testfst fsttester.verifyunprun testfsts.java:540 junit org.apache.lucene.util.automaton.fst.testfst fsttester.dotest testfsts.java:496 junit org.apache.lucene.util.automaton.fst.testfst fsttester.dotest testfsts.java:359 junit org.apache.lucene.util.automaton.fst.testfsts.dotest testfsts.java:319 junit org.apache.lucene.util.automaton.fst.testfsts.testrandomword testfsts.java:940 junit org.apache.lucene.util.automaton.fst.testfsts.testrandomword testfsts.java:915 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1282 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1211 junit junit junit test run 7 failur 1 error 0 time elaps 7.628 sec junit junit standard error junit note ignor nightly-on test method testbigset junit note reproduc ant test -dtestcase=testfst -dtestmethod=testrandomword -dtests.seed=-269475578956012681:0 junit note test param codec=preflex locale=ar timezone=america/blanc-sablon junit note test run jvm junit testtoken testcodec testindexreaderreopen testindexwritermerg testnodeletionpolici testparallelreaderemptyindex testparalleltermenum testpersegmentdelet testsegmentread testsegmenttermdoc teststressadv testtermvectorsread testsurrog testmultifieldquerypars testautomatonqueri testbooleanscor testfuzzyqueri testmultitermconstantscor testnumericrangequery64 testpositivescoresonlycollector testprefixfilt testquerytermvector testscorerperf testsloppyphrasequeri testspansadvanc testwindowsmmap testramusageestim testsmallfloat testunicodeutil testfst junit note linux 2.6.37-gentoo amd64/sun microsystem inc. 1.6.0_25 64-bit /cpus=8 threads=1 free=137329960 total=208207872 junit junit test org.apache.lucene.util.automaton.fst.testfst fail code abl reproduc
add iw.add/updatedocu support nest document think nest document lucene-2454 compel addit lucen 's also popular mani vote issu beyond support nest document queri alreadi incred addit sinc preserv relat model index normal content eg db tabl xml doc lucene-2454 also enabl speedup group implement group nest field reason also enabl fast post-group facet count impl lucene-3097 count distinct nestedfield instead uniqu document identifi expect mani app use facet need abil count distinct nestedfield distinct docid support use case believ core chang need abil atom add updat multipl document today sinc add/updatedocu call flush eg due commit getread could occur new api adddocu iter document updatedocu term delterm iter document would also guarante document assign sequenti docid order iter provid docid resid one segment segment merg never split segment apart invari would hold even merges/optim take place
fix analyz bug found mocktoken lucene-3064 beef mocktoken assert ve switch analysi test use mocktoken better coverag howev found bug one lucene-3106 incrementtoken return fals commongramsqueryfilt hyphenatedwordsfilt shinglefilt synonymfilt miss end implement prefixawaretokenfilt doubl reset queryautostopwordanalyz reusableanalyzerbas miss correctoffset mocktoken think would nice fix bug one issu ve fix everyth except shingl synonym
yank segmentreader.norm segmentreader.java work flex score branch lucene-3012 notic difficult navig norm handl segmentread 's code think yank inner class separ file start
fst offer lookup-by-output api output strict increas spinoff fst fieldcach java-dev thread http //lucene.markmail.org/thread/swoawlv3fq4dntvl fst abl associ arbitrari output sort input key special common case function strict monoton output increas vs prior output map term ord map file offset term dict offer lookup-by-output api effici walk fst locat input key exact floor ceil match output
testindexwriter.testbackgroundoptim fail mani open file recreat line ant test -dtestcase=testindexwrit -dtestmethod=testbackgroundoptim -dtests.seed=-3981504507637360146:51354004663342240 might relat lucene-2873
testdocvaluesindexing.testaddindex failur docvalu branch doc valu branch r1124825 reproduc code junit testsuit org.apache.lucene.index.values.testdocvaluesindex junit test run 1 failur 0 error 1 time elaps 0.716 sec junit junit standard error junit note reproduc ant test -dtestcase=testdocvaluesindex -dtestmethod=testaddindex -dtests.seed=5939035003978436534 -6429764582682717131 junit note test param codec=randomcodecprovid id=mockrandom bytes_var_deref=mockrandom ints=puls freqcutoff=13 locale=da_dk timezone=asia/macao junit note test run jvm junit testdocvaluesindex junit note linux 2.6.37-gentoo amd64/sun microsystem inc. 1.6.0_25 64-bit /cpus=8 threads=1 free=88582432 total=125632512 junit junit testcas testaddindex org.apache.lucene.index.values.testdocvaluesindex caus error junit null junit java.nio.channels.closedchannelexcept junit sun.nio.ch.filechannelimpl.ensureopen filechannelimpl.java:88 junit sun.nio.ch.filechannelimpl.read filechannelimpl.java:603 junit org.apache.lucene.store.niofsdirectori niofsindexinput.readintern niofsdirectory.java:161 junit org.apache.lucene.store.bufferedindexinput.refil bufferedindexinput.java:222 junit org.apache.lucene.store.bufferedindexinput.readbyt bufferedindexinput.java:39 junit org.apache.lucene.store.datainput.readint datainput.java:73 junit org.apache.lucene.store.bufferedindexinput.readint bufferedindexinput.java:162 junit org.apache.lucene.store.datainput.readlong datainput.java:115 junit org.apache.lucene.store.bufferedindexinput.readlong bufferedindexinput.java:175 junit org.apache.lucene.store.mockindexinputwrapper.readlong mockindexinputwrapper.java:136 junit org.apache.lucene.index.values.packedintsimpl intsenumimpl. init packedintsimpl.java:263 junit org.apache.lucene.index.values.packedintsimpl intsenumimpl. init packedintsimpl.java:249 junit org.apache.lucene.index.values.packedintsimpl intsreader.getenum packedintsimpl.java:239 junit org.apache.lucene.index.values.docvalues.getenum docvalues.java:54 junit org.apache.lucene.index.values.testdocvaluesindexing.getvaluesenum testdocvaluesindexing.java:484 junit org.apache.lucene.index.values.testdocvaluesindexing.testaddindex testdocvaluesindexing.java:202 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1304 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1233 junit junit junit test org.apache.lucene.index.values.testdocvaluesindex fail code code junit testsuit org.apache.lucene.index.values.testdocvaluesindex junit test run 1 failur 0 error 1 time elaps 0.94 sec junit junit standard error junit note reproduc ant test -dtestcase=testdocvaluesindex -dtestmethod=testaddindex -dtests.seed=-3677966427932339626 -4746638811786223564 junit note test param codec=randomcodecprovid id=standard bytes_fixed_deref=mocksep float_64=simpletext locale=ca timezone=asia/novosibirsk junit note test run jvm junit testdocvaluesindex junit note linux 2.6.37-gentoo amd64/sun microsystem inc. 1.6.0_25 64-bit /cpus=8 threads=1 free=88596152 total=125632512 junit junit testcas testaddindex org.apache.lucene.index.values.testdocvaluesindex caus error junit bad file descriptor junit java.io.ioexcept bad file descriptor junit java.io.randomaccessfile.seek nativ method junit org.apache.lucene.store.simplefsdirectori simplefsindexinput.readintern simplefsdirectory.java:101 junit org.apache.lucene.store.bufferedindexinput.refil bufferedindexinput.java:222 junit org.apache.lucene.store.bufferedindexinput.readbyt bufferedindexinput.java:39 junit org.apache.lucene.store.mockindexinputwrapper.readbyt mockindexinputwrapper.java:105 junit org.apache.lucene.index.values.float floatsreader.load floats.java:281 junit org.apache.lucene.index.values.sourcecach directsourcecache.load sourcecache.java:101 junit org.apache.lucene.index.values.docvalues.getsourc docvalues.java:101 junit org.apache.lucene.index.values.testdocvaluesindexing.getsourc testdocvaluesindexing.java:472 junit org.apache.lucene.index.values.testdocvaluesindexing.getvaluesenum testdocvaluesindexing.java:482 junit org.apache.lucene.index.values.testdocvaluesindexing.testaddindex testdocvaluesindexing.java:203 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1304 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1233 junit junit junit test org.apache.lucene.index.values.testdocvaluesindex fail code
indexwriter.addindex make incom segment cfs n't alreadi today iw.addindex directori modifi cfs-mode incom segment howev indexwrit 's mp want creat cfs general 's reason turn incom non-cf segment cfs anyway copi mp cfs creat cfs need use cfw sure 's readi w/ current api ll need check luckili re allow chang lucene.intern done imo even incom segment larg i.e. pass mp.nocfsratio b/c like wrote anyway copi howev think otherwis speak ll take look next day
pull coreread segmentread similar lucene-3117 think pull coreread class sr make easier navig code
single-pass group collector base doc block lucene-3112 enabl adding/upd contigu block document index guarante yet experiment retain adjac docid assign full life index long app doesn't delet individu doc block app enabl neat featur like lucene-2454 nest document post-group facet count lucene-3097 also make single-pass group possibl group identifi field share doc block sinc know see given group doc within one block faster fulli general two-pass collector alreadi 'm work patch quit yet
backport suggest modul branch 3.x would nice develop plan expos autosuggest function lucen user 3.x complic see backport fst-base function might requir good bit work think would well-worth
benchmark 's extractreut creat temp dir wrong provid out-dir param end slash see lucene-929 context result might fail creat temp dir
lucenetestcase.afterclass print enough inform temp-test-dir fail delet ve hit except ltc.afterclass _testutil.rmdir fail write.lock test releas resourc howev idea test caus i.e open temp directori releas resourc think follow track ltc map dirnam stacktraceel afterclass _testutil.rmdir fail print ste particular dir know directori creat make tempdir privat creat accessor method control insert map today set updat ltc _testutil testbackward
backport fsts 3.x
fastvectorhighlight expos fieldfraglist.fraginfo user-customiz fragmentsbuild need build custom highlight snippet snippet start sentenc contain first match continu 250 charact creat custom fragmentsbuild extend simplefragmentsbuild overrid createfrag indexread reader int docid string fieldnam fieldfraglist fieldfraglist method unit test contain code attach jira get work need expos make public fieldfraglist.fraginfo member variabl current packag privat fragmentsbuild implement within lucene-highlight o.a.l.s.vectorhighlight packag simplefragmentsbuild access sinc use lucene-highlighter.jar extern depend applic simplest way access fieldfraglist.fraginfo class make public
benchmark/stat packag obsolet unus remov seem like leftov origin benchmark implement thus remov
segmentmerg assert .del .s* file pass createcompoundfil spinoff lucene-3126 segmentmerger.createcompoundfil document receiv file includ .cfs .del .s* separ norm today method call code ensur add document clarifi add assert test code run w/ -ea catch post patch soon
freqproxtermswrit leak file handl except thrown flush freqproxtermswrit leak open file handl except thrown flush code need protect try-fin claus
indexreader.setnorm op one field instanc omit norm add two document index w/ field one omit norm indexreader.setnorm no-op ll attach patch w/ test case
mockdirectorywrapp track open file handl indexoutput mockdirectorywrapp current track open file handl indexinput therefor io file close fail test lead test directori fail delet window make sure open file track left open fail test ll attach patch short
testindexwriterexcept reproduc aoob mockvariableintblockcodec code junit testsuit org.apache.lucene.index.testindexwriterexcept junit test run 1 failur 0 error 1 time elaps 0.739 sec junit junit standard error junit note reproduc ant test -dtestcase=testindexwriterexcept -dtestmethod=testdocumentswriterabort -dtests.seed=4579947455 682149564 -7960989923752018504 junit note test param codec=randomcodecprovid content=mockvariableintblock baseblocksize=32 locale=bg_bg timezone=brazil /acr junit note test run jvm junit testindexwriterexcept junit note linux 2.6.37-gentoo amd64/sun microsystem inc. 1.6.0_25 64-bit /cpus=8 threads=1 free=94363216 total=125632512 junit junit testcas testdocumentswriterabort org.apache.lucene.index.testindexwriterexcept caus error junit 66 junit java.lang.arrayindexoutofboundsexcept 66 junit org.apache.lucene.index.codecs.mockintblock.mockvariableintblockcodec mockintfactori 2.add mockvariableintblockcodec.java 114 junit org.apache.lucene.index.codecs.intblock.variableintblockindexoutput.clos variableintblockindexoutput.java:118 junit org.apache.lucene.index.codecs.sep.seppostingswriterimpl.clos seppostingswriterimpl.java:320 junit org.apache.lucene.index.codecs.blocktermswriter.clos blocktermswriter.java:137 junit org.apache.lucene.index.perfieldcodecwrapp fieldswriter.clos perfieldcodecwrapper.java:81 junit org.apache.lucene.index.freqproxtermswriter.flush freqproxtermswriter.java:103 junit org.apache.lucene.index.termshash.flush termshash.java:118 junit org.apache.lucene.index.docinverter.flush docinverter.java:80 junit org.apache.lucene.index.docfieldprocessor.flush docfieldprocessor.java:75 junit org.apache.lucene.index.documentswriterperthread.flush documentswriterperthread.java:457 junit org.apache.lucene.index.documentswriter.doflush documentswriter.java:417 junit org.apache.lucene.index.documentswriter.postupd documentswriter.java:309 junit org.apache.lucene.index.documentswriter.updatedocu documentswriter.java:381 junit org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1469 junit org.apache.lucene.index.indexwriter.adddocu indexwriter.java:1229 junit org.apache.lucene.index.indexwriter.adddocu indexwriter.java:1210 junit org.apache.lucene.index.testindexwriterexceptions.testdocumentswriterabort testindexwriterexceptions.java:555 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1333 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1251 junit junit junit test org.apache.lucene.index.testindexwriterexcept fail code trunk r1127871
upgrad icu 4.8 upgrad 4.6 4.8. intern method becam public also package-priv reflect hack remov
mockdirectorywrapp wrap lockfactori appli patch lucene-3147 ad line make test fail remov temporari directori ran ant test linux 50 time pass 50 time window fail often write.lock unclos writer test mockdirectorywrapp current unawar write.lock think wrap lockfactori .close fail outstand lock hope test would fail linux
lucen benchmark unnecessari file lucene/contrib/benchmark/.rsync-filt sourc pack svn awar file though ad long ago https //issues.apache.org/jira/browse/lucene-848 focusedcommentid=12491404 page=com.atlassian.jira.plugin.system.issuetabpanel comment-tabpanel comment-12491404 blocker rc interest note mayb relat lucene-3155 could consid one automat exclus like ds_store fix commit svn
enabl throttl night build test take forev even big machin order speed test default io throttl never run night
testdocvaluesindex reproduc test failur docvalu branch r1131275 code junit testsuit org.apache.lucene.index.values.testdocvaluesindex junit test run 1 failur 1 error 0 time elaps 0.81 sec junit junit standard error junit note reproduc ant test -dtestcase=testdocvaluesindex -dtestmethod=testaddindex -dtests.seed=-3253978684351194958 -8331223747763543724 junit note test param codec=randomcodecprovid id=standard bytes_var_straight=puls freqcutoff=12 bytes_fixed_sorted=mockrandom locale=es_mx timezone=pacific/chatham junit note test run jvm junit testdocvaluesindex junit note linux 2.6.39-gentoo amd64/sun microsystem inc. 1.6.0_25 64-bit /cpus=8 threads=1 free=89168480 total=125632512 junit junit testcas testaddindex org.apache.lucene.index.values.testdocvaluesindex fail junit first=bytes_fixed_sort second=bytes_var_straight expect 9 10 junit junit.framework.assertionfailederror first=bytes_fixed_sort second=bytes_var_straight expect 9 10 junit org.apache.lucene.index.values.testdocvaluesindexing.testaddindex testdocvaluesindexing.java:208 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1348 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1266 junit junit junit test org.apache.lucene.index.values.testdocvaluesindex fail code
blockjoinquery/collector creat single-pass queri collector implement nest doc approach similar lucene-2454 app must index document join order block iw.add/updatedocu parent doc end block except impl one pass join index time take queri match child doc join parent docid space use blockjoinqueri use blockjoincollector sort parent doc provid sort gather result group parent collector find blockjoinqueri use scorer.visitscor retain child doc correspond collect parent doc search done retriev topgroup provid blockjoinqueri like lucene-2454 less general arbitrari join solr solr-2272 parent/child elasticsearch https //github.com/elasticsearch/elasticsearch/issues/553 sinc must join index time doc block abl handl nest join well join multipl tabl though n't yet test case put new join modul modules/join think refactor join impl put
similarity.stat class term collect statist order support rank method besid tf-idf need make statist need avail statist could comput computeweight soon becom computestat store separ object easi access sinc object use sole subclass similar implent static inner class i.e similarity.stat two way could implement singl similarity.stat class reus rank algorithm case class would member field statist hierarchi stat class one rank algorithm subclass would defin statist need rank algorithm second case stat class defaultsimilar would singl field idf one e.g bm25similar would idf averag field/docu length
speed core test core test gotten slower slower n't realli fast comput probabl frustrat think 1. still random paramet make obscen set like simpletext rarer alway make happen night 2. test make lot document condition night still reason test ordinari run e.g numdoc night 10000 1000 multipli 3. refactor slow huge class lot test like testiw/testir least pull realli slow method like testir.testdiskful class give better parallel
testnrtthread test failur hit fail testnrtthread run test
decoupl index document/field impl think defin minim iter interfac indexabledocument/field index requir index document index would consum bare minimum interfac concret document/field/fieldtyp class oal.docu packag document/field/fieldtyp hierarchi one concret impl interfac app free make impl well mayb eventu make anoth impl enforc global schema eg factor solr 's impl think free design pressur document/field/fieldtyp hierarchi ie class free becom concret fully-featur user-spac class sort friend sugar api adding/remov field getting/set valu type etc. n't need substanti extensibility/hierarchi ie extens point shift indexabledocument/field interfac think mean collaps three class field fieldable/abstracfield/field singl concret class well except lucene-2308 want break dedic class differ field type
openbitset.prevsetbit find previous set bit openbitset use parent test nest document queri execut lucene-2454
testaddindex reproduc test failur turnk trunk r1133385 code junit testsuit org.apache.lucene.index.testaddindex junit test run 2843 failur 1 error 0 time elaps 137.121 sec junit junit standard output junit java.io.filenotfoundexcept _cy.fdx junit org.apache.lucene.store.ramdirectory.filelength ramdirectory.java:121 junit org.apache.lucene.store.mockdirectorywrapper.filelength mockdirectorywrapper.java:606 junit org.apache.lucene.index.segmentinfo.sizeinbyt segmentinfo.java:294 junit org.apache.lucene.index.tieredmergepolicy.s tieredmergepolicy.java:633 junit org.apache.lucene.index.tieredmergepolicy.usecompoundfil tieredmergepolicy.java:611 junit org.apache.lucene.index.indexwriter.addindex indexwriter.java:2459 junit org.apache.lucene.index.testaddindex commitandaddindexes3.dobodi testaddindexes.java:847 junit org.apache.lucene.index.testaddindex runaddindexesthread 1.run testaddindexes.java:675 junit java.io.filenotfoundexcept _cx.fdx junit org.apache.lucene.store.ramdirectory.filelength ramdirectory.java:121 junit org.apache.lucene.store.mockdirectorywrapper.filelength mockdirectorywrapper.java:606 junit org.apache.lucene.index.segmentinfo.sizeinbyt segmentinfo.java:294 junit org.apache.lucene.index.tieredmergepolicy.s tieredmergepolicy.java:633 junit org.apache.lucene.index.tieredmergepolicy.usecompoundfil tieredmergepolicy.java:611 junit org.apache.lucene.index.indexwriter.addindex indexwriter.java:2459 junit org.apache.lucene.index.testaddindex commitandaddindexes3.dobodi testaddindexes.java:847 junit org.apache.lucene.index.testaddindex runaddindexesthread 1.run testaddindexes.java:675 junit junit standard error junit note reproduc ant test -dtestcase=testaddindex -dtestmethod=testaddindexeswithrollback -dtests.seed=9026722750295014952:2645762923088581043 -dtests.multiplier=3 junit note test param codec=randomcodecprovid id=simpletext content=simpletext d=mockrandom c=simpletext locale=fr timezone=africa/kigali junit note test run jvm junit testaddindex junit note linux 2.6.39-gentoo amd64/sun microsystem inc. 1.6.0_25 64-bit /cpus=8 threads=1 free=68050392 total=446234624 junit junit testcas testaddindexeswithrollback org.apache.lucene.index.testaddindex fail junit junit junit.framework.assertionfailederror junit org.apache.lucene.index.testaddindexes.testaddindexeswithrollback testaddindexes.java:932 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1362 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1280 junit junit junit test org.apache.lucene.index.testaddindex fail code fail random 1 test run fail min run code ant test -dtestcase=testaddindex -dtests.seed=9026722750295014952:2645762923088581043 -dtests.multiplier=3 -dtests.iter=200 -dtests.iter.min=1 code
testindexwrit failur aioob trunk r1133486 code junit testsuit org.apache.lucene.index.testindexwrit junit testcas testemptyfieldnam org.apache.lucene.index.testindexwrit caus error junit checkindex fail junit java.lang.runtimeexcept checkindex fail junit org.apache.lucene.util._testutil.checkindex _testutil.java:158 junit org.apache.lucene.util._testutil.checkindex _testutil.java:144 junit org.apache.lucene.store.mockdirectorywrapper.clos mockdirectorywrapper.java:477 junit org.apache.lucene.index.testindexwriter.testemptyfieldnam testindexwriter.java:857 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1362 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1280 junit junit junit test run 39 failur 0 error 1 time elaps 17.634 sec junit junit standard output junit checkindex fail junit segment file=segments_1 numsegments=1 version=format_4_0 lucen 4.0 junit 1 1 name=_0 doccount=1 junit codec=segmentcodec codecs= preflex provider=org.apache.lucene.index.codecs.corecodecprovid 3f78807 junit compound=fals junit hasprox=tru junit numfiles=8 junit size mb =0 junit diagnost os.version=2.6.39-gentoo os=linux lucene.version=4.0-snapshot source=flush os.arch=amd64 java.version=1.6.0_25 java.vendor=sun microsystem inc. junit delet junit test open reader ok junit test field ..ok 1 field junit test field norm ok 1 field junit test term freq prox error java.lang.arrayindexoutofboundsexcept -1 junit java.lang.arrayindexoutofboundsexcept -1 junit org.apache.lucene.index.codecs.preflex.terminfosreader.seekenum terminfosreader.java:212 junit org.apache.lucene.index.codecs.preflex.terminfosreader.seekenum terminfosreader.java:301 junit org.apache.lucene.index.codecs.preflex.terminfosreader.get terminfosreader.java:234 junit org.apache.lucene.index.codecs.preflex.terminfosreader.term terminfosreader.java:371 junit org.apache.lucene.index.codecs.preflex.preflexfield pretermsenum.reset preflexfields.java:719 junit org.apache.lucene.index.codecs.preflex.preflexfield preterms.iter preflexfields.java:249 junit org.apache.lucene.index.perfieldcodecwrapp fieldsread fieldsiterator.term perfieldcodecwrapper.java:147 junit org.apache.lucene.index.checkindex.testtermindex checkindex.java:610 junit org.apache.lucene.index.checkindex.checkindex checkindex.java:495 junit org.apache.lucene.util._testutil.checkindex _testutil.java:154 junit org.apache.lucene.util._testutil.checkindex _testutil.java:144 junit org.apache.lucene.store.mockdirectorywrapper.clos mockdirectorywrapper.java:477 junit org.apache.lucene.index.testindexwriter.testemptyfieldnam testindexwriter.java:857 junit sun.reflect.nativemethodaccessorimpl.invoke0 nativ method junit sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:39 junit sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:25 junit java.lang.reflect.method.invok method.java:597 junit org.junit.runners.model.frameworkmethod 1.runreflectivecal frameworkmethod.java:44 junit org.junit.internal.runners.model.reflectivecallable.run reflectivecallable.java:15 junit org.junit.runners.model.frameworkmethod.invokeexplos frameworkmethod.java:41 junit org.junit.internal.runners.statements.invokemethod.evalu invokemethod.java:20 junit org.junit.rules.testwatchman 1.evalu testwatchman.java:48 junit org.junit.internal.runners.statements.runbefores.evalu runbefores.java:28 junit org.junit.internal.runners.statements.runafters.evalu runafters.java:31 junit org.junit.runners.blockjunit4classrunner.runchild blockjunit4classrunner.java:76 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1362 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1280 junit org.junit.runners.parentrunn 3.run parentrunner.java:193 junit org.junit.runners.parentrunn 1.schedul parentrunner.java:52 junit org.junit.runners.parentrunner.runchildren parentrunner.java:191 junit org.junit.runners.parentrunner.access 000 parentrunner.java:42 junit org.junit.runners.parentrunn 2.evalu parentrunner.java:184 junit org.junit.internal.runners.statements.runbefores.evalu runbefores.java:28 junit org.junit.internal.runners.statements.runafters.evalu runafters.java:31 junit org.junit.runners.parentrunner.run parentrunner.java:236 junit junit.framework.junit4testadapter.run junit4testadapter.java:39 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.run junittestrunner.java:422 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.launch junittestrunner.java:931 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.main junittestrunner.java:758 junit test store field .ok 0 total field count avg 0 field per doc junit test term vector ..ok 0 total vector count avg 0 term/freq vector field per doc junit fail junit warn fixindex would remov refer segment full except junit java.lang.runtimeexcept term index test fail junit org.apache.lucene.index.checkindex.checkindex checkindex.java:508 junit org.apache.lucene.util._testutil.checkindex _testutil.java:154 junit org.apache.lucene.util._testutil.checkindex _testutil.java:144 junit org.apache.lucene.store.mockdirectorywrapper.clos mockdirectorywrapper.java:477 junit org.apache.lucene.index.testindexwriter.testemptyfieldnam testindexwriter.java:857 junit sun.reflect.nativemethodaccessorimpl.invoke0 nativ method junit sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:39 junit sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:25 junit java.lang.reflect.method.invok method.java:597 junit org.junit.runners.model.frameworkmethod 1.runreflectivecal frameworkmethod.java:44 junit org.junit.internal.runners.model.reflectivecallable.run reflectivecallable.java:15 junit org.junit.runners.model.frameworkmethod.invokeexplos frameworkmethod.java:41 junit org.junit.internal.runners.statements.invokemethod.evalu invokemethod.java:20 junit org.junit.rules.testwatchman 1.evalu testwatchman.java:48 junit org.junit.internal.runners.statements.runbefores.evalu runbefores.java:28 junit org.junit.internal.runners.statements.runafters.evalu runafters.java:31 junit org.junit.runners.blockjunit4classrunner.runchild blockjunit4classrunner.java:76 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1362 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1280 junit org.junit.runners.parentrunn 3.run parentrunner.java:193 junit org.junit.runners.parentrunn 1.schedul parentrunner.java:52 junit org.junit.runners.parentrunner.runchildren parentrunner.java:191 junit org.junit.runners.parentrunner.access 000 parentrunner.java:42 junit org.junit.runners.parentrunn 2.evalu parentrunner.java:184 junit org.junit.internal.runners.statements.runbefores.evalu runbefores.java:28 junit org.junit.internal.runners.statements.runafters.evalu runafters.java:31 junit org.junit.runners.parentrunner.run parentrunner.java:236 junit junit.framework.junit4testadapter.run junit4testadapter.java:39 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.run junittestrunner.java:422 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.launch junittestrunner.java:931 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.main junittestrunner.java:758 junit junit warn 1 broken segment contain 1 document detect junit junit junit standard error junit note reproduc ant test -dtestcase=testindexwrit -dtestmethod=testemptyfieldnam -dtests.seed=-3770357642070518646 -3121175410586002489 -dtests.multiplier=3 junit note test param codec=preflex locale=zh timezone=indian/antananarivo junit note test run jvm junit testdatetool testdeletionpolici testdocsandposit testflex testindexreaderclonenorm testindexwrit junit note linux 2.6.39-gentoo amd64/sun microsystem inc. 1.6.0_25 64-bit /cpus=8 threads=1 free=85972280 total=232521728 junit junit test org.apache.lucene.index.testindexwrit fail code
add lucenetestcase.rar /lucenetestcase.atleast lucene-3175 test sped lot use reason number iter normal crank night also crazi thing rare normal build e.g simpletext payload crazi merg param etc also found bug general paramet fix howev made code look messi propos new method instead crazi code test like code int numdoc test_night 1000 100 random_multipli code use code int numdoc atleast 100 code appli multipli also factor night final add random fudg e.g local run sometim 127 doc sometim 113 doc etc addit instead code like code test_night random.nextboolean || random.nextint 20 17 code code rare code appli night also multipli logarithm growth
nrtcachingdirectory.deletefil alway throw except silli bug
docvalu type recor fnx file earli fail user specifi incompat type current segment merger fail docvalu type compat across segment alreadi catch problem somebodi chang valu type field within one segment across segment order record type fnx fiel alon field number mark 4.0 sinc block land trunk
class cotrub directori org.apache.lucene.index.indexsplitt creat non correct index use method indexsplitter.split file destdir string seg lucen cotrib directori contrib/misc/src/java/org/apache/lucene/index creat index segment descriptor file wrong data name wrong number repres name segment would creat next index segment index alreadi name result either imposs creat new segment crate corrupt segment
testindexwriter.testthreadinterruptdeadlock fail ca n't reproduc trunk r1134163 ran time tests.iter=200 could n't reproduc believ like issu anyway code junit testsuit org.apache.lucene.index.testindexwrit junit testcas testthreadinterruptdeadlock org.apache.lucene.index.testindexwrit fail junit junit junit.framework.assertionfailederror junit org.apache.lucene.index.testindexwriter.testthreadinterruptdeadlock testindexwriter.java:1203 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1403 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1321 junit junit junit test run 40 failur 1 error 0 time elaps 23.79 sec junit junit standard output junit checkindex fail junit error could read segment file directori junit java.io.filenotfoundexcept segments_2w junit org.apache.lucene.store.mockdirectorywrapper.openinput mockdirectorywrapper.java:407 junit org.apache.lucene.index.codecs.defaultsegmentinfosreader.openinput defaultsegmentinfosreader.java:112 junit org.apache.lucene.index.codecs.defaultsegmentinfosreader.read defaultsegmentinfosreader.java:45 junit org.apache.lucene.index.segmentinfos.read segmentinfos.java:257 junit org.apache.lucene.index.segmentinfo 1.dobodi segmentinfos.java:287 junit org.apache.lucene.index.segmentinfo findsegmentsfile.run segmentinfos.java:698 junit org.apache.lucene.index.segmentinfo findsegmentsfile.run segmentinfos.java:533 junit org.apache.lucene.index.segmentinfos.read segmentinfos.java:283 junit org.apache.lucene.index.checkindex.checkindex checkindex.java:311 junit org.apache.lucene.util._testutil.checkindex _testutil.java:154 junit org.apache.lucene.util._testutil.checkindex _testutil.java:144 junit org.apache.lucene.index.testindexwrit indexerthreadinterrupt.run testindexwriter.java:1154 junit junit checkindex fail unexpect except junit java.lang.runtimeexcept checkindex fail junit org.apache.lucene.util._testutil.checkindex _testutil.java:158 junit org.apache.lucene.util._testutil.checkindex _testutil.java:144 junit org.apache.lucene.index.testindexwrit indexerthreadinterrupt.run testindexwriter.java:1154 junit indexreader.open fail unexpect except junit java.io.filenotfoundexcept segments_2w junit org.apache.lucene.store.mockdirectorywrapper.openinput mockdirectorywrapper.java:407 junit org.apache.lucene.index.codecs.defaultsegmentinfosreader.openinput defaultsegmentinfosreader.java:112 junit org.apache.lucene.index.codecs.defaultsegmentinfosreader.read defaultsegmentinfosreader.java:45 junit org.apache.lucene.index.segmentinfos.read segmentinfos.java:257 junit org.apache.lucene.index.directoryread 1.dobodi directoryreader.java:88 junit org.apache.lucene.index.segmentinfo findsegmentsfile.run segmentinfos.java:698 junit org.apache.lucene.index.directoryreader.open directoryreader.java:84 junit org.apache.lucene.index.indexreader.open indexreader.java:500 junit org.apache.lucene.index.indexreader.open indexreader.java:293 junit org.apache.lucene.index.testindexwrit indexerthreadinterrupt.run testindexwriter.java:1161 junit junit standard error junit note reproduc ant test -dtestcase=testindexwrit -dtestmethod=testthreadinterruptdeadlock -dtests.seed=6733070832417768606:3130345095020099096 junit note test param codec=randomcodecprovid =mockrandom f6=simpletext f7=mockrandom f8=mocksep f9=standard f1=simpletext f0=standard f3=standard f2=mocksep f5=puls freqcutoff=12 f4=mockfixedintblock blocksize=552 c=mockvariableintblock baseblocksize=43 d9=mockvariableintblock baseblocksize=43 d8=mockrandom d5=mocksep d4=puls freqcutoff=12 d7=mockfixedintblock blocksize=55 2 d6=mockvariableintblock baseblocksize=43 d25=mocksep d0=mockvariableintblock baseblocksize=43 c29=mockfixedintblock blocksize=552 d24=puls freqcutoff=12 d1=mockfixedintblock blocksize=552 c28= standard d23=simpletext d2=simpletext c27=mocksep d22=standard d3=mockrandom d21=mockrandom d20=simpletext c22=mocksep c21=puls freqcutoff=12 c20=simpletext d29=simpletext c26=mockvariableintblo ck baseblocksize=43 d28=standard c25=mockrandom d27=mockvariableintblock baseblocksize=43 c24=puls freqcutoff=12 d26=mockrandom c23=mockfixedintblock blocksize=552 e9=puls freqcutoff=12 e8=st andard e7=mocksep e6=mockrandom e5=simpletext c17=mockfixedintblock blocksize=552 e3=mockfixedintblock blocksize=552 d12=puls freqcutoff=12 c16=mockvariableintblock baseblocksize=43 e4=puls fr eqcutoff=12 d11=mockfixedintblock blocksize=552 c19=mockrandom e1=mocksep d14=mockvariableintblock baseblocksize=43 c18=simpletext e2=standard d13=mockrandom e0=simpletext d10=mocksep d19=mockvaria bleintblock baseblocksize=43 c11=mockvariableintblock baseblocksize=43 c10=mockrandom d16=standard c13=mockrandom c12=simpletext d15=mocksep d18=puls freqcutoff=12 c15=standard d17=mockfixedintbl ock blocksize=552 c14=mocksep b3=standard b2=mocksep b5=puls freqcutoff=12 b4=mockfixedintblock blocksize=552 b7=mockfixedintblock blocksize=552 b6=mockvariableintblock baseblocksize=43 d50=mock random b9=mockrandom b8=simpletext d43=simpletext d42=standard d41=mockvariableintblock baseblocksize=43 d40=mockrandom d47=puls freqcutoff=12 d46=mockfixedintblock blocksize=552 b0=mockrandom d 45=standard b1=mockvariableintblock baseblocksize=43 d44=mocksep d49=mockrandom d48=simpletext c6=simpletext c5=standard c4=mockvariableintblock baseblocksize=43 c3=mockrandom c9=mockfixedintblock bl ocksize=552 c8=standard c7=mocksep d30=standard d32=puls freqcutoff=12 d31=mockfixedintblock blocksize=552 c1=puls freqcutoff=12 d34=mockfixedintblock blocksize=552 c2=mocksep d33=mockvariab leintblock baseblocksize=43 d36=mockrandom c0=simpletext d35=simpletext d38=mocksep d37=puls freqcutoff=12 d39=mockvariableintblock baseblocksize=43 e92=mockfixedintblock blocksize=552 e93=pulsin g freqcutoff=12 e90=mocksep e91=standard e89=standard e88=mockvariableintblock baseblocksize=43 e87=mockrandom e86=mockfixedintblock blocksize=552 e85=mockvariableintblock baseblocksize=43 e84=mock ep e83=puls freqcutoff=12 e80=mockfixedintblock blocksize=552 e81=simpletext e82=mockrandom e77=standard e76=mocksep e79=puls freqcutoff=12 e78=mockfixedintblock blocksize=552 e73=mockvariabl eintblock baseblocksize=43 e72=mockrandom e75=simpletext e74=standard binary=mocksep f98=mockrandom f97=simpletext f99=mocksep f94=puls freqcutoff=12 f93=mockfixedintblock blocksize=552 f96=mock variableintblock baseblocksize=43 f95=mockrandom e95=mockrandom e94=simpletext e97=standard e96=mocksep e99=mocksep e98=puls freqcutoff=12 id=standard f34=simpletext f33=standard f32=mockvariabl eintblock baseblocksize=43 f31=mockrandom f30=mockfixedintblock blocksize=552 f39=simpletext f38=mockvariableintblock baseblocksize=43 f37=mockrandom f36=puls freqcutoff=12 f35=mockfixedintblock b locksize=552 f43=mocksep f42=puls freqcutoff=12 f45=mockfixedintblock blocksize=552 f44=mockvariableintblock baseblocksize=43 f41=standard f40=mocksep f47=simpletext f46=standard f49=mocksep f4 8=puls freqcutoff=12 content=standard e19=standard e18=mocksep e17=simpletext f12=mockrandom e16=standard f11=simpletext f10=mockfixedintblock blocksize=552 e15=mockvariableintblock baseblocksize= 43 e14=mockrandom f16=mockfixedintblock blocksize=552 e13=mocksep e12=puls freqcutoff=12 f15=mockvariableintblock baseblocksize=43 e11=simpletext f14=mocksep e10=standard f13=puls freqcutoff= 12 f19=standard f18=mockvariableintblock baseblocksize=43 f17=mockrandom e29=mockrandom e26=mocksep f21=standard e25=puls freqcutoff=12 f20=mocksep e28=mockfixedintblock blocksize=552 f23=pulsi ng freqcutoff=12 e27=mockvariableintblock baseblocksize=43 f22=mockfixedintblock blocksize=552 f25=mockrandom e22=mockfixedintblock blocksize=552 f24=simpletext e21=mockvariableintblock baseblocksize= 43 f27=standard e24=mockrandom f26=mocksep e23=simpletext f29=mocksep f28=puls freqcutoff=12 e20=puls freqcutoff=12 field=mocksep string=mockvariableintblock baseblocksize=43 e30=mockfixedin tblock blocksize=552 e31=puls freqcutoff=12 a98=mocksep e34=simpletext a99=standard e35=mockrandom f79=mocksep e32=mockvariableintblock baseblocksize=43 e33=mockfixedintblock blocksize=552 b97=m ockrandom f77=mockrandom e38=mockvariableintblock baseblocksize=43 b98=mockvariableintblock baseblocksize=43 f78=mockvariableintblock baseblocksize=43 e39=mockfixedintblock blocksize=552 b99=standard f75=mockfixedintblock blocksize=552 e36=puls freqcutoff=12 f76=puls freqcutoff=12 e37=mocksep f73=puls freqcutoff=12 f74=mocksep f71=standard f72=simpletext f81=standard f80=mocksep e40= mockvariableintblock baseblocksize=43 e41=standard e42=simpletext e43=mocksep e44=standard e45=mockfixedintblock blocksize=552 e46=puls freqcutoff=12 f86=standard e47=simpletext f87=simpletext e 48=mockrandom f88=puls freqcutoff=12 e49=mocksep f89=mocksep f82=mockvariableintblock baseblocksize=43 f83=mockfixedintblock blocksize=552 f84=simpletext f85=mockrandom f90=puls freqcutoff=12 f92=mockvariableintblock baseblocksize=43 f91=mockrandom str=mockrandom a76=standard e56=standard f59=puls freqcutoff=12 a77=simpletext e57=simpletext a78=puls freqcutoff=12 e54=mockrandom f 57=standard a79=mocksep e55=mockvariableintblock baseblocksize=43 f58=simpletext e52=mockvariableintblock baseblocksize=43 e53=mockfixedintblock blocksize=552 e50=puls freqcutoff=12 e51=mocksep f 51=mocksep f52=standard f50=mockrandom f55=mockvariableintblock baseblocksize=43 f56=mockfixedintblock blocksize=552 f53=puls freqcutoff=12 e58=mockfixedintblock blocksize=552 f54=mocksep e59=pul sing freqcutoff=12 a80=puls freqcutoff=12 e60=puls freqcutoff=12 a82=mockvariableintblock baseblocksize=43 a81=mockrandom a84=mockrandom a83=simpletext a86=standard a85=mocksep a89=simpletext f68=mockvariableintblock baseblocksize=43 e65=puls freqcutoff=12 f69=mockfixedintblock blocksize=552 e66=mocksep a87=mockvariableintblock baseblocksize=43 e67=mockvariableintblock baseblocksize=43 a88=mockfixedintblock blocksize=552 e68=mockfixedintblock blocksize=552 e61=simpletext e62=mockrandom e63=mocksep e64=standard f60=mockfixedintblock blocksize=552 f61=puls freq cutoff=12 f62=mockrandom f63=mockvariableintblock baseblocksize=43 e69=standard f64=simpletext f65=mockrandom f66=mocksep f67=standard f70=mockfixedintblock blocksize=552 a93=mocksep a92=puls freqcutoff=12 a91=simpletext e71=simpletext a90=standard e70=standard a97=mockvariableintblock baseblocksize=43 a96=mockrandom a95=puls freqcutoff=12 a94=mockfixedintblock blocksize=552 c58=mockrandom a63=mockfixedintblock blocksize=552 a64=puls freqcutoff=12 c59=mockvariableintblock baseblocksize=43 c56=mockfixedintblock blocksize=552 d59=mockrandom a61=mocksep c57=puls freqcutoff=12 a62=standard c54=puls freqcutoff=12 c55=mocksep a60=simpletext c52=standard c53=simpletext d53=simpletext d54=mockrandom d51=mockvariableintblock baseblocksize=43 d52=mockfixedintblock blocksize=552 d57=puls freqcutoff=12 b62=standard d58=mocksep b63=simpletext d55=standard b60=mockrandom d56=simpletext b61=mockvariableintblock baseblocksize=43 b56=standard b55=mocksep b54=mockrandom b53=simpletext d61=mockvariableintblock baseblocksize=43 b59=mockvariableintblock baseblocksize=43 d60=mockrandom b58=mocksep b57=puls freqcutoff=12 c62=standard c61=mocksep a59=mockvariableintblock baseblocksize=43 c60=mockrandom a58=mockrandom a57=mockfixedintblock blocksize=552 a56=mockvariableintblock baseblocksize=43 a55=mocksep a54=puls freqcutoff=12 a72=mockrandom c67=standard a73=mockvariableintblock baseblocksize=43 c68=simpletext a74=standard c69=puls freqcutoff=12 a75=simpletext c63=mockvariableintblock baseblocksize=43 c64=mockfixedintblock blocksize=552 a70=mockvariableintblock baseblocksize=43 c65=simpletext a71=mockfixedintblock blocksize=552 c66=mockrandom d62=mocksep d63=standard d64=mockfixedintblock blocksize=552 b70=standard d65=puls freqcutoff=12 b71=puls freqcutoff=12 d66=mockvariableintblock baseblocksize=43 b72=mocksep d67=mockfixedintblock blocksize=552 b73=mockvariableintblock baseblocksize=43 d68=simpletext b74=mockfixedintblock blocksize=552 d69=mockrandom b65=puls freqcutoff=12 b64=mockfixedintblock blocksize=552 b67=mockvariableintblock baseblocksize=43 b66=mockrandom d70=simpletext b69=mockrandom b68=simpletext d72=mocksep d71=puls freqcutoff=12 c71=puls freqcutoff=12 c70=mockfixedintblock blocksize=552 a69=puls freqcutoff=12 c73=mockvariableintblock baseblocksize=43 c72=mockrandom a66=mockrandom a65=simpletext a68=standard a67=mocksep c32=mocksep c33=standard c30=simpletext c31=mockrandom c36=mockvariableintblock baseblocksize=43 a41=puls freqcutoff=12 c37=mockfixedintblock blocksize=552 a42=mocksep a0=mockrandom c34=puls freqcutoff=12 c35=mocksep a40=simpletext b84=mocksep d79=mockfixedintblock blocksize=552 b85=standard b82=simpletext d77=mocksep c38=standard b83=mockrandom d78=standard c39=simpletext b80=mockrandom d75=standard b81=mockvariableintblock baseblocksize=43 d76=simpletext d73=mockrandom d74=mockvariableintblock baseblocksize=43 d83=mockrandom a9=mockfixedintblock blocksize=552 d82=simpletext d81=mockfixedintblock blocksize=552 d80=mockvariableintblock baseblocksize=43 b79=mockfixedintblock blocksize=552 b78=mocksep b77=puls freqcutoff=12 b76=simpletext b75=standard a1=puls freqcutoff=12 a35=puls freqcutoff=12 a2=mocksep a34=mockfixedintblock blocksize=552 a3=mockvariableintblock baseblocksize=43 a33=standard a4=mockfixedintblock blocksize=552 a32=mocksep a5=mockrandom a39=mockrandom c40=simpletext a6=mockvariableintblock baseblocksize=43 a38=simpletext a7=standard a37=mockfixedintblock blocksize=552 a8=simpletext a36=mockvariableintblock baseblocksize=43 c41=mockfixedintblock blocksize=552 c42=puls freqcutoff=12 c43=mockrandom c44=mockvariableintblock baseblocksize=43 c45=simpletext a50=mockvariableintblock baseblocksize=43 c46=mockrandom a51=mockfixedintblock blocksize=552 c47=mocksep a52=simpletext c48=standard a53=mockrandom b93=mockfixedintblock blocksize=552 d88=mockrandom c49=mockvariableintblock baseblocksize=43 b94=puls freqcutoff=12 d89=mockvariableintblock baseblocksize=43 b95=mockrandom b96=mockvariableintblock baseblocksize=43 d84=puls freqcutoff=12 b90=simpletext d85=mocksep b91=puls freqcutoff=12 d86=mockvariableintblock baseblocksize=43 b92=mocksep d87=mockfixedintblock blocksize=552 d92=standard d91=mocksep d94=puls freqcutoff=12 d93=mockfixedintblock blocksize=552 b87=mockfixedintblock blocksize=552 b86=mockvariableintblock baseblocksize=43 d90=simpletext b89=mockrandom b88=simpletext a44=mockvariableintblock baseblocksize=43 a43=mockrandom a46=simpletext a45=standard a48=standard a47=mocksep c51=mockfixedintblock blocksize=552 a49=mockfixedintblock blocksize=552 c50=mockvariableintblock baseblocksize=43 d98=mockfixedintblock blocksize=552 d97=mockvariableintblock baseblocksize=43 d96=mocksep d95=puls freqcutoff=12 d99=mockrandom a20=mockvariableintblock baseblocksize=43 c99=simpletext c98=standard c97=mockvariableintblock baseblocksize=43 c96=mockrandom b19=mockvariableintblock baseblocksize=43 a16=puls freqcutoff=12 a17=mocksep b17=puls freqcutoff=12 a14=standard b18=mocksep a15=simpletext a12=simpletext a13=mockrandom a10=mockvariableintblock baseblocksize=43 a11=mockfixedintblock blocksize=552 b11=mockfixedintblock blocksize=552 b12=puls freqcutoff=12 b10=standard b15=simpletext b16=mockrandom a18=mockrandom b13=mockvariableintblock baseblocksize=43 a19=mockvariableintblock baseblocksize=43 b14=mockfixedintblock blocksize=552 b30=mockrandom a31=mocksep a30=puls freqcutoff=12 b28=simpletext a25=mockvariableintblock baseblocksize=43 b29=mockrandom a26=mockfixedintblock blocksize=552 a27=simpletext a28=mockrandom a21=mocksep a22=standard a23=mockfixedintblock blocksize=552 a24=puls freqcutoff=12 b20=mockrandom b21=mockvariableintblock baseblocksize=43 b22=standard b23=simpletext a29=puls freqcutoff=12 b24=mocksep b25=standard b26=mockfixedintblock blocksize=552 b27=puls freqcutoff=12 b41=puls freqcutoff=12 b40=mockfixedintblock blocksize=552 c77=mockrandom c76=simpletext c75=mockfixedintblock blocksize=552 c74=mockvariableintblock baseblocksize=43 c79=simpletext c78=standard c80=mocksep c83=mockrandom c84=mockvariableintblock baseblocksize=43 c81=mockfixedintblock blocksize=552 b39=mockfixedintblock blocksize=552 c82=puls freqcutoff=12 b37=standard b38=simpletext b35=mockrandom b36=mockvariableintblock baseblocksize=43 b33=mockvariableintblock baseblocksize=43 b34=mockfixedintblock blocksize=552 b31=puls freqcutoff=12 b32=mocksep str2=mocksep b50=mockvariableintblock baseblocksize=43 b52=simpletext str3=mockvariableintblock baseblocksize=43 b51=standard c86=standard tvtest=mocksep c85=mocksep c88=puls freqcutoff=12 c87=mockfixedintblock blocksize=552 c89=mockvariableintblock baseblocksize=43 c90=simpletext c91=mockrandom c92=standard c93=simpletext c94=puls freqcutoff=12 c95=mocksep content1=mockrandom b46=puls freqcutoff=12 b47=mocksep content3=mockfixedintblock blocksize=552 b48=mockvariableintblock baseblocksize=43 content4=mockvariableintblock baseblocksize=43 b49=mockfixedintblock blocksize=552 content5=puls freqcutoff=12 b42=simpletext b43=mockrandom b44=mocksep b45=standard locale=sk timezone=america/rainy_riv junit note test run jvm junit testdatetool testdeletionpolici testdocsandposit testflex testindexreaderclonenorm testindexwrit junit note linux 2.6.39-gentoo amd64/sun microsystem inc. 1.6.0_25 64-bit /cpus=8 threads=1 free=86065896 total=127401984 junit junit test org.apache.lucene.index.testindexwrit fail code
teststressindexing2 testmulticonfig failur trunk r1134311 reproduc code junit testsuit org.apache.lucene.index.teststressindexing2 junit test run 1 failur 2 error 0 time elaps 0.882 sec junit junit standard error junit java.lang.assertionerror ram 460908 expect 408216 flush mem 395100 activ 65808 junit org.apache.lucene.index.documentswriterflushcontrol.assertmemori documentswriterflushcontrol.java:102 junit org.apache.lucene.index.documentswriterflushcontrol.doafterdocu documentswriterflushcontrol.java:164 junit org.apache.lucene.index.documentswriter.updatedocu documentswriter.java:380 junit org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1473 junit org.apache.lucene.index.indexwriter.updatedocu indexwriter.java:1445 junit org.apache.lucene.index.teststressindexing2 indexingthread.indexdoc teststressindexing2.java:723 junit org.apache.lucene.index.teststressindexing2 indexingthread.run teststressindexing2.java:757 junit note reproduc ant test -dtestcase=teststressindexing2 -dtestmethod=testmulticonfig -dtests.seed=2571834029692482827 -8116419692655152763 junit note reproduc ant test -dtestcase=teststressindexing2 -dtestmethod=testmulticonfig -dtests.seed=2571834029692482827 -8116419692655152763 junit follow except thrown thread junit thread thread-0 junit junit.framework.assertionfailederror java.lang.assertionerror ram 460908 expect 408216 flush mem 395100 activ 65808 junit junit.framework.assert.fail assert.java:47 junit org.apache.lucene.index.teststressindexing2 indexingthread.run teststressindexing2.java:762 junit note test param codec=randomcodecprovid f33=standard f57=mockfixedintblock blocksize=649 f11=standard f41=mockrandom f40=standard f62=mockrandom f75=standard f73=mocksep f29=mockfixedintblock blocksize=649 f83=mockrandom f66=mocksep f49=mockvariableintblock baseblocksize=9 f72=puls freqcutoff=7 f54=standard id=mockfixedintblock blocksize=649 f80=mockrandom f94=mocksep f93=puls freqcutoff=7 f95=standard locale=en_sg timezone=pacific/palau junit note test run jvm junit teststressindexing2 junit note linux 2.6.39-gentoo amd64/sun microsystem inc. 1.6.0_25 64-bit /cpus=8 threads=1 free=133324528 total=158400512 junit junit testcas testmulticonfig org.apache.lucene.index.teststressindexing2 fail junit r1.numdoc =17 vs r2.numdoc =16 junit junit.framework.assertionfailederror r1.numdoc =17 vs r2.numdoc =16 junit org.apache.lucene.index.teststressindexing2.verifyequ teststressindexing2.java:308 junit org.apache.lucene.index.teststressindexing2.verifyequ teststressindexing2.java:278 junit org.apache.lucene.index.teststressindexing2.testmulticonfig teststressindexing2.java:124 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1403 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1321 junit junit junit testcas testmulticonfig org.apache.lucene.index.teststressindexing2 fail junit thread threw uncaught except junit junit.framework.assertionfailederror thread threw uncaught except junit org.apache.lucene.util.lucenetestcase.teardown lucenetestcase.java:603 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1403 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1321 junit junit junit test org.apache.lucene.index.teststressindexing2 fail code
add topdocs.merg merg multipl topdoc 's easi today merg topdoc eg produc multipl shard support arbitrari sort
twophasecommit interfac would like propos twophasecommit interfac declar method necessari implement 2-phase commit algorithm preparecommit commit rollback prepare/commit one variant take map string string commitdata follow one indexwrit addit twophasecommittool implement 2-phase commit amongst sever tpcs indexwrit implement interfac allow run 2-phase commit algorithm multipl iw iw object implement interfac mark interfac lucene.intern block futur pretti advanc stuff anyway post patch soon
optim fixedstraightbyt byte size 1 current read byte pagedbyt instanc wich unneed singl byte valu like norm fast access simpli straight array
optim run forev keep delet doc time cascad merg optim also delet document merg run merg polici see result singl segment still optim sinc pend delet single-seg merg repeat indefinit long app keep delet doc
chang default directori impl 64bit linux mmap consist nrt test fedora 13 linux 64 bit jvm oracl 1.6.0_21 see mmapdir get better search merg perform compar niofsdir think fix default
cleanup mmapdirectori use one mmapindexinput impl map size power 2 robert discuss littl bit mike 's investig use singlemmapindexinput togeth multimmapindexinput lead hotspot slowdown sometim follow idea multimmapindexinput almost fast singlemmapindexinput switch buffer boundari done except catch block normal code path alway like single* seek method use strang calcul modulo total bogus could simpli int bufoffset int pos maxbufs strang way calcul modulo origin code speed suggest longer use arbitrari buffer size pass power 2 indexinput size calcul seek anywher els would simpl bit shift oper mask modulo calcul ctor like numericutil calcul precisionstep maximum buffer size 2^30 2^31-1 that issu opinion buffer size 2^31-1 stupid case longer fit page boundari mmap get harder o/ provid patch cleanup
improv compound file handl current compoundfileread could use improv see follow problem csindexinput extend bufferedindexinput stupid directori like mmap seek everi readintern possibl directori overrid improv handl compound file exampl seem impl' thing scratch would wrap ii direct extend bufferedindexinput add compound file offset x seek call overrid length cours couldnt throw read past eof alway user could read next file left unawar howev directori could handl better exampl mmapdirectori could return indexinput simpli mmap slice cfs file under bytebuff etc natur bound check alreadi etc wouldnt need buffer even need add offset seek posit would work think tri refactor directori custom compound file handl simplest case least code chang would add directory.java code public directori opencompoundinput string filenam return new compoundfileread filenam code code depend upon fact compound file implement directori transpar least subclass could overrid recurs littl ugli could still label expert+internal+experiment whatev
add datainput/dataoutput subclass deleg inputstream/outputstream class would handi fst serialization/deseri
rate-limit io use merg larg merg mess search increas nrt reopen time see http //blog.mikemccandless.com/2011/06/lucenes-near-real-time-search-is-fast.html simpl rate limit improv spikey nrt reopen time big merg think somehow make possibl like would reduc impact search well typic app index search box rush see merg complet good tradeoff
remov multitermqueri get/inc/clear totalnumberofterm method correct index one segment also thread safe mean call query.rewrit modifi origin queri thing add confus think remov multitermqueri thing use nrq test condition assert anyway
customscorequeri call weight call createweight thank uwe help track bug pull hair hour lucene-3174
move query.weight indexsearch protect method issu sever time latest lucene-3207 method query.weight left queri backward reason lucen 2.9 chang weight class method call top-level queri done indexsearch method util method noth queri itsself combin createweight method call normal afterward problem queri wrap queri like customscor constantscor boolean call query.weight instead query.createweight normal two time lead strang bug 3.3 make query.weight simpli deleg indexsearch 's replac method big deprec warn user see indexsearch itsself method protect call itsself subclass indexsearch deleg backward problem protect access class packag would suggest method name indexsearcher.createnormalizedweight queri q
memori codec codec store terms/post ram use fst bytesref use primari key field ensur lookup n't need hit disk keep nrt reopen time fast even io content
tieredmergepolici expos control aggress segment delet target tmp today alway linear pro-rat merg 's score accord pctg document delet 'd like 1 put power factor score multipl 2 default stronger favor merg away delet
use atomicreadercontext also customscoreprovid move atomicreadercontext one place chang use customscorequeri 's customscoreprovid also take atomicreadercontext instead indexread may help user effect implement custom score absolut docid need
sloppyphrasescor sometim comput infinit freq report user list http //www.lucidimagination.com/search/document/400cbc528ed63db9/score_of_infinity_on_dismax_queri
store docvalu per segment instead per field current store docvalu per field result least one file per field use docvalu two per field per segment depend impl. yet tri default pack docvalu singl file possibl enabl need hold docvalu memori index write disk flush segment
improv docvalu merg docvalu impl still load valu merg segment memori merg effici merg fli without buffer memori
make cfs append current cfs creat file written flush merg disk file copi cfs format basic unnecessari file time write least one file direct cfs save reason amount io instanc store field could written direct index codec flush one written file append direct optim nice sideeffect lucen index import docvalu lucene-3216 could transpar pack per field file singl file docvalu without chang code lucene-3216 resolv
chang sortfield type enum updat solr-2533 patch one issu int valu given new type use anoth chang mean time sinc n't use field bitset kind way convert enum
implement various rank model similar lucene-3174|http //issues.apache.org/jira/browse/lucene-3174 done final work implement standard rank model current dfr bm25 lm menu done easystat contain statist might relev rank algorithm easysimilar ancestor similar hide docscor much implement detail possibl _bm25_ current mock implement might ok _lm_ _dfr_ so-cal _information-bas models_
buffer delet count ram found work lucene-2548 freez delet creat frozenbuffereddelet set bytesus fail account ram requir term byte term field
searchwithsorttask ignor sort doc work lucene-3912 found follow code code field.equ doc sortfield0 sortfield.field_doc field.equ score sortfield0 sortfield.field_scor code mean set sortfield.field_doc ignor n't know much code seem like valid set obvious bug
bug bytearraydatainput bytearraydatainput byte ctor n't actual work thing like readvint work other fail due assert problem doesnt set thing like limit ctor think ctor call reset code use pass null ctor initi use reset instead could call bytearrayinput bytesref.empty_byt want final reset 's limit look like offset len
optim termsenum.seek caller n't need next term codec abl save cpu caller interest exact match eg memori codec simpletext effici fstenum lookup know caller n't need know term follow seek term case like lucen eg iw delet document term term found given segment n't need know ceil term likewis termqueri look term segment done chang part lucene-3030 new term index 's abl save seek exact-on lookup memori codec also save cpu think commit today chang add boolean onlyexact param seek bytesref
add rewrit support sortfield.tostr miss ad support new rewrit sortfield type tostr
add fix size docvalu int variant expos array possibl current variabl bit pack int implement flexibl score load field cach desir fix int implement 8 16 32 64 bit
move mutablevalu common modul solr make use mutablevalue* seri class improv perform group functionqueri think use valuesourc implement consequ need move class order move valuesourc yonik point class use beyond functionqueri might use solr modul howev n't think belong lucen core sinc n't realli relat search function therefor think put common modul serv depend solr modul
huperdupersynonymsfilter? current synonymsfilt use lot ram cpu especi build time think yesterday heard huge synonym file three time think use fst-base structur share input output effici tokenstream api e.g use save/restorest instead cloneattribut
provid limit phrase analysi fastvectorhighlight larger document fvh spend lot time tri find best-scor snippet examin everi possibl phrase form match term document one will accept less-than-perfect score limit number phrase examin substanti speedup possibl analog highlight limit number charact analyz patch includ artif test case show 1000x speedup normal test environ english document random queri see speedup around 3-10x set phraselimit=1 effect select first possibl snippet document site oper way show first snippet would big win us phraselimit -1 get exist fvh behavior larger valu phraselimit may get substanti speedup normal case get benefit protect blow-up patholog case
spanmultitermquerywrapp prefix queri issu tri search spanqueri prefixqueri messag return use spanmultitermquerywrapp suitabl spanrewritemethod problem wildcardqueri rewrit function wildcard queri prefix new prefix queri creat rewrit method set spanrewritemethod prefix queri return 's rewritten prefix queri return return rewritten return rewritten.rewrit reader attach patch unit test includ
drop java 5 support discuss think need drop java 5 support reason total untest continu build process test java5 releas candid readi enough claim support need hudson actual run test java 5 unmaintain bug either hack around test disabl warn place thing simpli fix actual support someth longer maintain find jre bug http //wiki.apache.org/lucene-java/sunjavabug import bug actual get fix everyth hack limit thing like allow 20 slower group speed find hard believ sacrif perform summari n't test buggi unmaintain sacrif perform think need cutov build system next releas requir java 6
move functionqueri valuesourc docvalu queri modul resolv functionqueri sort issu move mutablevalu class move functionqueri valuesourc docvalu queri modul
remov lucen core 's functionqueri impl part consolid functionqueri want remov lucen core 's impl includ work make sure function provid core impl also provid new modul test port across increas test coverag
contrib/module-uptod assum name match path jar ad new queri modul tri chang project name contrib/queri queries-contrib howev current contrib-uptod assum name properti use path jar name use name path must set valu queri sinc path contrib/queri howev project name queries-contrib actual jar file lucene-queries-contrib- version .jar lucene-queries- version .jar expect consequ think need separ path name jar name properti simplic think ad new jar-nam properti suffic option omit fill name properti
invert ir.getdeldoc ir.getlivedoc spinoff lucene-1536 need fix low level filter delet doc match filter ie set bit mean doc accept filter push way enum possible/appropri chang also invert mean first arg termsenum.docs/andposit renam skipdoc livedoc
move solr 's functionqueri impl queri modul main interfac queri modul move actual impl impl wo n't move function/distance/* move spatial modul function/filefloatsource.java depend solr 's schema data directori expos requesthandl
remov contrib/misc contrib/wordnet 's depend analyz modul contrib n't actual analyz text patch contrib/demo reli upon analyz modul separ tri figur one n't think lucen contrib need reach back modules/
directori copi leak file handl directori copi n't close target directori output stream sourcedir.openinput srcfile throw except lucene-3218 directori copi n't use extens n't like happen test today failur 3.x branch like caus bug noformat junit testsuit org.apache.lucene.index.testaddindex junit testcas testaddindexeswithrollback org.apache.lucene.index.testaddindex caus error junit mockdirectorywrapp close still open file _co.cfs=1 junit java.lang.runtimeexcept mockdirectorywrapp close still open file _co.cfs=1 junit org.apache.lucene.store.mockdirectorywrapper.clos mockdirectorywrapper.java:483 junit org.apache.lucene.index.testaddindex runaddindexesthreads.closedir testaddindexes.java:693 junit org.apache.lucene.index.testaddindexes.testaddindexeswithrollback testaddindexes.java:924 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1277 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1195 junit caus java.lang.runtimeexcept unclos indexoutput _co.cf junit org.apache.lucene.store.mockdirectorywrapper.addfilehandl mockdirectorywrapper.java:410 junit org.apache.lucene.store.mockcompoundfiledirectorywrapper. init mockcompoundfiledirectorywrapper.java:39 junit org.apache.lucene.store.mockdirectorywrapper.createcompoundoutput mockdirectorywrapper.java:439 junit org.apache.lucene.index.segmentmerger.createcompoundfil segmentmerger.java:128 junit org.apache.lucene.index.indexwriter.addindex indexwriter.java:3101 junit org.apache.lucene.index.testaddindex commitandaddindexes3.dobodi testaddindexes.java:839 junit org.apache.lucene.index.testaddindex runaddindexesthread 1.run testaddindexes.java:667 junit junit junit test run 18 failur 0 error 1 time elaps 9.034 sec junit junit standard output junit java.lang.illegalstateexcept cfs pend open file junit org.apache.lucene.store.compoundfilewriter.clos compoundfilewriter.java:143 junit org.apache.lucene.store.compoundfiledirectory.clos compoundfiledirectory.java:181 junit org.apache.lucene.store.defaultcompoundfiledirectory.clos defaultcompoundfiledirectory.java:58 junit org.apache.lucene.store.mockcompoundfiledirectorywrapper.clos mockcompoundfiledirectorywrapper.java:55 junit org.apache.lucene.index.segmentmerger.createcompoundfil segmentmerger.java:139 junit org.apache.lucene.index.indexwriter.addindex indexwriter.java:3101 junit org.apache.lucene.index.testaddindex commitandaddindexes3.dobodi testaddindexes.java:839 junit org.apache.lucene.index.testaddindex runaddindexesthread 1.run testaddindexes.java:667 noformat
testindexwriterwiththread testclosewiththread hang thread hit except index first document testindexwriterwiththread testclosewiththread loop thread index singl document one thread fail index first doc test hang forev check thread still aliv unless index document fail alreadi die
bitvector.isspars sometim wrong work lucene-3246 found problem bitvector.isspars math overflow int enough delet doc maxdoc largish isspars may incorrect return true over-estim size spars file sinc estim number byte vint dgap use bits.length instead bits.length divid number set bit ie averag gap set bit relat harmless affect perform size .del file disk correct
corrupt segment file detect wipe index content lucen happili wipe exist index present latest generat segments_n file zero file format document say segments_n file start format -9 segmentinfos.read accept =0 valid backward compat reason
consolid customscorequeri valuesourcequeri boostedqueri lucen 's customscorequeri solr 's boostedqueri essenti thing boost score document valu valuesourc boostedqueri direct fashion accept valuesourc customscorequeri hand accept seri valuesourcequeri valuesourcequeri seem exact thing functionqueri lucen 's valuesourc deprec remov need resolv depend simplifi code therefor recommend follow thing move customscorequeri customscoreprovid new queri modul chang use functionqueri instead valuesourcequeri deprec solr 's boostedqueri favour new customscorequeri csq provid lot support custom score process move consolid test csq boostedqueri queri modul test csq instead
file leak ioexcept occur index optim sure issu requir fix due natur occurr exist version lucen use lucen java 3.0.3 suse linux machin java 6 notic number file handl releas java applic ioexcept log regard disk full caus merg optim fail index currupt upon encount ioexcept use cfs index format 3x largest index size optim certain consum avail disk realiz need add disk space machin investig clean leak file handl fail find misus lucen 's indexwrit code wrap lucen quick search close invok lucen jave sourc code found number sourc file attempt close one object within close method think try/catch put around close attempt avoid skip subsequ close catch may abl ignor caught except avoid mask origin except like done simplefsdirectory.clos locat lucen java sourc suggest try/catch use org.apache.lucene.index.formatpostingfieldswriter.finish org.apache.lucene.index.terminfoswriter.clos org.apache.lucene.index.segmenttermpositions.clos org.apache.lucene.index.segmentmergeinfo.clos org.apache.lucene.index.segmentmerger.mergeterm final block org.apache.lucene.index.directoryreader.clos org.apache.lucene.index.fieldsreader.clos org.apache.lucene.index.multilevelskiplistreader.clos org.apache.lucene.index.multipletermpositions.clos org.apache.lucene.index.segmentmergequeue.clos org.apache.lucene.index.segmentmergedocs.clos org.apache.lucene.index.terminfosreader.clos
need test use termsenum.seekexact return true call next tri seekexact result must exist next ing facet modul seem like could bug think add test mix seekexact/seekceil/next like ensur seekexact return true enum proper posit
crank facet modul test facet modul larg set good test let switch use test infra randomindexwrit random iwconfig mockanalyz newdirectori n't want address multipli atleast etc issu think follow separ issu also look speed make sure night build exhaust let get coverag good refactor
testscoreddocidsutils.testwithdelet test failur ant test -dtestcase=testscoreddocidsutil -dtestmethod=testwithdelet -dtests.seed=-2216133137948616963:2693740419732273624 -dtests.multiplier=5 general 3.x trunk run test -dtests.iter=100 tend fail 2 time
speed top-k sampl test speed top-k sampl test make sure thorough night etc still usual would use atleast test somewhat tricki mayb differ approach need
move good contrib/queri class queri modul queri modul fill functionqueri stuff look close contrib/queri huge contrib contain number pretti use class go elsewher here propos plan similar suggest modul regex queri modul booleanfilt queri modul .filter packag boostingqueri queri modul chainedfilt queri modul .filter packag duplicatefilt queri modul .filter packag fieldcacherewritemethod n't belong contrib queri modul think push contrib/misc time seem quit constraint use inde constant_score_auto rewrit better dont see purpos filterclaus class insid booleanfilt fuzzylikethisqueri suggest modul class seem mess similar hardcod said seem claim cleanup could good termsfilt queri modul .filter packag slowcollated* stay modul till better place nuke one implic move xml-query-pars support mani queri need depend queri modul seem unavoid stage
consolid lucen 's querypars modul lucen lot querypars singl consist place follow querypars find warrant move new modul lucen core 's querypars analyzingquerypars complexphrasequerypars extendablequerypars surround 's querypars precedencequerypars standardquerypars xml-query-pars 's corepars seem good job kind pars extens test one challeng consolid mani test use lucen core 's querypars one option replic class src/test call testingquerypars anoth option convert test programmat build queri seem like alot work
convert lucen core test simpl mockquerypars test use lucen core 's querypars conveni want consolid qp modul ca n't depend add simpl mockquerypars string.split queri string analyz term build booleanqueri necessari complex queri phrase done programmat
collaps common modul lucen core util suggest robert http //markmail.org/message/wbfuzfamtn2qdvii tri limit depend graph modul someth common probabl go lucen core given n't ad anyth modul except mutablevalu class 'm go collaps util packag remov modul correct depend
renam contrib/querypars project queryparser-contrib much like contrib/queri differenti contrib/querypars querypars modul directori structur chang made ant maven
allow cfs empti sinc chang cfs semant slight close cfs directori error lead except yet empti cfs still valid cfs consist allow cfs empti exampl noformat 1 test fail regress org.apache.lucene.index.testindexwriterondiskfull.testadddocumentondiskful error messag cfs entri stack trace java.lang.illegalstateexcept cfs entri org.apache.lucene.store.compoundfilewriter.clos compoundfilewriter.java:139 org.apache.lucene.store.compoundfiledirectory.clos compoundfiledirectory.java:181 org.apache.lucene.store.defaultcompoundfiledirectory.clos defaultcompoundfiledirectory.java:58 org.apache.lucene.index.segmentmerger.createcompoundfil segmentmerger.java:139 org.apache.lucene.index.indexwriter.mergemiddl indexwriter.java:4252 org.apache.lucene.index.indexwriter.merg indexwriter.java:3863 org.apache.lucene.index.serialmergescheduler.merg serialmergescheduler.java:37 org.apache.lucene.index.indexwriter.maybemerg indexwriter.java:2715 org.apache.lucene.index.indexwriter.maybemerg indexwriter.java:2710 org.apache.lucene.index.indexwriter.maybemerg indexwriter.java:2706 org.apache.lucene.index.indexwriter.flush indexwriter.java:3513 org.apache.lucene.index.indexwriter.adddocu indexwriter.java:2064 org.apache.lucene.index.indexwriter.adddocu indexwriter.java:2031 org.apache.lucene.index.testindexwriterondiskfull.adddoc testindexwriterondiskfull.java:539 org.apache.lucene.index.testindexwriterondiskfull.testadddocumentondiskful testindexwriterondiskfull.java:74 org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1277 org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1195 noformat
add new bit set impl cach filter think openbitset tri satisfi mani audienc it confusing/error-pron result int/long variant mani method method requir in-bound access other n't other method auto-grow bit n't openbitset n't alway know numbit 'd like factor focus bit set impl whose primari target usag cach lucen filter ie bit set index docid int long whose size known fix front back final long alway access in-bound
move core querypars querypars modul move content lucene/src/java/org/apache/lucene/querypars querypars modul differenti parser other go place classic packag ll renam querypars classicquerypars well
move contribs/modul away querypars depend contrib modul depend core querypars simplic test appli process core test move away use querypars possibl
move querypars contrib/querypars querypars modul querypars port across use flexibl pars framework place packag flexibl standardquerypars renam flexiblequerypars surround.querypars renam surroundquerypars
move xml querypars querypars modul xml querypars port across querypars modul part work ll move qp 's demo demo modul
fst allow control hard builder tri share suffix today boolean option fst builder tell whether share suffix turn build much faster use much less ram result fst prefix trie fst larger need 's builder maintain node hash hold everi node seen far fst use ram slow thing dataset elmer see java-us thread autocomplet larg index jul 6 2011 provid thank 1.32 m titl avg 67.3 char per titl build suffix share took 22.5 second requir 1.25 gb heap produc 91.6 mb fst suffix share 8.2 second 450 mb heap 129 mb fst think allow boolean shade-of-gray instead usual well suffix share function far end string ad tunabl n share suffix length n let caller make reason tradeoff
add fieldinvertstate.numuniqueterm terms.sumdocfreq score system like lnu.ltc http //trec.nist.gov/pubs/trec16/papers/ibm-haifa.mq.final.pdf need suppli 3 stat averag tf within d uniqu term within d averag number uniqu term across field add fieldinvertstate.numuniqueterm incorpor first two norms/docvalu cut averag tf within d length numuniqueterm comput averag across field write sum term docfreq term dictionari header divid maxdoc get averag
iocontext part segmentread cach key iocontext lucene-2793 land iocontext part key use cach reader pool
use iocontext.readonc vargaptermsindexread load fst vargaptermsindexread pass readonc context opens/read fst yet replac ctx pass ie merg vs read want differenti
code still compar string equal instead use equal found coupl place still use string otherstr n't look correct attach patch soon
bitvector never skip fulli popul byte write cleareddgap write clear dgap bitvector compar byte 0xff 255 yet byte cast int -1 comparison never succeed mask byte 0xff compar compar -1
enabl pass config pkindexsplitt need abl pass indexwriterconfig iw use pkindexsplitt
refactor similarity.sloppyfreq similarity.scorepayload current top-level affect sloppydocscor make sens put sloppydocscor api give addit flexibl e.g combin payload csf whatev hell want cleaner furthermor follow confus exist issu scorepayload take bytesref payloadtermscor pass *null* byte array sim payload n't think inconsist payloadnearqueri undocu condit need score algorithm remov unus constant scorepayload no_doc_id_provid document never use anywher think remov condit possibl payload without docid n't pass fake document id -1 score api anyway
add workaround jre breakiter bug input java breakiter support intern crash exampl ant test -dtestcase=testthaianalyz -dtestmethod=testrandomstr -dtests.seed=-8005471002120855329 -2517344653287596566 -dtests.multiplier=3
leftov legaci enum indexread indexread still leftov handmad enum pre-java5 time unfortun generics/java5 policeman notic patch code cleanup baclkward break code use enum would see differ superclass chang commit asap
kuromoji code donat new japanes morpholog analyz atilika inc. ?~???????? would like donat kuromoji japanes morpholog analyz apach softwar foundat hope use lucen solr user japan elsewher project start 2010 sinc could n't find high-qual activ maintain easy-to-us java-bas japanes morpholog analyz becom mani design goal kuromoji kuromoji also segment mode particular use search hope interest lucen solr user compound-noun ??2???kansai intern airport ????U?g?? nikkei newspap segment one token analyz result search ???airport ?? newspap give word kuromoji segment word ???12??????? ?U?g ?? general would want search ll get hit also want make sure technolog licens make compat apach softwar foundat softwar maxim use kuromoji apach licens 2.0 code current own atilika inc softwar develop good friend ex-colleagu masaru hasegawa kuromoji use so-cal ipad dictionary/statist model licens term describ notice.txt ll upload code distribut correspond hash 'd much like start code grant process 'm also happi provid patch integr kuromoji codebas prefer pleas advis 'd like proceed thank
disabl posit spellcheck ngram field lucene-2391 optim spellcheck re build time/ram usag omit frequencies/positions/norm single-valu field among thing disabl posit keep freq disabl n-gram field spellcheck use posit queri
n't requir analyz field not_analyz seem wierd analyz not_analyz field must analyz null work documentsinvert want thing like offsetgap
cleanup good queri code move class queri contrib queri modul want pass clean sinc want code modul calibr core code
add narrow api load store field replac fieldselector think invert fieldselector api push api wherebi fieldsread invok api per field document visit implement api arbitrari thing like save away field 's size load field clone indexinput later lazi load etc thin api would mirror imag thin index time api indexablefield import would depend user space document/field/fieldtyp impl app free someth total custom build sugar api rebuild document instanc ie ir.docu int docid top new thin api ll also good test api suffici relev discuss irc morn http //colabti.org/irclogger/irclogger_log/lucene-dev date=2011-07-13 l76
cleanup xml querypars code move xml querypars querypars modul want pass bring modul standard
checkindex fail docfreq skipinterv term index posit bad check skip verif logic
morelikethi reus reader alreadi close morelikethi fatal bug wherebi tri reus reader multipl field code map string int word new hashmap string int int 0 fieldnames.length i++ string fieldnam fieldnam addtermfrequ r word fieldnam code howev addtermfrequ creat tokenstream reader code tokenstream ts analyzer.reusabletokenstream fieldnam r int tokencount=0 everi token chartermattribut termatt ts.addattribut chartermattribute.class ts.reset ts.incrementtoken bodi omit ts.end ts.close code close analys close under reader second time around loop get noformat caus java.io.ioexcept stream close sun.nio.cs.streamdecoder.ensureopen streamdecoder.java:27 sun.nio.cs.streamdecoder.read streamdecoder.java:128 java.io.inputstreamreader.read inputstreamreader.java:167 com.acme.util.compositereader.read compositereader.java:101 org.apache.lucene.analysis.standard.standardtokenizerimpl.zzrefil standardtokenizerimpl.java:803 org.apache.lucene.analysis.standard.standardtokenizerimpl.getnexttoken standardtokenizerimpl.java:1010 org.apache.lucene.analysis.standard.standardtokenizer.incrementtoken standardtokenizer.java:178 org.apache.lucene.analysis.standard.standardfilter.incrementtokenclass standardfilter.java:61 org.apache.lucene.analysis.standard.standardfilter.incrementtoken standardfilter.java:57 com.acme.storage.index.analyser.normalisefilter.incrementtoken normalisefilter.java:51 org.apache.lucene.analysis.lowercasefilter.incrementtoken lowercasefilter.java:60 org.apache.lucene.search.similar.morelikethis.addtermfrequ morelikethis.java:931 org.apache.lucene.search.similar.morelikethis.retrieveterm morelikethis.java:1003 org.apache.lucene.search.similar.morelikethis.retrieveinterestingterm morelikethis.java:1036 noformat first thought seem like readerfactori sort pass new reader creat second field mayb factori could pass field name someon want pass differ reader could interest method take file url exhibit issu 'm sure re use method take file could open file twice method take url probabl n't fetch url twice
testfsts.testrandomword throw aiob verbos =true seem like invalid utf-8 sometim get pass bytesref.utf8tostr verbos println
special booleanqueri claus termqueri work lucene-3319 ran issu booleanqueri compar phrasequeri exact case disabl score phrasequeri bypass posit match essenti conjunct match exactphrasescor beat plain boolean scorer 40 sizeabl gain convert conjunctionscor use docsenum direct still n't get 40 phrasequeri yet turn optim get close phrasequeri biggest gain came convert hand craft loop conjunctionscor donext loop seem less confus hotspot particular case think code special make lot sens sinc bq tq far one common queri upload patch short
revis scorer visitor api current expert api scorer allow take scorer visit children etc e.g booleanqueri think improv general queri current issu current api hardcod booleanqueri 's occur support type children e.g disjunctionmax difficult use api amount generic visitor callback api current api enforc dfs travers might prefer bfs instead
ioutils.closesaf log suppress except stack trace origin except new featur java 7 alway java 6 support bring realli help new featur lucen sever thing make life easier come java 7 hope juli 28th 2011 one simplier except handl suppress closeabl call try-with-resourc see http //docs.google.com/view id=ddv8ts74_3fs7483dp way lucen class support semant java 7 automat cool try-cod would work e.g indexwrit tokenstream alreadi function lucen sinc ad ioutils.closesaf util remov java 7 minimum requir lucen mayb 10 year code java tri closeabl new closeabl b new use closeabl catch except e dosometh throw e code code close b autogener final block supress except ident ioutils.closesaf code java except priorexcept null closeabl b tri closeabl new closeabl b new new b new use closeabl catch except e priorexcept e dosometh final ioutils.closesaf priorexcept b code mean function without java 7 one thing make logging/debug much nicer java 7 code also add mayb suppress except closeabl priorexcept print stacktrac show stacktrac origin except also print except suppress throw except closeable.clos failur noformat org.apache.lucene.util.testioutil testexcept base-except org.apache.lucene.util.testioutils.testsuppressedexcept testioutils.java:61 sun.reflect.nativemethodaccessorimpl.invoke0 nativ method sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:57 sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:43 java.lang.reflect.method.invok method.java:601 org.junit.runners.model.frameworkmethod 1.runreflectivecal frameworkmethod.java:44 org.junit.internal.runners.model.reflectivecallable.run reflectivecallable.java:15 org.junit.runners.model.frameworkmethod.invokeexplos frameworkmethod.java:41 org.junit.internal.runners.statements.invokemethod.evalu invokemethod.java:20 org.junit.rules.testwatchman 1.evalu testwatchman.java:48 org.junit.internal.runners.statements.runbefores.evalu runbefores.java:28 org.junit.internal.runners.statements.runafters.evalu runafters.java:31 org.junit.runners.blockjunit4classrunner.runchild blockjunit4classrunner.java:76 org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1486 org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1404 org.junit.runners.parentrunn 3.run parentrunner.java:193 org.junit.runners.parentrunn 1.schedul parentrunner.java:52 org.junit.runners.parentrunner.runchildren parentrunner.java:191 org.junit.runners.parentrunner.access 000 parentrunner.java:42 org.junit.runners.parentrunn 2.evalu parentrunner.java:184 org.junit.internal.runners.statements.runbefores.evalu runbefores.java:28 org.junit.internal.runners.statements.runafters.evalu runafters.java:31 org.junit.runners.parentrunner.run parentrunner.java:236 junit.framework.junit4testadapter.run junit4testadapter.java:39 org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.run junittestrunner.java:420 org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.launch junittestrunner.java:911 org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.main junittestrunner.java:768 suppress java.io.ioexcept test-io-exception-1 org.apache.lucene.util.testioutil brokencloseable.clos testioutils.java:36 org.apache.lucene.util.ioutils.closesaf ioutils.java:58 org.apache.lucene.util.testioutils.testsuppressedexcept testioutils.java:62 26 suppress java.io.ioexcept test-io-exception-2 org.apache.lucene.util.testioutil brokencloseable.clos testioutils.java:36 org.apache.lucene.util.ioutils.closesaf ioutils.java:58 org.apache.lucene.util.testioutils.testsuppressedexcept testioutils.java:62 26 noformat java 7 new method ad throwabl allow log suppress except call automat synthet bytecod emit javac patch simpli add function condit ioutil regist suppress except run java 7 done reflect look method throwable.class found invok closesaf except thrown closeable.clos n't get lost make debug much easier log problem may occur patch *not* chang function behaviour add nformat stack trace java-7-way similar way java 1.4 ad caus work local java 6 java 7 java 7 get addit stack trace java 6 noth chang java 5 backport 3.x would first java 7 improv minor one next would nio2 that easi reflect wait 10 year
flexibl queri parser support open rang rang queri mix inclus exclus rang flexibl queri parser support open rang rang queri mix inclus exclus rang two problem found develop lucene-1768
testnrtthread hang night 3.x build mayb problem mayb bug test strang late 3.x night hang
buffer delet flush ram count segment flush general flush delet ie simpli buffer pend delet terms/queri appli 1 segment go merg remov del doc segment 2 buffer delet ram exceed 1/2 iw 's ram limit flush segment 3 buffer delet count exceed iwc 's maxbuffereddeleteterm latter 2 trigger current broken trunk suspect 'm sure land dwpt introduc bug
make frozenbuffereddelet effici term look lucene-3340 thought also ridicul much ram use delet term save lot memori especi object overhead littl effici
add workaround icu bug combin java7 lucenetestcas bug icu make fail load ulocal class java7 http //bugs.icu-project.org/trac/ticket/8734 problem caus new local java 7 lead chicken-and-egg problem static initi ulocal initi default local jdk local static ctor default ulocal instanc creat default set ulocal ulocal ctor itsself need default local fetch ressourc bundl throw npe code lucenetestcas random default local classload ulocal tri set anoth random local use defin safe local locale.us patch easi
docvalu fnfe creat test lucene-3335 found unrel bug docvalu
xmlparser drop user boost lucen xml parser seem convert user defin boost back default 1.0 thus boost valu drop queri e.g code xml booleanqueri claus occurs= must booleanqueri claus occurs= userqueri fieldname= vehicle.colour red^66 blue~^8 /userqueri /claus /booleanqueri /claus claus occurs= booleanqueri claus occurs= userqueri fieldname= vehicle.colour black^0.01 /userqueri /claus /booleanqueri /claus /booleanqueri code produc lucen queri vehicle.colour red^66 vehicle.colour blue~0.5^8 vehicle.colour black expect queri vehicle.colour red^66 vehicle.colour blue~0.5^8 vehicle.colour black^0.01 develop work around modifi line 77 userinputquerybuilder.java code java q.setboost domutils.getattribut e boost ,1.0f code code java q.setboost domutils.getattribut e boost q.getboost code
indexwrit appli wrong delet concurr flush-al yonik uncov testrealtimeget test flush-al underway possibl incom updat pick dwpt stale ie yet pulled/mark flush yet dw cutov new delet queue happen delet term also updat one non-stal dwpts wrong document delet test fail detect wrong valu 's 2nd failur mode n't figur yet wherebi 2 doc return search id ever 1 doc sinc test use updatedocu atom wrt commit/reopen yonik verifi test pass pre-dwpt guess yet verifi test also pass 3.x ll backport test 3.x sure
trunk testdocumentswriterdeletequeue.teststressdeletequeu seed failur fail 100 time trunk r1152089 code junit testsuit org.apache.lucene.index.testdocumentswriterdeletequeu junit test run 1 failur 1 error 0 time elaps 0.585 sec junit junit standard error junit note reproduc ant test -dtestcase=testdocumentswriterdeletequeu -dtestmethod=teststressdeletequeu -dtests.seed=724635056932528964 -56 53725200660632980 junit note test param codec=randomcodecprovid locale=en_us timezone=pacific/port_moresbi junit note test run jvm junit testdocumentswriterdeletequeu junit note linux 2.6.39-gentoo amd64/sun microsystem inc. 1.6.0_26 64-bit /cpus=8 threads=1 free=86067624 total=125632512 junit junit testcas teststressdeletequeu org.apache.lucene.index.testdocumentswriterdeletequeu fail code
directspellcheck throw npe field n't exist directspellcheck n't check result term null return empti list
extend fieldcach architectur multipl valu would consid bug appear lot peopl work around limit n't chang under data structur nativ support multivalu field fieldcach architectur function work proper thing like easili geodist multivalu field thought
trunk testrollingupdates.testrollingupd seed failur trunk r1152892 reproduc alway code junit-sequenti junit testsuit org.apache.lucene.index.testrollingupd junit test run 1 failur 1 error 0 time elaps 1.168 sec junit junit standard error junit note reproduc ant test -dtestcase=testrollingupd -dtestmethod=testrollingupd -dtests.seed=-5322802004404580273 -4001225075726350391 junit warn test method testrollingupd left thread run merg thread _c 4.0 cv3/2 _h 4.0 cv3 _k junit resourc leak test method testrollingupd left 1 thread run junit note test param codec=randomcodecprovid docid=standard body=simpletext title=mocksep titletokenized=puls freqcutoff=20 date=mockfixedintblock blocksize=1474 locale=lv_lv timezone=pacific/fiji junit note test run jvm junit testrollingupd junit note linux 2.6.39-gentoo amd64/sun microsystem inc. 1.6.0_26 64-bit /cpus=8 threads=1 free=128782656 total=158400512 junit junit testcas testrollingupd org.apache.lucene.index.testrollingupd fail junit expect 20 21 junit junit.framework.assertionfailederror expect 20 21 junit org.apache.lucene.index.testrollingupdates.testrollingupd testrollingupdates.java:76 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1522 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1427 junit junit junit test org.apache.lucene.index.testrollingupd fail code
unit integr test case new similar write test case test new similar ad lucene-3220|http //issues.apache.org/jira/browse/lucene-3220 two type test case creat unit test mock statist provid similar score valid hand calcul integr test small collect index search use similar perform test perform separ issu
standardtoken dispos hiragana combin mark dakuten instead attach charact belong lucen 3.3 possibl 3.1 onward exhibit less great behaviour tokenis hiragana combin mark use 's unit test code test public void testhiraganawithcombiningmarkdakuten throw except hiragana 's follow combin mark dakuten tokenstream stream new standardtoken version.lucene_33 new stringread \u3055\u3099 kept togeth list string expectedtoken arrays.aslist \u3055\u3099 list string actualtoken new linkedlist string chartermattribut term stream.addattribut chartermattribute.class stream.incrementtoken actualtokens.add term.tostr assertequ wrong token expectedtoken actualtoken code code fail noformat java.lang.assertionerror wrong token expect ?? noformat seem tokenis throw away combin mark entir 3.0 's behaviour also undesir noformat java.lang.assertionerror wrong token expect ?? ? noformat least token possibl write filter work around issu katakana seem avoid particular problem katakana combin mark found singl run seem lump singl token problem right 'm sure 's realli bug
port url+email token standardtokenizerinterfac similar fix lucene-3358 bug preserv backward also want mechan anyway upgrad new unicod version futur regener new tld list 3.4 ensur exist one use urlemail33 whatev exact
initi error junit test solr-test-framework ide maven 'm current develop new compon solr netbean project creat two test class compon one class simpl unit test deriv solrtestcasej4 class second one test shard deriv basedistributedsearchtestcas launch test two class error initi second class test matter class alway second execut class fail error come assert fail begin function initrandom lucenetestcas class assert random.initi launch test class separat test succeed discuss mr. muir problem seem relat incompat class lucenetestcas function maven project ide accord mister muir problem via ant test work like e.g 3 test class computetestmethod beforeclass afterclass computetestmethod beforeclass afterclass computetestmethod beforeclass afterclass via ide run folder like computetestmethod computetestmethod computetestmethod beforeclass afterclass beforeclass afterclass beforeclass afterclass
minimizehopcroft oom smallish 2096 state finit automaton sure 's w/ check blocktre branch lucene-3030 comment ignor testtermsenum2.testfiniteversusinfinit hit oom ant test-cor -dtestcase=testtermsenum2 -dtestmethod=testfiniteversusinfinit -dtests.seed=-2577608857970454726 -2463580050179334504
creat append mode determin obtain write lock indexwrit writer1 open create_or_append mode determin whether creat append obtain write lock anoth indexwrit writer2 process creat index result writer1 enter creat mode wait obtain lock writer2 commit releas lock writer1 alreadi creat mode overwrit index creat write2 bug probabl effect lucene-2386 prior lucen generat empti commit new index creat think issu could still occur prior two indexwrit would need open near simultan first indexwrit would need releas lock second time
indexwrit commit updat document without correspond delet backport testcas lucene-3348 ran thread hazard 3.x branch actual fix issu lucene-3348 lucen 4.0 sinc dwpt slight differ behavior commit segment creat new issu track 3.x prepar commit sync iw flush dw appli delet releas lock maybemerg start commit iw startcommit userdata yet new segment could flush via getread sneak segementinfo clone iw startcommit instead preparecommit right flush
testindexwriterondiskfull.testadddocumentondiskful seed failur version trunk r1155278 reproduce- alway code junit testsuit org.apache.lucene.index.testindexwriterondiskful junit test run 1 failur 0 error 1 time elaps 0.847 sec junit junit standard error junit note reproduc ant test -dtestcase=testindexwriterondiskful -dtestmethod=testadddocumentondiskful -dtests.seed=-3cc23002ebad518d:70ae722281b31c9f:57406021f8789a22 junit note test param codec=randomcodecprovid content=mockfixedintblock blocksize=1081 locale=hr_hr timezone=atlantic/jan_mayen junit note test run jvm junit testindexwriterondiskful junit note linux 2.6.39-gentoo amd64/sun microsystem inc. 1.6.0_26 64-bit /cpus=8 threads=1 free=85252968 total=125632512 junit junit testcas testadddocumentondiskful org.apache.lucene.index.testindexwriterondiskful caus error junit segments* file found mockdirwrapp org.apache.lucene.store.ramdirectori 65dcc2a3 lockfactory=mocklockfactorywrapp org.apache.lucene.store.singleinstancelockfactori 6e8f94 file _1.cfs _1.cfe _0.cfe _0.cfs junit org.apache.lucene.index.indexnotfoundexcept segments* file found mockdirwrapp org.apache.lucene.store.ramdirectori 65dcc2a3 lockfactory=mocklockfactorywrapp org.apache.lucene.store.singleinstancelockfactori 6e8f94 file _1.cfs _1.cfe _0.cfe _0.cfs junit org.apache.lucene.index.segmentinfo findsegmentsfile.run segmentinfos.java:657 junit org.apache.lucene.index.segmentinfo findsegmentsfile.run segmentinfos.java:534 junit org.apache.lucene.index.segmentinfos.read segmentinfos.java:284 junit org.apache.lucene.index.segmentinfos.read segmentinfos.java:277 junit org.apache.lucene.index.testindexwriter.assertnounreferencedfil testindexwriter.java:158 junit org.apache.lucene.index.testindexwriterondiskfull.testadddocumentondiskful testindexwriterondiskfull.java:114 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1526 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1428 junit junit junit test org.apache.lucene.index.testindexwriterondiskful fail code
move nrtcachingdir core 4.0 4.0 iocontext chang implement clean think move core use test etc
process synonym token stream remov follow token stream phrase search field deriv fieldtyp synonym filter includ synonym term follow synonym vanish synonym expans e.g http //host port/solr/corename/select/ q=desc 22xyzzi 20 20bbb 20pot 20of 20gold 22 version=2.2 start=0 rows=10 indent=on debugquery=tru bbb default synonym file desc text fieldtyp output str name= rawquerystr desc xyzzi bbb pot gold /str str name= querystr desc xyzzi bbb pot gold /str str name= parsedqueri phrasequeri desc xyzzi bbbb 1 bbbb 2 gold /str str name= parsedquery_tostr desc xyzzi bbbb 1 bbbb 2 gold /str also see behavior use admin consol analysis.jsp solr 3.3 behav proper
move reusableanalyzerbas core lucene-2309 suggest make analyz reusabl compulsori reusableanalyzerbas fantast way drive reusabl let move core chang impl use
contrib depend core test compil fail ant clean done ant clean root level lucen go e.g contrib/querypars 3.x contrib/misc 3.x trunk call ant test build test fail contrib/querypars 's extendedableqptest extend core testquerypars 3.x modul work cours contrib/misc/testindexsplitt use core class build index find root caus first remov core test contrib classpath issu get visibl even without ant clean fix
sandbox remain contrib queri lucene-3271 move good queri queri contrib new destin primarili queri modul remnant need find home suggest lucene-3271 class bad per se odd let creat sandbox contrib odd contrib class go decid fate anoth time
fix compound-file/nosuchdirectoryexcept bug nrtcachingdir found bug lucene-3374 fix separ whether move core bug appli 3.x add explicit test problem
easysimilar interpret document length float
integr mockbm25similar mocklmsimilar framework step 1 decid mocklmsimilar need lmdirichletsimilar 2 move class similar packag 3 move similar packag src/ 4 move sim inc. similar similar 5 make mockbm25similar subclass easysimilar
get javadoc similar packag shape 1 creat package.html similar packag 2 updat javadoc search packag package.html mention similar 3 compil javadoc see warn
testtermsenum.testintersectrandom fail noformat junit testsuit org.apache.lucene.index.testtermsenum junit testcas testintersectrandom org.apache.lucene.index.testtermsenum fail junit null junit junit.framework.assertionfailederror junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1530 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1432 junit org.apache.lucene.index.codecs.blocktreetermsread fieldread intersectenum.getst blocktreetermsreader.java:894 junit org.apache.lucene.index.codecs.blocktreetermsread fieldread intersectenum.seektostartterm blocktreetermsreader.java:969 junit org.apache.lucene.index.codecs.blocktreetermsread fieldread intersectenum. init blocktreetermsreader.java:786 junit org.apache.lucene.index.codecs.blocktreetermsread fieldreader.intersect blocktreetermsreader.java:483 junit org.apache.lucene.index.testtermsenum.testintersectrandom testtermsenum.java:293 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1530 junit org.apache.lucene.util.lucenetestcas lucenetestcaserunner.runchild lucenetestcase.java:1432 junit junit junit test run 6 failur 1 error 0 time elaps 14.762 sec junit junit standard error junit note reproduc ant test -dtestcase=testtermsenum -dtestmethod=testintersectrandom -dtests.seed=320d0949741fc6b1:3cabdb9b04d0d243 -4b7c80572775ed92 -dtests.multiplier=3 noformat
incorrect sort numer valu document miss sort field sort result numer field document contain valu sort field seem get 0 zero valu sort test doubl float int long numer field ascend descend order behavior unexpect zero compar rest valu better solut would either allow user defin non-valu default alway bring document result last one exampl scenario ad 3 document 1st valu 3.5d 2nd -10d 3rd without valu search matchalldocsqueri sort field descend order yield docid result 0 2 1 ask top 2 document bring document without valu 2nd result seem bug
make easysimilarityprovid full-fledg class easysimilarityprovid testeasysimilar would good candid full-fledg class defaultsimilar bm25similar provid effect n't see could n't add one generic provid conveni
renam easysimilar similaritybas
testindexfiledelet checkindex fail found 3.x noformat ant test-tag -dtestcase=testindexfiledelet -dtestmethod=testdeleteleftoverfil -dtests.seed=7631088157098800527:4270221915205524915 noformat
make tokenstream reus mandatori analyz lucene-2309 becam clear 'd benefit lot analyz return reusabl tokenstream big chunk work time bite bullet plan attack follow way collaps logic reusableanalyzerbas analyz add reusestrategi abstract analyz control whether tokenstreamcompon reus global today per-field convert analyz use tokenstreamcompon ve alreadi seen tokenstream creat test need work reusabl even n't reus remov analyzer.reusabletokenstream convert everyth use .tokenstream return reusabl tokenstream
cleanup test tokenstream reusabl mani tokenstream creat test reusabl realli messi thing prevent reus may chang test ll target back port 3x
testcompoundfil fail window ant test-cor -dtestcase=testcompoundfil -dtestmethod=testreadnestedcfp -dtests.seed=-61cb66ec0d71d1ac -46685c36ec38fd32:568c63299214892c
deprec remov dutchanalyzer.setstemdictionari dutchanalyzer.setstemdictionari file prevent reus tokenstream also use file n't ideal deprec 3x remov trunk
need ensur sim use collection-level stat e.g sumtotaltermfreq handl non-exist field thing like querynorm unfortun similar handl case ask computestat term field exist note never actual score anyth unless break querynorm work tfidf deal case notic benchmark creat test test case like across sim
term vector miss addindex optim encount problem addindex term vector disappear follow optim wrote simpl test case demonstr problem bug appear addindex version appear adddocu call twice commit chang think track problem indexwriter.mergemiddl set term vector merger.merg call adddoc case merger.fieldinfo alreadi popul addindex case empti henc fieldinfos.hasvector return fals post patch short
testiwondiskful checkindex failur look like charli cron creat corrupt index disk full.. ca n't reproduc seed machin tri vm environ see better luck
renam ioutils.clos method closesaf method take boolean suppressexcept danger ve renam .close suppress .closewhilehandlingexcept suppress except
wrong stats/scor memorycodec hit random failur flexscor branch wierd random test notic test alway fail memorycodec wrote specif test n't trace thru yet think like issu memorycodec somehow return wrong stat
remov unnecessari memori barrier dwpt current dwpt still use atomiclong count bytesus write access issu implicit memori barrier total unnecessari sinc everyth singl thread level might minor n't issu unnecessari memori barrier caus processor lock instruct pipelin reason
nrt reader/writ ramdirectori memori leak nrt reader/writ empti index use writer.deleteal writer.commit n't releas alloc memori exampl follow code generat memori leak reveal memori leak nrt reader/writ br follow main 10k cycl ul li add 10k empti document index writer /li li commit /li li open nrt reader writer immedi close /li li delet document writer /li li commit chang writer /li /ul run -xmx256m result oom ~2600 cycl public static void main string arg throw except ramdirectori d new ramdirectori indexwrit w new indexwrit d new indexwriterconfig version.lucene_33 new keywordanalyz document doc new document int 0 10000 i++ int j 0 j 10000 ++j w.adddocu doc w.commit indexreader.open w true .close w.deleteal w.commit w.close d.close
make worddelimiterfilt 's instanti readabl current worddelimiterfilt 's constructor code public worddelimiterfilt tokenstream byte chartypet int generatewordpart int generatenumberpart int catenateword int catenatenumb int catenateal int splitoncasechang int preserveorigin int splitonnumer int stemenglishpossess chararrayset protword code mean instanti unread combin 1s 0s improv either use builder int flag enumset
sloppyphrasescor return non-determinist result queri mani repeat proxim queri mani repeat four base test return non-determinist result run queri multipl time data set get differ result far ve reproduc solr 1.4.1 3.1 3.2 3.3 latest 4.0 trunk step reproduc use solr exampl 1 solrconfig.xml set queryresultcach size 0 2 add document text dog dog dog dog dog dog dog http //localhost:8983/solr/upd stream.body= 3cadd 3e 3cdoc 3e 3cfield 20name= 22id 22 3e1 3c/field 3e 3cfield 20name= 22text 22 3edog 20dog 20dog 3c/field 3e 3c/doc 3e 3cdoc 3e 3cfield 20name= 22id 22 3e2 3c/field 3e 3cfield 20name= 22text 22 3edog 20dog 20dog 20dog 3c/field 3e 3c/doc 3e 3c/add 3e commit=tru 3 dog dog dog dog ~1 queri http //localhost:8983/solr/select q= 22dog 20dog 20dog 20dog 22~1 4 repeat step 3 mani time expect result document id 2 return actual result document id 2 alway return document id 1 sometim return differ proxim valu show bug dog dog dog dog ~5 dog dog dog dog ~100 etc show behavior far ve trace repeat array sloppyphrasescorer.initphraseposit depend order element array document may may match think hashset may blame 'm sure least seem non-determin come
bring hunspel lucen analysi modul time ago along robert uwe wrote stemmer use hunspel algorithm benefit support dictionari wide array languag seem still use fallen date think would benefit insid analysi modul addit featur decompound support could ad
allow pass instanc ratelimit fsdirectori allow rate limit merg io across sever directori instanc come handi run sever lucen indic vm wish rate limit merg across
dictionarycompoundwordtokenfilt proper add token end compound word due off-by-on error subword place end compound word get token ad token stream exampl unit test attach patch dictionari ab cd ef input abcdef creat token abcdef ab cd expect token abcdef ab cd ef addit could produc token shorter minsubwords due anoth off-by-on error exampl attach patch dictionari abc d efg minimum subword length 2 input abcdefg creat token abcdef abc d efg expect token abcdef abc efg
lucen fsync' file commit thank hurrican iren mark 's electr becam unreli discov power loss lucen could easili corrumpt index cours never happen abl easili repro pull plug ubuntu box index dig discov horror lucen fail fsync file ever bug unfortun creat commit lucene-2328 issu ad track fsdir file close sync 'd sync call iw.commit sync file n't alreadi sync 'd track done via fsdir.onindexoutputclos callback call fsindexoutput close bug call except close noformat overrid public void close throw ioexcept close file close yet isopen boolean success fals tri super.clos success true final isopen fals success tri file.clos parent.onindexoutputclos catch throwabl suppress n't mask origin except els file.clos noformat fsdir think file need sync sync method call think instead call up-front better over-sync under-sync fix trivial move callback up-front 'd love somehow test catch bad regress futur still think test separ commit fix first note even though lucene-2328 backport 2.9.x 3.0.x bug n't ie backport much simpler fix address origin memori leak 's 3.1 3.2 3.3 trunk bug present
resolv junit assert deprec mani test use assertequ method deprec culprit assertequ float float assertequ doubl doubl assertequ object object although big issu annoy everi time see 'm go fix
payloadtermqueri 's explain broken span score includ set includespanscor fals payloadtermqueri explain broken
add terms.doccount spinoff lucene-3290 yonik mention noformat current way get number document valu field one could comput averag length spars field via sumtotaltermfreq field /docswithfield field docswithfield field would use context want know spars field automat select facet algorithm etc noformat think use stat add case spars field heurist score
optim n-gram phrasequeri 2-gram use length queri string 4 exampl q= abcd querypars generat autogeneratephrasequeri true phrasequeri ab bc cd slop 0 optim phrasequeri ab cd appropri posit idea came japanes paper n.m-gram implement invert index use n-gram hash valu mikio hirabayashi et al main theme paper differ idea 'm use though
trunk test hang/deadlock testindexwriterwiththread trunk test hang often late hudson time care kill get good stacktrac
testparser.testspantermxml fail sim test sometim fail explan test wrote noformat make sure sim work spanor termx termi termi exist public void testcrazyspan throw except problem normal lucen queri creat scorer return null term dont exist mean never score term exist howev span one scorer whole hierarchi inner queri real queri boost ignor etc noformat basic spanqueri n't realli queri get one scorer call extractterm whole hierarchi comput weight e.g idf whole bag term even n't exist fine alreadi test sim 's wo n't bug-out computestat howev n't expect actual score document base term n't exist howev exact happen span n't use sub-scor lucen 's sim avoid docfreq 1
make queryautostopwordanalyz immut reusabl current queryautostopwordanalyz allow list stop word chang instanti addstopword method stop analyz reusabl sinc must instanti stopfilt everi time method mean although analyz instanti reus indexread actual analysi stack reusabl probabl expens part let chang analyz stop word set instanti time facilit reus
tieredmergepolici expungedelet enforc maxmergedsegmentmb
random access non ram resid indexdocvalu csf way get specif indexdocvalu go directori rather load valu memori
make shingleanalyzerwrapp perfieldanalyzerwrapp immut shingleanalyzerwrapp perfieldanalyzerwrapp setter chang state impact analysi stack go becom reusabl state must immut chang effect process similar queryautostopwordanalyz remov trunk deprec 3x
creat size estim model lucen solr often handi abl estim amount memori disk space lucen solr use given certain assumpt intend check excel spreadsheet allow peopl estim memori disk usag trunk propos put dev-tool n't think offici document yet like ide stuff ll see well get maintain
spellcheck suggest mode support spin-off solr-2585 current o.a.l.s.s.spellcheck o.a.l.s.s.directspellcheck support two suggest mode 1 suggest term index 2 suggest popular term issu add third suggest mode 3 suggest alway assist user develop context-sensit spell suggest and/or did-you-mean suggest see solr-2585 full discuss note o.a.l.s.s.spellcheck alreadi support function user pass null term indexread howev intut o.a.l.s.s.directspellcheck current support third suggest mode
detect test thread refer name get rid code dofail thread.currentthread .getnam .equal main || thread.currentthread .getnam .equal main thread code
move *termsenum.java oal.search oal.index think filteredtermsenum singletermsenum move left termrangetermsenum fuzzytermsenum prefixtermsenum sinc seem search specif
add checks/assert search across close reader tri search across close reader and/or searcher check even assert statement result crazi scari stacktrac deep insid place like fsts/various term dictionari implement etc situat depend codec wont even get error 'm sure fun tri retriev store field
querywrapperfilt get null docidsetiter wrap termqueri tri get iter docidset return querywrapperfilt wrap termqueri get null instead iter return document search termqueri code demonstr issu code java import java.io.ioexcept import org.apache.lucene.analysis.whitespaceanalyz import org.apache.lucene.document.docu import org.apache.lucene.document.field import org.apache.lucene.document.field.index import org.apache.lucene.document.field.stor import org.apache.lucene.index.indexread import org.apache.lucene.index.indexwrit import org.apache.lucene.index.indexwriterconfig import org.apache.lucene.index.term import org.apache.lucene.store.ramdirectori import org.apache.lucene.util.vers import org.apache.lucene.search.docidset import org.apache.lucene.search.docidsetiter import org.apache.lucene.search.filt import org.apache.lucene.search.indexsearch import org.apache.lucene.search.querywrapperfilt import org.apache.lucene.search.termqueri import org.apache.lucene.search.topdoc public class testquerywrapperfilteriter public static void main string arg tri indexwriterconfig iwconfig new indexwriterconfig version.lucene_34 new whitespaceanalyz version.lucene_34 iwconfig.setopenmod indexwriterconfig.openmode.cr ramdirectori dir new ramdirectori indexwrit writer new indexwrit dir iwconfig document d new document d.add new field id 1001 store.y index.not_analyz d.add new field text headlin one group one store.y index.analyz d.add new field group grp1 store.y index.not_analyz writer.adddocu d writer.commit writer.clos indexread rdr indexreader.open dir indexsearch searcher new indexsearch rdr termqueri tq new termqueri new term text headlin topdoc result searcher.search tq 5 system.out.println number search result results.totalhit filter f new querywrapperfilt tq docidset dis f.getdocidset rdr docidsetiter dis.iter null int docid it.nextdoc docid docidsetiterator.no_more_doc document doc rdr.document docid system.out.println iter doc doc.get id docid it.nextdoc els system.out.println iter null searcher.clos rdr.close catch ioexcept ioe ioe.printstacktrac code
port 3.x fieldcache.getdocswithfield trunk spinoff lucene-3390 think approach 3.x handl un-valu doc make possibl specifi doc sort better solut trunk like fc dedic method get bit doc field easi app direct use like bit entri fc one downsid 's 2 pass get valu valid bit think fix pass option bool fc.getxxx method indic want bit popul fc entri miss bit well 3.x trunk it singl pass
distinct field valu count per group support second pass collector count uniqu field valu field per group one exampl group statist one might want
add searchermanag manag indexsearch usag across thread reopen simpl helper class wrote lucen action 2nd ed 'd like commit lucen contrib/misc simplifi use reopen indexsearch across multipl thread use indexread 's ref count know 's safe close reader process also factor test base class test want make lot simultan index search thread fix testnrtthread core testnrtmanag contrib/misc new testsearchermanag contrib/misc use base class
nullpointerexcept booleanfilt booleanfilt getdisi method use querywrapperfilt occur nullpointerexcept querywrapperfilt match term indexread java.lang.nullpointerexcept org.apache.lucene.util.openbitsetdisi.inplaceand openbitsetdisi.java:66 org.apache.lucene.search.booleanfilter.getdocidset booleanfilter.java:102 org.apache.lucene.search.indexsearcher.searchwithfilt indexsearcher.java:551 org.apache.lucene.search.indexsearcher.search indexsearcher.java:532 org.apache.lucene.search.indexsearcher.search indexsearcher.java:463 org.apache.lucene.search.indexsearcher.search indexsearcher.java:433 org.apache.lucene.search.indexsearcher.search indexsearcher.java:356 test.booleanfiltertest.main booleanfiltertest.java:50 null-check line res new openbitsetdisi getdisi shouldfilt reader reader.maxdoc res.inplaceor getdisi shouldfilt reader res new openbitsetdisi getdisi notfilt reader reader.maxdoc res.inplacenot getdisi notfilt reader res new openbitsetdisi getdisi mustfilt reader reader.maxdoc res.inplaceand getdisi mustfilt reader
add fixedbitset.and other/disi andnot other/disi parent issu andnot disi fixedbitset miss issu add method disi method also alreadi exist disi method check openbitsetiter inplac oper use bit optim
nativ fs lock use test-framework 's o.a.l.util.lucenejunitresultformatt prohibit test multi-us system lucenejunitresultformatt use lock buffer test suit output run parallel n't interrupt display consol current implement use fix directori lucene_junit_lock/ java.io.tmpdir default /tmp/ unix/linux system locat lock function introduc solr-1835 shawn heisey report solr-2739 test fail run root succeed run non-root user lucen irc today shawn wrote quot 2:06:07 pm elyograg know ca n't run test root discov /tmp/lucene_junit_lock run test user run user b directori delet root origin user quot
remov indexdocvaluesfield confus present csf function user actual field attribut field like store index otherwis realli hard think csf mismatch api index format
renam optim less cool-sound name think user see name optim feel must want suboptim system probabl result wast time resourc mayb renam collapseseg someth
analysi consum use reusabletokenstream analyz use tokenstreamcompon there reason analysi consum use tokenstream give bad perform consequ consum move use reusabletokenstream challeng reusabletokenstream throw ioexcept mani consum rig deal consum move renam reusabletokenstream back tokenstream
upgrad commons-compress 1.2 common compress bug compress-127 fix 1.2 workaround benchmark 's streamutil longer requir compress also use solr replac new jar benchmark solr get rid workaround
chang booleanfilt singl claus arraylist tostr work fine claus method could ad behav lik booleanqueri unrel bf chang done
ad indexdocvaluesfield twice trip assert doc valu field single-valu design ie given field name occur document accident add get assert error spooki run w/o assert mayb someth evil happen think explicit check throw clear exc sinc user could easili accid
jenkin build hang quit often testindexwriterwiththreads.testclosewiththread last hung test run https //builds.apache.org/job/lucene-solr-tests-only-trunk/10638/consol noformat junit main prio=5 tid=0x0000000801ef3800 nid=0x1965c wait condit 0x00007fffffbfd000 junit java.lang.thread.st wait park junit sun.misc.unsafe.park nativ method junit park wait 0x0000000825d853a8 java.util.concurrent.locks.reentrantlock nonfairsync junit java.util.concurrent.locks.locksupport.park locksupport.java:186 junit java.util.concurrent.locks.abstractqueuedsynchronizer.parkandcheckinterrupt abstractqueuedsynchronizer.java:838 junit java.util.concurrent.locks.abstractqueuedsynchronizer.acquirequeu abstractqueuedsynchronizer.java:871 junit java.util.concurrent.locks.abstractqueuedsynchronizer.acquir abstractqueuedsynchronizer.java:1201 junit java.util.concurrent.locks.reentrantlock nonfairsync.lock reentrantlock.java:214 junit java.util.concurrent.locks.reentrantlock.lock reentrantlock.java:290 junit org.apache.lucene.index.documentswriterflushcontrol.markforfullflush documentswriterflushcontrol.java:403 junit org.apache.lucene.index.documentswriter.flushallthread documentswriter.java:557 junit lock 0x0000000825d81998 org.apache.lucene.index.documentswrit junit org.apache.lucene.index.indexwriter.preparecommit indexwriter.java:2776 junit lock 0x0000000825d7d840 java.lang.object junit org.apache.lucene.index.indexwriter.commitintern indexwriter.java:2904 junit lock 0x0000000825d7d830 java.lang.object junit org.apache.lucene.index.indexwriter.closeintern indexwriter.java:1156 junit org.apache.lucene.index.indexwriter.clos indexwriter.java:1099 junit org.apache.lucene.index.testindexwriterwiththreads.testclosewiththread testindexwriterwiththreads.java:200 junit sun.reflect.nativemethodaccessorimpl.invoke0 nativ method junit sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:57 junit sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:43 junit java.lang.reflect.method.invok method.java:616 junit org.junit.runners.model.frameworkmethod 1.runreflectivecal frameworkmethod.java:44 junit org.junit.internal.runners.model.reflectivecallable.run reflectivecallable.java:15 junit org.junit.runners.model.frameworkmethod.invokeexplos frameworkmethod.java:41 junit org.junit.internal.runners.statements.invokemethod.evalu invokemethod.java:20 junit org.junit.rules.testwatchman 1.evalu testwatchman.java:48 junit org.apache.lucene.util.lucenetestcas 2 1.evalu lucenetestcase.java:611 junit org.junit.internal.runners.statements.runbefores.evalu runbefores.java:28 junit org.junit.internal.runners.statements.runafters.evalu runafters.java:31 junit org.junit.runners.blockjunit4classrunner.runchild blockjunit4classrunner.java:76 junit org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:148 junit org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:50 junit org.junit.runners.parentrunn 3.run parentrunner.java:193 junit org.junit.runners.parentrunn 1.schedul parentrunner.java:52 junit org.junit.runners.parentrunner.runchildren parentrunner.java:191 junit org.junit.runners.parentrunner.access 000 parentrunner.java:42 junit org.junit.runners.parentrunn 2.evalu parentrunner.java:184 junit org.junit.internal.runners.statements.runbefores.evalu runbefores.java:28 junit org.junit.internal.runners.statements.runafters.evalu runafters.java:31 junit org.junit.runners.parentrunner.run parentrunner.java:236 junit junit.framework.junit4testadapter.run junit4testadapter.java:39 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.run junittestrunner.java:420 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.launch junittestrunner.java:911 junit org.apache.tools.ant.taskdefs.optional.junit.junittestrunner.main junittestrunner.java:743 noformat
jenkin trunk test night fail quit often oom automaton/fst test night job lucene-trunk quit often fail oom sever method alway test exampl last night time huge automaton noformat junit java.lang.outofmemoryerror java heap space junit dump heap /home/hudson/hudson-slave/workspace/lucene-trunk/heapdumps/java_pid38855.hprof junit heap dump file creat 86965954 byte 1.186 sec junit testsuit org.apache.lucene.index.testtermsenum junit testcas testintersectrandom org.apache.lucene.index.testtermsenum caus error junit java heap space junit java.lang.outofmemoryerror java heap space junit org.apache.lucene.util.automaton.runautomaton. init runautomaton.java:128 junit org.apache.lucene.util.automaton.byterunautomaton. init byterunautomaton.java:28 junit org.apache.lucene.util.automaton.compiledautomaton. init compiledautomaton.java:134 junit org.apache.lucene.index.testtermsenum.testintersectrandom testtermsenum.java:266 junit org.apache.lucene.util.lucenetestcas 2 1.evalu lucenetestcase.java:611 junit org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:148 junit org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:50 junit junit junit test run 6 failur 0 error 1 time elaps 11.699 sec noformat trace noformat junit testsuit org.apache.lucene.util.fst.testfst junit testcas testrealterm org.apache.lucene.util.fst.testfst caus error junit java heap space junit java.lang.outofmemoryerror java heap space junit org.apache.lucene.util.arrayutil.grow arrayutil.java:338 junit org.apache.lucene.util.fst.fst byteswriter.writebyt fst.java:927 junit org.apache.lucene.util.fst.bytesequenceoutputs.writ bytesequenceoutputs.java:113 junit org.apache.lucene.util.fst.bytesequenceoutputs.writ bytesequenceoutputs.java:32 junit org.apache.lucene.util.fst.fst.addnod fst.java:451 junit org.apache.lucene.util.fst.nodehash.add nodehash.java:122 junit org.apache.lucene.util.fst.builder.compilenod builder.java:180 junit org.apache.lucene.util.fst.builder.finish builder.java:495 junit org.apache.lucene.index.codecs.memory.memorycodec termswriter.finish memorycodec.java:232 junit org.apache.lucene.index.freqproxtermswriterperfield.flush freqproxtermswriterperfield.java:414 junit org.apache.lucene.index.freqproxtermswriter.flush freqproxtermswriter.java:92 junit org.apache.lucene.index.termshash.flush termshash.java:117 junit org.apache.lucene.index.docinverter.flush docinverter.java:80 junit org.apache.lucene.index.docfieldprocessor.flush docfieldprocessor.java:78 junit org.apache.lucene.index.documentswriterperthread.flush documentswriterperthread.java:472 junit org.apache.lucene.index.documentswriter.doflush documentswriter.java:420 junit org.apache.lucene.index.documentswriter.flushallthread documentswriter.java:568 junit org.apache.lucene.index.indexwriter.getread indexwriter.java:366 junit org.apache.lucene.index.indexreader.open indexreader.java:317 junit org.apache.lucene.util.fst.testfsts.testrealterm testfsts.java:1034 junit org.apache.lucene.util.lucenetestcas 2 1.evalu lucenetestcase.java:611 noformat noformat junit testsuit org.apache.lucene.util.automaton.testcompiledautomaton junit testcas testrandom org.apache.lucene.util.automaton.testcompiledautomaton caus error junit java heap space junit java.lang.outofmemoryerror java heap space junit org.apache.lucene.util.automaton.runautomaton. init runautomaton.java:128 junit org.apache.lucene.util.automaton.byterunautomaton. init byterunautomaton.java:28 junit org.apache.lucene.util.automaton.compiledautomaton. init compiledautomaton.java:134 junit org.apache.lucene.util.automaton.testcompiledautomaton.build testcompiledautomaton.java:39 junit org.apache.lucene.util.automaton.testcompiledautomaton.testterm testcompiledautomaton.java:55 junit org.apache.lucene.util.automaton.testcompiledautomaton.testrandom testcompiledautomaton.java:101 junit org.apache.lucene.util.lucenetestcas 2 1.evalu lucenetestcase.java:611 junit org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:148 junit org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:50 noformat almost everi night test fail histori https //builds.apache.org/job/lucene-trunk mayb rais max heap space reduc doc counts/
renam indexreader.reopen make clear reopen may happen spinoff lucene-3454 shai note inconsist ir.reopen sound like uncondit oper trap user past alway close old reader instead close return reader new think hidden maybe- trappi renam maybereopen reopenifneed addit instead return reopen n't happen think return null enforc proper usag maybe- api
indexsearch fail pass docbas collector use executorservic bug caus failur testsearchaft alway pass docbas 0 collector use executorservic indexsearch n't affect trunk atomicreadercontext carri right docbas 3.x
renam analyzer.reusabletokenstream tokenstream analysi consum use reusabletokenstream final make reus mandatori let renam resuabletokenstream tokenstream remov old tokenstream method
cut numer docvalu fix straight byte current numer docvalu type encod store individu creat massiv duplic write index code yet almost except pack int essenti fix straight byte variant
firstpassgroupingcollector use polllast current firstpassgroupingcollector use last remov method treeset replac relev group group replac polllast sinc lucen trunk java 6 termfirstpassgroupingcollectorjava6 solr remov well
move documentstoredfieldsvisitor o.a.l.docu examin chang field/docu api notic class o.a.l.index think o.a.l.docu intuit packag
reorder argument field constructor intuit think field take name valu type name type valu seem intuit consist previous releas take chang code exampl noformat d1.add new field foo bar field.store.y field.index.analyz d1.add new field foo textfield.type_stor bar noformat think would better noformat document.add new field foo bar textfield.type_stor noformat
testnrtmanag test failur reproduc
add back document.getvalu 'm port code trunk 's new doc/field api keep run pattern noformat string valu doc.getvalu field noformat new api becom littl verbos noformat indexablefield field doc.getfield field string valu new string fields.length int 0 values.length i++ valu field .stringvalu noformat think probabl add back sugar api name
checkindex verifi numuniqueterm recomputednumuniqueterm glanc code seem sorta check hasord==tru case mayb seem test someth els would nice verifi also term dict dont support ord add explicit check per-field 4.x for-all-field 3.x preflex
pass livedoc bit scorercontext instead weight pull reader spinoff lucene-1536 would allow filter work flexibl way besid clean
searchermanag miss close ir manag close reopen close sm thread call maybreopen swapsearch throw alreadi close except miss close searcher reader
fix jflex token compil warn get lot distract fallthrough warn run ant compil modules/analysi token generat jflex dig bit actual look spooki manag edit jflex input insert bunch break statement rule idea right/danger seem bit weird insert nake break fix warn test pass
testsimpleexplan failur noformat ant test -dtestcase=testsimpleexplan -dtestmethod=testdmq8 -dtests.seed=-7e984babece66153:3e3298ae627b33a9:3093059db62bcc71 noformat fail w/ current trunk look like silli float point precis issu noformat junit testsuit org.apache.lucene.search.testsimpleexplan junit 1.4508595 match sum junit 1.4508595 match weight field yy 2 defaultsimilar result junit 1.4508595 score doc=2 freq=1.0 termfreq=1 junit product junit 1.287682 queryweight product junit 1.287682 idf docfreq=2 maxdocs=4 junit 1.0 querynorm junit 1.1267219 fieldweight 2 product junit 1.0 tf freq=1.0 freq junit 1.0 termfreq=1 junit 1.287682 idf docfreq=2 maxdocs=4 junit 0.875 fieldnorm doc=2 junit 145085.95 match weight field xx^100000.0 2 defaultsimilar result junit 145085.95 score doc=2 freq=1.0 termfreq=1 junit product junit 128768.2 queryweight product junit 100000.0 boost junit 1.287682 idf docfreq=2 maxdocs=4 junit 1.0 querynorm junit 1.1267219 fieldweight 2 product junit 1.0 tf freq=1.0 freq junit 1.0 termfreq=1 junit 1.287682 idf docfreq=2 maxdocs=4 junit 0.875 fieldnorm doc=2 junit expect 145086.66 145086.69 junit test run 1 failur 1 error 0 time elaps 0.544 sec junit junit standard error junit note reproduc ant test -dtestcase=testsimpleexplan -dtestmethod=testdmq8 -dtests.seed=144152895b276837 eb7ba4953db943f:33373b79a971db02 junit note test param codec=preflex sim=randomsimilarityprovid querynorm=fals coord=fals field=defaultsimilar alt=dfr ne lz 0.3 key=ib ll-d2 locale=en_in timezone=pacific/samoa junit note test run jvm junit testsimpleexplan junit note linux 2.6.33.6-147.fc13.x86_64 amd64/sun microsystem inc. 1.6.0_21 64-bit /cpus=24 threads=1 free=130426744 total=189988864 junit junit testcas testdmq8 org.apache.lucene.search.testsimpleexplan fail junit field yy field w5^100.0 field xx^100000.0 ~0.5 score doc=2 =145086.66 explanationscore=145086.69 explan 145086.69 match max plus 0.5 time other junit 1.4508595 match sum junit 1.4508595 match weight field yy 2 defaultsimilar result junit 1.4508595 score doc=2 freq=1.0 termfreq=1 junit product junit 1.287682 queryweight product junit 1.287682 idf docfreq=2 maxdocs=4 junit 1.0 querynorm junit 1.1267219 fieldweight 2 product junit 1.0 tf freq=1.0 freq junit 1.0 termfreq=1 junit 1.287682 idf docfreq=2 maxdocs=4 junit 0.875 fieldnorm doc=2 junit 145085.95 match weight field xx^100000.0 2 defaultsimilar result junit 145085.95 score doc=2 freq=1.0 termfreq=1 junit product junit 128768.2 queryweight product junit 100000.0 boost junit 1.287682 idf docfreq=2 maxdocs=4 junit 1.0 querynorm junit 1.1267219 fieldweight 2 product junit 1.0 tf freq=1.0 freq junit 1.0 termfreq=1 junit 1.287682 idf docfreq=2 maxdocs=4 junit 0.875 fieldnorm doc=2 junit expect 145086.66 145086.69 junit junit.framework.assertionfailederror field yy field w5^100.0 field xx^100000.0 ~0.5 score doc=2 =145086.66 explanationscore=145086.69 explan 145086.69 match max plus 0.5 time other junit 1.4508595 match sum junit 1.4508595 match weight field yy 2 defaultsimilar result junit 1.4508595 score doc=2 freq=1.0 termfreq=1 junit product junit 1.287682 queryweight product junit 1.287682 idf docfreq=2 maxdocs=4 junit 1.0 querynorm junit 1.1267219 fieldweight 2 product junit 1.0 tf freq=1.0 freq junit 1.0 termfreq=1 junit 1.287682 idf docfreq=2 maxdocs=4 junit 0.875 fieldnorm doc=2 junit 145085.95 match weight field xx^100000.0 2 defaultsimilar result junit 145085.95 score doc=2 freq=1.0 termfreq=1 junit product junit 128768.2 queryweight product junit 100000.0 boost junit 1.287682 idf docfreq=2 maxdocs=4 junit 1.0 querynorm junit 1.1267219 fieldweight 2 product junit 1.0 tf freq=1.0 freq junit 1.0 termfreq=1 junit 1.287682 idf docfreq=2 maxdocs=4 junit 0.875 fieldnorm doc=2 junit expect 145086.66 145086.69 junit org.apache.lucene.search.checkhits.verifyexplan checkhits.java:324 junit org.apache.lucene.search.checkhit explanationasserter.collect checkhits.java:494 junit org.apache.lucene.search.scorer.scor scorer.java:60 junit org.apache.lucene.search.indexsearcher.search indexsearcher.java:580 junit org.apache.lucene.search.indexsearcher.search indexsearcher.java:363 junit org.apache.lucene.search.checkhits.checkexplan checkhits.java:302 junit org.apache.lucene.search.queryutils.checkexplan queryutils.java:92 junit org.apache.lucene.search.queryutils.check queryutils.java:126 junit org.apache.lucene.search.queryutils.check queryutils.java:122 junit org.apache.lucene.search.queryutils.check queryutils.java:106 junit org.apache.lucene.search.checkhits.checkhitcollector checkhits.java:89 junit org.apache.lucene.search.testexplanations.qtest testexplanations.java:99 junit org.apache.lucene.search.testsimpleexplanations.testdmq8 testsimpleexplanations.java:224 junit org.apache.lucene.util.lucenetestcas 2 1.evalu lucenetestcase.java:611 junit org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:148 junit org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:50 junit junit junit test org.apache.lucene.search.testsimpleexplan fail noformat
testgroup failur noformat ant test -dtestcase=testgroup -dtestmethod=testrandom -dtests.seed=295cdb78b4a442d4 -4c5d64ef4d698c27 -425d4c1eb87211ba noformat fail current trunk noformat junit standard error junit note reproduc ant test -dtestcase=testgroup -dtestmethod=testrandom -dtests.seed=295cdb78b4a442d4 -4c5d64ef4d698c27 -425d4c1eb87211ba junit note test param codec=randomcodecprovid id=mockrandom content=mocksep sort2=simpletext groupend=puls freqcutoff=3 minblocksize=65 maxblocksize=132 sort1=memori group=memori sim=randomsimilarityprovid querynorm=tru coord=fals id=dfr f l2 content=dfr bel3 800.0 sort2=dfr gl3 800.0 groupend=dfr g2 sort1=dfr gb3 800.0 group=lm jelinek-merc 0.700000 locale=zh_tw timezone=america/indiana/indianapoli junit note test run jvm junit testgroup junit note linux 2.6.33.6-147.fc13.x86_64 amd64/sun microsystem inc. 1.6.0_21 64-bit /cpus=24 threads=1 free=143246344 total=281804800 junit junit testcas testrandom org.apache.lucene.search.grouping.testgroup fail junit expect 11 7 junit junit.framework.assertionfailederror expect 11 7 junit org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:148 junit org.apache.lucene.util.lucenetestcaserunner.runchild lucenetestcaserunner.java:50 junit org.apache.lucene.search.grouping.testgrouping.assertequ testgrouping.java:980 junit org.apache.lucene.search.grouping.testgrouping.testrandom testgrouping.java:865 junit org.apache.lucene.util.lucenetestcas 2 1.evalu lucenetestcase.java:611 junit junit noformat dug test bit sneaki compar sort doc score across 2 index index 1 delet index 2 doc organ doc block group delet theori think even though delet caus score differ across two indic alter sort order doc explain output doc sort differ noformat 1 top hit delet doc-block index id=239 explain 2.394486 match weight content real1 292 dfrsimilar result 2.394486 score dfrsimilar doc=292 freq=1.0 comput 1.0 termfreq=1 41.944084 normalizationh3 comput 1.0 tf 5.3102274 avgfieldlength 2.56 len 102.829 basicmodelb comput 41.944084 tfn 880.0 numberofdocu 239.0 totaltermfreq 0.023286095 aftereffectl comput 41.944084 tfn 2 hit delet normal index id=229 id=229 explain=2.382285 match weight content real1 225 dfrsimilar result 2.382285 score dfrsimilar doc=225 freq=1.0 comput 1.0 termfreq=1 41.765594 normalizationh3 comput 1.0 tf 5.3218827 avgfieldlength 10.24 len 101.879845 basicmodelb comput 41.765594 tfn 786.0 numberofdocu 215.0 totaltermfreq 0.023383282 aftereffectl comput 41.765594 tfn went call explain delet normal index top doc id=239 explain 2.3822558 match weight content real1 17 dfrsimilar result 2.3822558 score dfrsimilar doc=17 freq=1.0 comput 1.0 termfreq=1 42.165264 normalizationh3 comput 1.0 tf 5.3218827 avgfieldlength 2.56 len 102.8307 basicmodelb comput 42.165264 tfn 786.0 numberofdocu 215.0 totaltermfreq 0.023166776 aftereffectl comput 42.165264 tfn noformat
refactor docvalu param codec.java work lucene-2621 tri cleanup codec api current codec.java boolean getdocvaluesusecf think impl detail codec.java e.g might make simpletext impl use 1 file param awkward instead creat sep impl dont use cfs use separ file place sep packag n't want use cfs use implement codec
move function group collector solr group modul move function*collector solr insid group sourc file group modul
taxonomywrit parent array creation thread safe caus npe follow user list thread taxwrit leakag http //markmail.org/thread/jkkhemfzpnbdzoft appear two thread ask parent array first time context switch first thread creat empti parent array initi would caus array use uniniti array caus npe fix simpl synchron method getparentarray
lucenetaxonomyread .decref may close inner ir render ltr limbo taxonomyread support ref-count decref method deleg inner indexread call .decref latter may close reader ref zero taxonomi would remain open fail mani method call also ltr 's .close method work manner indexread 's call decref leav real close logic decref believ right approach fix
add searcherlifetimemanag retriev searcher previous use idea similar solr-2809 ad searcher leas solr util class sit whatev sourc current searcher eg nrtmanag searchermanag etc record hold refer searcher recent histori idea ensur user follow-on action click next page drill down/up two searcher invoc within singl user search need happen searcher eg distribut search retriev searcher use last time think new searchaft api lucene-2215 follow-on search searcher import sinc bottom score/docid held api easili shift new searcher open new search record searcher use manag return long token current ir.getvers later use retriev searcher separ must period call prune prune old searcher ideal thread time open new searcher
testbooleanminshouldmatch test failur ant test -dtestcase=testbooleanminshouldmatch -dtestmethod=testrandomqueri -dtests.seed=505d62a62e9f90d0 -60daa428161b404b -406411290a98f416 think absolute/rel epsilon issu
factor searchermanag nrtmanag current nrtmanag searchermanag nrtmanag contain big piec code alreadi searchermanag user kind forc use nrtmanag want searchermanag good nrt integr nrtmanag also forc maintain two instanc even know alway want delet nrtmanag tri necessari mix lot respons ie handl searcher handl index generat nrtmanag use searchermanag aggreg rather duplic lot logic searchermanag nrt directori base implement user simpli choos
restructur codec hierarchi spinoff lucene-2621 hope renam etc rote way make progress current codec.java repres portion index part index store field term vector fieldinfo want codec control also inconsist codec current exampl memori puls realli postingsformat might appli specif field hand preflex actual codec repres lucen 3.x index format part yet imagin would like simpletext way propos restructur class someth like codecprovid dead replac java serviceprovid mechan index readabl codec classpath codec repres index format postingsformat fieldsformat postingsformat codec control today codec return one field fieldsformat store field term vector fieldinfo think preflex doesnt make sens expos postingsformat public class preflex never per-field use allow configur preflex specif field similar think futur thing simpletext nobodi need simpletext product codec tri make much index plain text simpl possibl debugging/learning/etc n't need expos postingsformat hand n't think need puls memori codec pretti silli make entir index use one postingsformat parallel analysi postingsformat like token codec like analyz n't need analyz show everi token also move bake perfieldcodecwrapp would basic perfieldpostingsformat privat would write id file like today futur 3.x hairi backward code would move preflexcodec simpletextcodec would get plain text fieldinfo impl etc
extract generic framework run random test color red work issu temporarili github color lot experi tweak https //github.com/carrotsearch/randomizedtest direct git clone git //github.com/carrotsearch/randomizedtesting.git color randomizedrunn junit runner capabl run test-annot test case respect regular lifecycl hook beforeclass afterclass also add follow random repeat execut infrastructur deal random use pseudo-random given run repeat given start seed mani thing call random random shuffl test method ensur n't depend random shuffl hook within given class ensur n't depend base class randomizedtest provid number method generat random number string pick random object collect fulli repeat given initi seed race condit runner provid infrastructur augment stack trace inform initi seed use run test repeat determin test repeat indic problem test case thread control thread creat part test case assign initi random seed repeat track attempt termin thread creat termin insid test case clean caus test failur track attempt termin test case run long default timeout 60 second adjust use global properti annot improv valid lifecycl support randomizedrunn use relax contract hook method access hook method _can_ privat help avoid problem method shadow static hook overrid requir tedious super chain privat hook alway execut n't affect subclass way period listen annot test class allow hook execut progress listen event valid annot allow test class provid custom valid strategi project-specif exampl base class request specif test case name strategi reject junit3-lik method instanc randomizedrunn chain suppress except happen execut test case includ hook except report soon happen multipl failur report occur environ know display failur sequenti allow clearer understand actual happen first
remov per-docu multipli filteredqueri spinoff lucene-1536 lucene-1536 uwe suggest use filteredqueri under-the-hood implement filter search queri ineffici per-docu multipl wrapped.scor boost instead pass boost weight like booleanqueri avoid per-docu multipli
blockjoinqueri n't implement boost review lucene-3494 check queri notic blockjoinqueri current throw uoe getboost setboost noformat throw new unsupportedoperationexcept queri support boost pleas use childquery.setboost instead noformat n't think safe queri part lucen reli upon work exampl bqs rewrit singl claus eras think pass boost inner weight
support group indexdocvalu although idv yet final particular sortedsourc think alreadi discuss investig implement group idv
random sampler random facet samplingwrappertest occasion fail randomsampl random even import java.util.random behavior determinist addit test testcountusingsamp never retri suppos take care hoped-for random
pack int move .getarray reader api simpl code cleanup 's messi consum packedints.read must check whether impl direct8/16/32/64 order get array 's better move .getarray reader interfac make directn impl packag privat
disjunctionsumscor give slight float iota differ score .nextdoc vs .advanc spinoff lucene-1536 dug hit score diff use luceneutil benchmark patch first thought bs1/bs2 differ bug patch still use bs2 bs1 robert 's last patch fix 's actual diff bs2 whether next advanc doc 's disjunctionsumscor sum float score given doc match multipl sub-scor might sum differ order .nextdoc 'd doc .advance'd turn pq use scorer scorerdocqueu make effort break tie top n scorer doc pq n't care order fix scorerdocqueu break tie like non-trivi perf hit though 'm sure whether anyth