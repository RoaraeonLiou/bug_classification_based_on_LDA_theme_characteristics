75
cach invalid obsolet entri mention content-loc http //www.w3.org/protocols/rfc2616/rfc2616-sec13.html sec13.6 cach receiv success respons whose content-loc field match exist cach entri request-uri whose entity-tag differ exist entri whose date recent exist entri exist entri return respons futur request delet cach current cach modul n't yet recommend requir must mark improv rather bug
stringbodi incorrect default characterset stringbodi default charset.defaultcharset charset provid mean default depend current host default us-ascii case stringpart common httpclient 3.1
formbodypart code agre contentdescriptor javadoc wrt nullabl mimetyp transferencod formbodypart agre contentdescriptor javadoc wrt nullabl mimetyp transferencod code formbodypart explicit allow mimetyp transferencod null case relev header generat use behaviour header necessaruli need howev bahaviour disagre javadoc contentdescriptor interfac null allow also abstractcontentbodi allow mime-typ null
abstracthttpclient.determinetarget httpurirequest issu 4.1 beta1 fail pars right host url eg http //my.site.com/search/ for=http //other.site.com fail request eg rest param valu '/ abstracthttpclient.determinetarget httpurirequest httpcomponents-client-4.0.3 privat httphost determinetarget httpurirequest request null target may accept default target otherwis null target detect director httphost target null uri requesturi request.geturi requesturi.isabsolut target new httphost requesturi.gethost requesturi.getport requesturi.getschem return target httpcomponents-client-4.1-beta1 privat httphost determinetarget httpurirequest request throw clientprotocolexcept null target may accept default target otherwis null target detect director httphost target null uri requesturi request.geturi requesturi.isabsolut string ssp requesturi.getschemespecificpart ssp ssp.substr 2 ssp.length //remov prefix int end ssp.indexof 0 ssp.indexof ssp.indexof '/ 0 ssp.indexof '/ ssp.indexof 0 ssp.indexof ssp.length string host ssp.substr 0 end int port requesturi.getport string scheme requesturi.getschem host null || .equal host throw new clientprotocolexcept uri specifi valid host name requesturi target new httphost host port scheme return target
abstracthttpclient.determinetarget recogn target host correct tri execut httpget follow uri http //www.foo.foo/dosomething.html url=http //www.bar.bar/dosomethingelse.html lead unknownhostexcept go intern code problem seem abstracthttpclient.determinetarget method string ssp requesturi.getschemespecificpart ssp ssp.substr 2 ssp.length //remov prefix int end ssp.indexof 0 ssp.indexof ssp.indexof '/ 0 ssp.indexof '/ ssp.indexof 0 ssp.indexof ssp.length string host ssp.substr 0 end code set target host www.foo.foo/dosomething.html url=http instead www.foo.foo obvious break execut far line defaultclientconnectionoperator.resolvehostnam throw unknownhostexcept fwiw abstracthttpclient.determinetarget method actual access request uri object correct state host www.foo.foo tri extract host scheme specif part anyway hope use workaround pleas let know 'm stuck one marco
enabl wire log chang iseof/isstal behavior enabl wire log defaultclientconnect wrap socketinputbuff loggingsessioninputbuff hide eofsensor interfac implement socketinputbuff loggingsessioninputbuff make least abstracthttpclientconnection.iseof isstal method behav differ stale connect check wo n't realli work intend wire log enabl make bit difficult debug problem relat stale connect propos fix implement eofsensor interfac loggingsessioninputbuff deleg wrap buffer
defaulthttprequestretryhandl handl put idempot method retri though rfc2616 section 9.1.2 clear defin one see attach patch file fix fix treat put request idempot mark retri enclos httpentiti either null repeat
httpget request creat paramet url present formatt follow redirect locat result bad request 404 made http //www.qpassport.co.uk/passport/register.php do=signup who=adult url=http 3a 2f 2fwww.qpassport.co.uk 2fpassport 2f month=2 year=1947 day=26 get request made header notic host valu debug org.apache.http.wir get http //www.qpassport.co.uk/passport/register.php do=signup who=adult url=http 3a 2f 2fwww.qpassport.co.uk 2fpassport 2f month=2 year=1947 day=26 http/1.1 \r \n debug org.apache.http.wir accept text/html application/xhtml+xml application/xml q=0.9 q=0.8 \r \n debug org.apache.http.wir accept-languag en-us en q=0.5 \r \n debug org.apache.http.wir accept-charset iso-8859-1 utf-8 q=0.7 q=0.7 \r \n debug org.apache.http.wir proxy-connect keep-al \r \n debug org.apache.http.wir refer http //www.qpassport.co.uk/passport/register.php s=b9761dfa820bb55722e3feb6438fa11f \r \n debug org.apache.http.wir host www.qpassport.co.uk/passport/register.php do=signup who=adult url=http \r \n debug org.apache.http.wir user-ag mozilla/4.0 compat msie 7.0 window nt 5.1 \r \n notic host valu debug org.apache.http.wir get http //www.qpassport.co.uk/passport/register.php do=signup who=adult month=2 year=1947 day=26 http/1.1 \r \n debug org.apache.http.head accept text/html application/xhtml+xml application/xml q=0.9 q=0.8 debug org.apache.http.head accept-languag en-us en q=0.5 debug org.apache.http.head accept-charset iso-8859-1 utf-8 q=0.7 q=0.7 debug org.apache.http.head proxy-connect keep-al debug org.apache.http.head refer http //www.qpassport.co.uk/passport/register.php s=005ef80064a0fb2f5aa6f4677a194928 debug org.apache.http.head content-length 134 debug org.apache.http.head content-typ application/x-www-form-urlencod charset=utf-8 debug org.apache.http.head host www.qpassport.co.uk debug org.apache.http.head user-ag opera/9.20 window nt 6.0 u en problem appear relat url paramet request remov request succeed formatt
ssl connect establish use resolv ip address httpclient 4.1 introduc regress establish ssl connect remot peer seem common regress major httpclient updat see httpclient-803 new sslsocketfactory.connectsocket method call x509hostnameverifi inetsocketaddress.gethostnam paramet select ip address revers lookup name verifi call resolv name ip check fail 4.0 releas check origin ip/hostnam done new connectsocket method testhostnameverifier.java check 127.0.0.1/.2 mask issu match certif localhost 127.0.0.1 actual localhost match test case 8.8.8.8 would better
secur issu digestschem use constant nonc count valu nonc count valu digestschem static set 00000001 never chang also seen comment said file mean fail server correct detect man-in-the-middl replay attack lead addit 401 request everi second time server must configur turn check either poor secur poor perform suggest minimum count increment everi call digestschem createdigest also instanc variabl instead static realli relat challeng assum case instanc cach reus atomicinteg good choic implement counter see rfc 2617 chapter 3.2.2 3.2.3
httpclient per default relentless spam stderr httpclient relentless spam stderr includ project via maven decent default behaviour libari libari per default communic intern state sole adequat via api let applic react state log one reaction repli ticket vain see perhap sensit topic see log core concern httpclient agre 's help debug tool need opt-in standard error output log httpclient absolut useless describ applic tri improv way disabl httclient log fact seem mani way alway bad sign googl search httpclient consol spam 204 hit harsh phrase alon search phrase libari like use compar number hit ask youself often seen java standard libari write stdout stderr person tri disabl via jdk14 getlogg org.apach .setlevel level.off would n't work use solut found stackoverflow system.setproperti org.apache.commons.logging.log org.apache.commons.logging.impl.nooplog problem includ lib suddent consol useless httpclient write system monitor search googl find solut http //hc.apache.org/httpcomponents-client-ga/logging.html tell turn log logic one turn jdk logger work right away 's realli matter follow princip least supris libari expect write consol observ default behaviour httpclient princip separ concern log concern applic libari follow least one would substanti increas joy work httpclient libari
wrong creation authscop object class name org.apache.http.client.protocol.requestauthcach line 118-119 issu want creat new object authscop pass host name port scheme name due incorrect constructor call get object realm name scheme name current code credenti cred credsprovider.getcredenti new authscop host.gethostnam host.getport null schemenam
wrong class name statemgmt.xml basicclientcooki read basiccookiestor see patch detail
so_timeout set earli enough sock proxi plainsocketfactori ve creat deleg schemesocketfactori implement support set sock proxi socket creation connectsocket implement previous deleg plainsocketfactori problem so_timeout set socket connect establish sock proxi lead stop nativ read0 method socket endless wait read occur proxi continu connect actual socket destin proxi made sure set so_timeout paramet httpparam get honor plainsocketfactori fix make httpclient honor so_timeout sock proxi follow line ad sock.setsotimeout httpconnectionparams.getsotimeout param plainsocketfactory.connectsocket here complet fix method plainsocketfactori public socket connectsocket final socket socket final inetsocketaddress remoteaddress final inetsocketaddress localaddress final httpparam param throw ioexcept connecttimeoutexcept remoteaddress null throw new illegalargumentexcept remot address may null param null throw new illegalargumentexcept http paramet may null socket sock socket sock null sock createsocket localaddress null sock.setreuseaddress httpconnectionparams.getsoreuseaddr param sock.bind localaddress //fix sock proxi get stall n't answer sock.setsotimeout httpconnectionparams.getsotimeout param int timeout httpconnectionparams.getconnectiontimeout param tri sock.connect remoteaddress timeout catch sockettimeoutexcept ex throw new connecttimeoutexcept connect remoteaddress.gethostnam remoteaddress.getaddress time return sock current ve implement deleg schemesocketfactori plainsocketfactori miss set dunno implement socketfactori httpclient might need fix anyway hope help peopl get headach halt thread use sock proxi
proxy-author header receiv server side 'm follow exampl http //hc.apache.org/httpcomponents-client-ga/examples.html proxi authent seem proxi receiv credenti proxi log generat target.host see header proxy-author basic header host target.host:443 connect keep-al user-ag apache-httpclient/4.1 java 1.5 proxy-author basic z post dusan
responsecontentencod also handl x-gzip compress x-compress responsecontentencod also handl x-gzip compress x-compress encod accord spec http //www.w3.org/protocols/rfc2616/rfc2616-sec3.html 3.5 content code also requestacceptencod set accept-encod gzip deflat ident sure x-gzip compress x-compress though thank
document singleclientconnmanag schemeregistri schreg constructor wrong seem document single-arg constructor singleclientconnmanag schemeregistri schreg wrong document say incom schemeregistri paramet null schreg scheme registri null default registri howev constructor throw except incom schreg param null creat new simpl connect manag param param paramet manag param schreg scheme registri code null /code default registri public singleclientconnmanag httpparam param schemeregistri schreg schreg null throw new illegalargumentexcept scheme registri must null like document bug
httpclient 4.1 auto slash remov ve put comment follow issu https //issues.apache.org/jira/browse/httpclient-929 focusedcommentid=13001748 comment-13001748 use httpclient 4.1 problem fix defaultrequestdirector.rewriterequesturi method non-proxi uri absolut uri call uriutils.rewriteuri take rawpath uri normal pass uri exampl http //www.whatever.com/1//3 automat remov extra slash becom http //www.whatever.com/1/3 ve got rest servic accept uri param1 param2 param3 take empti valu past auto slash remov 3 valu shift left posit match param2 would n't say solut wrong guess chang valu user pass
httpclient 4.1 ignor request retri handler stop retri read timeout follow connect refus encount issu write unit test restbackup tm api client librari https //github.com/mleonhard/restbackup-java httpclient 4.1 fail retri encount read timeout follow connect refus problem occur window linux short program reproduc problem perform expect 5 request attempt linux 2 window window environ laptop window 7 ultim 64-bit oracl java se develop kit updat 21 32-bit linux environ amazon ec2 ubuntu 10.04 lts 32-bit oracl java se develop kit updat 21 32-bit first bug report apach project 'd like add 'm big fan common librari http compon sincer -michael retrybug.java import java.io.ioexcept import java.net.serversocket import java.util.logging.logg import org.apache.http.client.httprequestretryhandl import org.apache.http.client.methods.httpget import org.apache.http.impl.client.defaulthttpcli import org.apache.http.params.coreconnectionpnam import org.apache.http.protocol.httpcontext public class retrybug privat static final logger _log logger.getlogg retrybug.class.getnam public static void main string arg throw ioexcept serversocket serversocket new serversocket 0 1 defaulthttpcli httpclient new defaulthttpcli httprequestretryhandl retryhandl new httprequestretryhandl public boolean retryrequest ioexcept e int count httpcontext context _log.info count= count e.tostr return count 5 httpclient.sethttprequestretryhandl retryhandl httpclient.getparam .setintparamet coreconnectionpnames.so_timeout 100 tri string url http //127.0.0.1 serversocket.getlocalport httpclient.execut new httpget url final serversocket.clos window 7 c \retrybug md5sum httpcomponents-client-4.1-bin.zip 008ad15560249bcde42cfe34fdb4e858 *httpcomponents-client-4.1-bin.zip c \retrybug c \program file x86 \java\jdk1.6.0_21\bin\java.ex -version java version 1.6.0_21 java tm se runtim environ build 1.6.0_21-b06 java hotspot tm client vm build 17.0-b16 mix mode c \retrybug c \program file x86 \java\jdk1.6.0_21\bin\javac.ex -cp httpcomponents-client-4.1\lib\commons-codec-1.4.jar httpcomponents-client-4.1\lib\commons-logging-1.1.1.jar httpcomponents-client-4.1\lib\httpclient-4.1.jar httpcomponents-client-4.1\lib\httpcore-4.1.jar retrybug.java c \retrybug c \program file x86 \java\jdk1.6.0_21\bin\java.ex -cp httpcomponents-client-4.1\lib\commons-codec-1.4.jar httpcomponents-client-4.1\lib\commons-logging-1.1.1.jar httpcomponents-client-4.1\lib\httpclient-4.1.jar httpcomponents-client-4.1\lib\httpcore-4.1.jar retrybug mar 9 2011 9:14:36 pm retrybug 1 retryrequest info count=1 java.net.sockettimeoutexcept read time mar 9 2011 9:14:36 pm org.apache.http.impl.client.defaultrequestdirector tryexecut info i/o except java.net.sockettimeoutexcept caught process request read time mar 9 2011 9:14:36 pm org.apache.http.impl.client.defaultrequestdirector tryexecut info retri request except thread main org.apache.http.conn.httphostconnectexcept connect http //127.0.0.1:56361 refus org.apache.http.impl.conn.defaultclientconnectionoperator.openconnect defaultclientconnectionoperator.java:158 org.apache.http.impl.conn.abstractpoolentry.open abstractpoolentry.java:149 org.apache.http.impl.conn.abstractpooledconnadapter.open abstractpooledconnadapter.java:121 org.apache.http.impl.client.defaultrequestdirector.tryexecut defaultrequestdirector.java:650 org.apache.http.impl.client.defaultrequestdirector.execut defaultrequestdirector.java:454 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:820 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:754 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:732 retrybug.main retrybug.java:27 caus java.net.connectexcept connect refus connect java.net.plainsocketimpl.socketconnect nativ method java.net.plainsocketimpl.doconnect plainsocketimpl.java:333 java.net.plainsocketimpl.connecttoaddress plainsocketimpl.java:195 java.net.plainsocketimpl.connect plainsocketimpl.java:182 java.net.sockssocketimpl.connect sockssocketimpl.java:366 java.net.socket.connect socket.java:529 org.apache.http.conn.scheme.plainsocketfactory.connectsocket plainsocketfactory.java:120 org.apache.http.impl.conn.defaultclientconnectionoperator.openconnect defaultclientconnectionoperator.java:148 8 c \retrybug ubuntu 10 md5sum httpcomponents-client-4.1-bin.tar.gz f043c1cc016cb3b720be9fb020bfa755 httpcomponents-client-4.1-bin.tar.gz ~/jdk1.6.0_21/bin/java -version java version 1.6.0_21 java tm se runtim environ build 1.6.0_21-b06 java hotspot tm client vm build 17.0-b16 mix mode share ~/jdk1.6.0_21/bin/javac -cp httpcomponents-client-4.1/lib/httpclient-cache-4.1.jar httpcomponents-client-4.1/lib/commons-logging-1.1.1.jar httpcomponents-client-4.1/lib/httpcore-4.1.jar httpcomponents-client-4.1/lib/httpclient-4.1.jar httpcomponents-client-4.1/lib/httpmime-4.1.jar httpcomponents-client-4.1/lib/commons-codec-1.4.jar retrybug.java ~/jdk1.6.0_21/bin/java -cp httpcomponents-client-4.1/lib/httpclient-cache-4.1.jar httpcomponents-client-4.1/lib/commons-logging-1.1.1.jar httpcomponents-client-4.1/lib/httpcore-4.1.jar httpcomponents-client-4.1/lib/httpclient-4.1.jar httpcomponents-client-4.1/lib/httpmime-4.1.jar httpcomponents-client-4.1/lib/commons-codec-1.4.jar retrybug mar 9 2011 1:09:42 pm retrybug 1 retryrequest info count=1 java.net.sockettimeoutexcept read time mar 9 2011 1:09:42 pm org.apache.http.impl.client.defaultrequestdirector tryexecut info i/o except java.net.sockettimeoutexcept caught process request read time mar 9 2011 1:09:42 pm org.apache.http.impl.client.defaultrequestdirector tryexecut info retri request mar 9 2011 1:09:42 pm retrybug 1 retryrequest info count=2 java.net.sockettimeoutexcept read time mar 9 2011 1:09:42 pm org.apache.http.impl.client.defaultrequestdirector tryexecut info i/o except java.net.sockettimeoutexcept caught process request read time mar 9 2011 1:09:42 pm org.apache.http.impl.client.defaultrequestdirector tryexecut info retri request mar 9 2011 1:09:42 pm retrybug 1 retryrequest info count=3 java.net.sockettimeoutexcept read time mar 9 2011 1:09:42 pm org.apache.http.impl.client.defaultrequestdirector tryexecut info i/o except java.net.sockettimeoutexcept caught process request read time mar 9 2011 1:09:42 pm org.apache.http.impl.client.defaultrequestdirector tryexecut info retri request mar 9 2011 1:09:42 pm retrybug 1 retryrequest info count=4 java.net.sockettimeoutexcept read time mar 9 2011 1:09:42 pm org.apache.http.impl.client.defaultrequestdirector tryexecut info i/o except java.net.sockettimeoutexcept caught process request read time mar 9 2011 1:09:42 pm org.apache.http.impl.client.defaultrequestdirector tryexecut info retri request mar 9 2011 1:09:51 pm retrybug 1 retryrequest info count=5 java.net.sockettimeoutexcept read time except thread main java.net.sockettimeoutexcept read time java.net.socketinputstream.socketread0 nativ method java.net.socketinputstream.read socketinputstream.java:129 org.apache.http.impl.io.abstractsessioninputbuffer.fillbuff abstractsessioninputbuffer.java:149 org.apache.http.impl.io.socketinputbuffer.fillbuff socketinputbuffer.java:110 org.apache.http.impl.io.abstractsessioninputbuffer.readlin abstractsessioninputbuffer.java:260 org.apache.http.impl.conn.defaultresponseparser.parsehead defaultresponseparser.java:98 org.apache.http.impl.io.abstractmessageparser.pars abstractmessageparser.java:252 org.apache.http.impl.abstracthttpclientconnection.receiveresponsehead abstracthttpclientconnection.java:281 org.apache.http.impl.conn.defaultclientconnection.receiveresponsehead defaultclientconnection.java:247 org.apache.http.impl.conn.abstractclientconnadapter.receiveresponsehead abstractclientconnadapter.java:219 org.apache.http.protocol.httprequestexecutor.doreceiverespons httprequestexecutor.java:298 org.apache.http.protocol.httprequestexecutor.execut httprequestexecutor.java:125 org.apache.http.impl.client.defaultrequestdirector.tryexecut defaultrequestdirector.java:622 org.apache.http.impl.client.defaultrequestdirector.execut defaultrequestdirector.java:454 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:820 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:754 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:732 retrybug.main retrybug.java:27
inlin nest jar osgi bundl eclips n't support bundl nest jar https //bugs.eclipse.org/bugs/show_bug.cgi id=111238 workaround inlin content nest jar simpl fix n't impact non-eclips user pom.xml embed-depend scope=compile|runtim inline=fals /embed-depend embed-depend scope=compile|runtim inline=tru /embed-depend
cach modul generat except non-compli respons without consum respons bodi responseprotocolcompli class cach modul check incom origin respons attempt make compliant rfc2616 howev instanc possibl current throw except without consum origin respons bodi caus connect leak general try..catch..fin pattern document httpclient interfac javadoc follow
contentencodinghttpclient.execut httpget responsehandl throw ioexcept read compress respons follow snippet string url http //yahoo.com httpclient httpclient new contentencodinghttpcli httpget get new httpget url string content httpclient.execut get new basicresponsehandl throw java.io.ioexcept attempt read close stream org.apache.http.impl.io.chunkedinputstream.read chunkedinputstream.java:126 java.util.zip.checkedinputstream.read checkedinputstream.java:42 java.util.zip.gzipinputstream.readubyt gzipinputstream.java:205 java.util.zip.gzipinputstream.readushort gzipinputstream.java:197 java.util.zip.gzipinputstream.readhead gzipinputstream.java:136 java.util.zip.gzipinputstream. init gzipinputstream.java:58 java.util.zip.gzipinputstream. init gzipinputstream.java:68 org.apache.http.client.entity.gzipdecompressingentity.getcont gzipdecompressingentity.java:63 org.apache.http.conn.basicmanagedentity.getcont basicmanagedentity.java:88 org.apache.http.util.entityutils.consum entityutils.java:65 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:974 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:919 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:910 tv.adap.service.httppooltest.testchunkedgzip httppooltest.java:41 wherea follow snippet run fine string url http //yahoo.com httpclient httpclient new contentencodinghttpcli httpget get new httpget url httprespons respons httpclient.execut get httpentiti entiti response.getent string content entityutils.tostr entiti two snippet function put entiti bodi content creat jira per recommend oleg httpclient-us
gsoc 2011 fluent api httpclient develop fluent api facad httpclient base code current maintain apach stanbol apach sling project detail see http //markmail.org/message/mmyljtgjp3za6kyz contact apach httpcompon committ dev hc.apache.org
decompressingent call close inputstream retriev getcont method decompressingentity.writeto outputstream outstream close inputstream retriev getcont accord document httpentity.writeto import pleas note entiti implement must ensur alloc resourc proper dealloc method return imho satisfi decompressingentity.writeto
kerbero cross-realm support broken issu basic base fact issu https //issues.sonatype.org/browse/ahc-71 focusedcommentid=129559 action_129559 sinc kerbero code look assum ahc use code patch appli fix http //hc.apache.org/httpcomponents-client-ga/httpclient/xref/org/apache/http/impl/auth/negotiatescheme.html 200 defect code
use iter extend urlencodedforment instead list extend urlencodedforment urlencodedutils.format urlencodedforment urlencodedforment requir list extend urlencodedforment pass urlencodedutils.format would nice use iter extend urlencodedforment abl use collect e.g set extend urlencodedforment
proxi authent error unexpect state msg_type3_gener use ntlm authent tri connect websit requir basic authent proxi requir ntlm authent proxi authent fail proxi authent error unexpect state msg_type3_gener full wire log attach code replic problem follow privat void execut throw httpexcept ioexcept url targeturl new url target_url defaulthttpcli httpclient new defaulthttpcli httphost targethost new httphost targeturl.gethost httphost proxyhost new httphost proxy_host proxy_port httpclient.getparam .setparamet connroutepnames.default_proxi proxyhost credentialsprovid credprovid httpclient.getcredentialsprovid credenti proxycredenti new ntcredenti proxy_us proxy_password proxy_machin proxy_domain authscop proxyauthscop new authscop proxyhost.gethostnam proxyhost.getport credprovider.setcredenti proxyauthscop proxycredenti credenti targetcredenti new usernamepasswordcredenti target_us target_password authscop targetauthscop new authscop targethost.gethostnam targethost.getport credprovider.setcredenti targetauthscop targetcredenti httpget httpget new httpget targeturl.getpath httprespons respons httpclient.execut targethost httpget system.out.println respons respons
clientpnames.virtual_host use provid port deriv target url paramet clientpnames.virtual_host allow default host header overridden current code use httphost entri provid automat add port suffix mean user code provid port 's default protocol would simpler user port automat ad user provid port code deriv target url user provid port number use done current allow user overrid port ever prove necessari
browsercompathostnameverifi stricthostnameverifi handl wildcard ssl certif better ran problem ssl wildcard certif class browsercompathostnameverifi handl *.example.org fine server*.example.org fail work correct javadoc claim behav way curl firefox firefox ssl certif server*.example.org work fine host server.example.org use httpclient throw except exampl test junit4 packag org.example.hb import javax.net.ssl.sslexcept import org.apache.http.conn.ssl.browsercompathostnameverifi import org.junit.test public class browsercompathostnameverifiertest throw exept verifi method throw sslexcept test public void testverifystringstringarraystringarray throw sslexcept browsercompathostnameverifi hv new browsercompathostnameverifi string host www.example.org string cns www*.example.org hv.verifi host cns cns
popul except messag inetsocketaddress.gethostnam take long time plainsocketfactori class sockettimeoutexcept occur call made inetsocketaddress.gethostnam generat except messag unfortun call take long time case address specifi ip address inetsocketaddress attempt perform reverse-lookup determin hostnam howev sinc address hostnam assign oper take long time return 'm attach patch trunk propos fix view sourc histori look like code use behavior 'm propos chang revis 1070943 base sourc commit link issu determin specif reason chang reason code need way apolog inconveni caus
miss content-length header make cach entri invalid cach entri whose origin respons n't carri content-length header reject consid invalid length cach content differ non-exist content-length header valu attach patch verifi length header origin present
gzipdecompressingent therefor contentencodinghttpcli consist entityutils.consumeent invok entityutils.consum entiti previous call entity.getcont subsequ process content throw java.io.eofexcept gzip decompress support enabl via contentencodinghttpcli similar mechan invok entityutils.consum final block mayb 'm use api correct java.io.eofexcept java.util.zip.gzipinputstream.readubyt gzipinputstream.java:207 java.util.zip.gzipinputstream.readushort gzipinputstream.java:197 java.util.zip.gzipinputstream.readhead gzipinputstream.java:136 java.util.zip.gzipinputstream. init gzipinputstream.java:58 java.util.zip.gzipinputstream. init gzipinputstream.java:68 org.apache.http.client.entity.gzipdecompressingentity.getcont gzipdecompressingentity.java:63 org.apache.http.conn.basicmanagedentity.getcont basicmanagedentity.java:88 org.apache.http.util.entityutils.consum entityutils.java:65 believ problem under decompressingent alloc new gzipinputstream call getcont rather cach stream creat first getcont call http //svn.apache.org/repos/asf/httpcomponents/httpclient/trunk/httpclient/src/main/java/org/apache/http/client/entity/decompressingentity.java customprotocolinterceptor exampl bug http //hc.apache.org/httpcomponents-client-ga/examples.html work around problem implement exampl gzipdecompressingent scala code lazi valu evalu till access class gzipdecompressingent entiti http.httpentiti extend http.entity.httpentitywrapp entiti privat lazi val gzipstream new gzipinputstream entity.getcont wrap entiti stream gzipinputstream overrid def getcont java.io.inputstream gzipstream return -1 n't know unzip content size overrid def getcontentlength long -1l
add way check releas connect back pool document emphas import clean httpentiti use n't tie default small number connect pool howev noth provid httpclient user default class allow unit test code help verifi fact proper releas connect circumst one way could done api expos number current leas taken connect pool would connmanager.pool.leasedconnections.s necessari field protect statist publish api user unit test could check zero finish workaround user subclass connect manag connpoolbyrout add getter method kind clunki solut think api written encourag user perform check
built-in way auto-retri certain status code httprequestretryhandl mechan great allow api user plug logic control whether retri automat done mani time retri etc work perfect scenario except caught issu request fall short howev scenario 'm hit servic return 503 want abl retri request automat well right need write logic accomplish 's clunki tri integr httpclient.execut call sinc 's responsehandl impl end get 503 see use case auto-retri upon get http status well 503 request would love abl configur either httpclient wrap class someth request automat retri http status code among set status configur would nice could set max retri option sleep time retri perhap option increment backoff want get fanci 'm sure possibl would nice type status-bas retri enabl responsehandl would n't even get invok retri success 's altern suggest possibl simpler build definit eleg responsehandl could throw retryrequestexcept someth like call code would catch expect might simplifi mechan speak anyway would love roll retri code sinc suspect someth hundr thousand httpclient user code seem like provid standard well-written way would go long way help mani coder thank
httpclient retri authent multipl challeng present primari one fail 'm tri request page ii 6 7.5 ii configur provid negoti ntlm negoti authent tri fail tri use ntlm authent requir remov negoti provid ii use ntlm work well solut n't control web server output debug singleclientconnmanag get connect rout httprout http //win-hnb91nnab2g debug defaultclientconnectionoper connect win-hnb91nnab2g/147.183.80.134:80 debug requestaddcooki cookiespec select best-match debug defaulthttpcli attempt 1 execut request debug defaultclientconnect send request get http/1.1 debug wire get http/1.1 \r \n debug wire host win-hnb91nnab2g \r \n debug wire connect keep-al \r \n debug wire user-ag apache-httpclient/4.1 java 1.5 \r \n debug wire \r \n debug header get http/1.1 debug header host win-hnb91nnab2g debug header connect keep-al debug header user-ag apache-httpclient/4.1 java 1.5 debug wire http/1.1 401 unauthor \r \n debug wire content-typ text/html \r \n debug wire server microsoft-iis/7.5 \r \n debug wire www-authent negoti \r \n debug wire www-authent ntlm \r \n debug wire date fri 15 jul 2011 12:15:11 gmt \r \n debug wire content-length 58 \r \n debug wire \r \n debug defaultclientconnect receiv respons http/1.1 401 unauthor debug header http/1.1 401 unauthor debug header content-typ text/html debug header server microsoft-iis/7.5 debug header www-authent negoti debug header www-authent ntlm debug header date fri 15 jul 2011 12:15:11 gmt debug header content-length 58 debug defaulthttpcli connect kept aliv indefinit debug defaulthttpcli target request authent debug defaulttargetauthenticationhandl authent scheme order prefer negoti ntlm digest basic debug defaulttargetauthenticationhandl negoti authent scheme select debug negotiateschem receiv challeng auth server debug defaulthttpcli author challeng process debug defaulthttpcli authent scope negoti realm win-hnb91nnab2g:80 debug defaulthttpcli found credenti debug wire permiss view directori page debug requestaddcooki cookiespec select best-match debug negotiateschem init win-hnb91nnab2g error requesttargetauthent authent error invalid name provid mechan level could load configur file c \windows\krb5.ini system find file specifi debug defaulthttpcli attempt 2 execut request debug defaultclientconnect send request get http/1.1 debug wire get http/1.1 \r \n debug wire host win-hnb91nnab2g \r \n debug wire connect keep-al \r \n debug wire user-ag apache-httpclient/4.1 java 1.5 \r \n debug wire \r \n debug header get http/1.1 debug header host win-hnb91nnab2g debug header connect keep-al debug header user-ag apache-httpclient/4.1 java 1.5 debug wire http/1.1 401 unauthor \r \n debug wire content-typ text/html \r \n debug wire server microsoft-iis/7.5 \r \n debug wire www-authent negoti \r \n debug wire www-authent ntlm \r \n debug wire date fri 15 jul 2011 12:15:11 gmt \r \n debug wire content-length 58 \r \n debug wire \r \n debug defaultclientconnect receiv respons http/1.1 401 unauthor debug header http/1.1 401 unauthor debug header content-typ text/html debug header server microsoft-iis/7.5 debug header www-authent negoti debug header www-authent ntlm debug header date fri 15 jul 2011 12:15:11 gmt debug header content-length 58 debug defaulthttpcli connect kept aliv indefinit debug defaulthttpcli target request authent debug negotiateschem receiv challeng auth server debug negotiateschem authent alreadi attempt debug defaulthttpcli author challeng process debug defaulthttpcli authent scope negoti realm win-hnb91nnab2g:80 debug defaulthttpcli authent fail debug wire permiss view directori page content permiss view directori page debug singleclientconnmanag releas connect org.apache.http.impl.conn.singleclientconnmanag connadapt 17fa65
set sslsocket paramet httpclient 4.0.3 easi subclass sslsocketfactori set sslsocket option e.g setenabledciphersuit setsslparameters ssl handshak happen way possibl e.g restrict cipher suit per-httpclient basi instead jvm-wide system properti httpclient 4.1.1 design chang quit lot copy-past sever long method need ideal sslsocketfactori support appli sslparamet socket howev sslparamet java 1.6 want keep compat 1.5 's howev 'd nice least method e.g protect sslsocket preparesslsocket sslsocket would get call immedi socket retriev socket factori default implement could return subclass could someth like s.setenabledciphersuit s.setsslparamet
error download text file gzip content encod hello get except tri download certain file n't control host server client 's client code httpparam param new basichttpparam params.setparamet coreconnectionpnames.connection_timeout 300000l params.setparamet clientpnames.handle_redirect true client indic server support gzip deflat compress respons contentencodinghttpclient.setdefaulthttpparam param contentencodinghttpcli client new contentencodinghttpcli user null password null string hostnam url.gethost httphost hosthttp new httphost hostnam 80 http httphost hosthttp new httphost hostnam 443 https client.getcredentialsprovid .setcredenti new authscop hostnam 80 new usernamepasswordcredenti user password client.getcredentialsprovid .setcredenti new authscop hostnam 443 new usernamepasswordcredenti user password creat authcach instanc authcach authcach new basicauthcach generat basic scheme object add local auth cach basicschem basicauth new basicschem authcache.put hosthttp basicauth authcache.put hosthttp basicauth add authcach execut context basichttpcontext localcontext new basichttpcontext localcontext.setattribut clientcontext.auth_cach authcach httpget httpget new httpget url.tostr httpget.sethead if-modified-sinc lastmodifi httprespons respons client.execut httpget responsecod response.getstatuslin .getstatuscod httpentiti entiti response.getent responsecod httpstatus.sc_not_modifi els responsecod httpstatus.sc_ok entiti null outstream new bufferedoutputstream new fileoutputstream outfilenam entity.writeto outstream 's log output debug 2011-08-02 01:23:01,031 org.apache.http.impl.conn.singleclientconnmanager:212 get connect rout httprout http host debug 2011-08-02 01:23:01,036 org.apache.http.impl.conn.defaultclientconnectionoperator:145 connect host ip :80 debug 2011-08-02 01:23:01,057 org.apache.http.client.protocol.requestaddcookies:132 cookiespec select best-match debug 2011-08-02 01:23:01,057 org.apache.http.client.protocol.requestauthcache:75 auth cach set context debug 2011-08-02 01:23:01,058 org.apache.http.impl.client.defaultrequestdirector:631 attempt 1 execut request debug 2011-08-02 01:23:01,058 org.apache.http.impl.conn.defaultclientconnection:264 send request get file http/1.1 debug 2011-08-02 01:23:01,058 org.apache.http.impl.conn.wire:63 get file http/1.1 \r \n debug 2011-08-02 01:23:01,058 org.apache.http.impl.conn.wire:63 if-modified-sinc mon 01 aug 2011 18:26:09 cest \r \n debug 2011-08-02 01:23:01,059 org.apache.http.impl.conn.wire:63 host host \r \n debug 2011-08-02 01:23:01,059 org.apache.http.impl.conn.wire:63 connect keep-al \r \n debug 2011-08-02 01:23:01,059 org.apache.http.impl.conn.wire:63 user-ag apache-httpclient/4.1.1 java 1.5 \r \n debug 2011-08-02 01:23:01,059 org.apache.http.impl.conn.wire:63 accept-encod gzip deflat \r \n debug 2011-08-02 01:23:01,060 org.apache.http.impl.conn.wire:63 \r \n debug 2011-08-02 01:23:01,060 org.apache.http.impl.conn.defaultclientconnection:268 get file http/1.1 debug 2011-08-02 01:23:01,060 org.apache.http.impl.conn.defaultclientconnection:271 if-modified-sinc mon 01 aug 2011 18:26:09 cest debug 2011-08-02 01:23:01,060 org.apache.http.impl.conn.defaultclientconnection:271 host host debug 2011-08-02 01:23:01,061 org.apache.http.impl.conn.defaultclientconnection:271 connect keep-al debug 2011-08-02 01:23:01,061 org.apache.http.impl.conn.defaultclientconnection:271 user-ag apache-httpclient/4.1.1 java 1.5 debug 2011-08-02 01:23:01,061 org.apache.http.impl.conn.defaultclientconnection:271 accept-encod gzip deflat debug 2011-08-02 01:23:01,085 org.apache.http.impl.conn.wire:63 http/1.1 200 ok \r \n debug 2011-08-02 01:23:01,086 org.apache.http.impl.conn.wire:63 server nginx/0.8.54 \r \n debug 2011-08-02 01:23:01,086 org.apache.http.impl.conn.wire:63 date mon 01 aug 2011 23:23:01 gmt \r \n debug 2011-08-02 01:23:01,086 org.apache.http.impl.conn.wire:63 content-typ text/plain \r \n debug 2011-08-02 01:23:01,086 org.apache.http.impl.conn.wire:63 last-modifi wed 20 jul 2011 14:39:57 gmt \r \n debug 2011-08-02 01:23:01,087 org.apache.http.impl.conn.wire:63 transfer-encod chunk \r \n debug 2011-08-02 01:23:01,087 org.apache.http.impl.conn.wire:63 connect keep-al \r \n debug 2011-08-02 01:23:01,087 org.apache.http.impl.conn.wire:63 vari accept-encod \r \n debug 2011-08-02 01:23:01,087 org.apache.http.impl.conn.wire:63 expir wed 31 aug 2011 23:23:01 gmt \r \n debug 2011-08-02 01:23:01,088 org.apache.http.impl.conn.wire:63 cache-control max-age=2592000 \r \n debug 2011-08-02 01:23:01,088 org.apache.http.impl.conn.wire:63 content-encod gzip \r \n debug 2011-08-02 01:23:01,088 org.apache.http.impl.conn.wire:63 \r \n debug 2011-08-02 01:23:01,088 org.apache.http.impl.conn.defaultclientconnection:249 receiv respons http/1.1 200 ok debug 2011-08-02 01:23:01,089 org.apache.http.impl.conn.defaultclientconnection:252 http/1.1 200 ok debug 2011-08-02 01:23:01,089 org.apache.http.impl.conn.defaultclientconnection:255 server nginx/0.8.54 debug 2011-08-02 01:23:01,089 org.apache.http.impl.conn.defaultclientconnection:255 date mon 01 aug 2011 23:23:01 gmt debug 2011-08-02 01:23:01,089 org.apache.http.impl.conn.defaultclientconnection:255 content-typ text/plain debug 2011-08-02 01:23:01,089 org.apache.http.impl.conn.defaultclientconnection:255 last-modifi wed 20 jul 2011 14:39:57 gmt debug 2011-08-02 01:23:01,090 org.apache.http.impl.conn.defaultclientconnection:255 transfer-encod chunk debug 2011-08-02 01:23:01,090 org.apache.http.impl.conn.defaultclientconnection:255 connect keep-al debug 2011-08-02 01:23:01,090 org.apache.http.impl.conn.defaultclientconnection:255 vari accept-encod debug 2011-08-02 01:23:01,090 org.apache.http.impl.conn.defaultclientconnection:255 expir wed 31 aug 2011 23:23:01 gmt debug 2011-08-02 01:23:01,090 org.apache.http.impl.conn.defaultclientconnection:255 cache-control max-age=2592000 debug 2011-08-02 01:23:01,091 org.apache.http.impl.conn.defaultclientconnection:255 content-encod gzip debug 2011-08-02 01:23:01,091 org.apache.http.impl.client.defaultrequestdirector:477 connect kept aliv indefinit debug 2011-08-02 01:23:01,131 org.apache.http.impl.conn.wire:63 600a \r \n debug 2011-08-02 01:23:01,132 org.apache.http.impl.conn.wire:77 0x1f debug 2011-08-02 01:23:03,838 org.apache.http.impl.conn.wire:63 \r \n content debug 2011-08-02 01:23:03,839 org.apache.http.impl.conn.singleclientconnmanager:267 releas connect org.apache.http.impl.conn.singleclientconnmanag connadapt 2aa3873 debug 2011-08-02 01:23:03,839 org.apache.http.impl.conn.singleclientconnmanager:285 releas connect open reusabl debug 2011-08-02 01:23:03,839 org.apache.http.impl.conn.defaultclientconnection:152 connect shut error 2011-08-02 01:23:03,840 app except download file java.io.eofexcept java.util.zip.gzipinputstream.readubyt gzipinputstream.java:224 java.util.zip.gzipinputstream.readushort gzipinputstream.java:214 java.util.zip.gzipinputstream.readhead gzipinputstream.java:153 java.util.zip.gzipinputstream. init gzipinputstream.java:75 java.util.zip.gzipinputstream. init gzipinputstream.java:85 org.apache.http.client.entity.gzipdecompressingentity.getcont gzipdecompressingentity.java:63 org.apache.http.util.entityutils.consum entityutils.java:65 org.apache.http.conn.basicmanagedentity.ensureconsum basicmanagedentity.java:98 org.apache.http.conn.basicmanagedentity.writeto basicmanagedentity.java:115 util.filedownload.download filedownload.java:188 app happen server n't specifi content length
responsecachingpolici use integ size responsecachingpolici current use integ interpret size content-length well intern caus issu attempt use modul cach entiti 2gb size modul fail grace throw numberformatexcept patch fix promot int long allow larger entiti cach also updat public face api possibl n't think promot break compat massiv chang also seen https //github.com/gregbowyer/httpclient/commit/1197d3f94bd2eedcec32646cd6146748ca2e6fa1
defaulthttprequestretryhandl retryrequest retri abort request defaulthttprequestretryhandl retryrequest incorrect retri abort request seen follow log messag jmeter org.apache.http.impl.client.defaulthttpcli i/o except java.net.socketexcept caught process request socket close org.apache.http.impl.client.defaulthttpcli retri request org.apache.http.impl.client.defaulthttpcli i/o except java.net.bindexcept caught connect target host address alreadi use connect org.apache.http.impl.client.defaulthttpcli retri connect abort method set isabort flag retri handler check
npe requestproxyauthent android got npe backtrac requestproxyauthentication.process httprout rout conn.getrout route.istunnel line 88 npe return 's null check return rout although getrout return null guess 's suppos happen httpclient code 's call getrout without null check return rout java.lang.nullpointerexcept com.bubblesoft.org.apache.http.client.protocol.requestproxyauthentication.process sourcefile:88 com.bubblesoft.org.apache.http.protocol.immutablehttpprocessor.process sourcefile:108 com.bubblesoft.org.apache.http.protocol.httprequestexecutor.preprocess sourcefile:174 com.bubblesoft.org.apache.http.impl.client.defaultrequestdirector.execut sourcefile:457 com.bubblesoft.org.apache.http.impl.client.abstracthttpclient.createhttpprocessor sourcefile:821 execut com.bubblesoft.org.apache.http.impl.client.abstracthttpclient.createhttpprocessor sourcefile:755 execut com.bubblesoft.org.apache.http.impl.client.abstracthttpclient.createhttpprocessor sourcefile:733 execut
implement way overrid resolv dns entri defin os work httpclient restrict environ user n't permissis edit local /etc/host file dns configur eas dns overrid capabl use jmeter follow redirect automat resolv redirect host configur anoth exampl custom forward proxi written java base httpclient deploy restrict environ would eas develop various web solut develop
deadlock singleclientconnmanager.releaseconnect singleclientconnmanager.shutdown 's possibl creat deadlock within singleclientconnectionmanag jmeter interrupt test call httpurirequest.abort part thread end process call singleclientconnmanager.shutdown see deadlock detail n't yet know shutdown call abort finish probabl bug howev may issu lock strategi within sccm henc report thread-18 org.apache.http.impl.conn.singleclientconnmanager.releaseconnect singleclientconnmanager.java:258 wait lock 0x19e00118 org.apache.http.impl.conn.singleclientconnmanag org.apache.http.impl.conn.abstractclientconnadapter.abortconnect abstractclientconnadapter.java:323 lock 0x19e00148 org.apache.http.impl.conn.singleclientconnmanag connadapt org.apache.http.client.methods.httprequestbase.abort httprequestbase.java:161 org.apache.jmeter.protocol.http.sampler.httphc4impl.interrupt httphc4impl.java:1090 org.apache.jmeter.protocol.http.sampler.httpsamplerproxy.interrupt httpsamplerproxy.java:77 org.apache.jmeter.threads.jmeterthread.interrupt jmeterthread.java:580 org.apache.jmeter.engine.standardjmeterengine.tellthreadstostop standardjmeterengine.java:552 org.apache.jmeter.engine.standardjmeterengine.access 2 standardjmeterengine.java:547 org.apache.jmeter.engine.standardjmeterengin stoptest.run standardjmeterengine.java:284 java.lang.thread.run thread.java:662 thread group 1-1 org.apache.http.impl.conn.abstractpooledconnadapter.detach abstractpooledconnadapter.java:106 wait lock 0x19e00148 org.apache.http.impl.conn.singleclientconnmanag connadapt org.apache.http.impl.conn.singleclientconnmanager.shutdown singleclientconnmanager.java:342 lock 0x19e00118 org.apache.http.impl.conn.singleclientconnmanag org.apache.jmeter.protocol.http.sampler.httphc4impl.closethreadlocalconnect httphc4impl.java:1076 org.apache.jmeter.protocol.http.sampler.httphc4impl.threadfinish httphc4impl.java:1065 org.apache.jmeter.protocol.http.sampler.httpsamplerproxy.threadfinish httpsamplerproxy.java:71 org.apache.jmeter.threads.jmeterthread threadlistenertraverser.addnod jmeterthread.java:553 org.apache.jorphan.collections.hashtree.traverseinto hashtree.java:986 org.apache.jorphan.collections.hashtree.travers hashtree.java:969 org.apache.jmeter.threads.jmeterthread.threadfinish jmeterthread.java:528 org.apache.jmeter.threads.jmeterthread.run jmeterthread.java:308 java.lang.thread.run thread.java:662
provid factori method creat defaulthttpcli instanc pre-configur base jsse network system properti provid factori method factori class intend creat defaulthttpcli instanc pre-configur base jsse 1 network 2 system properti 1 http //download.oracle.com/javase/1,5.0/docs/guide/security/jsse/jsserefguide.html 2 http //download.oracle.com/javase/1.5.0/docs/guide/net/properties.html
redirect kerbero authent conflict use httpclient connect websit use kerberos-authent bewar trigger word kerbero think *not* problem pleas read sequenc event client get server unauthor client get includ authent server 302 /someth host show principl authent work client get /someth includ authent server unauthor client quit 401-unauthor would expect one follow instead 1 client immedi send author inform redirect get /someth 2 client re-request /someth author 401-unauthor could get around problem set connectionreusestrategi constant fals would great someon could tell httpclient work expect whether bug misconfigur lurk thank harald
new laxredirectstrategi class probabl call super method first laxredirectstrategi extend defaulredirect class call super method one would expect ad patch make sure get call
support http url inlin authent tri execut method httpclient use valid url conform schema http //usernam password host port/ authent fail get 401 error
port proxycli 3.1 4.x api 3.1 version httpclient possibl establish tunnel connect generic non http server authent proxi sinc 3.1 version support ntlmv2 kerbero authent support 4.x version use port featur provid proxycli 4.x api
basicresponsehandl javadoc need clarif class-level javadoc basicresponsehandl indic read respons bodi throw except respons status code 300 case
randomaccessfil mode w valid accord java doc randomaccessfil mode must r rw rws rwd anyth els result illegalargumentexcept seem sun/oracle/openjdk 's n't document support w mode equival rw android javadoc say throw illegalargumentexcept mode w pass httpclientcach ioutils.copyfil line 70-71 mean httpclient cach work android
basicclientconnectionmanager.releaseconnect access poolentri use non-standard lock accord annot poolentri guardedbi howev least one place access without hold lock basicclientconnectionmanager.releaseconnect synchron managedconn access poolentri without synchronis synch work parti use lock
valu via header creat httpclient-cach cach backend request via header get generat insert cach layer done repeat http convers even construct string constant protocol version involv propos patch construct map generat valu held memori associ protocolvers key use read/writ lock access data solut minim time generat valu sever millisecond 40-50 microsecond
ntlm authent longer work latest releas applic work fine use ntlm auth httpclient 3 year recent 4.0.3 upon upgrad 4.1.2 ntlm stop work tri new 4.1 built-in ntlm old way use jcif client.getauthschem .regist ntlm new ntlmschemefactori use wireshark see ntlm auth even attempt use 4.1.2 roll back 4.0.3 immedi resolv problem
infinit loop basic authent class org.apache.http.impl.client.defaultrequestdirector bug wherebi authent fail log warnen receiv retri request end infinit loop retri requests.. occur sl4j pick implement proper configur 4.1.2 line number offend code handlerespons method line 1126 return null statement requir move outsid statement check log warn enabl
infinit loop ntlm authent got infinit loop ntlm authent authent fail bad credenti state fail ntlm sheme never catch method authent class httpauthent line 123 fix temporatili bug ad case protocol state handshak
cachinghttpcli leak connect stale-if-error use stale-if-error cache-control header cachinghttpcli decid use stale cach respons clean exist backend respons bug caus connect leak connect pool time stale-if-error flow execut
cach client class common header use consist code httpcachingcli class call headerconst contain cach interest header use code base class string constant use consist code base attach patch clean
httpclient-cach open cach file act like miss set httpclient-cach like final string cachedir cachedir httpclient cachinghttpcli final cacheconfig cacheconfig new cacheconfig cacheconfig.setsharedcach fals cacheconfig.setmaxobjectsizebyt 262144 //256kb new file cachedir httpclient-cach .exist new file cachedir httpclient-cach .mkdir throw new runtimeexcept fail creat httpclient cach directori new file cachedir httpclient-cach .getabsolutepath final resourcefactori resourcefactori new fileresourcefactori new file cachedir httpclient-cach final httpcachestorag httpcachestorag new managedhttpcachestorag cacheconfig cachinghttpcli new cachinghttpcli client resourcefactori httpcachestorag cacheconfig make request final httpget get new httpget url final httprespons respons cachinghttpclient.execut get final statuslin statuslin response.getstatuslin statusline.getstatuscod 300 statusline.getstatuscod 404 throw new noresultexcept throw new httpresponseexcept statusline.getstatuscod statusline.getreasonphras response.getent .getcont everyth work expect delet cach directori cachedir/httpclient-cach exampl make request actual caus java.lang.illegalstateexcept content consum org.apache.http.entity.basichttpentity.getcont basichttpentity.java:84 org.apache.http.conn.basicmanagedentity.getcont basicmanagedentity.java:100 expect httpclient n't throw except perform request act like cach miss
org.apache.http.impl.client.cache.memcached.memcachedhttpcachestorag verifi class return object cast org.apache.http.impl.client.cache.memcached.memcachedhttpcachestorag origin getentri function byte data byte client.get url object obj= client.get url null obj || objinstanceof byte return null byte data byte obj origin updateentri function byte oldbyt v null byte v.getvalu null byte oldbyt v null v.getvalu instanceof byte byte v.getvalu null
org.apache.http.impl.client.cache.memcached.memcachedhttpcachestorag use url cach key n't spi memcach 250 defin max key length http //dustin.github.com/java-memcached-client/apidocs/constant-values.html net.spy.memcached.memcachedclientif.max_key_length url often much longer 250 charact url hash use key
org.apache.http.impl.client.cache.memcached.memcachedhttpcachestorag allow client specifi custom prefix string key org.apache.http.impl.client.cache.memcached.memcachedhttpcachestorag allow client specifi custom prefix string key ensur collision-avoid memcach key client may use
cachinghttpcli similar behavior abstracthttpcli execut responsehandl call execut abstracthttpcli responsehandl abstracthttpcli attempt consum entiti close open connect return behavior current cachinghttpcli lead connect leak switch cachinghttpcli becuas respons fulli consum entiti responsehandl instead httpclient code exist auto-clos behavior org.apache.http.impl.client.abstracthttpclient.java line 1080-1111
kerbero authent scheme httpclient 4.1.2 spnego authent use negoti keyword ms ii must connect send back www-authent negoti instead send www-authent kerbero use negotiatescheme.java negotiateschemefactory.java base creat new scheme call kerberosscheme.java kerberosschemefactory.java make work essenti replac everi negoti scheme kerbero kerberosscheme.java remov part code tri first spnego_oid use kerberos_oid direct instead work fine took figur think could come new version ll attach version packag made test project 's trivial put right place/packag
memcachedhttpcachestorag throw ioexcept instead runtim except memcachedhttpcachestorag class implement httpcachestorag defin method throw ioexcept under net.spy.memcached.memcachedclientif throw runtim except except caught code ioexcept expect caus except bubbl call code seem like memcachedhttpcachestorag class treat least runtim except ioexcept normal code execut path follow 'm propos memcachedhttpcachestorag treat operationtimeoutexcept memcach client ioexcept would allow exist cachinghttpcli code catch log except warn instead bubbl except call code
chang error messag except uriutil rewriteuri messag uriutil rewriteuri misspel uri may null uri null
httpclientutil helper method releas resourc httpclient httprespons use found write boiler plate code various httpclient relat project releas resourc want provid simpler way releas resourc similar ioutils.closequiet oppos maintain code new class o.a.http.client.utils.httpclientutil ad pre public static void closequiet final httprespons respons public static void closequiet final httpclient httpclient /pre 2 method help releas resourc
layeredschemesocketfactory.createlayeredsocket access httpparam use custom implement layeredschemesocketfactori manag keystor locat httpparam allow us use differ keystor per connect basi proxi use layeredschemesocketfactory.createlayeredsocket invok paramet pass httpparam along consequ certif authent fail implement reason factori method super class httpparam paramet except layeredschemesocketfactory.createlayeredsocket downstream bug 369805 certif authent custom keystor fail behind proxi https //bugs.eclipse.org/bugs/show_bug.cgi id=369805 input would great appreci
header ad org.apache.http.client.protocol.requestacceptencod condit org.apache.http.client.protocol.requestacceptencod add header case chanc condit like requestclientconncontrol code would someth like request.containshead accept-encod request.addhead accept-encod gzip deflat app header may ad request intercept would great fact check
compress entiti cach proper org.apache.http.impl.client.cache.cachevaliditypolicy.contentlengthheadermatchesactuallength return fals entiti decompress contentencodinghttpcli length decompress entiti store cach differ length specifi respons header consequ gzipped/defl entiti never satisfi cach propos fix introduc new field httpcacheentri actualcontentlength popul actual content length rigth cach entri store cach chang org.apache.http.impl.client.cache.cachevaliditypolicy.contentlengthheadermatchesactuallength method compar entry.getresourc .length entry.getactualcontentlength
uriutils.extracthost throw numberformatexcept line 310 origin jboss-seam-wicket-book applic jboss-4.2.3.ga start post login request thank httpclient numberformatexcept regard page http //hc.apache.org/httpcomponents-client-dev/httpclient/clover/org/apache/http/client/utils/uriutils.html 305 extract port suffix present 306 host null 307 int colon host.indexof 308 colon 0 309 colon+1 host.length 310 port integer.parseint host.substr colon+1 311 312 host host.substr 0 colon 313 314 resolv port throw numberformatexcept java.lang.numberformatexcept input string 8080 jsessionid=9e9eda0b6e1cdd499a0a15c4a8f212d8 java.lang.numberformatexception.forinputstr numberformatexception.java:48 java.lang.integer.parseint integer.java:458 java.lang.integer.parseint integer.java:499 org.apache.http.client.utils.uriutils.extracthost uriutils.java:310 org.apache.http.impl.client.abstracthttpclient.determinetarget abstracthttpclient.java:764 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:754 org.tagbrowser.api.tagbrowser.request tagbrowser.java:109 anoth case problem canb found hier https //gitorious.org/yacy/rc1/commit/8b0920b0b5eb67ae17eec24c1bf3a059543cb6e8/diff
httpclient n't send authent header thread environ use httpclient multipl thread basic authent seem creat race condit request header sometim n't contain author entri result 401 although usernam password credenti correct set
localtestserv support class avail separ jar localtestserv 's support class use anyon want easili mock /test simpl http call without emb full jetti someth would awesom avail separ http-localtestserver.jar could use project outsid httpclient
httpclient treat uri fragment redirect uri incosist httpclient treat uri fragment redirect uri incosist strip fragment relat uri leav absolut one unchang
upgrad commons-codec 1.4 1.6 commons-codec 1.4 buggi see exampl https //issues.apache.org/jira/browse/codec-99
nullpointerexcept use httphead request/respons interceptor tri execut httphead object instead httpget object use add request/respons interceptor get nullpointerexcept replic except use clientgzipcontentcompress exampl found httpclient exampl instead use httpget object execut httphead object comment interceptor part n't get except error stack trace get execut code netbean except thread main java.lang.nullpointerexcept testhttphead.clientgzipcontentcompress 2.process clientgzipcontentcompression.java:74 org.apache.http.protocol.immutablehttpprocessor.process immutablehttpprocessor.java:116 org.apache.http.protocol.httprequestexecutor.postprocess httprequestexecutor.java:342 org.apache.http.impl.client.defaultrequestdirector.execut defaultrequestdirector.java:472 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:820 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:754 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:732 testhttphead.clientgzipcontentcompression.main clientgzipcontentcompression.java:92 java result 1 code give error packag testhttphead import java.io.ioexcept import java.io.inputstream import java.util.zip.gzipinputstream import org.apache.http import org.apache.http.client.methods.httphead import org.apache.http.entity.httpentitywrapp import org.apache.http.impl.client.defaulthttpcli import org.apache.http.protocol.httpcontext import org.apache.http.util.entityutil demonstr use protocol interceptor transpar modifi properti http messag sent receiv http client p/ particular case http client made capabl transpar content gzip compress ad two protocol interceptor request interceptor add accept-encod gzip header outgo request respons interceptor automat expand compress respons entiti wrap uncompress decor class use protocol interceptor make content compress complet transpar consum link org.apache.http.client.httpcli httpclient interfac public class clientgzipcontentcompress public final static void main string arg throw except defaulthttpcli httpclient new defaulthttpcli tri httpclient.addrequestinterceptor new httprequestinterceptor public void process final httprequest request final httpcontext context throw httpexcept ioexcept request.containshead accept-encod request.addhead accept-encod gzip httpclient.addresponseinterceptor new httpresponseinterceptor public void process final httprespons respons final httpcontext context throw httpexcept ioexcept httpentiti entiti response.getent header cehead entity.getcontentencod cehead null headerel codec ceheader.getel int 0 codecs.length i++ codec .getnam .equalsignorecas gzip response.setent new gzipdecompressingent response.getent return httphead httphead new httphead http //www.howest.b execut http request system.out.println execut request httphead.geturi httprespons respons httpclient.execut httphead system.out.println system.out.println response.getstatuslin system.out.println response.getlasthead content-encod system.out.println response.getlasthead content-length system.out.println httpentiti entiti response.getent entiti null string content entityutils.tostr entiti system.out.println content system.out.println system.out.println uncompress size content.length final httpclient instanc longer need shut connect manag ensur immedi dealloc system resourc httpclient.getconnectionmanag .shutdown static class gzipdecompressingent extend httpentitywrapp public gzipdecompressingent final httpentiti entiti super entiti overrid public inputstream getcont throw ioexcept illegalstateexcept wrap entiti 's getcont decid repeat inputstream wrappedin wrappedentity.getcont return new gzipinputstream wrappedin overrid public long getcontentlength length ungzip content known return -1 kind regard peter
add constructor org.apache.http.conn.ssl.sslsocketfactori allow direct wrap javax.net.ssl.sslsocketfactori socketfactori applic use java webstart deploy amoung thing webstart give us abil access system 's case window certif system instanc one client use certif base authent webserv done hardwar devic attach system window 's alreadi way interfac devic webstart way interfac window api n't think get use socketfactori creat would check oracl sure think need use one set default httpsurlconnect suggest anoth constructor ad allow wrap one plan put depend httpsurlconnect rather add abil wrap javax.net.ssl.sslsocketfactori big chang api get patch readi soon