671
http authent invalid credenti caus infinit loop httpmethodbas 460 break statement execut log.isinfoen break statement need move outsid statement break realm alreadi contain foo patch submit mail list per apach site guidelin
chunk transfer encod isol applic chunk transfer encod support transpar httpmethodbas object caus chunk data embed respons bodi data forc applic handl http/1.1 implement chunk transfer encod includ patch proper pars chunk data per rfc 2068 provid bodi content consist regardless whether chunk transfer encod use server reliev applic requir implement rfc 2068 patch sent mail list per guidelin address defici
cookie.pars except pars expiri date singl quot netscape-enterprise/3.6 sp3 server send cooki paramet expires='thu 05-dec- 2002 12:07:45 gmt cookie.pars throw except none four built-in format match test pars code work ok singl quot omit valu pars resolut valu expir paramet start end singl quot strip first last charact pars
logsource.setlevel incorrect use entryset call logsource.setlevel get follow except java.lang.classcastexcept java.util.hashmap entri org.apache.commons.httpclient.log.logsource.setlevel logsource.java:158 call code logsource.setlevel log.off error believ get valu set map entri set logsourc static public void setlevel int level iter _logs.entryset .iter _logs.valu it.hasnext log log log it.next log.setlevel level
null path break compar method compar method handl path null
tests-loc fail 3 test 1 testmultisendcookieget org.apache.commons.httpclient.testwebappcooki junit.framework.assertionfailederror html head titl readcookieservlet get /titl /head bodi p respons http get request. /p p tt cooki version=1 simplecookie=valu path=/httpclienttest/cooki domain=localhost /tt /p tt version=1 /tt br tt simplecookie=valu /tt br tt path=/httpclienttest/cooki /tt br tt domain=localhost /tt br /bodi /html org.apache.commons.httpclient.testwebappcookie.testmultisendcookieget testwebappcookie.java:348 sun.reflect.nativemethodaccessorimpl.invoke0 nativ method sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:39 sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:25 2 testdeletecookieget org.apache.commons.httpclient.testwebappcooki junit.framework.assertionfailederror html head titl readcookieservlet get /titl /head bodi p respons http get request. /p p tt cooki version=1 simplecookie=valu path=/httpclienttest/cooki domain=localhost /tt /p tt version=1 /tt br tt simplecookie=valu /tt br tt path=/httpclienttest/cooki /tt br tt domain=localhost /tt br /bodi /html org.apache.commons.httpclient.testwebappcookie.testdeletecookieget testwebappcookie.java:389 sun.reflect.nativemethodaccessorimpl.invoke0 nativ method sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:39 sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:25 3 testdeletecookieput org.apache.commons.httpclient.testwebappcooki junit.framework.assertionfailederror html head titl readcookieservlet put /titl /head bodi p respons http put request. /p p tt cooki version=1 simplecookie=valu path=/httpclienttest/cooki domain=localhost /tt /p tt version=1 /tt br tt simplecookie=valu /tt br tt path=/httpclienttest/cooki /tt br tt domain=localhost /tt br /bodi /html org.apache.commons.httpclient.testwebappcookie.testdeletecookieput testwebappcookie.java:464 sun.reflect.nativemethodaccessorimpl.invoke0 nativ method sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:39 sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:25 failur test run 108 failur 3 error 0 httpclient/build.xml 271 java return -1 build fail total time 9 second
null domain break cookie.java domain assum non-nul place cookie.java see match method exampl
doubl encod url httpmethodbase.generaterequestlin httpconnect connect string name string reqpath string qstring string protocol path alway encod use uriutil.encod reqpath uriutil.pathsaf howev path alreadi contain encod space i.e 20 encod get 2520 behavior correct n't encod sign
empti path handl correct request url empti path e.g http //abcnews.go.com code send follow line get http/1.1 get http/1.1 instead
redirect handl correct locat header n't protocol http redirect handl correct locat header n't protocol e.g locat web/tbghome.nsf/pages/index java.net.malformedurlexcept throw case correct behavior inherit protocol current url relev code httpmethodbase.execut
need way set time use httpclient httpmulticli use class httpclient httpmulticli way set time valu settimeout method httpconnect httpclient httpmulticli n't expos httpconnect object one option add method settimeout httpclient httpmulticli anoth option add method httpmethod
ca n't use proxi server https n't seem way configur httpclient use https proxi server time 's clear oversight deliber decis support combin reason assum oversight fix seem requir one variat startsess httpclient.java would follow public void startsess string host int port string proxyhost int proxyport boolean https connect new httpconnect proxyhost proxyport host port https
respons fold header throw httpexcept 4/4/02 cvs repositori httpmethodbas class n't handl fold header readresponsehead method http/1.1 http/1.0 descript fold header see section 2.2 basic rule http //www.ietf.org/rfc/rfc2616.txt http //www- old.ics.uci.edu/pub/ietf/http/rfc1945.html basic-rul ve prepar patch email jakarta-common jakarta.apache.org
n't automat set content-length request header current httpclient automat add content-length 0 request header caus problem web server particular ar.atwola.com tri follow url http //ar.atwola.com/file/adswrapper.j block indefinit problem fix send content-length header browser 's behavior 'm sure casu problem let 's conform standard browser 's practic avoid troubl
except n't thrown unsupport authent method current authent throw unsupportedoperationexcept unsupport authent method like ntlm correct howev httpmethodbase.execut catch httpexcept unsupportedoperationexcept leak user undesir user may want chanc handl authent themself correct way pass http status code user like treat redirect differ host simpl fix catch except httpmethodbase.execut call authenticator.authent
httpclient incorrect credenti loop infinit incorrect credenti assign request httpclient loop forev tri fail httpexcept request credenti set fail org.apache.commons.httpclient.httpmethodbase.execut check need track credenti sent
need way set request bodi postmethod current way user set request bodi postmethod direct way ad paramet postmethod make sens case howev situat user actual know request bodi want set direct ad follow method fix public void setrequestbodi string requestbodi this.requestbodi requestbodi
n't throw except bad cooki current httpclient throw except bad cooki expect user expect httpclient ignor cooki get except except throw user way know continu
allow receiv secur cooki non-secur chanel current httpclient throw except secur cooki receiv non-secur chanel although rfc n't specifi explicit client allow receiv secur cooki non-secur channel default set browser seem allow tri follow link ie http //www.snapfish.com default cooki polici httpclient
user need way control cooki polici user need way control cooki accept reject would nice provid cooki filter interfac user chang cooki polici implement filter
querystr still set url*method constructor querystr still set various url*method 's constructor get set seturl simplest fix call seturl constructor
optim send request network sniffer notic httpclient send request line header separ packag httpclient includ ie netscap java 's urlconnect send one packag easili fix use buffer httpmethodbas
httpclient better proxi support httpmulticli proxi requir authent send status 407 proxi authent requir respons header proxy-authent see rfc2616 e.g squid configur httpclient n't yet process respons behavior similar process status 401 unauthor
header connect close close connect connectionhead equal close conect imediateley close without wait responc back server client pull data cgi script sent content length server send connect close header exampl http/1.1 200 ok date fri 21 jun 2002 17:08:46 gmt server apache/1.3.14 unix connect close content-typ text/html html head titl thegumtree.com london 's onlin communiti aussi kiwi south african /titl meta http-equiv= content-typ content= text/html c harset=iso-8859-1 /head yet work arround apart comment follow code header connectionhead getresponsehead connect etc httpmethodbas
author credenti sent pre-empt web browser receiv 401 unauthor /i respons code browser prompt user password credenti request authent realm author header sent request httpclient model behaviour quit well web browser authent credenti given host port realm send author header subsequ request pre-empt whithout need 401 respons httpclient alway reqir 401 respons send author header code httpclient.startsess /code take code credenti /code object paramet default credenti default credenti sent part everi request session mechanisim over-rid default credenti also provid sent pre-empt point enhanc request minim number unnecessisari 401 respons appear simpl solut might modifi logic code authenticator.authent /code get call code httpmethodbase.addauthorizationrequesthead /code
new method add array paramet postmethod post form web page may mani paramet post webserv current postmethod want add multipl paramet would call addparamet name valu one new convin method ad allow simpler client code take array namevaluepair object ad paramet singl function call void addparamet namevaluepair paramet also comment postmethod function deal paramet state overrid method httpmethodbas incorrect inform comment ad public api
open org.apache.commons.httpclient.base64 pleas sever problem late need truck backward forward byte base64 use httpclient know code proect need duplic heirarchi get access right pleas make appropri chang base64 simpl mark encod decod method public allow outsid use base64 would nice extend base64 deal multi-lin base64 content know outsid base64 origin intend use would use
replac postmethod paramet hashmap list propos chang paramet datastructur postmethod current hashmap arraylist vector namevaluepair object chang would lead simpler robust code postmethod determinist behaviour follow reason 1 hashmap loos insert order client want encod paramet show particular order unabl 2 hash map requr uniqu key reason multipl paramet name post current implement replac string valu list addparamet repeat name key everi get hashmap instanceof see valu string list 3 hash map faster vector typic oper o 1 insert o n remov oper genpropos chang paramet datastructur postmethod current hashmap arraylist vector namevaluepair object chang would lead simpler robust code postmethod determinist behaviour follow reason 1 hashmap loos insert order client want encod paramet show particular order unabl 2 hash map requr uniqu key reason multipl paramet name post current implement replac string valu list addparamet repeat name key everi get hashmap instanceof see valu string list 3 hash map faster vector typic oper o 1 insert o n remov oper generat bodi hashmap faster search requir getparamet string setparamet string string removeparamet string rare call would also move depric setparamet string string confus api setparamet overwrit exist paramet name addparamet accumul list paramet setparamet function also effect call removeparamet addparamet alreadi erat bodi hashmap faster search requir getparamet string setparamet string string removeparamet string rare call would also move depric setparamet string string confus api setparamet overwrit exist paramet name addparamet accumul list paramet setparamet function also effect call removeparamet addparamet alreadi
non-standard configur track simpl strict setleni like inadequ particular non-standard behaviour tag settabl client mask particular behaviour featur could provid strict mean none lenient mean
http version configur track http version track current oversimplifi singl http11 boolean extend handl http version simpli effici possibl suggest get rid sethttp11 ishttp11 void sethttpvers string version string gethttpvers boolean ishttpvers string version
plug-in authent modul current basic authent support authent interfac provid allow plug-in support authenticaiton scheme may applic specif therefor place httpclient would requir user
user defin default header support provid abil set default header sent everi request use whenev object creat recycl need user configur
user interact authent action requir user input like forward anoth host retriev authent credenti way client setup listen event handl fli gui programat
user configur cooki polici user configur cooki handl emul cooki option web browser
redefin httpclient vs httpmulticli interfac 2.0 particular httpclient/httpmulticli issu must resolv httpulticli function prefer httpclient suitabl name consid impact project java1.1 compat realli issu anymor
handl return null consist consid return empti array instead null consist eg getresponsebodi may good reason null empti array depend circumstannc
handl null argument consist consid throw nullpointerexcept invalidargumentexcept null argument allow consist document behaviour
move commons-log commons-log deriv httpclient.log still use old log remov complaint mail list set commons-log simpl well document
defin implement log polici use info vs debug vs warn log except enter exit messag per method basi alway log debug swallow except
handl virtual host relat url multi-hom need abl open socket one ipaddress hostnam includ virtual hostnam host header use inetaddress class perhap
configur user-ag string user configur item set user agent without have set per httpmethod basi
develop document provid exampl code cvs give clear link websit walkthrough api documennt suitabl new user
respons handler perhap plugin handler use handl various rang http respons could use respond auto-forward resubmit could solv difficulti handl 303 respons
rfc 2965 support port sensit cooki rfc 2109 n't consid port number match filter cooki rfc 2965 modifi cooki class option support rfc 2965 maintain support rfc 2109-style portless cooki
build environ configur maven build process eas build httpclient buildabl without user need go away download extra jar maven good job autom site build night basi pick chang move j2sdk1.4
user/develop document quot user 's use better project doc includ checkstyl clover report changelog exampl show configur log may want link httpclient sister project slide cactus latka show 's use
provid exampl code better project sampl show use httpclient varieti way alreadi src/exampl directori excel right place build full compil know api chang may effect exampl code requir keep current make sure use 2.0 api depric method
add support digest authent authent class 's code initi whip geza apach axi adapt httpclient add support digest authent authent class test code tomcat 4.0.4 sampl code call apach axi web servic one caveat accord geza code right support qop-int
support ntlm authent late write would support ntlm authenticatin well basic digest obvious non-trivi would big featur adrian sutton softwar engin ephox corpor www.ephox.com http //www.ephox.com
way get requestbodi postmethod use extend class attempt extend postmethod class discov access requestbodi member declar privat get method tri overrid setrequestcontentlength discov problem enhanc request specif 1. add get method abl get requestbodi probabl get method paramet well 2 option make requestbodi paramet member protect instead privat extend class easier case wonder reason extend class add abil set timeout valu httpconnect also abil set charact encod request bodi n't know worthi enhanc request requir 'm nice work way thank
j2ee form authent also affect pluggabl authent add support j2ee style form authent type unlik basic digest type handl http header need adjust way authent sent far tell test one two j2ee server way success login requir request protect page respond login form submiss form two request must associ one anoth use jsessionid cooki seem bug must solv cooper recent discuss pluggabl authent modul suggest follow signatur pluggableauthenticator.authent httpmethod method httpstate state mirror exist authent method also requir chang state object allow access connect properti dont know affect multicli altern could go pluggableauthenticator.authent httpmethod method httpclient client either case authent need way know plugin call suggest modif httpmethodbas detect j_security_check form action respons automat submit credenti provid use new class j2eeformauthent implement pluggableauthent
implement connect timeout write test code use setsotimeout int milli method set timeout valu connect url appear matter set timeout httpconnect tri connect use timeout valu 'm guess os 's default valu look code httpconnect use socket host port constructor tri connect write away 'd like suggest follow code timeout set first connect even made compil code timeout within sec uncom first two line tri statement comment socket connect statement run code notic write away timeout someth els connect right away constructor like timeout worthless point matter fact code never get assum 192.168.168.50 network import java.io import java.net public class sockettest public static void main string arg long start system.currenttimemilli tri //socket socket new socket 192.168.168.50 ,80 //socket.setsotimeout 1000 //set timeout connect made socket socket new socket inetsocketaddress saddress new inetsocketaddress 192.168.168.50 ,80 socket.connect saddress,1000 catch unknownhostexcept e system.out.println e catch socketexcept e system.out.println e catch ioexcept e system.out.println e system.out.println system.currenttimemilli start
preemtiv auth fail whithout credenti preemtiv author caus httpexcept thrown teh authent credenti provid case handl quiet test case ad
postmethod chunk request support moment apach axi 'd like send post request without need calcul content-length http 1.1 base server cours server-sid support 1.1 fallback mechan could calcul total size cover also see relat request trevor o'reilli wtrevor yahoo.com http //marc.theaimsgroup.com/ l=jakarta-commons-us m=102719653201792 w=2
need getresponsecontentlength httpmethod need way find respons content length httpmethod
httpurlconnect wrapper initi comment vincent massol featur move jakarta cactus use jdk httpurlconnect common httpclient howev public interfac return httpurlconnect break contract cactus user propos write httpurlconnect wrapper httpmethod actual alreadi written current test cactus make proper donat sure work i.e cactus test pass attach preview interest think includ httpclient distribut thank -vincent
handl multivalu header correct time web server send back multipl header key e.g www-authent negoti www-authent ntlm www-authent basic realm= kmdc5 handl correct add method public java.util.iter getresponsehead java.lang.str name javax.servlet.http.httpservletrequest
host request header contain port host request header alway ad hostnam use connect port differ 80 need includ well colon separ hostnam problem especi appar use httpclient connect tomcat 4 use httputil creat full url repres request httputil pull host port host header commons-httpcli use httputil never includ port sinc never host header
need add default constructor cooki cooki class n't default argument constructor caus problem framework support marshal unmarshal data type e.g soap implement may need transfer soap server soap client would nice add default constructor wo n't break anyth follow javabean convent potenti save user troubl futur
cooki valu string pars correct case version extract set-cooki statement follow http respons header incorrect http respons sent execut get method http //my.taishinbank.com.tw/netbank/nbslogin.asp subfunid=http //my.taishinbank.com.tw/netbank/accountquery/qaccbyid.asp httpclient extract set-cooki respons generat wrong cooki statement info wire cooki version=0 _mysite=520163500 1027657033=null 1027787539=null 0=null path=/ cata=11 path=/ aspsessionidgggqqxeu=adlcdagajlkebjekbommamob path=/ shall _mysite=520163500,1027657033,1027787539,1027787539,0 _mysite=520163500 1027657033=null 1027787539=null 0=null thank
proxi authent handl multipl multipl authent scheme proxi server return follow header line respons proxy-authent ntlm proxy-authent basic realm= 10.105.20.201 i.e. return two proxy-authent header line unfortun work line 253 class authent method authent httpmethod httpstate header string see comment fixm note wo n't work one realm within challeng look like someth n't yet implement log see authent attempt pars realm look like done correct 411 debug attempt authent challeng proxy-authent ntlm basic realm= 10.105.20.201 411 debug pars realm ealm= 10.105.20.201 challeng ntlm basic realm= 10.105.20.201 421 warn except thrown authent java.lang.unsupportedoperationexcept authent type ntlm recogn org.apache.commons.httpclient.authenticator.authent authenticator.java:274 org.apache.commons.httpclient.authenticator.authenticateproxi authenticator.java:178 org.apache.commons.httpclient.httpmethodbase.processauthenticationrespons httpmethodbase.java:580 org.apache.commons.httpclient.httpmethodbase.execut httpmethodbase.java:668 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:355 com.cmg.httptest.main.main main.java:34 look wrong realm name seem pars ealm= 10.105.20.201 understand authent know ntlm would like use basic authent case authent method possibl specifi one want use jesper de jong
error read data hi problem httpclient head work fine build 20020720 httpclient though seem httpclient read correct return http respons 'm attach log output cactus build java junit testcas testlongprocess took 3.645 sec java junit caus error java junit fail get test result probabl due error happen ed server side tri execut test return server html head long process /head bodi data /bodi /html java junit java junit org.apache.cactus.util.chainedruntimeexcept fail get test resul ts probabl due error happen server side tri execut tes ts return server html head long process /head bodi data /bod y /html java junit java junit org.apache.cactus.client.abstracthttpclient.dotest unknown sourc java junit org.apache.cactus.abstractwebtestcase.runwebtest unknown sourc java junit org.apache.cactus.abstractwebtestcase.rungenerictest unknown sour ce java junit org.apache.cactus.servlettestcase.runtest unknown sourc java junit org.apache.cactus.abstracttestcase.runbar unknown sourc java junit org.apache.cactus.client.parsingexcept valid respons first 100 c haract repons /webresult http/1.1 200 ok java junit server resin/2.1.2 java junit content-length 23 java junit date tue 13 aug 2002 08:45:2 java junit org.apache.cactus.client.webtestresultparser.readexceptionclassna unknown sourc java junit org.apache.cactus.client.webtestresultparser.pars unknown sourc thank -vincent
put method block older server reproduc attempt put request appropri servlet tc3.2 yes know need upgrad sigh rfc 2616 say presenc older implement protocol allow ambigu situat client may send expect 100- continu without receiv either 417 expect fail status 100 continu status therefor client send header field origin server possibl via proxi never seen 100 continu status client wait indefinit period send request bodi n't httpclient behav send header putmethod.writerequestbodi return fals httpmethodbas call readstatuscod block wait read guess could time whole request right make imposs use httpclient put older http 1.1 implement suggest resolut sinc spec allow client avoid wait know 100 respons arriv simpli provid boolean flag allow wait 100 behaviour putmethod.writeresponsebodi turn per-request basi solut put burden know origin server never seen 100 continu status user httpclient less perfect find happen trial error correct solut maintain list server ignor expect header putmethod overrid putmethod.readstatuscod time send bodi rememb server buggi read status code
request retri 3 time unconditionali use 20020811 tarbal jdk1.4.0 get post retri soon finish send request turn log verifi soon last \r\n hit wire start next retri exampl 08-10 09:53:12 main httpclient.wir \r\n 08-10 09:53:12 main httpclient.methods.postmethod enter postmethod.writerequestbodi httpstate httpconnect 08-10 09:53:12 main commons.httpclient.httpconnect enter httpconnection.writ byte int int 08-10 09:53:12 main commons.httpclient.httpmethod attempt number 3 write request 08-10 09:53:12 main commons.httpclient.httpmethod enter httpmethodbase.writerequest httpstate httpconnect 08-10 09:53:12 main commons.httpclient.httpmethod enter httpmethodbase.writerequestlin httpstate httpconnect 08-10 09:53:12 main commons.httpclient.httpmethod enter httpmethodbase.generaterequestlin httpconnect string string string string 08-10 09:53:12 main commons.httpclient.httpconnect enter httpconnection.print string 08-10 09:53:12 main commons.httpclient.httpconnect enter httpconnection.writ byte 08-10 09:53:12 main httpclient.wir post /lookup.jsp http/1.1 \r\n top line end second post last line start third post make sure server realli n't send someth back wrote quick server would listen request send 404 soon read post get line would keep read dump info httpclient log still shoot 3 request receiv respons server got three request client server run machin httpclient send three request without wait respons
add possibl disabl automat authent header process applic 'm work need possibl manual get www-authent header instead let httpclient process automat instead rewrit execut method subclass ad configur set similar followredirect flag diff anyon interest
unabl get status line http method object status line typic first line return http connect read hidden insid httpclient way client code retriev intact readstatuslin httpmethodbas status line read never store avail outsid method could store status line string add getstatuslin method httpmethod interfac httpmethodbas class altern could creat header name statuslin perhap null could retriev gethead statuslin would preserv interfac would bit kludg
chunkedinputstream incorrect handl chunksiz without semicolon chunkedinputstream correct read chunk size semicolon appear first line chunk whitespac exist chunk size valu end line semicolon present whitespac remov parseint call result ioexcept bad chunk size tell rfc2616 whitespac legal receiv least one web server relev section 3.6.1 small patch repair problem attach immedi
incorrect debug messag httpmethodbas httpmethodbase.addcontentlengthrequesthead wrong debug messag see attach patch
chunkedinputstream broken 2 bug fix 1 suggest bug 1 read byte b int int len method chunkedinputstream number byte read under inputstream calcul wrong code done len math.min len chunksiz could caus server also apach inde serv number byte let 's say chunksiz may alreadi number byte first read result input posit end chunk rest reader fail find crlf valid chunksiz propos fix work test len math.min len chunksize-po bug 2 calcul chunksiz method getchunksizefrominputstream convers int done call result integer.parseint datastr 16 robust caus occasion crash fix simpl fact implement done chunksiz comment see line code result integer.parseint datastring.trim 16 test work suggest routin input state machin perhap pedantic..chang loop state 2 int b in.read b -1 throw new ioexcept chunk stream end unexpect switch state case 0 b \r state 1 els baos.writ b break case 1 b \n state 2 els crlf write \r char baos.writ \r baos.writ b state 0 break default throw new runtimeexcept assert fail read byte b int int len method chunkedinputstream number byte read under inputstream calcul wrong code done len math.min len chunksiz could caus server also apach inde serv number byte let 's say chunksiz may alreadi number byte first read result input posit end chunk rest reader fail find crlf valid chunksiz propos fix work test len math.min len chunksize-po bug 1 read byte b int int len method chunkedinputstream number byte read under inputstream calcul wrong code done len math.min len chunksiz could caus server also apach inde serv number byte let 's say chunksiz may alreadi number byte first read result input posit end chunk rest reader fail find crlf valid chunksiz propos fix work test len math.min len chunksize-po bug 2 calcul chunksiz method getchunksizefrominputstream convers int done call result integer.parseint datastr 16 robust caus occasion crash fix simpl fact implement done chunksiz comment see line code result integer.parseint datastring.trim 16 test work suggest routin input state machin perhap pedantic..chang loop state 2 int b in.read b -1 throw new ioexcept chunk stream end unexpect switch state case 0 b \r state 1 els baos.writ b break case 1 b \n state 2 els crlf write \r char baos.writ \r baos.writ b state 0 break default throw new runtimeexcept assert fail calcul chunksiz method getchunksizefrominputstream convers int done call result integer.parseint datastr 16 robust caus occasion crash fix simpl fact implement done chunksiz comment see line code result integer.parseint datastring.trim 16 test work suggest routin input state machin perhap pedantic..chang loop state 2 int b in.read b -1 throw new ioexcept chunk stream end unexpect switch state case 0 b \r state 1 els baos.writ b break case 1 b \n state 2 els crlf write \r char baos.writ \r baos.writ b state 0 break default throw new runtimeexcept assert fail
path encod httpmethodbas suggest chang protocol add new method one protect static string generaterequestlin httpconnect connect string name string reqpath string qstring string protocol choos use uriutil.encod reqpath uriutil.pathsaf reason encod process server recogn actual handl project method propfind get mail hotmail find restrict hotmail server quit high address encod work
httpmethodbas port mismatch url redirect absolut locat cvs version latka fail test ant test maven use cvs version httpclient messag java warn main org.apache.commons.httpclient.httpmethod redirect port 80 -1 support 21 sep 2002 00:54:32,098 request preced java debug main httpclient.wir get /common http/1.1 java \r\n 21 sep 2002 00:54:31,262 java debug main org.apache.commons.httpclient.httpmethod enter java debug main httpclient.wir host jakarta.apache.org java \r\n 21 sep 2002 00:54:31,441 java debug main httpclient.wir user-ag jakarta commons-httpclient/2.0m1 java \r\n 21 sep 2002 00:54:31,442 respons java debug main org.apache.commons.httpclient.httpmethod enter httpmethodbase.readstatuslin httpstate httpconnect 21 sep 2002 00:54:31,444 java debug main org.apache.commons.httpclient.httpconnect enter httpconnection.readlin 21 sep 2002 00:54:31,444 java debug main httpclient.wir http/1.1 301 move perman \r\n 21 sep 2002 00:54:32,080 java debug main org.apache.commons.httpclient.httpmethod enter httpmethodbase.readresponsehead httpstate httpconnect 21 sep 2002 00:54:32,086 java debug main org.apache.commons.httpclient.httpconnect enter httpconnection.readlin 21 sep 2002 00:54:32,087 java debug main httpclient.wir date fri 20 sep 2002 23:54:30 gmt \r\n 21 sep 2002 00:54:32,088 java debug main org.apache.commons.httpclient.httpconnect enter httpconnection.readlin 21 sep 2002 00:54:32,089 java debug main httpclient.wir server apache/2.0.42 unix \r\n 21 sep 2002 00:54:32,090 java debug main org.apache.commons.httpclient.httpconnect enter httpconnection.readlin 21 sep 2002 00:54:32,090 java debug main httpclient.wir locat http //jakarta.apache.org/commons/ \r\n 21 sep 2002 00:54:32,091 java debug main org.apache.commons.httpclient.httpconnect enter httpconnection.readlin 21 sep 2002 00:54:32,091 java debug main httpclient.wir content-length 319 \r\n 21 sep 2002 00:54:32,091 java debug main org.apache.commons.httpclient.httpconnect enter httpconnection.readlin 21 sep 2002 00:54:32,092 java debug main httpclient.wir content-typ text/html charset=iso-8859-1 \r\n 21 sep 2002 00:54:32,092 java debug main org.apache.commons.httpclient.httpconnect enter httpconnection.readlin 21 sep 2002 00:54:32,092 java debug main org.apache.commons.httpclient.httpmethod enter httpmethodbase.processresponsehead httpstate httpconnect 21 sep 2002 00:54:32,093 java debug main org.apache.commons.httpclient.methods.getmethod enter getmethod.readresponsebodi httpstate httpconnect 21 sep 2002 00:54:32,093 java debug main org.apache.commons.httpclient.httpmethod enter httpmethodbase.readresponsebodi httpstate httpconnect 21 sep 2002 00:54:32,093 java debug main org.apache.commons.httpclient.httpmethod enter httpmethodbase.readresponsebodi httpstate httpconnect 21 sep 2002 00:54:32,094 java debug main org.apache.commons.httpclient.httpconnect enter httpconnection.getrequestoutputstream httpmethod 21 sep 2002 00:54:32,094 java debug main org.apache.commons.httpclient.httpmethod enter writeremainingrequestbodi httpstate httpconnect 21 sep 2002 00:54:32,096 java debug main org.apache.commons.httpclient.httpmethod redirect requir 21 sep 2002 00:54:32,097 java debug main org.apache.commons.httpclient.httpmethod redirect request locat http //jakarta.apache.org/commons/ 21 sep 2002 00:54:32,097 java warn main org.apache.commons.httpclient.httpmethod redirect port 80 -1 support 21 sep 2002 00:54:32,098 problem appear section code httpmethodbas url null //tri construct new url base current url tri url currenturl new url conn.getprotocol conn.gethost conn.getport getpath url new url currenturl locat inherit port catch except ex log.error redirect locat locationheader.getvalu malform return statuscod
cookie.java bookean typo
port 80 need run test 'm tri upgrad cactus 1.4.1 strutstest 1.9 test work fine month ago night build get follow error junit testcas testcreat took 0.2 sec junit caus error junit port rang -1 junit java.lang.illegalargumentexcept port rang -1 junit java.net.inetsocketaddress. init inetsocketaddress.java:103 junit java.net.socket. init socket.java:119 junit org.apache.commons.httpclient.httpconnection.open httpconnection.java:260 junit org.apache.commons.httpclient.httpclient.executemethod httpclient.java:255 junit org.apache.cactus.client.httpclientconnectionhelper.dispatch24_connect httpclientconnectionhelper.jav org/apache/cactus/util/log/logaspect.aj 1k :164 junit org.apache.cactus.client.httpclientconnectionhelper.around24_connect httpclientconnectionhelper.java org/apache/cactus/util/log/logaspect.aj 1k :1236 junit org.apache.cactus.client.httpclientconnectionhelper.connect httpclientconnectionhelper.java org/apach e/cactus/util/log/logaspect.aj 1k :106 junit org.apache.cactus.client.abstracthttpclient.callruntest abstracthttpclient.java org/apache/cactus/uti l/log/logaspect.aj 1k :186 junit org.apache.cactus.client.abstracthttpclient.dispatch2_dotest abstracthttpclient.java org/apache/cactu s/util/log/logaspect.aj 1k :109 junit org.apache.cactus.client.abstracthttpclient.around2_dotest abstracthttpclient.java org/apache/cactus/ util/log/logaspect.aj 1k :1236 junit org.apache.cactus.client.abstracthttpclient.dotest abstracthttpclient.java org/apache/cactus/util/log /logaspect.aj 1k :104 junit org.apache.cactus.abstractwebtestcase.rungenerictest abstractwebtestcase.java:260 junit org.apache.cactus.servlettestcase.runtest servlettestcase.java:133 junit org.apache.cactus.abstracttestcase.runbar abstracttestcase.java:195 found add port 80 :80 get work new stuff cactus.properti cactus.contexturl http //localhost/myapp cactus.contexturl http //localhost:80/myapp build.xml target name= tomcat.navigationact depends= deploy if= tomcat.hom suppos webapp name onpoint runservertest testurl= http //localhost/ webapp.nam starttarget= start.tomcat stoptarget= stop.tomcat testtarget= test.navigationact /target target name= tomcat.navigationact depends= deploy if= tomcat.hom suppos webapp name onpoint runservertest testurl= http //localhost:80/ webapp.nam /servletredirector cactus_service=run_test starttarget= start.tomcat stoptarget= stop.tomcat testtarget= test.navigationact /target
add multi-part post support add new method support multi-part post
httpclient incorrect handl transfer-encod header rfc2616 section 4.4 item 3 state content-length header field section 14.13 present decim valu octet repres entity-length transfer-length content-length header field must sent two length differ i.e. transfer-encod header field present messag receiv transfer-encod header field content-length header field latter must ignor handl correct case noncompli http server return transfer-encod header content-length header gave write testcas would requir reliabl noncompli http server
nullpointerexcept httpmethodbase.getresponsebodyasstr follow code cocoon compon caus npe delay seem help sometim int htcode httpclient.executemethod method todo fix-m sleep temporari workaround avoid nullpointerexcept next line thread.currentthread .sleep 100 string ret method.getresponsebodyasstr java.lang.nullpointerexcept java.lang.string. init string.java:399 org.apache.commons.httpclient.httpmethodbase.getresponsebodyasstr httpmethodbase.java:579 org.apache.cocoon.generation.webserviceproxygenerator.fetch webserviceproxygenerator.java:264
httpclient build requir jdk 1.4 jce classpath current ant dist perform httpclient look javax.crypt jce.jar build.xml build.properties.sampl need patch allow jce.jar file specifi like jsse.jar specifi attach two patch file made today cvs
request/respons race condit multipl request connect one tri multipl request socket connect race condit occur input/output stream eg request http/1.1 200 ok header bodi next request http/1.1 200 ok header data second request sent second respons n't yet receiv client start tri read ll get org.apache.commons.httpclient.httprecoverableexcept error pars status line respons unabl find line start http/ except think bodi part second respons follow code reproduc problem import java.io import java.net import java.util import org.apache.commons.httpcli import org.apache.commons.httpclient.method public class httpclientracebug public static void main string arg tri simplehttpserver.listen 8987 httpclient client new httpclient client.startsess localhost 8987 client.getst .setcredenti test realm new usernamepasswordcredenti foo bar int 0 100 i++ getmethod meth new getmethod client.executemethod meth catch except e e.printstacktrac privat static final class simplehttpserv implement runnabl privat socket socket public simplehttpserv socket socket this.socket socket public static void listen final int port thread server new thread public void run tri serversocket ss new serversocket port true new thread new simplehttpserv ss.accept .start catch except e e.printstacktrac server.setdaemon true server.start public void run tri bufferedread new bufferedread new inputstreamread this.socket.getinputstream int len 0 boolean auth fals string line line in.readlin null system.out.println line line.trim .equal in.read new char len dooutput auth auth fals len 0 els line.indexof -1 stringtoken tok new stringtoken line string key tok.nexttoken .tolowercas key.equ content-length len integer.parseint tok.nexttoken .trim els key.equ author auth true catch except e privat static int count 0 public void dooutput boolean author throw ioexcept writer new outputstreamwrit this.socket.getoutputstream count++ string id count 100 count 10 00 count 0 count count author write http/1.1 200 ok\r\n els write http/1.1 401 unauthorized\r\n write www-authent basic realm=\ test realm\ \r\n write response-id id \r\n write content-typ text/html charset=iso-8859-1\r\n write content-length 17\r\n\r\n write respons id out.clos privat void write writer string text throw ioexcept system.out.print text out.writ text
move new uriutil class depric httpclient.uriutil class method move uriutil call httpclient.util.uriutil
build jdk 1.4 get mani javadoc warn build httpclient dist ant target get lot warn first sentenc interpret summari say get warn build use jdk 1.4 use jdk 1.3.1 yield far fewer problem see latest sourc post
patch filepart fail send data second call send use filepart multipartpostmethod server requir authent first call filepart.send send data correct httpclient receiv unauthor respons server httpclient set automat handl authent attempt attempt send filepart time inputstream filepart read empti n't send data due data actual sent httpclient n't match content length specifi server continu wait data n't respond leav httpclient timeout wait respons occur latest sourc cvs 16 octob 2002
cookie.java blow cooki countri code domain follow except thrown cookie.java receiv cooki countri code domain amazon.ca java info cookie.pars reject set cooki header session-id=702-1613649-9326458 path=/ domain= .amazon.ca expires=tuesday 29-oct-2002 08:00:00 gmt session-id-time=1035878400 path=/ domain=.amazon.ca expires=tuesday 29-oct-2002 08:00:00 gmt session-id illeg domain attribut .amazon.ca given domain www.amazon.ca violoat netscap cooki specif non-speci tlds java oct 22 2002 9:32:37 org.apache.commons.httpclient.httpmethodbas processresponsehead java sever except process respons header java org.apache.commons.httpclient.httpexcept bad set-cooki header session-id=702-1613649-9326458 path=/ domain=.amazon.ca expires=tuesday 29-oct-2002 08:00:00 gmt session-id-time=1035878400 path=/ main=.amazon.ca expires=tuesday 29-oct-2002 08:00:00 gmt illeg domain attribut .amazon.ca java org.apache.commons.httpclient.cookie.pars cookie.java:944 java org.apache.commons.httpclient.httpmethodbase.processresponsehead httpmethodbase.java:141 9 java org.apache.commons.httpclient.httpmethodbase.readrespons httpmethodbase.java:1504 java org.apache.commons.httpclient.httpmethodbase.processrequest httpmethodbase.java:2128 java org.apache.commons.httpclient.httpmethodbase.execut httpmethodbase.java:790 java org.apache.commons.httpclient.httpclient.executemethod httpclient.java:442 http respons caus except http/1.1 302 found date tue 22 oct 2002 13:30:11 gmt server stronghold/2.4.2 apache/1.3.6 c2neteu/2412 unix set-cooki session-id=702-8591055-5561622 path=/ domain=.amazon.ca expires=tuesday 29-oct-2002 08:00:00 gmt set-cooki session-id-time=1035878400 path=/ domain=.amazon.ca expires=tuesday 29-oct-2002 08:00:00 gmt locat http //www.amazon.ca/exec/obidos/tg/browse/-/915398/702-8591055-5561622 connect close transfer-encod chunk content-typ text/html ve seen problem .ca domain n't problem uniqu amazon.ca guess would problem line 929 cookie.java int domainpart new stringtoken cookie.getdomain .counttoken domainpart would 2 domain like .amazon.ca instead 3 code expect 'm familiar cooki spec could complet wrong result done oct 20/2002 gump build
httpmulticli reus close connect socket time sit connect pool httpconnectionmanag still attempt reus result ioexcept thrown write socket believ problem server side client side timeout ie tri reus connect time though certain least server side timeout caus issu yet ca n't see fix current code n't even appear suitabl workaround except thrown connect ad back pool reus even though close caus next attempt fail well ca n't see reliabl way tell whether connect open would suggest follow fix 1 httpmulticlient.executemethod close connect except thrown option ioexcept thrown instead httpexcept general except tend leav thing unknown state 2 option add retri loop executemethod retri except occur possibl ioexcept thrown depend exact httpexcept thrown ll attach patch help clarifi
multipartpostmethod check error messag multipartpost request sent server requir authent server may respond request unauthor header close connect data sent httpclient monitor incom stream ceas transmit bodi error messag receiv section 8.2.2 rfc2616 see least httpclient check respons catch httprecoverableexcept retri probabl done httpmethodbas known state start retri connect ie n't exist respons socket buffer caus problem ideal httpclient also implement 100 continu status specifi section 8.2.3 rfc2616 final postmethod test ensur exhibit bug well 8.2.2 monitor connect error status messag http/1.1 later client send message-bodi monitor network connect error status transmit request client see error status immedi ceas transmit bodi bodi sent use chunk encod section 3.6 zero length chunk empti trailer may use prematur mark end messag bodi preced content-length header client must close connect
multipartpost close input stream someth collect issu interrel 1 multipartpost call close outputstream retriev httpconnect caus except thrown later call replac call flush 2 multipartpost class log add trace statement minimum 3. new filepart string file throw null pointer except 4 test testpartsnohost broken ll attach patch fix moment broken much possibl
empti host header ip address file httpmethodbase.java method addhostrequesthead httpclient write empti host header host refer use ip address http 1.1 rfc clear use case howev http 1.1 implement e.g java 1.4.0 use ip address instead dns name header furthermor http server implement e.g jetti return 400 bad request encount empti host header may bug jetti might good idea use ip address host header increas compabl
default charset defin rfc2616 default charact set iso-8859-1 us-ascii defin httpmethodbas see 3.7.1 canonic text default rfc 2616
redirect post method execut postmethod url redirect html page set follow redirect true httpclient want execut post cours post allow html page think httpclient exectu get method instead 's also rfc2616 10.3 redirect 3xx class status code indic action need taken user agent order fulfil request action requir may carri user agent without interact user method use second request get head client detect infinit redirect loop sinc loop generat network traffic redirect note previous version specif recommend maximum five redirect content develop awar might client implement fix limit
multipart feedback never got repli 10/20/02 mail email address author tag post matt jeff excus write direct address found code author pleas feel free forward list appropri thank much effort make http client java find great use aspect org.apache.commons.httpclient.methods.multipart packag 'd like consid first consid make encod paramet current content disposit general-purpos header written string.getbyt call use default encod whatev client use custom rfc http post specifi encod line perhap header inform disposit inform standard utf-8 encod addit paramet could specifi encod anyth suppli user librari notabl stringpart second consid content length header may import mani context receiv post server side depend content length header browser suppli header even would wise believ server side fact common librari handl post notabl http //www.servlets.com/cos/index.html ignor content length header suppli client server side content length calcul actual byte receiv mention appear trade-off made alpha code content length calcul import polymorph part.java follow 2 method n't need final need overridden pair way make sure make sure n't overridden final public void send outputstream throw ioexcept sendstart sendhead sendendofhead senddata sendend final public long length throw ioexcept return lengthofstart lengthofhead lengthofendofhead lengthofdata lengthofend method send seem like import method abl overrid exampl consid situat post content zip on-the-fli content length known write header would handi overrid certain method like send order manipul output stream basic sinc librari general purpos use wide easi polymorph custom appreci librari way make content length calcul header write flexibl may avoid known priori third consid make content type paramet filepart exampl content type zip file application/x-zip-compress rather application/octet-stream happi find excel work librari thank contribut apach jakarta larri hamel
httpmethodbas compil jdk prior 1.3 reason use url.getpath url.getqueri within method processredirectrespons use uriutil.getpath uriutil.getqueri instead httpmethodbas around line 952 //updat current locat redirect locat setpath uriutil.getpath redirecturl.tostr setquerystr uriutil.getqueri redirecturl.tostr thank marius
httpclient authent abil perform altern authent post user group develop repli suggest enter enhanc request -origin messag gustafson vicki mailto vicki.gustafson us.didata.com sent thursday 12 decemb 2002 5:03 jakarta common user list subject httpclient authent use basic way specifi authent scheme would like client use sever scheme return www-auth header 'm perform simpl post use httpclient server return 401 point httpclient tri authent server follow header receiv attempt pars authent header www-authent negoti ntlm basic realm= xxxwhateverxxx need authent use basic authent class tri secur scheme ntlm set paramet set forc httpclient use basic thank vicki determin secur request header add header requesthead null challengemap.containskey ntlm string challeng string challengemap.get ntlm requesthead authenticator.ntlm challeng method state responsehead els challengemap.containskey digest string challeng string challengemap.get digest string realm parserealmfromchalleng challeng requesthead authenticator.digest realm method state responsehead els challengemap.containskey basic string challeng string challengemap.get basic string realm parserealmfromchalleng challeng requesthead authenticator.bas realm state responsehead els challengemap.s 0 throw new httpexcept authent scheme found authenticatehead els throw new unsupportedoperationexcept request authent scheme challengemap.keyset unsupport unsubscrib e-mail mailto commons-user-unsubscrib jakarta.apache.org addit command e-mail mailto commons-user-help jakarta.apache.org unsubscrib e-mail mailto commons-user-unsubscrib jakarta.apache.org addit command e-mail mailto commons-user-help jakarta.apache.org **********develop response********************************** current n't howev probabl intellig fall back authent scheme base type credenti provid said 'm sure conform http spec strict state client must use strongest authent scheme support 's grey area applic n't provid dialog similar user enter ntlm credenti support basic digest authent despit httpclient support ntlm 'd like see happen ntlm authent request top prioriti usernamepasswordcredenti avail instead ntlmcredenti fall back one scheme general would mean authent scheme request credenti object wrong type provid httpclient assum probabl option non- strict mode request authent scheme support fall option achiev would requir reason amount refactor authent class n't imposs unfortun n't time moment 'd happi help felt like otherwis log enhanc bug bugzilla would good way record request someon time actual implement adrian sutton softwar engin ephox corpor www.ephox.com
new prefer architectur architectur solut need configur various aspect httpclient method connect featur configur certain properti per request per connect configur done consist way use system properti configur complet option default valu use configur made refactor request remind file configur issu depend bug
possibl httpclient codepag issu ascii/ebcd webspher z/os work cactus 1.4.1 webspher nt also webspher z/os mainfram problem seem httpclient tri nuild 7th decemb tri get basic cactus servlet test work webspher z/os everyth work fine webspher nt howev applic deploy webspher z/os get follow error xml version= 1.0 encoding= utf-8 xml-stylesheet type= text/xsl href= junit-noframes.xsl testsuit testsuit name= testcactusservlet tests= 1 failures= 0 errors= 1 time= 10.184 testcas name= testneal time= 10.182 error message= error pars status line respons unabl find line start quot http/ quot type= org.apache.commons.httpclient.httprecoverableexcept org.apache.commons.httpclient.httprecoverableexcept error pars status line respons unabl find line start quot http/ quot org.apache.commons.httpclient.httpmethodbase.readstatuslin httpmethodbase.java:1791 org.apache.commons.httpclient.httpmethodbase.readrespons httpmethodbase.java:1559 org.apache.commons.httpclient.httpmethodbase.processrequest httpmethodbase.java:2219 etc verifi applic server webspher z/os work fine set log cactus debug notic data httpclient retriev connect scrambl way exampl 16:06:20,213 webspher t=009d7920 debug ent.httpclientconnectionhelp getcookiestr null 16:06:20,317 webspher t=009d7920 debug httpclient.wir  a  etc webspher nt data point look ok. spring mind mayb ascii/ebcd convers problem z/os use unicod java howev httpclient creat socket connect app server therefor connect non java code situat codepag convers necessari could anybodi adsvis get work regard neal johnston-ward
inadequ http proxi server support httpclient 1 httpclient class save statuslin hidden connectmethod object use connect via http proxi server thus proxi failur pick anonym except useless graceful recoveri rapid debug 2 current class structur fragil neat support http proxi authen chain would good idea look time prefer support proxi chain redirect non/dead http proxi server found
ishttp11 httpclient scope -origin messag kalnichevski oleg mailto oleg.kalnichevski bearingpoint.com sent wednesday januari 15 2003 8:24 common httpclient project cc rob owen subject re ishttp11 http/1.0 server rob basic right hand make sens http version flag httpclient scope address shortcom part post-2.0-releas redesign feel free file bug report make sure issu go forgotten http //nagoya.apache.org/bugzilla/enter_bug.cgi product=common mani thank bring cheer oleg -origin messag rob owen mailto rob.owen sas.com sent monday januari 13 2003 18:31 common httpclient project subject ishttp11 http/1.0 server boolean variabl http11 set method method basi putmethod decis eg expect 100-continu request header made prior determin valu http11 chicken egg problem default true use produc request http/1.0 server hang wait extra data put method bodi applic use httpclient ie manipul http method direct expect set valu http11 method instanc n't http11 httpclient scope would allow interact eg option set http11 method thereaft would use set rob owen sas institut inc. email rob.owen sas.com
use deprec class javax.servlet.http.httputil javac test-webapp/src/org/apache/commons/httpclient/redirectservlet.java:74 warn javax.servlet.http.httputil javax.servlet.http deprec javac httputils.getrequesturl request .append .append request.getquerystr .tostr javax.servlet.http.httputil class deprec tomcat 4.1.18 use
test case failur testconntimeout java 1 failur java 1 testconntimeout org.apache.commons.httpclient.testhttpconnect junit.framework.assertionfailederror time java org.apache.commons.httpclient.testhttpconnection.testconntimeout testhttpconnection.java:118 java sun.reflect.nativemethodaccessorimpl.invoke0 nativ method java sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:39 java sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:25 test fail time run test-loc ant target
better integr testwebapp-howto document excel webapp howto written olegola need integr better httpclient document current doc directori html file would better xdoc directori xml file
add document describ httpclient releas process common releas process http //jakarta.apache.org/commons/releases.html good start place date releas step particular maven test-loc webapp test must document
align code base checkstyl style use httpclient still quit inconsist checkstyl use align code base similar style checkstyl report found http //jakarta.apache.org/commons/httpclient/checkstyle-report.html generat maven checkstyl generate-report
error maven generat task list messag scroll rune site generat goal tasklist generat non-fat error pars file /home/jsdever/cvs-commit/jakarta-commons/httpclient/src/java/org/apache/commons/httpclient/headerelement.java non-fat error pars file /home/jsdever/cvs-commit/jakarta-commons/httpclient/src/java/org/apache/commons/httpclient/uri.java
httpclient enter 100 endless time work masiv use httpclient test usag within server got 100 cpu endless time queri url type http //search.barnesandnoble.com/booksearch/results.asp wrd= text sort=r sat=1 reproduc run 100-200 url random word instead text ll probabl reproduc problem
redirect relat url fail request url http //commerce1.cera.net/discount-pcbooks/catalog/categories.asp search_str=0782128092 browser redirect work httpclient n't
303 redirect handl proper server spit back 303 see redirect handl look code saw processredirectrespons method httpmethodbas check sc_see_oth case statement sc_see_oth redirect handl appropri trace output client server get http //172.30.229.75/cgi/screenshot http/1.1 author basic c3vwzxj1c2vyonjvb3q= host 172.30.229.75 user-ag jakarta commons-httpclient/2.0m1 http/1.1 303 see locat http //172.30.229.75/fs/cip_0_5842 content-length 0 server *snip*
stringindexoutofbound except rfc2109 cooki valid host name contain domain inform short length cooki domain target server identifi hostnam domain domain cooki greater length target hostnam stringindexoutofboundsexcept occur offend line code 174-176 o.a.c.h.cookie.rfc2109spec.java
cookiespec.formatcooki cooki produc incorrect cooki header valu consid follow cooki cooki new cooki .foo.com name valu cookie.setvers 1 cookie.setpath cookiespec spec cookiepolicy.getspecbypolici cookiepolicy.rfc2109 system.out.println spec.formatcooki cooki call cookiespec.formatcooki cooki result output name= valu version attribut present requir rfc2109 path domain inform includ seem case cooki type 0 output produc
ensur features.html index.html adequ give httpclient enough credit see email thread start eric johnson http //archives.apache.org/eyebrowse/browselist listid=128 by=thread from=316092 initi post base recent uri discuss point strike could take littl credit work gone httpclient httpclient home page http //jakarta.apache.org/commons/httpclient/index.html four rfcs list given discuss uri thrown around think might reason add rfc 2396 uri complianc rfc 1867 multipart/form-data post request think got right number rfcs correspond cooki complianc rfcs claim credit conform recent protocol chang think ve made relat straightforward client httpclient plug secur socket implement make easier use third parti non-sun solut
allow redirect host port redirect differ host port protocol current prevent histor httpmethodbase.checkvalidredirect use prevent type redirect due state inform manag connect much chang sinc relax check allow redirect host port redirect across protocol consid time issu relat secur best left user httpclient
nullpointerexcept thrown invalid header encount server return header name valu ie invalid line header httpclient throw nullpointerexcept instead skip header line perhap treat continu previous header need consult rfc confirm problem report eduardo franco commons-us list good test url problem http //www.pc.ibm.com/us/accessories/monitors/p_allmodelos.html return 404 error throw nullpointerexcept instead
migrat commons-codec base64 common codec authorit sourc base64 function base64 httpclient deprec remov 2.1 also add new depend httpclient commons-codec packag
empti respons bodi proper handl chunk encod use ii 5.0 server return content respons http/1.1 request still includ transfer-encod chunk respons header httpclient alway expect chunk-encod stream proper termin httprecoverableexcept except result content sent back post /someurl.aspx http/1.1 content-length 1132 host xxx.xxx.xxx.xxx user-ag jakarta commons-httpclient/2.0alpha2 content-typ multipart/form-data boundary= 314159265358979323846 314159265358979323846 content-disposit form-data name= nmfile filename= xxxxxxxxx.xml content-typ application/octet-stream content remov 314159265358979323846 http/1.1 200 ok server microsoft-iis/5.0 date sat 08 feb 2003 15:22:26 gmt transfer-encod chunk cache-control privat content-typ text/html bug report jim crossley
multipartpostmethod hold file stream open daniel walsh daniel.walsh13 verizon.net date tue feb 25 2003 8:05:49 pm us/eastern common httpclient project commons-httpclient-dev jakarta.apache.org subject multipartpostmethod hold file stream open reply-to common httpclient project commons-httpclient-dev jakarta.apache.org 'm use multipartpostmethod upload file servlet file file new file strurl httpclient client new httpclient hostconfigur hostconfig new hostconfigur multipartpostmethod mppost new multipartpostmethod hostconfig.sethost someurl.gethost someurl.getport someurl.getprotocol client.setconnectiontimeout 30000 client.sethostconfigur hostconfig mppost.addparamet somenam somevalu mppost.addparamet file.getnam file mppost.setpath strpath client.executemethod mppost string confirmupload tppost.getresponsebodyasstr mppost.releaseconnect file.delet block upload would like delet file disk use method upload file particular putmethod abl delet file upload use multipartpostmethod obj upload unabl delet file return valu fals securityexcept thrown securitymanag even set point either guess question whether call multipartpostmethod obj 'm overlook would releas 's connect 'm sure open inputstream sort read file content order form http messag file unimped access oper
realm authent challeng unavail current way extract authent realm httpclient except extract authent challeng header pars manual either realm need avail client method authent extract realm given authent header problem occur determin type authent use option basic digest ntlm other
httpclient compil out box ibm 's visualag ide observ ibm visualag 3.5 run jdk1.2.2 import httpclient sourc code ide bring compil error org.apache.commons.httpclient.httpmethodbas initi privat responseconsumedwatch m_responsewatch use anyonym inner class seem caus troubl implic code privat responseconsumedwatch m_responsewatch new responseconsumedwatch public void responseconsum responsebodyconsum error messag field initi constructor invok creat org.apache.commons.httpclient.httpmethodbas 1 argument defin context httpmethodbas string uri constructor i.e httpmethodbas constructor *can* compil httpmethodbas string uri compil error creat constructor due incorrect field initi interpret mean compil look parameterless constructor anonym class context httpmethodbas string uri messag realli make sens check syntax check languag definit whether set anonym class like permit found noth obvious wrong fix code equival construct instanc begin constructor enclos class copi past construct code two constructor fix thing next updat
100-continu respons time unexpect entiti encos method time 3 second rather get 100-continu respons send bodi 100-continu respons receiv return ad method.setuseexpecthead fals seem fix platform 1 jetti server window xp sun jdk 1.4.1_01 platform 2 tomcat-4.1.18 turbin window 2000 pro sun jdk 1.3.1 platform 3 tomcat-4.1.18 linux connect run stunnel-4.00 report simon robert simon.robert fifthweb.net aurelien pernoud apernoud sopragroup.com ingo brunberg ib fiz-chemie.d
waitforrespons use busi wait httpconnect method waitforrespons use busywait instead block respons arriv purpos n't handl block instead
ssl tunnel work multithreadedhttpconnectionmanag httpconnect releas prematur ssl tunnel multithreadedhttpconnectionmanag connectmethod releas connect responsebodyconsum use real method
includ generat websit distribut user abl build non-api doc well would nice includ xdoc sourc packag well
cooki null valu format correct server set bunch empti cooki 2003/03/06 16:28:52:055 pst debug wire set-cooki list 2esince= path=/ \r \n 2003/03/06 16:28:52:055 pst debug wire set-cooki search 2ephonesda= path=/ \r \n subsequ request httpclient attach cooki thusli 2003/03/06 16:28:55:480 pst debug wire cooki version=0 list 2esince=nul path=/ \r \n 2003/03/06 16:28:55:480 pst debug wire cooki version=0 search 2ephonesda=nul path=/ \r \n 'm sure read portion wirelog seem actual valu contain string null sent part request respons request server echo cooki null valu back 2003/03/06 16:28:55:660 pst debug wire set-cooki search 2ephonesda=nul path=/ \r \n 2003/03/06 16:28:55:660 pst debug wire set-cooki list 2esince=nul path=/ \r \n n't good basic list.since= cooki convert list.since=nul caus server 's script crash p microsoft vbscript runtim /font font face= arial size=2 error 800a000d /font p font face= arial size=2 type mismatch cint /font p font face= arial size=2 /listcust.asp /font font face= arial size=2 line 283 /font guess script tri assign string null integ die report tom samplonius tom sdf.com
multipl digest authent attempt credenti httpmethodbas 's processauthenticationrespons use set realm attempt authent alreadi made element set concaten request path valu authent respons header digest authent respons header contain nonc valu uniqu generat server time 401 respons made make imposs recogn authent realm attempt 100 attempt made return nonc probabl use realmsus element report rob owen rob.owen sas.com
need seturi method httpmethod interfac 'd like method seturi uri seturi string method also method like getrequesturi uri get method geturi chang execut request automat forward method seturi throw except alreadi execut
httpstate differenti credenti differ host realm name seem one need separ httpstate per client per host javadoc coincid design one host use realm name privat 's unresolv conflict httpstate store one set credenti given name accord oleg kalnichevski plausibl extend httpstate class addit method would requir host specifi along authent realm deal credenti see post common httpclient project mail list info date 21/03/2003
unusu http status line web server http //alces.med.umn.edu/candida.html return follow status line http 200 document follow page load 3 browser tri though safari actual render header current version httpclient read whole page look line start http/ n't know big problem 's fair easi fix patch follow
reus connect unreli httpconnect reus unreli follow 1 current way determin connect still open server side 2 ioexcept occur write connect reus
multithreadedhttpconnectionmanag never reclaim unus connecton limit number connect get creat multithreadedhttpconnectionmanag unus connect never destroy
https post work use java 1.4.1_01 window 2000 https post result http/100-continu messag code post non https url work code popul request bodi use namevaluepair array
httpclient charset encood loos problem file org\apache\commons\httpclient\httpconstants.java line near 261 public static string getcontentstr final byte data string charset return getcontentstr data 0 data.length must return getcontentstr data 0 data.length charset
org.apache.commons.httpclient.headerel fail pars cooki header set-cooki header valu expires=mon org.apache.commons.httpclient.headerel fail pars header caus sourc cord tri follow rfc 2109 2965 order conflict next header element make sure pars token expir date format wdi dd-mon-yy hh mm ss gmt notic alway comma sign general case rfc1123-date rfc850-date tokenizer.hasmoretoken string nexttoken.tolowercas nexttoken.endswith mon || s.endswith tue || s.endswith wed || s.endswith thu || s.endswith fri || s.endswith sat || s.endswith sun || s.endswith monday || s.endswith tuesday snip nexttoken.endswith mon wrong must s.endswith mon sourc cord version header /home/cvspublic/jakarta-commons/httpclient/src/java/org/apache/commons/httpclient/headerelement.java v 1.17 2003/03/08 21:30:02 olegk exp revis 1.17 date 2003/03/08 21:30:02
order method postmethod chang behaviour spent best part two day tri work servlet run tomcat get utf-8 set client send utf-8 turn set postmethod request header set request bodi content get sent utf-8 follow get sent utf-8 postmethod post new postmethod destinationurl.tostr post.setstrictmod fals post.setrequesthead content-typ text/xml charset=utf-8 post.setrequesthead user-ag myagent post.setrequestbodi content post.setfollowredirect true follow n't postmethod post new postmethod destinationurl.tostr post.setstrictmod fals post.setrequestbodi content post.setrequesthead content-typ text/xml charset=utf-8 post.setrequesthead user-ag myagent post.setfollowredirect true live execut would understand order make big differ fill object feel like defin valu java bean like less obvious
provid general http date pars add general access support pars http date use headers/cooki initi submit httpclient dev chris brown
recover except read retri recover except occur request written method retri
set-cookie2 set-cooki acord rfc2965 9.1 user agent receiv respons set-cooki set-cookie2 respons header cooki must discard set-cooki inform use set-cookie2 inform read header cetain cooki cooki server send set-cooki header cooki cooki send set-cookie2 set-cooki httpclient implement handl find set-cookie2 header ignor set-cooki header know site use set-cookie2 cooki need flexibl exir handl cooki use set-cooki one exmapl site know tdnet databas servic provid tokyo stock exchang prefer implement set-cookie2 header found certain cooki cooki valu set set-cookie2 header set-cooki header
setcooki datepars fail pars non-standard date format 'm receiv follow expir date setcooki datepars n't handl expires=sat,19-apr-03 04:28:07 gmt lack space 19 caus problem possibl add follow line datepattern eee dd-mmm-yy hh mm ss z eee dd-mmm-yyyy hh mm ss z
ntlm authent fail ntlm authent requir multipl request/respons authent succeed sinc httpmethodbas use host port realm identifi whether authent attempt second pass ntlm authent never perform
duplic request header connect proxi negoti proxi server write-failur retri httpclient add duplic request header retri result header duplic multipl time number retri impact header allow multipl valu other prevent byt code particular affect cooki header happen often go proxi server tunnel connect https also happen http ntlm proxi server need multipl round trip get authent step reproduc setup client applic go websit requir go proxi server support tunnel https connect authent user basic and/or ntlm websit also need support keep-al support https initil httpstate cooki turn httpclient log wire debug trace log set proxi credenti valid user id password run applic url websit test result fix 1 connect https netscape/bas auth proxi tunnel initi connect add cooki header proxi return 407 code use proxi credenti connect success connect 200 code proper post httpclient code add cooki one time case caus wrapper class connectmethod use wrap method addrequesthead build header conenct fix connectmethod add header need addhostrequesthead addproxyauthorizationrequesthead 2 connect http proxi client first send post without proxi credenti get 407 back cooki header ad happen loop httpmethodbase.execut client retri post credenti logic requir respons header submit credenti retri cooki ad addrequesthead call insid writerequest 3 use kee-al no-proxi http connect time next call method get socket error write retri loop processrequest method retri request add cooki deal case 2 3 addrequestheadr call need move begin httpmethodbase.execut test approach work us 4 negoti ntlm proxi https multipl round trip need get user authent connectmethod instanc use ad proxi authent header need done connectmethod instanc vs. wrap method host header otherwis authent class would abl find inform authent user send suggest fix later build base 0307 night build run problem tri 0410 night build
buffer output socket post slavik markovich hi probabl known issu n't found answer yet 'm use httpclient post data remot server far see use ether client write everi line wire without buffer examin code see httpconnect class use output stream receiv socket direct reason direct write problem caus remot server set low timeout return bad request respons receiv request line without header line request bodi easili add buffer behavior http client 10x
httpclient support instal differ sslsocketfactori descript sslprotocolsocketfactori class hard- code javax.net.ssl.sslsocketfactori socket factori support instal socket factori propos fix ad setdefaultsslsocketfactori method sslprotocolsocketfactori modifi code use factori set code fall back use javax.net.ssl.sslsocketfactori default set
ntlm authent fail due close connect descript deal ntlm proxi server send respons back line 14:51:27:750 http/1.0 407 proxi authent requir 14:51:27:796 date mon 14 apr 2003 19:52:43gmt \r \n 14:51:27:796 content-length 257 \r \n 14:51:27:796 content-typ text/html \r \n 14:51:27:796 server netcach applianc netapp/5.3.1r1 \r \n 14:51:27:796 connect keep-al \r \n 14:51:27:796 proxy-authent ntlm tlrmtvntuaacaaaabgagacgaaaagggeatoony4m0g0eaaaaaaaaaaedmt0jbta== \r \n httpclient code use http/1.0 clue close connect ignor connect keep-al caus ntlm authent fail ntlm requir respons challeng sent back connect propos fix fix add flag inproxyauthenticationretri httpmethodbas indic method proxi authent retri flag true httpmethodbase.shouldcloseconnect check connect keep- aliv determin close connect
httpclient fail reconnect keep-al connect time descript use httpclient https tunnel througha proxi server keep- aliv connect time server side httpclient code unabl establish connect caus httpmethodbase.processrequest 's retri loop retri connect without go connect request proxi server proxi server return 407 error code case tunnel connect proper reconnect done first connect sequenc get authent throught proxi temp fix work around implement work around retri applic layer order detect situat reli error messag contain httprecoverableexcept check text connect abort peer socket write error also modifi httpmethodbas code throw httprecoverableexcept applic
problem redirect head bad naughti server return bodi content ve testing/us httpclient 2.0a3 resin 2.1.9 ve found use head request jsp resin return bodi content along header case someth httpclient break look httpclient log look like 1 httpclient head origin url 2 resin return valid status line header 3 httpclient pars header recogn redirect header 4 httpclient head new url locat header 5 httpmethodbas call readstatuslin eventu call readrawlin httpconnect read intern inputstream 6 readrawlin return first line bodi origin head request 1 look like origin bodi content respons first head buffer somewher ca n't figur know invalid behavior server 's part would like abl recov redir_test.jsp xml version= 1.0 response.setstatus response.sc_moved_temporarili response.sethead locat redirect_pass.xml dummi data attr= yea well /dummi /some
postmethod bring back respons header proxi server descript tunnel proxi server case 407 respons wrapper class connectmethod fail pass respons header back wrap method postmethod case result respons header pass back applic propos fix chang connectmethod use wrap method instanc get respons header reiniti connect success also modifi addproxyauthorizationrequesthead code use wrap method authent work
getmethod.java check use flag set time getmethod.getresponsebodyasstream call httpmethodbase.checkus assert flag use true time use true use set true httpmethodbase.processrequest two line readrespons call turn call readresponsebodi readresponsebodyasstream mayb requests flag check instead use stack trace fragment java.lang.illegalstateexcept use org.apache.commons.httpclient.httpmethodbase.checkus httpmethodbase.java:1642 org.apache.commons.httpclient.methods.getmethod.getresponsebodyasstream getmethod.java:309 org.apache.commons.httpclient.methods.getmethod.readresponsebodi getmethod.java:428 org.apache.commons.httpclient.httpmethodbase.readrespons httpmethodbase.java:1893 org.apache.commons.httpclient.httpmethodbase.processrequest httpmethodbase.java:2496 org.apache.commons.httpclient.httpmethodbase.execut httpmethodbase.java:1062 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:599 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:497 org.apache.webdav.lib.webdavresource.getmethoddata webdavresource.java:2227 org.apache.webdav.lib.webdavresource.getmethoddata webdavresource.java:2206
stackoverflowerror httpconnect httpconnect wrappedoutputstream.flush encount ioexcept druign write call httpconnection.clos call httpconnection.closesocketandstream eventu call httpconnect wrappedoutputstream.flush circular call caus stackoverflowerror run accident tri extend httpconnect look code believ ioexcept may caus problem circular call either remov control part teh stack trace java.lang.stackoverflowerror java.lang.exception. init unknown sourc java.io.ioexception. init unknown sourc java.net.socketexception. init unknown sourc java.net.socketoutputstream.socketwrit nativ method java.net.socketoutputstream.writ unknown sourc org.apache.commons.httpclient.httpconnect wrappedoutputstream.writ e httpconnection.java:1273 java.io.bufferedoutputstream.flushbuff unknown sourc java.io.bufferedoutputstream.flush unknown sourc java.io.filteroutputstream.clos unknown sourc org.apache.commons.httpclient.httpconnection.closesocketandstream ht tpconnection.java:1083 org.apache.commons.httpclient.httpconnection.clos httpconnection.jav a:1024 org.apache.commons.httpclient.httpconnect wrappedoutputstream.hand leexcept httpconnection.java:1235 org.apache.commons.httpclient.httpconnect wrappedoutputstream.writ e httpconnection.java:1275 java.io.bufferedoutputstream.flushbuff unknown sourc java.io.bufferedoutputstream.flush unknown sourc java.io.filteroutputstream.clos unknown sourc org.apache.commons.httpclient.httpconnection.closesocketandstream ht tpconnection.java:1083 org.apache.commons.httpclient.httpconnection.clos httpconnection.jav a:1024 org.apache.commons.httpclient.httpconnect wrappedoutputstream.hand leexcept httpconnection.java:1235 org.apache.commons.httpclient.httpconnect wrappedoutputstream.writ e httpconnection.java:1275 java.io.bufferedoutputstream.flushbuff unknown sourc java.io.bufferedoutputstream.flush unknown sourc java.io.filteroutputstream.clos unknown sourc org.apache.commons.httpclient.httpconnection.closesocketandstream ht tpconnection.java:1083 org.apache.commons.httpclient.httpconnection.clos httpconnection.jav a:1024 org.apache.commons.httpclient.httpconnect wrappedoutputstream.hand leexcept httpconnection.java:1235 org.apache.commons.httpclient.httpconnect wrappedoutputstream.writ e httpconnection.java:1275 java.io.bufferedoutputstream.flushbuff unknown sourc java.io.bufferedoutputstream.flush unknown sourc java.io.filteroutputstream.clos unknown sourc org.apache.commons.httpclient.httpconnection.closesocketandstream ht tpconnection.java:1083 org.apache.commons.httpclient.httpconnection.clos httpconnection.jav a:1024 org.apache.commons.httpclient.httpconnect wrappedoutputstream.hand leexcept httpconnection.java:1235 org.apache.commons.httpclient.httpconnect wrappedoutputstream.writ e httpconnection.java:1275
httpmethodbas string incorrect encod uri httpmethodbas string constructor handl uri incorrect javadoc indic given uri alreadi escap constructor use uri constructor unescap uri
uri class constructor need revis optim 1 current 's way pass escap string paramet uri class result url paramet httpmethodbas httpmethodbas string constructor get convert array char convert back string uri contructor call method 2 overal design uri class contructor appear coher least
netscap proxi problem wtih post descript use httpclient post http url netscap proxi server httpclient fail due read error read status line log seem indic proxi talk http/1.0 expect post data come use modifi version clientapp exampl attach test program log file workaround use postmethod.setuseexpect true work mani case would slower relat issu test also found httpclient postmehtod work request bodi set call setrequestbodi also work empti bodi setrequestbodi attach clientapp.properti file flag test case attach log well excus ignor know sure http spec say bodi post method least caller/app wrong set bodi except thrown could also server 's problem pleas let know case use weblog server 6.1
add set/getlocaladdress method hostconfigur cluster multi-hom system 's need specifi local bind address socket ensur re creat right interfac local address need pass 4-argument version protcolsocketfactory.createsocket discuss mail list best approach seem ad local address properti hostconfigur httpconnect ve attach patch follow add public set/getlocaladdress method hostconfigur httpconnect httpconnect use local address open connect modifi hostconfiguration.equ hostequ compar local address simplehttpconnectionmanag use local address provid config also clean getconnect method bit httpclient.executemethod use local address default hostconfigur method 's config n't specifi one
except handl httpclient requir redesign use httpclient2.0-alpha3 settimeout 60000 specifi time would like see interruptedioexcept thrown got httprecoverableexcept instead pretti general would like see origin except thank
authent fail proxi ssl connect connect proxi use ssl authent httpclient wind send get request proxi initi auth requir respons proxi obvious respond implement respons sinc ca n't handl get request ssl url essenc follow happen 1 httpclient send connect respons 2 proxi respond 200 connect ok 3 httpclient use ssl connect send request web server 4 web server respond author close connect 5 httpclient open new connect proxi issu get request ssl url 6 proxi return 501 implement ll attach full log bug like hard fix sinc retri perform httpmethodbas connect method execut httpclient fix may best wait 2.1 look similar httpclient-195 except bug mark fix one still n't work also appli authent scheme ntlm test ntlm basic best evalu web server return connect close reject author attempt httpmethodbas incap creat new ssl connect proxi thing think could done prior 2.1 fix send connect keep-al well proxy-connect keep-al re alreadi send origin request
httpclient drop connect proxi invalid connect close direct encount connect establish respons one custom use applic connect servlet use https use httpclient http protocol handl custom ibm proxi see log file connect fail null pointer except log seem indic proxi server return 200 connect proxi also send connect close header httpclient close connect tri creat ssl socket proxi server incorrect send 200 connect close httpclient throw except invalid state illegalstateexcept attach log file
build problem strictsslprotocolsocketfactori strictsslprotocolsocketfactori requir jcert.jar compile.classpath build.xml patch fix index build.xml rcs file /home/cvspublic/jakarta-commons/httpclient/build.xml v retriev revis 1.27 diff -u -r1.27 build.xml build.xml 23 may 2003 02:49:01 -0000 1.27 +++ build.xml 26 may 2003 04:23:50 -0000 -98,6 +98,7 pathel location= build.hom /class pathel location= junit.jar pathel location= jsse.jar pathel location= jcert.jar pathel location= jce.jar pathel location= jnet.jar pathel location= commons-logging.jar
cooki null path attribut reject compat mode weblog send cooki path empti httpclient emit warn n't send back cooki server mayb httpclient work rfc 's way n't reproduc common web browser behaviour applic work well ie opera netscap httpunit also send back cooki server recev respons httpclient emit followin warn warn httpmethod -invalid cooki header jtd=o 2fdf13cdb1w7h2gnfuts2yq3zt6bcw6zkzrvvj9fwaadqlxxvi7rgii 2fwbxecsqym7dcwkdxsj 2bg1ubjrsvrhygb7wrljp5c0v2r3qrcixvhmkdjuwuxdxnjbh3lhswg7bfzjsms7nxk9r 2fqmirhb5najlqku7wkupggxunuln 2bf51tajkvmxkrlmyn7mhdt48behvfqfnxblmsrejwqrd 2fiiao0flobort3hcawi09b1vekpacpmgvmd2ozzxqwjwjdzix6qovvd6u8cxpsvvqjityaxf6aqa 2bafjgrsqbzbc0 2bv5g 2fnze87ggoviozfpfn99ny0kxipgbeisjiy 3d 3d version=1 path= max-age=604800 miss valu path attribut 's right mayb http header correct think httpclient handl case without error order behaviour common browser way give better valu path
httpmethod.abort need problem use httpclient fire mani request point time server queu request certain request wait respons call httpmethod.releaseconnect request stop wait respons connect close howev happen request given time
httpclient proper handl application/x-www-form-urlencod encod alway 'd like pass thank 'm find httpclient realli use problem occur use strut map base actionform generat request paramet form input type= text name= searchselect c submit use postmethod class generaterequestbodi call turn call uri.encod method bitset accept charact case charact mark accept problem work correct submit remot server howev issu request direct webpag rather use httpclient work examin request input stream see paramet re-written select c display select 28c 29 may error encod problem fact set content type etc correct could bug 'm afraid http knowledg good enough chris mein
error handl duplic connect header httpmethodbase.shouldcloseconnect correct handl case one connect header exist report ross rankin
via ntlm proxi ssl apache/basicauth work may 22nd broken beta1 hi morn download beta 1 tri small piec code connect sslifi apach server use basic authent via ms-proxi 2.0 ntlm enabl sourcecod crashm base 1st attach httpclient-153 differ origin use basic authent webserv instead ntlm fail error 10-jun-2003 16:39:05 org.apache.commons.httpclient.httpmethodbas processauthenticationrespons info alreadi tri authent websit still receiv 407 status 407 proxi authent requir download fresh night build commons-httpclient-20030605 also fail went back old build may commons-httpclient-20030522 work like charm use msie succes connect apach server know 's problem typo msie ask cred seem someth got broken along way help pleas ask cheer
uri path resolut problem uri complet conform rfc 2396 particular handl follow relat uri correct ../../../g ../../../../g
httpmethod getresponsebodi throw npe httpmethod getresponsebodi throw npe respons server 204 n't getresponsebodi return null contract instead throw npe
miss content-length header caus socketexcept essenti invalid http server stellent cms actual file bug return header like http/1.1 401 unauthor www-authent basic secur realm connect keep-al clear miss content-length header previous httpclient handl perfect read end connect ie treat like connect close howev reason socket except thrown invalid connect ad back connect pool everi connect server thow except see thread socketexcept invalid server full discuss issu ll attach patch fix problem biggest thing consid chang duplic connect header test case resolv around question connect keep- aliv present content-length provid connect close patch requir answer yes realli ca n't see way
request digest authent fail redirect request digest authent fail redirect due invalid uri paramet client side log debug httpclient -java version 1.2.2 debug httpclient -java vendor sun microsystem inc. debug httpclient -oper system name linux debug httpclient -oper system architectur i386 debug httpclient -oper system version 2.4.20-13.9-ok debug httpclient -sun 1.2 sun dsa key/paramet generat dsa sign sha-1 md5 digest securerandom x.509 certif jks keystor debug httpclient -sunjss 1.0301 sun jsse provid implement rsa signatur pkcs12 sunx509 key/trust factori sslv3 tlsv1 debug httpconnect -creat connect localhost use protocol http:80 debug httpconnect -httpconnection.setsotimeout 0 debug httpmethod -execut loop tri 1 debug wire get /transfer http/1.1 \r \n debug httpmethod -ad host request header debug wire user-ag jakarta commons-httpclient/2.0beta1 \r \n debug wire host localhost \r \n debug wire \r \n debug wire http/1.1 401 author requir \r \n debug wire date fri 20 jun 2003 08:30:06 gmt \r \n debug wire server apache/2.0.40 red hat linux \r \n debug wire www-authent digest realm= guest realm nonce= ei+t7opaawa=53c8e6d609ff81a8dcbc370b51f8aadec565009a algorithm=md5 domain= /transfer qop= auth \r \n debug wire vari accept-languag \r \n debug wire accept-rang byte \r \n debug wire content-length 1285 \r \n debug wire content-typ text/html charset=iso-8859-1 \r \n debug httpmethod -author requir debug httpauthent -use guest realm authent realm debug httpmethod -httpmethodbase.execut server demand authent credenti tri debug httpmethod -resort protocol version default close connect polici debug httpmethod -should close connect use http/1.1 debug httpmethod -execut loop tri 2 debug wire get /transfer http/1.1 \r \n debug httpmethod -request add host header ignor header alreadi ad debug wire user-ag jakarta commons-httpclient/2.0beta1 \r \n debug wire host localhost \r \n debug wire author digest username= guest realm= guest realm nonce= ei+t7opaawa=53c8e6d609ff81a8dcbc370b51f8aadec565009a uri= /transfer qop= auth algorithm= md5 nc=00000001 cnonce= 81d4b905a4e9def944beaed8daf79283 response= 71394edcddf4bcee6237ea4bb50cfaa5 \r \n debug wire \r \n debug wire http/1.1 301 move perman \r \n debug wire date fri 20 jun 2003 08:30:06 gmt \r \n debug wire server apache/2.0.40 red hat linux \r \n debug wire locat http //localhost/transfer/ \r \n debug wire content-length 302 \r \n debug wire content-typ text/html charset=iso-8859-1 \r \n debug httpmethod -redirect requir debug httpmethod -redirect request locat http //localhost/transfer/ debug httpmethod -redirect http //localhost:80/transf http //localhost/transfer/ debug httpmethod -resort protocol version default close connect polici debug httpmethod -should close connect use http/1.1 debug httpmethod -execut loop tri 3 debug wire get /transfer/ http/1.1 \r \n debug httpmethod -request add host header ignor header alreadi ad debug wire user-ag jakarta commons-httpclient/2.0beta1 \r \n debug wire host localhost \r \n debug wire author digest username= guest realm= guest realm nonce= ei+t7opaawa=53c8e6d609ff81a8dcbc370b51f8aadec565009a uri= /transfer qop= auth algorithm= md5 nc=00000001 cnonce= 81d4b905a4e9def944beaed8daf79283 response= 71394edcddf4bcee6237ea4bb50cfaa5 \r \n debug wire \r \n debug wire http/1.1 400 bad request \r \n debug wire date fri 20 jun 2003 08:30:06 gmt \r \n debug wire server apache/2.0.40 red hat linux \r \n debug wire vari accept-languag \r \n debug wire accept-rang byte \r \n debug wire content-length 973 \r \n debug wire connect close \r \n debug wire content-typ text/html charset=iso-8859-1 \r \n end client side log server side log fri jun 20 10:30:06 2003 error client 127.0.0.1 digest uri mismatch /transfer match request-uri /transfer/ end server side log
contribut util determ content type file type extens apach softwar licens version 1.1 copyright c 2002-2003 apach softwar foundat right reserv redistribut use sourc binari form without modif permit provid follow condit met 1 redistribut sourc code must retain copyright notic list condit follow disclaim 2 redistribut binari form must reproduc copyright notic list condit follow disclaim document and/or materi provid distribut 3 end-us document includ redistribut must includ follow acknowleg product includ softwar develop apach softwar foundat http //www.apache.org/ altern acknowleg may appear softwar wherev third-parti acknowleg normal appear 4 name jakarta project common apach softwar foundat must use endors promot product deriv softwar without prior written permiss written permiss pleas contact apach apache.org 5 product deriv softwar may call apach may apach appear name without prior written permiss apach group softwar provid express impli warranti includ limit impli warranti merchant fit particular purpos disclaim event shall apach softwar foundat contributor liabl direct indirect incident special exemplari consequenti damag includ limit procur substitut good servic loss use data profit busi interrupt howev caus theori liabil whether contract strict liabil tort includ neglig otherwis aris way use softwar even advis possibl damag softwar consist voluntari contribut made mani individu behalf apach softwar foundat inform apach softwar foundat pleas see http //www.apache.org/ addit notic requir prior licens condit packag org.apache.commons.httpclient.contrib.util import java.io.fil import java.io.ioexcept class provid map file name extens content type author href= mailto emdevlin charter.net eric devlin /a disclaim httpclient develop activ support compon compon provid refer materi may inappropri use without addit custom public class contenttyp mime type map liber tomcat4.1.18/conf/web.xml*/ public static final string mime_type_map ab audio/x-mpeg ai application/postscript aif audio/x-aiff aifc audio/x-aiff aiff audio/x-aiff aim application/x-aim art image/x-jg asf video/x-ms-asf asx video/x-ms-asf au audio/bas avi video/x-msvideo avx video/x-rad-screenplay bcpio application/x-bcpio bin application/octet-stream bmp image/bmp bodi text/html cdf application/x-cdf cer application/x-x509-ca-cert class application/java cpio application/x-cpio csh application/x-csh css text/css dib image/bmp doc application/msword dtd text/plain dv video/x-dv dvi application/x-dvi ep application/postscript etx text/x-setext exe application/octet-stream gif image/gif gtar application/x-gtar gz application/x-gzip hdf application/x-hdf hqx application/mac-binhex40 htc text/x-compon htm text/html html text/html hqx application/mac-binhex40 ief image/ief jad text/vnd.sun.j2me.app- descriptor jar application/java-arch java text/plain jnlp application/x-java-jnlp- file jpe image/jpeg jpeg image/jpeg jpg image/jpeg js text/javascript jsf text/plain jspf text/plain kar audio/x-midi latex application/x-latex m3u audio/x-mpegurl mac image/x-macpaint man application/x-troff-man application/x-troff-m mid audio/x-midi midi audio/x-midi mif application/x-mif mov video/quicktim movi video/x-sgi-movi mp1 audio/x-mpeg mp2 audio/x-mpeg mp3 audio/x-mpeg mpa audio/x-mpeg mpe video/mpeg mpeg video/mpeg mpega audio/x-mpeg mpg video/mpeg mpv2 video/mpeg2 ms application/x-wais-sourc nc application/x-netcdf oda application/oda pbm image/x-portable-bitmap pct image/pict pdf application/pdf pgm image/x-portable-graymap pic image/pict pict image/pict pls audio/x-scpl png image/png pnm image/x-portable-anymap pnt image/x-macpaint ppm image/x-portable-pixmap ps application/postscript psd image/x-photoshop qt video/quicktim qti image/x-quicktim qtif image/x-quicktim ras image/x-cmu-rast rgb image/x-rgb rm application/vnd.rn- realmedia roff application/x-troff rtf application/rtf rtx text/richtext sh application/x-sh shar application/x-shar smf audio/x-midi snd audio/bas src application/x-wais-sourc sv4cpio application/x-sv4cpio sv4crc application/x-sv4crc swf application/x-shockwave- flash application/x-troff tar application/x-tar tcl application/x-tcl tex application/x-tex texi application/x-texinfo texinfo application/x-texinfo tif image/tiff tiff image/tiff tr application/x-troff tsv text/tab-separated-valu txt text/plain ulw audio/bas ustar application/x-ustar xbm image/x-xbitmap xml text/xml xpm image/x-xpixmap xsl text/xml xwd image/x-xwindowdump wav audio/x-wav svg image/svg+xml svgz image/svg+xml wbmp image/vnd.wap.wbmp wml text/vnd.wap.wml wmlc application/vnd.wap.wmlc wmls text/vnd.wap.wmlscript wmlscriptc application/vnd.wap.wmlscriptc wrl x-world/x-vrml z application/x-compress z application/x-compress zip application/zip get content type base extens file name br param filenam content type determin return content type file null map possibl public static string get string filenam string contenttyp null filenam null int extensionindex filename.lastindexof extensionindex -1 extensionindex 1 filename.length string extens filename.substr extensionindex 1 int 0 mime_type_mappings.length i++ extension.equ mime_type_map 0 contenttyp mime_type_map 1 break return contenttyp get content type base extens file name br param file content type determin return content type file null map possibl throw ioexcept construct canon path file fail public static string get file file throw ioexcept string contenttyp null file null contenttyp get file.getcanonicalpath return contenttyp
make multithreadedhttpconnectionmanag default public static could default multithreadedhttpconnectionmanag made public constant would self sinc karma contribut lang codec want step anyon toe patch attach
httpmethodbas javadoc patch clarifi http 1.1 default attach
customiz cooki polici even server compli cooki specif sometim still need talk would nice set cooki polici httpmethod could specifi custom polici implement cookiespecbas may handl certain problem lenient would instead specifi one three hard-cod polici
httpmethodbas logger use wrong class notic minor error httpmethodbas initi log object httpmethod.class instead httpmethodbase.class big deal probabl ought fix point ll attach patch
uri.norm error code import org.apache.commons.httpclient.uri class main publi static void main string arg throw except uri uri new uri http null host -1 /tmp/../yo null null uri.norm system.out.println uri end main print http //host/tmp/../yo instead http //host/yo
wire logger skip empti line log org.apache.commons.logging.simplelog.log.httpclient.wire=debug httpconnect skip one line server output log crlf line header bodi
headerel pars string implement optim cooki set localdirector 416 version 4.2.3 bug set tuesday thursday tue thur instead canon tue thu break pars stage stop httpclient work 2 day week cours modifi pars method headerel class everytim download new version remak jar 's possibl includ cvs file
redirect 302 url caus max redirect except notic server return 302 without url link httpclient follow empti url maximum time 100 default instead check url empti string n't tri follow redirect 12:18:17,430 u main error httpmethodbas narrowli avoid infinit loop execut 12:18:17,430 u main debug urlmonitor method.execut attempt 1 fail http //www.stagecoach.co.uk org.apache.commons.httpclient.httprecoverableexcept maximum redirect 100 exceed 12:18:17,430 u main debug urlmonitor httprecoverableexcept http //www.stagecoach.co.uk org.apache.commons.httpclient.httprecoverableexcept maximum redirect 100 exceed org.apache.commons.httpclient.httpmethodbase.execut httpmethodbase.java:1065 com.verideon.veriguard.domain.urlmonitor.monitor urlmonitor.java:189 com.verideon.veriguard.domain.urlmonitor.monitor urlmonitor.java:101 com.verideon.veriguard.domain.testurlmonitor.getpag testurlmonitor.java:58 com.verideon.veriguard.domain.testurlmonitor.monitorurl testurlmonitor.java:47 com.verideon.veriguard.domain.testurlmonitor.testmonitorurlstagecoach testurlmonitor.java:138 sun.reflect.nativemethodaccessorimpl.invoke0 nativ method sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:39 sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:25 java.lang.reflect.method.invok method.java:324 junit.framework.testcase.runtest testcase.java:154 junit.framework.testcase.runbar testcase.java:127 junit.framework.testresult 1.protect testresult.java:106 junit.framework.testresult.runprotect testresult.java:124 junit.framework.testresult.run testresult.java:109 junit.framework.testcase.run testcase.java:118 junit.framework.testsuite.runtest testsuite.java:208 junit.framework.testsuite.run testsuite.java:203 org.eclipse.jdt.internal.junit.runner.remotetestrunner.runtest remotetestrunner.java:392 org.eclipse.jdt.internal.junit.runner.remotetestrunner.run remotetestrunner.java:276 org.eclipse.jdt.internal.junit.runner.remotetestrunner.main remotetestrunner.java:167 result telnet get http/1.1 302 object move server microsoft-iis/5.0 date tue 01 jul 2003 10:05:58 gmt x-powered-bi asp.net locat http //www.stagecoach.co.uk connect keep-al content-length 121 content-typ text/html set-cooki aspsessionidcqcsraab=ifjjleadopddnnghlpfbiii path=/ cache-control privat head titl object move /titl /head bodi h1 object move /h1 object may found href= /a /bodi connect close foreign host
support handl larg file ad probabl chang entityenclosingmethod content length field long futur releas current 's int
add inputstream buffer current httpclient buffer inputstream receiv socket perhap would improv perform report toni bigbe
transfer-encod ident support possibl patch httpmethodbase.readresponsebodi chunk transfer encod support proxi server like privoxi etc send transfer-encod ident header httpclient fail quiet return null result input stream line 2037 httpmethodbase.java revis 1.160 insert follow two line appear work fine els ident .equalsignorecas transferencodingheader.getvalu result think least throw except someth encount unsupport transfer-encod instead return null input stream
uri use sun.security.action.getpropertyact uri use sun class use class remov report mark wilcox
custom handl 302 redirect tri beta2 2.0 releas night build follow code snippet describ tri httpclient.gethostconfigur .sethost shost 80 http httpmethod method=nul smethod.indexof post =-1 method=new postmethod surlinfo els method=new getmethod surlinfo method.setfollowredirect true httpclient.executemethod method code execut getfollowredirect method still return fals redirect sent webserv follow temporari workaround sinc want redirect follow comment follow code httpmethodbas class processredirectrespons method /*if getfollowredirect log.info redirect request followredirect disabl return fals bug alreadi report apolog search found noth relat issu
pleas log alloc new connect support debug test 'd like suggest multithread connect manag emit trace-level log alloc new httpconnect support debug test ad one work integr apach axi see org.apache.axis.transport.http.commonshttpsend figur would general use ll attach patch oh-so-minor addit submit enhanc request
content-length transfer-encod request header handl entiti enclos method current content-length transfer-encod request header handl httpmethodbas class conceptu wrong error-pron opinion entiti enclos method control content-length transfer- encod request header instead provid request content encapsul requisit content transfer logic
cooki strict mode independ regular strict mode hi 'm problem web site 'm tri access use strict cooki one line 302 redirect fail strict mode access websit strict mode fail 302 redirect non-strict mode websit n't recogn cooki separ line 'd love see ad next releas candid thank brent
javadoc clean-up httpclient releas javadoc need updat proof-read
j2sdk 1.5.0 tiger enum keyword hi tiger add extens java program languag jsr201 one enumer requir add new keyword enum made grep grep -lrw sourc found apach project use enum word compliant new specif pleas check enum use variabl field method name regard robert
ntlm class regist sun jce implement default current ntlm class attempt load regist sun jce implement unless system properti set indic differ jce use remov entir leav instal configur jce applic rather tri could caus problem implement jce ll attach initi patch moment patch document morn write doc 1am never good idea
maven migrat checkstyle.properti xml newer checkstyl version use latest maven build use old properti configur file work xml configur file checkstyle.properti must migrat order use current version maven
authent respond stale nonc use digest authent http allow server mark nonc valu stale client must re-authent new nonc valu provid server current httpclient support function i'v creat patch allow httpclient support stale nonc valu attach patch appli httpmethodbase.java /home/scohen/downloads/httpclient-src/commons-httpclient-2.0-rc1/src/java/org/apache/commons/httpclient/httpmethodbase.java 2003-07-31 22:15:26.000000000 -0400 org/apache/commons/httpclient/httpmethodbase.java 2003-08-20 17:22:52.000000000 -0400 1351,1384 throw ioexcept error occur read write to/from connect throw httpexcept recover error occur protect void addauthorizationrequesthead httpstate state httpconnect conn throw ioexcept httpexcept log.trac enter httpmethodbase.addauthorizationrequesthead httpstate httpconnect add author header need getrequesthead httpauthenticator.www_auth_resp null header challeng getresponseheadergroup .gethead httpauthenticator.www_auth challenges.length 0 tri authschem authschem httpauthenticator.selectauthschem challeng httpauthenticator.authent authschem conn state catch httpexcept e log move log.iserroren log.error e.getmessag e add tt content-length /tt tt transfer-encod chunk /tt request header long tt content-length /tt request header alreadi exist 1351,1391 throw ioexcept error occur read write to/from connect throw httpexcept recover error occur protect void addauthorizationrequesthead httpstate state httpconnect conn throw ioexcept httpexcept log.trac enter httpmethodbase.addauthorizationrequesthead httpstate httpconnect add author header need header challeng getresponseheadergroup .gethead httpauthenticator.www_auth challenges.length 0 tri authschem authschem httpauthenticator.selectauthschem challeng getrequesthead httpauthenticator.www_auth_resp null || isnoncestal authschem httpauthenticator.authent authschem conn state catch httpexcept e log move log.iserroren log.error e.getmessag e privat boolean isnoncestal authschem authschem return authscheme.getschemenam .equalsignorecas digest true .equalsignorecas authscheme.getparamet stale add tt content-length /tt tt transfer-encod chunk /tt request header long tt content-length /tt request header alreadi exist 2419,2430 buffer.append port buffer.append buffer.append authscheme.getid string realm buffer.tostr realmsused.contain realm log.isinfoen log.info alreadi tri authent realm still receiv statuscod 2426,2442 buffer.append port buffer.append buffer.append authscheme.getid string realm buffer.tostr check see server made nonc stale re-auth realmsused.contain realm isnoncestal authschem return fals log.isinfoen log.info alreadi tri authent realm still receiv statuscod
infinit loop 302 redirect differ host locat header use cvs version 2.1 rc think tri get url content url followredirect specifi strictmod get 302 redirect differ url differ host locat header caus go infinit loop merci abort 100 redirect exampl offend url http //www.snowcrest.net/mice/mice.htm problem lie httpmethodbase.java version 1.177 line 1225 follow getrequesthead host null log.debug request add host header ignor header alreadi ad return alreadi host header previous url request endless loop abort max redirect default 100 guess comment work fine
minor typo org.apache.commons.httpclient.wir 2.0-rc1 minor typo may noy null public static final void output final string public static final void input final string org.apache.commons.httpclient.wir
crash get redirect get follow crash vfs code call httpclient code work older version httpclient belief n't appear work cvs head henc post note 'm sorri n't know method call hope redirect redirect bug stand irrespect major ruper cos first thing attempt read content locat regard adam java.lang.nullpointerexcept org.apache.commons.httpclient.httpmethoddirector.processredirectrespons httpmethoddirector.java:454 org.apache.commons.httpclient.httpmethoddirector.isretryneed httpmethoddirector.java:639 org.apache.commons.httpclient.httpmethoddirector.executemethod httpmethoddirector.java:145 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:378 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:268
error releas chunk connect respons bodi httpmethodbase.releaseconnect success releas connect close respons stream throw except
patch support digest auth md5-sess attempt access devic requir digest authent use md5-sess seem support
socket stream close incorrect order httpconnect close streams/socket follow order outputstream inputstream socket http //java.sun.com/docs/books/tutorial/networking/sockets/readingwriting.html
httpconnection.isresponseavail call setsotimeout catch ioexcept httpconnection.isresponseavail throw ioexcept set sotimeout probabl return fals case http //marc.theaimsgroup.com/ t=106268485100002 r=1 w=2
return valu postmethod removeparamet httpclient2.0-rc1 public boolean removeparamet string paramnam throw illegalargumentexcept method postmethod method new postmethod uri method.addparamet name matsui hideki boolean b b method.removeparamet name return true b method.removeparamet xxxx return true sorri poor english
postmethod setparamet httpclient2.0-rc1 code fragment 1 postmethod method new postmethod uristr method.addparamet tel 1111-1111 method.addparamet tel 2222-2222 method.setparamet tel 3333-3333 post data sent tel=1111-1111 tel=2222-2222 tel=3333-3333 post data hope tel=3333-3333 code fragment 2 postmethod method new postmethod uristr method.addparamet tel 1111-1111 method.addparamet tel 2222-2222 method.addparamet tel 3333-3333 post data sent tel=1111-1111 tel=2222-2222 tel=3333-3333 differ code 1 code2 sorri poor english
connectiontimeoutexcept n't releaseconnect connectiontimeoutexcept thrown httpconnect n't seem releas connect instead connect proper releas interruptedioexcept thrown pattern use tri method.execut method.getresponsebodyasstr catch connectiontimeoutexcept cte catch interruptedioexcept ioe final method.releaseconnect log.info releas follow log show actual releas perform messag releas log 10544 debug maincheck2 httpclient.httpconnect enter httpconnection.isresponseavail int 10930 warn maincheck1 httpclient.httpconnect host www.pccomputing.com:80 proxi null -1 accept connect within timeout 3000 millisecond 10931 warn maincheck1 checkperform connect timeout occurred.. org.apache.commons.httpclient.httpconnect connectiontimeoutexcept org.apache.commons.httpclient.httpconnection.open httpconnection.java:659 persistencecheck maincheck.run persistencecheck.java:306 10932 info maincheck1 checkperform releas call httpconnection.releaseconnect perform thank
default behaviour useexpecthead suggest set expectcontinuemethod.setuseexpecthead per default fals arrang per default use lost awful lot time project use multipartpostmethod via proxi everth work fine dev howev soon start use proxi product test environ sever problem lost sever manday look problem includ snif log op proxi end useexpecthead true per default put fals end problem opinion bit hard make someth default behaviour javadoc warn snip handshak use caution may caus problem http server proxi support http/1.1 protocol /snip regard dirkp
problem isipv4address relat uri 's follow block code tri uri uri new uri http //10.0.1.10:8830 system.out.println ip= +uri isipv4address uri new uri uri /04-1.html system.out.println ip= +uri isipv4address catch uriexcept e return output ip=tru ip=fals creat relat uri uri object n't right set isipv4address
add abil disabl content-typ transfer encod header part
connect releas recover except occur pleas see url discuss detail
freez w/ multithreadedhttpconnectionmanag singl thread user vfs httpclient user use multithreadedhttpconnectionmanag hang suspect indefinit minor activ ve turn httpclient debug see last line last thing get 2003/10/09 09:34:26:482 mdt debug wire content-typ text/html \r \n 2003/10/09 09:34:26:482 mdt debug httpmethodbas -resort protocol version default close co nnection polici 2003/10/09 09:34:26:492 mdt debug httpmethodbas -should close connect use http/1.1 2003/10/09 09:34:26:502 mdt debug httpmethoddirector -execut loop tri 1 2003/10/09 09:34:26:512 mdt debug multithreadedhttpconnectionmanag -httpconnectionmanager.getc onnect config hostconfigur host=www.ibiblio.org protocol=http:80 port=80 timeout 0 2003/10/09 09:34:26:522 mdt debug multithreadedhttpconnectionmanag -unabl get connect wait hostconfig=hostconfigur host=www.ibiblio.org protocol=http:80 port=80 pretti reproduc hack vfs use multithreadedhttpconnectionmanag n't get problem
defaulthttpparamsfactori violat applet sandbox defaulthttpparamsfactori night build 20031009 make two call system.getproperti default verboten applet patch sourc catch secur except set properti default valu modifi code block follow todo remov provid backward compat tri string agent system.getproperti .getproperti httpclient.userag agent null params.setparamet httpmethodparams.user_ag agent catch securityexcept dontcar todo remov provid backward compat tri string preemptivedefault system.getproperti .getproperti httpclient.authentication.preempt preemptivedefault null preemptivedefault preemptivedefault.trim .tolowercas preemptivedefault.equ true params.setparamet httpclientparams.preemptive_authent els preemptivedefault.equ fals params.setparamet httpclientparams.preemptive_authent catch securityexcept dontcar
invalid cooki caus illegalargumentexcept bug report oliv kll listen quimby.d httpclient mail list quot 'm deal site serv invalid cooki various kind way case cooki valu contain charact realli confus header/cooki parser eventu lead illegalargumentexcept thrown cooki constructor java.lang.illegalargumentexcept cooki name may blank org.apache.commons.httpclient.cookie. init cookie.java:142 org.apache.commons.httpclient.cookie.cookiespecbase.pars cookiespecbas .java:192 org.apache.commons.httpclient.cookie.cookiespecbase.pars cookiespecbas .java:256 org.apache.commons.httpclient.httpmethodbase.processresponsehead http methodbase.java:1826 org.apache.commons.httpclient.httpmethodbase.readrespons httpmethodbas .java:1939 org.apache.commons.httpclient.httpmethodbase.processrequest httpmethodba se.java:2631 org.apache.commons.httpclient.httpmethodbase.execut httpmethodbase.java :1085 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:6 74 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:5 29 my.code.test.gethttp test.java:114 bother illegalargumentexcept never caught httpclient code make effectivili imposs handl respons /quot
updat connectionstalecheckingen doc comment itai brickner thread section userguid http //jakarta.apache.org/commons/httpclient/threading.html mention setconnectionstalecheckingen also felt n't clear apidoc http //jakarta.apache.org/commons/httpclient/apidocs/org/apache/commons/httpclient/multithreadedhttpconnectionmanager.html stalecheckingen caus stale connect reconnect multithreadedhttpconnectionmanag thank itai
abil ignor reject cooki altogeth look way ignor cooki altogeth n't appear one could definit use capabl right see other make use time
manual set cooki author header get discard httpclient discard cooki author header includ manual set popul request header collect automat generat header
set connection_timeout so_timeout per-method basi capabl set connect timeout socket timeout per-method basi provid would enabl differ thread share httpclient set differ timeout method execut
multithreadedhttpconnectionmanag daemon thread never gc 'd one colleagu invok httpclient way loop someth like int 0 300 i++ getmethod method new getmethod http //cvs.apache.org/viewcvs/jakarta-commons/httpclient/ tri httpclient httpclient new httpclient new multithreadedhttpconnectionmanag httpclient.executemethod method byte byte method.getresponsebodi final alway releas connect re done method.releaseconnect 's process revis code n't loop develop might point non-optim use along way discov daemon thread multithreadedhttpconnectionmanag make get garbag collect cours connect manag also never gc 'd think avoid problem code general case client may actual abl control number multithreadedconnectionmanag creat could eventu caus problem make think problem deserv patch found problem 2.0rc2 although presum also exist cvs head patch follow
ms proxi ntlm authent set work tri go via ms proxi set ntlm authent alway get 407 error matter credenti use
cooki doc outdat cooki doc reflect latest code chang
ntlm proxi basic host author use microsoft proxi ntlm valid enabl author remot host work cours assum page correct fetch current see ntlm authent bug number 24327
provid support non-ascii charset multipart disposition-cont header follow line getasciibyt data.getbyt us-ascii return string modifi latin charact ex document non-control document non-control
httpclient loop endless tri retriev status line fed wrong url exampl http //localhost:19/ chargen port httpclient loop endless attempt read status line caus bug httpmethodbase.readstatuslin httpstate httpconnect loop without except abort condit wire log excerpt 2003/11/10 12:33:04:085 cet debug httpmethoddirector -execut loop tri 1 2003/11/10 12:33:04:312 cet debug wire get http/1.1 \r \n 2003/11/10 12:33:04:351 cet debug httpmethodbas -ad host request header 2003/11/10 12:33:04:532 cet debug wire user-ag jakarta commons-httpcli \r \n 2003/11/10 12:33:04:554 cet debug wire host localhost:19 \r \n 2003/11/10 12:33:04:559 cet debug wire \r \n 2003/11/10 12:33:04:639 cet debug wire *+ -./0123456789 abcdefghijklmnopqrstuvwxyz ^_ abcdefgh \r \n 2003/11/10 12:33:04:669 cet debug wire *+ -./0123456789 abcdefghijklmnopqrstuvwxyz ^_ abcdefghi \r \n 2003/11/10 12:33:04:673 cet debug wire *+ -./0123456789 abcdefghijklmnopqrstuvwxyz ^_ abcdefghij \r \n 2003/11/10 12:33:04:692 cet debug wire *+ -./0123456789 abcdefghijklmnopqrstuvwxyz ^_ abcdefghijk \r \n 2003/11/10 12:33:04:698 cet debug wire *+ -./0123456789 abcdefghijklmnopqrstuvwxyz ^_ abcdefghijkl \r \n 2003/11/10 12:33:04:703 cet debug wire *+ -./0123456789 abcdefghijklmnopqrstuvwxyz ^_ abcdefghijklm \r \n snip
basic authentif fail non-ascii username/password charact http //marc.theaimsgroup.com/ t=106866959500001 r=1 w=2
digestscheme.authent return invalid author string algorithm null digestscheme.authent return invalid author string algorithm null trace bug found follow method call authent credenti credenti string method string uri call authent usernamepasswordcredenti credenti map param call createdigest string unam string pwd map param proper default algorithm md5 null final call createdigesthead string unam map param string digest default algorithm md5 null
javadoc often code without /code mention lot javadoc comment read like tt fals /ff otherwis print rest document tt ca n't give complet list happen often check go bottom page see appear tt code
basicauthenticatonexample.java cvs exampl cvs revis 1.1.2.1 code would lead beliv setcredenti use host realm credienti actual realm host credienti look like correct revis 1.1 chang revis 1.1.2.1 pass credenti httpclient use authent server realm realm authent again arbitrari realm chang null client.getst .setcredenti www.verisign.com realm new usernamepasswordcredenti usernam password
cooki reject hello 'm use httpclient 1.0 rc2 login sourceforg websit perform oper 'm get follow error page 1 https //sourceforge.net/account/login.php 6 dc 2003 23:45:27 org.apache.commons.httpclient.httpmethodbas processresponsehead attent cooki reject username=l6qpwtk5hp 3d illeg domain attribut .sourceforge.net domain origin sourceforge.net 6 dc 2003 23:45:27 org.apache.commons.httpclient.httpmethodbas readresponsebodi cooki return sourceforg reject domain request sourceforge.net domain cooki .sourceforge.net tri chang cooki polici avail option none work cookiepolicy.setdefaultpolici cookiepolicy.compat thank ludov
except writerequest leav connect un-releas execut method follow simplifi flow 1 get connect 2 write request 3 read result 4 releas connect releas step 4 happen input complet read work fine except occur step 1 2 connect also releas proper howev except occur step 2 connect never releas back connect manag eventu run connect easiest way test make simpl subclass postmethod overrid writerequest method public class testconnectionreleasemethod extend postmethod protect void writerequest httpstate state httpconnect conn throw ioexcept httpexcept throw new ioexcept test
auto close idl connect mention sever time mail list recent http //nagoya.apache.org/eyebrowse/readmsg listname=commons-httpclient-dev jakarta.apache.org msgno=5191 desir http client close 's connect configur idl time fail caus server everi tcp resourc keep socket open possibl run resourc load http 1.1 rfc say section 8.1.4 server usual time-out valu beyond longer maintain inact connect proxi server might make higher valu sinc like client make connect server use persist connect place requir length exist time-out either client server client server wish time-out issu grace close transport connect client server constant watch side transport close respond appropri client server detect side 's close prompt could caus unnecessari resourc drain network first sentenc 2nd paragraph interest client suppos grace close simpli mean close socket one possibl may issu http/option request connect close header
cleanup use encodingutil httpconstant httpconstant becom somewhat irrelev deprec httpconstant move exist function encodingutil
redesign http authent framework exist http authent framework got glare defici authent header manag evolv degrad sort black art prove error-pron exist logic intend deal authent failur authent failur recoveri flaw resolut httpclient-213 appear possibl without better approach one base authschem getid top authent logic got quit messi seri attempt fix breakag complex authent scheme latest ntlm proxi basic host fix patch attach attempt address shortcom mention build upon previous patch enabl authent scheme maintain authent state present complet redesign exist http authent framework basic 's authent code left untouch pleas take closer look critiqu comment suggest welcom oleg
ioexcept runtimeexcept leav under socket undetermin state applic level ioexcept runtimeexcept occur under socket undetermin state mani case lead zombi connect pool respond proper simpl exampl upload file via post promis server 1mb data short start transfer ioexcept occur e.g nfs server file resid stop respond connect return pool see httpclient-302 server still expect close 1mb data socket next request socket e.g get send http header server think header part old stream doesn't respond
log level messag debug instead error method org.apache.commons.httpclient.httpmethodbase.getresponsebodi log messag log debug instead error 717 catch ioexcept e 718 log.error i/o failur read respons bodi e 719 this.responsebodi null 720 accord httpclient-57 2 only/alway log except stack trace debug level catch except ex log.debug
rfe allow stream post method via chunk transfer encod rfe possibl implement attach implement modifi exist code re use http post send larg amount data unknown size n't want buffer entir request implement stream post method implement 3 class streamedpostmethod bufferedchunkedoutputstream outputstreamwrit bulk code bufferedchunkedoutputstream may good target replac chunkedoutputstream main distribut bufferedchunkedoutputstream follow charactersit 1 intern 2k buffer without buffer chunk size would small mani case e.g objectoutputstream like call write byte 4 byte long argument 2k chosen minim chunk overhead less 1 2 entir entiti bodi fit within 2k buffer use chunk impli header sent first chunk entir bodi written sooner 3 chunk size limit 2k write byte call larg argument intern buffer new request sent singl chunk 4 2 's tight coupl streamedpostmethod.reallywritehead 5 streamedpostmethod call bufferedchunkedoutputstream.finish write last buffer end chunk 4 5 n't want touch chunkedoutputstream interest entityenclosingmethod alreadi tight coupl chunkedoutputstream call writeclosingchunk probabl room refactor packag suggest feel free move file appropir code written 2.0rc2 re hope get includ time 2.1 releas use code must implement outputstreamwrit pass streamedpostmethod 's constructor execut method usual caveat streamedpostmethod implement expect/continu logic way test also strict post general methodolog applic put etc fair simpl general legal goldman sach co. make code avail apach licens
memori leak multithreadedhttpcli caus bad .equal note 2.0 releas candid 1 'm sure version translat bug definit present current sourc multithreadedhttpcli use follow code look list connect given config hostconnectionpool listconnect hostconnectionpool maphosts.get hostconfigur listconnect null first time config listconnect new hostconnectionpool listconnections.hostconfigur hostconfigur maphosts.put hostconfigur listconnect hash map reli hostconfigur 's .equal resolv equal determin map configur hostconfigur follow 's .equal method protocol.equ config.getprotocol return fals protocol obj instanceof protocol protocol p protocol obj return defaultport p.getdefaultport scheme.equalsignorecas p.getschem secur p.issecur socketfactory.equ p.getsocketfactori howev .equal method protocolsocketfactori object n't note interfac necess .equal method
getschem getport return wrong default httpsurl getschem call instanc httpsurl wrong return http instead https 's dynam data bind n't work final static field see default_schem
updat licens term copyright 1999-2003 apach softwar foundat licens apach licens version 2.0 licens may use file except complianc licens may obtain copi licens http //www.apache.org/licenses/license-2.0 unless requir applic law agre write softwar distribut licens distribut basi without warranti condit kind either express impli see licens specif languag govern permiss limit licens
improp eol text file window version 2.0-rc3 improp eol text file window readme.txt license.txt docs/*.txt file display one loooong line notepad
new socket timeout valu wont effect connect reus report teemu tingand teemu.tingand tecnomen.fi jakarta common httpclient develop list snip chang read timeout wont affect success method execut use connection.. seem bug httpclient class method executemethod hostconfigur problemat section seem section check connect open method.setstrictmod strictmod connection.isopen connection.setconnectiontimeout connectiontimeout connection.setsotimeout sotimeout connection.open connection.isproxi connection.issecur method new connectmethod method problem solv move line section method.setstrictmod strictmod connection.setsotimeout sotimeout connection.isopen connection.setconnectiontimeout connectiontimeout connection.open connection.isproxi connection.issecur method new connectmethod method /snip
httpurl creat wrong author string user info chang chang user info exist httpurl addit port inform new author string contain wrong hostnam part instead get hostnam portnumb string hostnameportnumb i.e miss method need chang setrawpassword setrawus setrawuserinfo look line string hostport _port -1 hostnam hostnam _port andrea fnger esign softwar gmbh
releas sign signatur checksum avail latest releas
http client n't support multipart/rel content-typ possibl sent data eas multipart/rel content-typ discrib rfc 2387 use http client
host configur properti updat method redirect uri http //www.adobe.com/cgi-bin/redirect http //lists.w3.org/archives/public/www-xsl-fo generat two 302 respons origin http //lists.w3.org/archives/public/www-xsl-fo http //lists.w3.org/archives/public/www-xsl-fo/ client accept follow redirect trace process show 's work well ask getmethod uri end use geturi method return bastardis result http //www.adobe.com/archives/public/www-xsl-fo/ instead correct http //lists.w3.org/archives/public/www-xsl-fo/ client actual download use cvsup 'd copi show version string jakarta commons-httpclient/2.1m1
arrayindexoutofbound except invalid content-length server return invalid parsabl int content legnth method protect int getresponsecontentlength httpmethodbas walk end header array throw arrayindexoutofboundsexcept loop line 687 httpmethodbase.java int headers.length 1 0 i++ start end array use ++ intead walk end array next line header invalid header valid return statement tri block succeed error fix simpli chang line int headers.length -1 =0
socket close ioexcept thrown httpconnect httpclient.java modifi version 2.0 final method executemethod call connection.setsotimeout use rc3 call connection.isopen final version call happen call isopen result chang setsotimeout call could throw ioexcept close socket would fix problem ad httpconnection.setsotimeout similar method httpconnect explicit check call isopen whether socket close exist socket object guarante i.e follow code public void setsotimeout int timeout throw socketexcept illegalstateexcept log.debug httpconnection.setsotimeout timeout sotimeout timeout socket null socket.setsotimeout timeout would chang public void setsotimeout int timeout throw socketexcept illegalstateexcept log.debug httpconnection.setsotimeout timeout sotimeout timeout isopen socket.setsotimeout timeout
wrong charset indic httpconstants.getcontentstr around line 236 httpconstants.getconstentstr charset wrong indic default_content_charset indic charset like getcontentbyt function log.iswarnen log.warn unsupport encod default_content_charset variabl charset default http encod use wrong copy/past guess zc
deprec replac simplehttpconnect simplehttpserv base test framework thank christian kohlschuett odi flexibl test framework enabl us emul pretti much aspect http server function includ non-compli behavior various vendor specif implement quirk mani mani thank go christian kohlschuett contribut origin code propos simplehttpconnect deprec eventu phase took first step toward goal migrat basic authent test case urg committ contributor use simplehttpserv new case ideal futur even abl get rid tomcat depend test also took liberti tweak simplehttpserv api littl factor simplerequest simplerespons class provid new interfac call httpservic use instead httprequesthandl implement test case way similar write servlet ll commit patch short realli touch _productive_ code oleg
getmethod.getresponsebodyasstream .avail could return content-length would nice inputstream return getmethod.getresponsebodyasstream could overrid avail method return content-length request url would make thing like progressmonitorinputstream use monitor progress download code snippet suppli hard-cod valu avail method class fixedinputstream extend filterinputstream privat int contentlength public fixedinputstream inputstream int contentlength super this.contentlength contentlength public int avail throw ioexcept return contentlength also somewhat relat request could getmethod.getresponsecontentlength must made public good reason protect extend getmethod implement public getresponsecontentlength order feed valu fixedinputstream thank time
api doc document except thrown execut method detail document httpclient :executemethod httpmethod :execut except thrown case
deadlock multithreadedhttpconnectionmanag 'm get dealock multithreadedhttpconnectionmanag usual work fine web page redirect block ludov error redirect http //sourceforge.net/ full thread dump java hotspot tm client vm 1.4.2_03-b02 mix mode multithreadedhttpconnectionmanag cleanup daemon prio=5 tid=0x02d566f0 nid=0xe14 object.wait 2e9f000..2e9fd8c java.lang.object.wait nativ method wait 0x10513be8 java.lang.ref.referencequeu lock java.lang.ref.referencequeue.remov unknown sourc lock 0x10513be8 java.lang.ref.referencequeu lock java.lang.ref.referencequeue.remov unknown sourc org.apache.commons.httpclient.multithreadedhttpconnectionmanag referencequeuethread.run multithreadedhttpconnectionmanager.java:805 signal dispatch daemon prio=10 tid=0x0003da00 nid=0xd44 wait condit 0..0 final daemon prio=9 tid=0x009bca30 nid=0xce8 object.wait 2b5f000..2b5fd8c java.lang.object.wait nativ method wait 0x10504b80 java.lang.ref.referencequeu lock java.lang.ref.referencequeue.remov unknown sourc lock 0x10504b80 java.lang.ref.referencequeu lock java.lang.ref.referencequeue.remov unknown sourc java.lang.ref.fin finalizerthread.run unknown sourc refer handler daemon prio=10 tid=0x009bb600 nid=0xfa4 object.wait 2b1f000..2b1fd8c java.lang.object.wait nativ method wait 0x10504be8 java.lang.ref.refer lock java.lang.object.wait unknown sourc java.lang.ref.refer referencehandler.run unknown sourc lock 0x10504be8 java.lang.ref.refer lock main prio=5 tid=0x00035e28 nid=0xf68 object.wait 7f000..7fc3c java.lang.object.wait nativ method wait 0x105170e8 org.apache.commons.httpclient.multithreadedhttpconnectionmanag connectionpool org.apache.commons.httpclient.multithreadedhttpconnectionmanager.dogetconnect multithreadedhttpconnectionmanager.java:388 lock 0x105170e8 org.apache.commons.httpclient.multithreadedhttpconnectionmanag connectionpool org.apache.commons.httpclient.multithreadedhttpconnectionmanager.getconnect multithreadedhttpconnectionmanager.java:296 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:645 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:529 net.sourceforge.cvsgrab.webbrowser.executemethod webbrowser.java:201 net.sourceforge.cvsgrab.webbrowser.getrespons webbrowser.java:257 net.sourceforge.cvsgrab.webbrowser.getdocu webbrowser.java:295 net.sourceforge.cvsgrab.cvswebinterface.loaddocu cvswebinterface.java:111 net.sourceforge.cvsgrab.cvswebinterface.getdocumentfordetect cvswebinterface.java:216 net.sourceforge.cvsgrab.cvswebinterface.findinterfac cvswebinterface.java:86 net.sourceforge.cvsgrab.cvsgrab.detectwebinterfac cvsgrab.java:688 net.sourceforge.cvsgrab.cvsgrab.grabcvsrepositori cvsgrab.java:616 net.sourceforge.cvsgrab.cvsgrab.run cvsgrab.java:317 net.sourceforge.cvsgrab.cvsgrab.main cvsgrab.java:206 vm thread prio=5 tid=0x009f76d0 nid=0x550 runnabl vm period task thread prio=10 tid=0x009f8208 nid=0x560 wait condit suspend checker thread prio=10 tid=0x009bed88 nid=0xe84 runnabl
multithreadedconnectionmanag provid shutdown multithreadedconnectionmanag provid shutdown method releas resourc current use daemon thread stop http connect releas annoy pool connect creat within web applic undeploy re-deploy i.e jvm restart consum resourc local remot server
proxi tunneling/auth connect non-http protocol httpclient would even use support connect tunnel proxi proxi authent non-http protocol e.g binari protocol ssh jxta-tcp could tunnel web proxi httpclient provid access under socket negoti auth connect web proxi complet
api doc compil perform optim guid perform optim guid long overdu bad need peopl start use httpclient sort creativ way go need oleg
patch wirelog correct patch fix problem report geir h. pettersen geir cellus.no see http //marc.theaimsgroup.com/ t=108072355300004 r=1 w=2 detail increas prioriti http request/status line http header output debug info quit often request/respons content generat excess amount output wirelog produc valuabl debug inform ever set wirelog verbos info one turn log request/respons content believ patch appli cvs head 2.0 branch pleas let know agre oleg
patch httpclient gethost httpclient getport method mislead httpclient gethost httpclient getport method mislead accompani obsolet factual wrong javadoc deprec oleg
connect timeout logic redesign changelog createsocket method timeout paramet ad protocolsocketfactori interfac timeoutcontrol relat code factor httpconnect class move controllerthreadsocketfactori helper class reflectionsocketfactori helper class ad factori encapsul reflect code call jdk 1.4 socket connect method support protocol socket factori attempt initi use reflectionsocketfactori requir creat socket within given limit time reflect fail protocol socket factori fall back onto good ol controllerthreadsocketfactori benefit httpconnect code got lot cleaner run modern jres expens timeout control thread per connect attempt longer need ugli code intend work around limit older jres confin helper class easili thrown away move onto java 1.4 let know think oleg
per socket sock proxi httpclient requir way allow sock proxi use connect without requir creat socket go proxi
handl sub-domain cooki notic differ behaviour httpclient common browser ie/mozilla web site set cooki beta.gamma.com cooki sent request alpha.beta.gamma.com sure cooki spec say mozilla ie even http :cooki modul lwp seem behav differ httpclient httpclient seem reli lead dot domain name like .beta.gamma.com
arrayindexoutofboundsexcept httpstatus.getstatustext 508 tri follow system.out.println status text httpstatus.getstatustext 507 tri system.out.println status text httpstatus.getstatustext 508 catch except ex system.err.println except msg ex.getmessag ex.printstacktrac system.out.println status text httpstatus.getstatustext 509 507 return messag expect 508 arrayindexoutofboundsexcept 509 null expect
move content-typ requestent content type realli properti requestent move
httpurl accept unescap password taken email gustav munkbi post httpclient dev mail list httpurl url new httpurl kurt nicepass hostnam 80 path throw uriexcept messag port number invalid first messag wrong next attempt urlencod password result line work password sent url-encod destin hard desir behaviour
api doc improv descript preemptiv authent httpclient authent guid reflect fact preemptiv authent requir default credenti set also mention secur implic preemptiv authent default credenti sent everi request target proxi server
api doc compil new prefer architectur http parameter guid document new prefer architectur base hierarchi httpparam collect well avail paramet option
httpconnection.isopen log accur isopen differenti stale close connect close isstal return true log indic connect stale even though realli close close also call second time unnecessarili fix 3.0 perhap even 2.0.1 http //nagoya.apache.org/eyebrowse/readmsg listname=commons-httpclient- dev jakarta.apache.org msgno=7205
contrib ssl authent protocol socket factori 's long promis ssl client/serv authent socket factori socket factori use enforc client/serv authent ssl context negoti let know think pleas pleas someon proof-read accompani javadoc let know text comprehens also tweak easysslprotocolsocketfactori littl patch httpclient_2_0_branch oleg
cooki name contain blank start reject rfc2109 spec report john patterson cooki class like name space throw illegalargumentexcept unfortun server app interact use space cooki name ie mozilla n't mind
multithreadedconnectionmanag account problem getconnectionsinpool certain intut name alreadi mention certain need connect killer method multithreadedhttpconnectionmanager.destroyidleconnect long idletim also would recommend one method could spit connect statist time given connect manag great method test purpos well multithreadedhttpconnectionmanager.displaycurrentstatist curent connect statist total connectino pool 10 open connectino 3 close connect 5 stale connect 2 even adventur could extend report averag wait time connect 1356 ms maximum wait time connectino 1892 ms
credenti ignor realm specifi preemptiv authent specifiy credenti specif realm use preemptiv authent credenti ignor first tri error 401 back httpclient client new httpclient manag client.getst .setcredenti myrealm myhost new usernamepasswordcredenti user password client.getst .setauthenticationpreempt true myrealm ignor httpstate 's matchcredenti privat method preemptiv authent call null realm privat static credenti matchcredenti hashmap map string realm string host httpauthrealm entri new httpauthrealm host realm possibl match map contain version realm credenti cred credenti map.get entri cred null host null realm null entri new httpauthrealm host null cred credenti map.get entri cred null entri new httpauthrealm null realm cred credenti map.get entri cred null cred credenti map.get default_auth_realm return cred quit logic sinc realm come server n't contact server first preemptiv authent possibl set realm use preemptiv mode least silent ignor current workaround set realm null setcredenti eleg work regard philipp
httpstate matchcredenti broken credenti match algorithm flaw generat unnecessari garbag instanti intermedi object lookup
split wire log header content part
allow polymorph use addparamet common code revers proxi server use addparamet instanc postmethod multipartpostmethod would great either addparamet made abstract method expectcontinuemethod made implement common base class 's workaround privat void addpostparamet expectcontinuemethod method string name string valu method instanceof postmethod postmethod method .addparamet name valu els method instanceof multipartpostmethod multipartpostmethod method .addparamet name valu els throw new illegalargumentexcept addpostparamet defin postmethod multipartpostmethod whoa smell pretti bad
set differ max_host_connect valu per host use singl multithreadedhttpconnectionmanag right 's possibl use multithreadedhttpconnectionmanager.setmaxconnectionsperhost int method per hostconfigur basi valu appli everi hostconfigur current connect manag manag would quit use allow connect manag set differ valu depend hostconfigur
api doc authent guid updat altern authent add section altern authent
auto method retrial broken folk work except handl guid 3.0-alpha2 releas stumbl upon problem httptimeoutexcept subclass 3.0a1 httptimeoutexcept subclass httprecoverableexcept caus http method fail due connect socket timeout automat retri info httpmethoddirector -recover except caught process request info httpmethoddirector -recover except caught process request info httpmethoddirector -recover except caught process request info httpmethoddirector -recover except caught process request warn httpmethoddirector -recover except caught methodretryhandler.retrymethod return fals rethrow except org.apache.commons.httpclient.iotimeoutexcept read time org.apache.commons.httpclient.httpconnect wrappedinputstream.handleexcept httpconnection.java:1350 org.apache.commons.httpclient.httpconnect wrappedinputstream.read httpconnection.java:1360 java.io.filterinputstream.read filterinputstream.java:66 java.io.pushbackinputstream.read pushbackinputstream.java:120 org.apache.commons.httpclient.httpparser.readrawlin httpparser.java:76 org.apache.commons.httpclient.httpparser.readlin httpparser.java:104 org.apache.commons.httpclient.httpconnection.readlin httpconnection.java:1054 org.apache.commons.httpclient.httpmethodbase.readstatuslin httpmethodbase.java:1785 org.apache.commons.httpclient.httpmethodbase.readrespons httpmethodbase.java:1546 org.apache.commons.httpclient.httpmethodbase.execut httpmethodbase.java:977 org.apache.commons.httpclient.httpmethoddirector.executewithretri httpmethoddirector.java:383 org.apache.commons.httpclient.httpmethoddirector.executemethod httpmethoddirector.java:164 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:437 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:324 test.main test.java:13 caus java.net.sockettimeoutexcept read time java.net.socketinputstream.socketread0 nativ method java.net.socketinputstream.read socketinputstream.java:129 java.net.socketinputstream.read socketinputstream.java:182 org.apache.commons.httpclient.httpconnect wrappedinputstream.read httpconnection.java:1358 13 except thread main probabl want besid non-idempot method may simpli fatal result sort unpleas side-effect one possibilti person favour make httptimeoutexcept class extend ioexcept instead httprecoverableexcept other question whether timeout except consid recover conseptu standpoint think oleg
stringrequestentity.getcontentlength wrong multibyt char set postmethod contain stringrequestent umlaut charset utf-8 content-length header wrong number byte number char e.g content-typ text/xml charset=utf-8 body=  bug-loc org.apache.commons.httpclient.methods.stringrequestent
question default valu bufferedoutputstream size httpconnect dev list hi eric thank bring httpclient 3.0 allow parameter so_sndbuf so_rcvbuf set httpclient 2.0 well 3.0 fall back onto system default howev would make sens set cap size send receiv buffer feel free open ticket issu bugzilla oleg fri 2004-07-02 18:39 eric bloch wrote hi httpclient folk ve look 2.0 sourc code default valu bufferedoutputstream use httpconnectionn come socket.getsendbuffers hunch general bigger 'd want http send less 1kbyte cept big post default valu get socket.getsendbuffers 8192 would think better default buffer would 1k also fyi someon happen dork system send buffer size hi say mb use multithreadedconnectionmanag 2.0 dunno 3.0 use lot memori connect sinc pool n't let idl connect buffer gced got bit bad -eric
statuslin indexoutofbound report sam berlin develop mail list 'm sure problem still cvs head re see 2.0rc2 statuslin line 139 version walk space possibl entir line space thus malform respons code throw stringindexoutofboundsexcept instead correct httpexcept see follow bug http //bugs.limewire.com/bugs/ searching.jsp disp1=l disp2=c disp3=o disp4=j l=151 c=204 m=416_205 thank sam
postmethod java doc refer wrong section rfc1945 http post method defin section 9.5 rfc1945 read http post method defin section 8.3 rfc1945 chang 9.5 8.3
patch charact encod handl invalid multipart hi commons-httpcli handl charact encod incorrect multipart signific problem english peopl like multipart two encod first header encod specifi header part second 's bodi encod bodi encod work well header encod fix asc-ii problem user follow situat upload file file name describ asc-ii use paramet includ asc-ii charact unfortun seem rfc n't defin header encod multipart lot peopl need set header encod thier laungag attach patch pleas fix problem regard takashi okamoto
miss skip -method contentlengthinputstream contentlengthinputstream miss skip -method caus intern pos variabl get sync content length obersev close stream caus wait time 15 sec routin use skip -method inputstream 's possibl implement solv problem public long skip long len throw ioexcept long count super.skip len pos += count return count
allow configur so_ling current way configur so_ling option socket pleas chang httpclient class allow configur so_ling option socket similar way so_timeout configur suggest extens interfac httpclient class add method setsoling set current set so_ling method could accept one argument negat valu could indic so_ling disabl add method getsoling return current set so_ling negat valu would indic so_ling option disabl see http //java.sun.com/j2se/1.4.2/docs/api/java/net/socket.html setsoling boolean 20int
chunk stream encod problem fail throw except use httpclient 2.0.1 sun 's jdk 1.4.1_01 connect site appar problem generat proper chunk output caus http client catch log except return null data ideal http client throw ioexcept call class handl programm 's problem except generat bug except trap somewher httpclient code 2004-08-27 21:19:01,013 main httpmethodbas error i/o failur read respons bodi java.io.ioexcept chunk stream end unexpect org.apache.commons.httpclient.chunkedinputstream.getchunksizefrominputstream chunkedinputstream.java:234 org.apache.commons.httpclient.chunkedinputstream.nextchunk chunkedinputstream.java:205 org.apache.commons.httpclient.chunkedinputstream.read chunkedinputstream.java:160 java.io.filterinputstream.read filterinputstream.java:111 org.apache.commons.httpclient.autocloseinputstream.read autocloseinputstream.java:110 java.io.filterinputstream.read filterinputstream.java:90 org.apache.commons.httpclient.autocloseinputstream.read autocloseinputstream.java:129 org.apache.commons.httpclient.httpmethodbase.getresponsebodi httpmethodbase.java:685 com.algorim.ei.cets.emailpreprocessor.processmessag emailpreprocessor.java:565 com.algorim.ei.cets.emailupdate.run emailupdate.java:332 com.algorim.ei.cets.emailupdate.main emailupdate.java:89 request respons caus error get /aeq.aspx k=32226 k=sb1313 xcorp5.com http/1.1 user-ag mozilla/4.0 compat msie 6.0 window nt 5.0 .net clr 1.1.4322 host 38.117.227.56 http/1.1 200 ok date fri 27 aug 2004 20:55:27 gmt server microsoft-iis/6.0 x-powered-bi asp.net x-aspnet-vers 1.1.4322 transfer-encod chunk cache-control privat content-typ text/html charset=utf-8 179 html head meta http-equiv=refresh content= 1 url=http //www.datingresults.com/default.asp p=7090 prm=38664 /head bodi script win2=win dow.open http //m.qmct.com/images/d.html a=1 newwin toolbar=0 width=730 height=500 win2 null win2.blur window.focus wind ow.loc http //www.datingresults.com/default.asp p=7090 prm=38664 /script /bodi /html
datepars refactor state cooki spec present datepars tight coupl defaulthttpparam class find sub-optim design standpoint moreov believ date pattern specifi method host client level global one current case sync rest prefer framework result quit bit confus refactor datepars class also realiz cooki spec share httpmethod instanc stateless even though present case technic 's noth prevent user implement state cooki spec plug httpclient potenti caus quit unpleas concurr issu therefor believ pluggabl cooki spec may share cooki spec instanc creat per method invoc oleg
api doc httpclient tutori updat bring tutori date latest best practic
httpstate.setcookiepolici complet ignor though method deprec current effect give warn noth patch fix problem come short mike
jvm bug 4949631 caus bufferoverflowexcept httpmethodbase.getresponsebodyasstr ava.nio.bufferoverflowexcept java.nio.charset.coderresult.throwexcept coderresult.java:259 java.lang.stringcod charsetsd.decod stringcoding.java:188 java.lang.stringcoding.decod stringcoding.java:224 java.lang.string. init string.java:320 org.apache.commons.httpclient.httpconstants.getcontentstr httpconstants.java:199 org.apache.commons.httpclient.httpconstants.getcontentstr httpconstants.java:233 org.apache.commons.httpclient.httpmethodbase.getresponsebodyasstr httpmethodbase.java:735 seem caus known jvm bug http //bugs.sun.com/bugdatabase/view_bug.do bug_id=4949631 string 16mb caus problem workaround list essenc split string call getbyt piec reassembl bytebuff
httpstate preemptive_properti remov code longer compil httpstate preemptive_properti remov code compil 2.0.1 see http //jakarta.apache.org/commons/httpclient/apidocs/org/apache/commons/httpclient/httpstate.html preemptive_properti
move multipart request new requestent type multipart post current handl via separ post method multipartpostmethod separ method unnecessari given new requestent mechan
hostconfigur handl requir cleanup discuss mail list host configur handl current appear faulti http //marc.theaimsgroup.com/ t=109644952000001 r=1 w=2 oleg
3.0 compile-tim compat 2.0 librari usag surpris oleg say intent yet jakarta-slid webdavcli librari compil box patch issu follow
access so_timeout open connect 'm tri access set page order maximum delay permiss complet oper includ follow redirect fetch complet page content need n't seem doabl right accord common-us list reset so_timeout properti socket read inputstream 'd need access httpconnect way set paramet object simplifi version 'm httpurl url new httpurl urlstr method.seturi url method.setfollowredirect fals method.getparam .setsotimeout remainingtim hostconfigur hostconfig new hostconfigur hostconfig.sethost url method.sethostconfigur hostconfig timeoutchecker.getremainingtim int statuscod client.executemethod hostconfig method state string pagecont isredirect statuscod timeoutchecker.istimeout throw new timeoutexcept total execut time fetch exceed timeout paramet els header locationhead method.getresponsehead locat httpurl nextloc new httpurl locationheader.getvalu .tochararray pagecont fetchget nextlocation.getescapeduri addresshold timeoutcheck state els issuccess statuscod least 4k buffer might big webpag int responses math.max getresponses method default_response_s inputstream respons method.getresponsebodyasstream bytearrayoutputstream outstream new bytearrayoutputstream responses byte buffer new byte responses int len ***todo need reset so_timeout remain time len response.read buffer outstream.writ buffer 0 len len 0 timeoutchecker.istimeout outstream.clos pagecont encodingutil.getstr outstream.tobytearray method.getresponsecharset response.clos els
catch sockettimeoutexcept interruptedioexcept coupl place re catch interruptedioexcept catch sockettimeoutexcept instead exampl httpconnect protect boolean isstal boolean isstal true isopen connect open see read assum connect stale isstal fals tri inputstream.avail 0 tri socket.setsotimeout 1 inputstream.mark 1 int byteread inputstream.read byteread -1 socket report data read probabl stale isstal true els inputstream.reset final socket.setsotimeout this.params.getsotimeout catch interruptedioexcept e aha connect stale continu catch interruptedioexcept intend happen inputstream.read termin due socket.setsotimeout time reach howev could also occur thread.interrupt call case continu happen instead request termin legitim reason someon might want interrupt httpclient code exampl httpclient provid hard timeout total length time request may take includ connect send request receiv complet respons enforc hard timeout necessari run request worker thread interrupt n't complet timeout expir techniqu use timeoutcontrol class note sockettimeoutexcept ad 1.4 compat older jdk version code catch interruptedioexcept use getclass see whether sockettimeoutexcept probabl place code interruptedioexcept caught interpret socket timeout thread.interrupt proper effect caus request termin asap 'm familiar enough code find
defaulthttpparamsfactory.getdefaultparam thread safe method getdefaultparam org.apache.commons.httpclient.params.defaulthttpparamsfactori thread safe code public httpparam getdefaultparam httpparam null httpparam createparam return httpparam possibl httpparam call one thread set httpparam second thread may call may find httpparam non-nul howev old java languag spec chapter 17 new java memori model second thread wo n't necessarili see valu first thread set referenc httpparam object easiest way fix jvms memori model declar getdefaultparam synchron
http.connection-manager.timeout long integ document wrong tabl prefer architectur page state http.connection-manager.timeout integ setparamet http.connection-manager.timeout new integ n caus java.lang.classcastexcept org.apache.commons.httpclient.params.defaulthttpparams.getlongparamet defaulthttpparams.java:171 org.apache.commons.httpclient.params.httpclientparams.getconnectionmanagertimeo ut httpclientparams.java:143 org.apache.commons.httpclient.httpmethoddirector.executemethod httpmethoddirector.java:161 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:437 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:324
provid date header util method hello would realli nice util method help set date header instanc like servlet spec 's setdatehead method allow client httpclient deal format date correct string parsed method turn string date would nice opposit method thank seth
ssl proxi host auth keep aliv caus infinit loop httpmethoddirector combin ssl tunnel host authent disabl persist connect support httpd keepal caus infinit loop httpmethoddirector problem report httpclient-dev list rindress macdonald rmacdona enterasys.com
deprec replac testwebapp simplehttpserv base test framework basic testwebapp base testcas test function tomcat rather httpclient tend get broken everi major releas tomcat proven burden good
provid addit test coverag http https proxi http https proxi test coverag still insuffici
connect close connect close request http specif http //www.w3.org/protocols/rfc2616/rfc2616- sec8.html chapter negoti state either client server send close token connect header request becom last one connect httpclient v2.0.2 v3.0 alpha2 current close connect server sent connect close header request contain
httpstate method clear cooki credenti
defaultmethodretryhandl bug defaultmethodretryhandl seem test correct number attempt retri given method seem bail one attempt earli executioncount this.retrycount retri max retri count return fals exampl set retrycount 1 httpclient retri method least 's 'm see step debugg
so_timeout paramet method level effect bug report httpclient user list ilya kharmatski ilyak -at- mainsoft.com
hostconfiguration.sethost string caus nullpointerexcept call sethost string hostconfigur object caus null pointer except far tell due incorrect call deprec sethost string string int protocol method rather sethost string int protocol public synchron void sethost final string host protocol defaultprotocol protocol.getprotocol http sethost host null defaultprotocol.getdefaultport defaultprotocol becom public synchron void sethost final string host protocol defaultprotocol protocol.getprotocol http sethost host defaultprotocol.getdefaultport defaultprotocol
releas connect unconfirm connect attempt releas use httpconnection.releaseconnect unclear whether actual done implement method follow 3.0-beta1 releas connect public void releaseconnect log.trac enter httpconnection.releaseconnect lock log.debug connect lock call releaseconnect ignor els httpconnectionmanag null log.debug releas connect back connect manag httpconnectionmanager.releaseconnect els log.warn httpconnectionmanag null connect relea silent ignor request releas connect case hard ever right thing opinion instead suggest method indic whether connect actual close see least 2 altern 1 throw except indic connect could releas 2 return flag indic whether connect could actual releas
error charact entiti javadoc httpversion error javadoc httpversion class class comment p http version specifi rfc 2616. /p p http use ltmajor gt. ltminor gt number scheme indic version protocol protocol version polici intend allow sender indic format messag capac understand http communic rather featur obtain via communic chang made version number addit messag compon affect communic behavior add extens field valu ltminor gt number increment chang made protocol add featur chang general messag pars algorithm may add messag semant impli addit capabl sender ltmajor gt number increment format messag within protocol chang see rfc 2145 36 fuller explan /p p version http messag indic http-version field first line messag /p pre http-version http 1*digit 1*digit /pre p note major minor number must treat separ integ may increment higher singl digit thus http/2.4 lower version http/2.13 turn lower http/12.3 lead zero must ignor recipi must sent /p note charact entiti less-than greater-than proper end semi-colon attach propos fix
typo multithreadedhttpconnectionmanag ve done review multithreadedhttpconnectionmanag class 3.0-beta1 especi focuss document general could use lot improv imho bug report deal typo found class minim style improv compat class attach propos patch
check stale connect broken httpconnect went stale drop server throw socketexcept instead silent re-open case earlier version httpclient think problem found httpconnect public boolean closeifstal throw ioexcept use isopen isstal log.debug connect stale close close return true return fals stale check use true code httpconnect set use flag word use alway fals isstal never call
document single_cookie_head param cooki guid includ sampl code show behaviour load page phpbb power site result see machin start result polici rfc2109 url http //www.sgboards.com/forums/viewtopic.php t=12 view=next mforum=str respons status code 200 present cooki forumsetcookie=str phpbb_str_data=a 3a0 3a 7b 7d phpbb_str_sid=c8da590cc4b1683b9079da3d82f4efa6 url http //www.sgboards.com/forums/viewtopic.php p=24 mforum=str respons status code 200 present cooki phpbb_str_data=a 3a0 3a 7b 7d phpbb_str_sid=c8da590cc4b1683b9079da3d82f4efa6 forumsetcookie=str url http //www.sgboards.com/forums/posting.php mode=quot p=24 mforum=str respons status code 200 present cooki phpbb_str_data=a 3a0 3a 7b 7d phpbb_str_sid=c8da590cc4b1683b9079da3d82f4efa6 forumsetcookie=str url http //www.sgboards.com/forums/viewtopic.php p=25 mforum=str respons status code 200 present cooki phpbb_str_data=a 3a0 3a 7b 7d phpbb_str_sid=c8da590cc4b1683b9079da3d82f4efa6 forumsetcookie=str polici netscap url http //www.sgboards.com/forums/viewtopic.php t=12 view=next mforum=str respons status code 200 present cooki phpbb_str_sid=e2604334a0022283333153f6879feb70 url http //www.sgboards.com/forums/viewtopic.php p=24 mforum=str respons status code 200 present cooki phpbb_str_sid=e2604334a0022283333153f6879feb70 url http //www.sgboards.com/forums/posting.php mode=quot p=24 mforum=str respons status code 200 present cooki phpbb_str_sid=e2604334a0022283333153f6879feb70 url http //www.sgboards.com/forums/viewtopic.php p=25 mforum=str respons status code 200 present cooki phpbb_str_sid=e2604334a0022283333153f6879feb70 polici compat url http //www.sgboards.com/forums/viewtopic.php t=12 view=next mforum=str respons status code 200 present cooki forumsetcookie=str phpbb_str_data=a 3a0 3a 7b 7d phpbb_str_sid=d156f6dbfa605320b5a250129fa0b22 url http //www.sgboards.com/forums/viewtopic.php p=24 mforum=str respons status code 200 present cooki forumsetcookie=str phpbb_str_data=a 3a0 3a 7b 7d phpbb_str_sid=d5d5a46fd27fd783cdb4e324992bc9d2 url http //www.sgboards.com/forums/posting.php mode=quot p=24 mforum=str respons status code 200 present cooki phpbb_str_data=a 3a0 3a 7b 7d phpbb_str_sid=b4312fee4250f767cd1b34b11afadb3d forumsetcookie=str url http //www.sgboards.com/forums/viewtopic.php p=25 mforum=str respons status code 200 present cooki forumsetcookie=str phpbb_str_data=a 3a0 3a 7b 7d phpbb_str_sid=daf72685d35d851c3eec68b6b3bc3705 end result see cooki polici n't success track session compat set lot phpbb site around 's ve notic behaviour tri anoth random php power site see polici work expect would nice know 's mess cooki hand phpbb site ca n't reli compat set reliabl maintain session variabl henc truli imit browser life get 's littl complic 3.0beta1 cvs version show behaviour mani thank garri exampl code begin code import org.apache.commons.httpclient.cooki import org.apache.commons.httpclient.httpcli import org.apache.commons.httpclient.httpst import org.apache.commons.httpclient.cookie.cookiepolici import org.apache.commons.httpclient.methods.getmethod public class cookieprob static final string url http //www.sgboards.com/forums/viewtopic.php t=12 view=next mforum=str http //www.sgboards.com/forums/viewtopic.php p=24 mforum=str http //www.sgboards.com/forums/posting.php mode=quot p=24 mforum=str http //www.sgboards.com/forums/viewtopic.php p=25 mforum=str static final string urls2 http //www.virginmobilelouder.com/live/index.php http //www.virginmobilelouder.com/live/index.php page_id=214 http //www.virginmobilelouder.com/live/index.php page_id=3 http //www.virginmobilelouder.com/live/index.php page_id=116 static final string polici cookiepolicy.rfc_2109 cookiepolicy.netscap cookiepolicy.browser_compat public static void main string arg tri int 0 policies.length i++ system.out.println \n================================== system.out.println polici polici system.out.println ==================================\n trypolici polici catch except e e.printstacktrac system.err public static void trypolici string polici throw except httpstate initialst new httpstate httpclient httpclient new httpclient httpclient.gethttpconnectionmanag getparam .setconnectiontimeout 30000 httpclient.setst initialst httpclient.getparam .setcookiepolici polici int 0 urls.length i++ system.out.println \n\turl url tryurl httpclient url thread.sleep 1000 give server break public static void tryurl httpclient httpclient string strurl throw except getmethod httpget new getmethod strurl int result httpclient.executemethod httpget system.out.println \trespons status code result get cooki cooki cooki httpclient.getst .getcooki system.out.println \tpresent cooki int 0 cookies.length i++ system.out.println \t\t cooki .toexternalform releas current connect connect pool done httpget.releaseconnect end code
cooki domain .mydomain.com sent host mydomain.com cooki exampl .mydomain.com domain properti sent host mydomain.com without www anyth els mydomain.com concern cookiespec relev code locat cookiespecbas public boolean domainmatch final string host final string domain return host.endswith domain chang instanc someth like public boolean domainmatch final string host final string domain take care host mydomain.com domain .mydomain.com return host.endswith domain || _host.equ _domain.substr 1
cooki 20 year invalid
allow_circular_redirect effect refer includ queri string allow_circular_redirect paramet httpclientparamet effect circular refer contain url paramet
provid non-pool connect manag current implement connect manag connect pool applic requir singl request rare overkil provid simpl connect manag use connect one time close right away
setauthpreempt restrict basic authschem pre-empt authent hardcod restrict basic authent scheme fulli support custom authent scheme pre-empt authent made configur either global per-schem basi potenti compromis may requir authschem report whether support pre-empt capabl wish explicit exclud certain scheme pre-empt authent report 3.0 rc 1
uri.gethost generat illegalargumentexcept hi guy n't know 'm someth wrong follow code uri uri new uri mailto eay cryptsoft.com true system.out.println uri.gethost generat follow except java.lang.illegalargumentexcept compon array char may null org.apache.commons.httpclient.uri.decod uri.java:1722 org.apache.commons.httpclient.uri.gethost uri.java:2780 could help also 'm sorri put report version 3.0 final could n't find entri 3.0-rc1 'm use moment thank lot bisser
httpclient n't read pars respons certain type proxi server post method use determin send post data server via squid proxi server version 2.4.stable2 squid respond 407 proxi authent requir respons httpclient n't read respons order pars rather fail soket except java.net.socketexcept softwar caus connect abort recv fail behaviour reproduc latest nigt build httpclient version 3.0 9 februari 2005 well 3.0 rc1 2.0.2 2.0 piec code send post data use httpclient tri httpclientparam httpclientparam new httpclientparam httpclient client new httpclient httpclientparam hostconfigur hostconfig new hostconfigur hostconfig.setproxi db00-devl.eps.agfa.b 3128 squid proxi server version 2.4.stable2 client.sethostconfigur hostconfig postmethod postmethod new postmethod http //brugge.eps.agfa.be/portal03/servlet/selectfil postmethod.addparamet data data int status client.executemethod postmethod system.out.println status status status httpstatus.sc_ok system.out.println ok els status httpstatus.sc_proxy_authentication_requir system.out.println proxi authent requir catch except e system.out.println socket except e.printstacktrac look debug log problem attach see output httpclient mention piec code problem_request_response_interact attac possibl see interact beetween httpclient squid proxi server httpclient send initi request header squid respond proxi authent requir respons afterward httpclient tri send post data without read respons fail connect alreadi close detail look ethereal_problem attach network traffic run mention piec code ether protocol analyz use open file http //www.ethereal.com/ like particular version squid close connect send proxi athent respons back caus httpclient fail send post data let 's look writerequest method httpmethodbas class 1 send request line header server 2 handl expect 100-continu handshak need 3 send post data server question httpclient send initi request header data even go read respons server proxi server done case expect 100-continu handshak seem case httpclient go listen server in-between step 1 3 understand command make sure status line header sent conn.flushrequestoutputstream actual split send data two part need expect 100-continu handshak case move flush command appropri place insid expect 100-continu handshak case tri conn.flushrequestoutputstream move conn.setsockettimeout response_wait_time_m posibl solv describ problem creat postmethodex overrid writerequest method httpmethodbas look postmethodex attach case expect 100-continu handshak send request line header post data server mention piec code postmethod chang postmethodex execut everyt work fine look debug log fix fix_request_response_interact ethereal_fix network trafic attach accord mention log httpclient send post data read pars proxi authent requir respons squid set status code 407 correct
implement cach perform real request need browser may cach receiv content accord valu differ respons header would great httpclient could
problem get httpclient use http 1.0 proxi server use httpclient 3.0-rc1 connect https site proxi use httplook see http messag proxi httpclient notic alway use http/1.1 setvers either httpclient method help could find get httpclient use http/1.0 proxi look connectmethod class http1.1 inde hardcod thank riad
retri connectionexcept work notic retri handler mechan work client initi connect throw java.net.connectionexcept happen instanc proxi tunnel pictur sometim connect problem retryhandl howev connect timeout except never fall took look sourc code notic open method thrown except level occur outsid control retri handler seem involv open succeed fact open throw connectionexcept case sinc try/catch wrap open insid top stop loop retri handler get chanc invok riad
method.geturi return escap uri n't hi guy pleas consid follow imaginari simplifi code uri u new uri http //some.host.com/ 41.html true httpclient httpclient new httpclient getmethod method new getmethod method.seturi u uri u2 method.geturi system.out.println 1. u system.out.println 2. new string u.getrawuri system.out.println 3. u.geturi system.out.println 4. u2 system.out.println 5. new string u2.getrawuri system.out.println 6. u2.geturi result ll get 1. http //some.host.com/ 41.html 2. http //some.host.com/ 41.html 3. http //some.host.com/a.html 4. http //some.host.com/ 2541.html 5. http //some.host.com/ 2541.html 6. http //some.host.com/ 41.html see line 4 5 6 uri sudden get escap percent sign get convert 25 someth wrong desir behaviour would expect get uri back without escap besid anoth question execut method httpclient.executemethod method method.geturi return uri *after* redirect origin uri seem get uri *after* redirect fine document n't say explicit say getpath method behaviour best regard thank bisser
common codec document depend except entri jdepend-report common codec document depend use httpclient 3.0 rc1 depend document common log java.lang.noclassdeffounderror org/apache/commons/codec/decoderexcept org.apache.commons.httpclient.httpmethodbase. init httpmethodbase.java:217 org.apache.commons.httpclient.methods.expectcontinuemethod. init expectcontinuemethod.java:92 org.apache.commons.httpclient.methods.entityenclosingmethod. init entityenclosingmethod.java:114 org.apache.commons.httpclient.methods.postmethod. init postmethod.java:105
authent fail connect server usernam password non ascii charact tri connect exchang server use ntlm authent usernam  password  get 401 respons auth fail bodi error access deni
except httpconnect uncheck buffer size httpclient-dev mail list date tue 8 mar 2005 19:08:35 +0100 subject error multipl connect hello problem tri multipl connect httpclient object multithreadedhttpconnectionmanag launch 10 thread thread execut getmethod use httpclient object time got error like java.lang.illegalargumentexcept buffer size 0 java.io.bufferedinputstream. init unknown sourc org.apache.commons.httpclient.httpconnection.open httpconnection.java:70 3 org.apache.commons.httpclient.multithreadedhttpconnectionmanag httpcon nectionadapter.open multithreadedhttpconnectionmanager.java:1170 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:6 28 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:4 97 main hilo.run main.java:58 anybodi idea thank advanc jorg
cookie.java hashcod method violat contract org.apache.commons.httpclient.cooki hashcod meet object.hashcod contract cookie.hashcod return differ valu even though data use equal comparison contract **whenev invok object execut java applic hashcod method must consist return integ provid inform use equal comparison object modifi break use cooki within collect use contain trace problem back parent class namevaluepair cookie.hashcod call namevaluepair.hashcod reli name/valu hash cooki reli valu determin equal
preemptiv authent caus ntlm auth scheme fail ntlm authent scheme work preemptiv authent enabl report dave seidel dave mindreef.com
304 respons status handl ibm webspher server return 304 respons content- length header set someth 0 server close connect accord http rfc http //www.w3.org/protocols/rfc2616/rfc2616-sec10.html sec10.3.5 304 respons must contain message-bodi thus alway termin first empti line header field obvious web server return bad respons httpclient block wait data respons even though n't http client browser issu seem ignor fact server set invalid content-length respons
illegalstateexcept authent state alreadi initi hi run httpclient 3.0 rc2 applic user send logfil tell illegalstateexcept authent state alreadi initi want access site sun.com behind proxi site seem redirect differ domain attach debug+trac httpclient log ben
requestent entityenclosingmethod inconsist javadoc use deprec variabl robert man robert.man collabraspace.com report problem httpclient-us list regard inconsist javadoc requestent interfac entityenclosingmethod class prompt review said class discov sever issu must dealt 3.0 goe final 1 's virtual test coverag entityenclosingmethod class 2 code entityenclosingmethod class extens use deprec method variabl beyond requir maintain backward compat 2.0.x api 3 exist code grace handl faulti requestent implement getcontentlength method return negat valu -2 commit addit test case cover fundament function entityenclosingmethod http //svn.apache.org/repos/asf/jakarta/commons/proper/httpclient/trunk/src/test/org/apache/commons/httpclient/testentityenclosingmethod.java submit patch address issu 2 3 short oleg
testexcet never run one testcas httpclient testexcet read main public static void main string arg string testcasenam testchallengeparser.class.getnam junit.textui.testrunner.main testcasenam testcas method public static test suit return new testsuit testchallengeparser.class testchallengepars testexcet
dateutil.formatd use default timezon instead gmt dateutil.formatd use default timezon instead gmt section 3.3.1 rfc 2616 state http date/tim stamp must repres greenwich mean time gmt without except reproduc run follow snippet public static void main string arg timezon tz timezone.gettimezon gmt gregoriancalendar gc new gregoriancalendar tz gc.set 1900 104 gregoriancalendar.januari 1 0 0 0 system.out.println dateutil.formatd gc.gettim expect result thu 01 jan 2004 00:00:00 gmt actual result default timezon pst wed 31 dec 2003 16:00:00 pst
virtual host set appli pars match cooki virtual host set appli pars match cooki problem report httpclient-dev list dan levin
connect proxi reopen proxi auth failur occur ssl tunnel establish connect proxi reopen proxi auth failur occur ssl tunnel establish problem report httpclient-us gebhard gaukler gebhard.gaukl db.com bad oleg
featur request includ contribut code plugin proxi detect attach zip file contain two class pluginproxyutil proxydetectionexcept ve test pluginproxyutil.detectproxi url window xp jre 's 1.3/1.4/1.5 ie solari jre 1.4 netscap correct detect browser plugin set n't access maco x tri doubt work anyway base dmitri 's comment http //forum.java.sun.com/thread.jspa threadid=364342 tstart=120 pleas chang header packag necessari includ contrib section plan contribut exampl applet use code point app way complic use exampl want wait done includ 's fine want offer case anyon els look
httpclient alway overrid host hostconfigur absolut request uri given bug like occur patform os 's test winxp httpclient.executemethod hostconfigur httpmethod httpstate receiv throw illegalargumentexcept state host paramet null hostconfigur object pass proxi set via hostconfiguration.setproxi string int detail reproduc follow bug easili reproduc use apach axi 1.2 commonshttpsend class jvm system prop http.proxyhost http.proxyport set bug apach common http client 3.0rc2 set hostnam properti code hostconfigur /code object follow two step perform br 1 call code httpclient.executemethod hostconfigur httpmethod httpstate /code code hostconfigur /code object code httpmethod /code object creat use httpmethod string uri constructor .this method call exact way apach axi 1.2 client commonshttpsender.java line 132 186 br 2 code hostconfigur /code object proxi set use setproxi string int method call exact way apach axi 1.2 client commonshttpsender.java line 389 br apach axi 1.2rc3 commonshttpsender.java expos bug common http client 3.0rc2 set code hostconfigur /code differ manner follow br 1 call code httpclient.sethostconfigur hostconfigur /code first code hostconfigur /code object must proxi set host name. br 2 call code httpclient.executemethod httpmethod /code br use step axi 1.2rc3 commonshttpsender.java invok method line 379 httpclient.java evalu true argument code hostconfigur /code null see line 324 httpclient.java local variabl code defaulthostconfigur /code code httpclient.sethostconfigur hostconfigur /code set item 1 hostnam get set code hostconfigur /code object line 384 httpclient.java
document problem ms impl digest authent older jres stale connect check seem like digest authent use usernam format domain\usernam fail httpclient-3.0-rc2 confirm digest authent work connect local apach http 2.0 server use usernam password domain\usernam howev support md5-sess algorithm server get failur use md5-sess may turn usernam caus problem one thing consist connect site log use httpclient-2.0.2 fail use ident java code addit authscop use httpclient-3.0-rc2 also attach java code reproduc problem follow wire debug log httpclient-2.0.2 httpclient-3.0-rc2 respect first one connect get http 200 respons second one use 3.0-rc2 fail http 401 log commons-httpclient-2.0.2 work 2005/05/13 11:05:15:185 edt debug httpclient java version 1.3.1 2005/05/13 11:05:15:185 edt debug httpclient java vendor ibm corpor 2005/05/13 11:05:15:185 edt debug httpclient java class path 2005/05/13 11:05:15:205 edt debug httpclient oper system name window xp 2005/05/13 11:05:15:205 edt debug httpclient oper system architectur x86 2005/05/13 11:05:15:205 edt debug httpclient oper system version 5.1 2005/05/13 11:05:15:205 edt debug httpclient sun 1.2 sun dsa key/paramet generat dsa sign sha-1 md5 digest securerandom x.509 certif jks keystor 2005/05/13 11:05:15:205 edt debug httpclient sunjc 1.22 sunjc provid implement des tripl des blowfish pbe diffie-hellman hmac-md5 hmac-sha1 2005/05/13 11:05:15:205 edt debug httpclient sunjss 1.0303 sun jsse provid implement rsa signatur pkcs12 sunx509 key/trust factori sslv3 tlsv1 2005/05/13 11:05:20:893 edt debug httpconnect httpconnection.setsotimeout 0 2005/05/13 11:05:20:893 edt debug httpmethodbas execut loop tri 1 2005/05/13 11:05:20:913 edt debug header get /customerdata-30/customerdataservice.asmx http/1.1 \r \n 2005/05/13 11:05:20:913 edt debug httpmethodbas ad host request header 2005/05/13 11:05:20:913 edt debug header user-ag jakarta commons-httpclient/2.0.2 \r \n 2005/05/13 11:05:20:913 edt debug header host mappoint-css.partners.extranet.microsoft.com \r \n 2005/05/13 11:05:21:173 edt debug header \r \n 2005/05/13 11:05:21:273 edt debug header http/1.1 401 unauthor \r \n 2005/05/13 11:05:21:273 edt debug header content-length 1656 \r \n 2005/05/13 11:05:21:283 edt debug header content-typ text/html \r \n 2005/05/13 11:05:21:283 edt debug header server microsoft-iis/6.0 \r \n 2005/05/13 11:05:21:283 edt debug header www-authent digest qop= auth algorithm=md5-sess nonce= b2a83a38cd57c501af3ad2c91f189512060524424ffc2b818c9920db15cd247a9d47cf5a789d63c6 opaque= 1704373a505e74c4ec692978e5c1a539 charset=utf-8 realm= digest \r \n 2005/05/13 11:05:21:283 edt debug header x-powered-bi asp.net \r \n 2005/05/13 11:05:21:283 edt debug header date fri 13 may 2005 15:05:37 gmt \r \n 2005/05/13 11:05:21:283 edt debug httpmethodbas author requir 2005/05/13 11:05:21:283 edt debug httpauthent authent digest authent realm mappoint-css.partners.extranet.microsoft.com 2005/05/13 11:05:21:283 edt debug digestschem use qop method auth 2005/05/13 11:05:21:283 edt debug httpmethodbas httpmethodbase.execut server demand authent credenti tri 2005/05/13 11:05:21:293 edt debug httpmethodbas resort protocol version default close connect polici 2005/05/13 11:05:21:293 edt debug httpmethodbas close connect use http/1.1 2005/05/13 11:05:21:293 edt debug httpmethodbas execut loop tri 2 2005/05/13 11:05:21:293 edt debug header get /customerdata-30/customerdataservice.asmx http/1.1 \r \n 2005/05/13 11:05:21:293 edt debug httpmethodbas request add host header ignor header alreadi ad 2005/05/13 11:05:21:293 edt debug header user-ag jakarta commons-httpclient/2.0.2 \r \n 2005/05/13 11:05:21:293 edt debug header host mappoint-css.partners.extranet.microsoft.com \r \n 2005/05/13 11:05:21:293 edt debug header author digest username= domain\us realm= digest nonce= b2a83a38cd57c501af3ad2c91f189512060524424ffc2b818c9920db15cd247a9d47cf5a789d63c6 uri= /customerdata-30/customerdataservice.asmx qop= auth algorithm= md5-sess nc=00000001 cnonce= 393a8abf65cd20f85ffdf46a9273b28b response= 854bf54261112caf2e86652276cb2ce6 opaque= 1704373a505e74c4ec692978e5c1a539 \r \n 2005/05/13 11:05:21:293 edt debug header \r \n 2005/05/13 11:05:21:994 edt debug header http/1.1 200 ok \r \n http result 200 commons-httpclient-3.0-rc2 work 2005/05/13 11:16:54:881 edt debug defaulthttpparam -set paramet http.userag jakarta commons-httpclient/3.0-rc2 2005/05/13 11:16:54:881 edt debug defaulthttpparam -set paramet http.protocol.vers http/1.1 2005/05/13 11:16:54:881 edt debug defaulthttpparam -set paramet http.connection-manager.class class org.apache.commons.httpclient.simplehttpconnectionmanag 2005/05/13 11:16:54:891 edt debug defaulthttpparam -set paramet http.protocol.cookie-polici rfc2109 2005/05/13 11:16:54:891 edt debug defaulthttpparam -set paramet http.protocol.element-charset us-ascii 2005/05/13 11:16:54:891 edt debug defaulthttpparam -set paramet http.protocol.content-charset iso-8859-1 2005/05/13 11:16:54:891 edt debug defaulthttpparam -set paramet http.method.retry-handl org.apache.commons.httpclient.defaulthttpmethodretryhandl 5048d78c 2005/05/13 11:16:54:891 edt debug defaulthttpparam -set paramet http.dateparser.pattern eee dd mmm yyyi hh mm ss zzz eeee dd-mmm-yy hh mm ss zzz eee mmm d hh mm ss yyyi eee dd-mmm-yyyy hh mm ss z eee dd-mmm-yyyy hh-mm-ss z eee dd mmm yy hh mm ss z eee dd-mmm-yyyy hh mm ss z eee dd mmm yyyi hh mm ss z eee dd-mmm-yyyy hh-mm-ss z eee dd-mmm-yy hh mm ss z eee dd mmm yy hh mm ss z eee dd-mmm-yy hh mm ss z eee dd-mmm-yyyy hh mm ss z eee dd-mm-yyyy hh mm ss z 2005/05/13 11:16:54:911 edt debug httpclient -java version 1.3.1 2005/05/13 11:16:54:911 edt debug httpclient -java vendor ibm corpor 2005/05/13 11:16:54:911 edt debug httpclient -java class path 2005/05/13 11:16:54:941 edt debug httpclient -oper system name window xp 2005/05/13 11:16:54:941 edt debug httpclient -oper system architectur x86 2005/05/13 11:16:54:941 edt debug httpclient -oper system version 5.1 2005/05/13 11:16:54:941 edt debug httpclient -sun 1.2 sun dsa key/paramet generat dsa sign sha-1 md5 digest securerandom x.509 certif jks keystor 2005/05/13 11:16:54:951 edt debug httpclient -sunjc 1.22 sunjc provid implement des tripl des blowfish pbe diffie-hellman hmac-md5 hmac-sha1 2005/05/13 11:16:54:951 edt debug httpclient -sunjss 1.0303 sun jsse provid implement rsa signatur pkcs12 sunx509 key/trust factori sslv3 tlsv1 2005/05/13 11:16:54:961 edt debug httpconnect -open connect mappoint-css.partners.extranet.microsoft.com:443 2005/05/13 11:17:00:629 edt debug header get /customerdata-30/customerdataservice.asmx http/1.1 \r \n 2005/05/13 11:17:00:629 edt debug httpmethodbas -ad host request header 2005/05/13 11:17:00:639 edt debug header user-ag jakarta commons-httpclient/3.0-rc2 \r \n 2005/05/13 11:17:00:639 edt debug header host mappoint-css.partners.extranet.microsoft.com \r \n 2005/05/13 11:17:00:639 edt debug header \r \n 2005/05/13 11:17:00:989 edt debug header http/1.1 401 unauthor \r \n 2005/05/13 11:17:00:999 edt debug header content-length 1656 \r \n 2005/05/13 11:17:00:999 edt debug header content-typ text/html \r \n 2005/05/13 11:17:00:999 edt debug header server microsoft-iis/6.0 \r \n 2005/05/13 11:17:00:999 edt debug header www-authent digest qop= auth algorithm=md5-sess nonce= c66759cace57c5016cf5645c6dee5b649ed29067f652939d6aaf7239310bb333eeb0153783ae445f opaque= e7e259c137b65766c971d6cfc4115789 charset=utf-8 realm= digest \r \n 2005/05/13 11:17:00:999 edt debug header x-powered-bi asp.net \r \n 2005/05/13 11:17:00:999 edt debug header date fri 13 may 2005 15:16:51 gmt \r \n 2005/05/13 11:17:00:999 edt debug httpmethoddirector -author requir 2005/05/13 11:17:01:009 edt debug authchallengeprocessor -support authent scheme order prefer ntlm digest basic 2005/05/13 11:17:01:009 edt debug authchallengeprocessor -challeng ntlm authent scheme avail 2005/05/13 11:17:01:009 edt info authchallengeprocessor -digest authent scheme select 2005/05/13 11:17:01:009 edt debug authchallengeprocessor -use authent scheme digest 2005/05/13 11:17:01:009 edt debug authchallengeprocessor -author challeng process 2005/05/13 11:17:01:009 edt debug httpmethoddirector -authent scope digest digest mappoint-css.partners.extranet.microsoft.com:443 2005/05/13 11:17:01:009 edt debug httpmethoddirector -retri authent 2005/05/13 11:17:01:019 edt debug httpmethodbas -resort protocol version default close connect polici 2005/05/13 11:17:01:019 edt debug httpmethodbas -should close connect use http/1.1 2005/05/13 11:17:01:019 edt debug httpconnect -connect lock call releaseconnect ignor 2005/05/13 11:17:01:019 edt debug httpmethoddirector -authent digest digest mappoint-css.partners.extranet.microsoft.com:443 2005/05/13 11:17:01:019 edt debug httpmethodparam -credenti charset configur use http element charset 2005/05/13 11:17:01:019 edt debug digestschem -use qop method auth 2005/05/13 11:17:01:019 edt debug httpconnect -connect stale close 2005/05/13 11:17:01:019 edt debug httpconnect -open connect mappoint-css.partners.extranet.microsoft.com:443 2005/05/13 11:17:01:110 edt debug header get /customerdata-30/customerdataservice.asmx http/1.1 \r \n 2005/05/13 11:17:01:110 edt debug httpmethodbas -ad host request header 2005/05/13 11:17:01:110 edt debug header user-ag jakarta commons-httpclient/3.0-rc2 \r \n 2005/05/13 11:17:01:110 edt debug header author digest username= domain\us realm= digest nonce= c66759cace57c5016cf5645c6dee5b649ed29067f652939d6aaf7239310bb333eeb0153783ae445f uri= /customerdata-30/customerdataservice.asmx response= 9cab4fcdb2d09f57523aec80d7b51e95 qop= auth nc=00000001 cnonce= b27507ee79c880b2bb565d363598ce07 algorithm= md5-sess opaque= e7e259c137b65766c971d6cfc4115789 \r \n 2005/05/13 11:17:01:120 edt debug header host mappoint-css.partners.extranet.microsoft.com \r \n 2005/05/13 11:17:01:120 edt debug header \r \n 2005/05/13 11:17:01:540 edt debug header http/1.1 401 unauthor \r \n 2005/05/13 11:17:01:540 edt debug header content-length 1539 \r \n 2005/05/13 11:17:01:540 edt debug header content-typ text/html \r \n 2005/05/13 11:17:01:550 edt debug header server microsoft-iis/6.0 \r \n 2005/05/13 11:17:01:550 edt debug header www-authent digest qop= auth algorithm=md5-sess nonce= 3296b0dace57c5012fe314f8c6f8cafd10abc7a61c09484b2be5c7ef19ecb3c080da1f82c3f5a532 opaque= 87578a7f0871280654aed868cb9497fb charset=utf-8 realm= digest \r \n 2005/05/13 11:17:01:550 edt debug header x-powered-bi asp.net \r \n 2005/05/13 11:17:01:550 edt debug header date fri 13 may 2005 15:17:19 gmt \r \n 2005/05/13 11:17:01:550 edt debug httpmethoddirector -author requir 2005/05/13 11:17:01:550 edt debug authchallengeprocessor -use authent scheme digest 2005/05/13 11:17:01:550 edt debug authchallengeprocessor -author challeng process 2005/05/13 11:17:01:550 edt debug httpmethoddirector -authent scope digest digest mappoint-css.partners.extranet.microsoft.com:443 2005/05/13 11:17:01:550 edt debug httpmethoddirector -credenti requir http result 401 2005/05/13 11:17:01:550 edt debug httpmethoddirector -credenti provid avail 2005/05/13 11:17:01:580 edt info httpmethoddirector -failur authent digest digest mappoint-css.partners.extranet.microsoft.com:443 2005/05/13 11:17:01:580 edt debug httpmethodbas -buffer respons bodi 2005/05/13 11:17:01:580 edt debug httpmethodbas -resort protocol version default close connect polici 2005/05/13 11:17:01:580 edt debug httpmethodbas -should close connect use http/1.1 2005/05/13 11:17:01:580 edt debug httpconnect -releas connect back connect manag
window specif implement digest auth scheme microsoft window 2003 implement digest auth scheme essenti superset rfc 2617 window specif aspect http //www.microsoft.com/technet/prodtechnol/windowsserver2003/library/techref/717b450c-f4a0-4cc9-86f4-cc0633aae5f9.mspx provid super class digestschem window 2003 specif extens plug instead standard digest impl detail see pr 34909
httpclient correct handl escap charact http header element excerpt microsoft 's digest authent work http //www.microsoft.com/technet/prodtechnol/windowsserver2003/library/techref/717b450c-f4a0-4cc9-86f4-cc0633aae5f9.mspx quot rfc 2617-compliant digest authent challeng respons must also compli rfc 2616 hypertext transfer protocol http/1.1 quot string requir requir particular affect use backslash embed doubl quot must preced escap backslash exampl domain\usernam accord rfc 2616 read domainusernam read import applic send inform format rather domain\\usernam authent fail howev known issu domain\usernam authent backslash encod fail digest ssp attempt authent respons assum backslash part string behavior turn set servercompat registri key /quot review fix parameterpars class class implemet cookiespec authschem interfac see also pr 34909
protocolexcept thrown slight broken header httpclient throw except pars header return get follow url http //butler.cit.nih.gov/hembase/hembase.taf header return follow http/1.0 200 ok\r\nserv webstar/1.0 id/acgi\r\nmime-vers 1.0\r\ncontent-typ text/html\r\nset-cooki tango_userreference=adc5871c57fabedec63dd47b path=/\n\r\r\n\r\n doctyp html public -//w3c//dtd html 4.01 transitional//en pleas note superflu \r line separ header bodi imho type error generat warn caus grace recoveri current protocolexcept thrown standard java.net.httpurlconnect handl fine without give warn
occasion host connect pool found 'm use httpclient multithreadedhttpconnectionmanag crawler applic applic issu request mani host 10-20 parallel request thread thread creat new getmethod thread use instanc httpclient creat multi-thread manag code thread look like getmethod get new getmethod url tri int code getsharedhttpcli .executemethod get read respons stuff final get.releaseconnect time time get error like host connect pool found hostconfig=hostconfigur host=http //a.b.c url random url fetch list look sourc code night releas multithreadedhttpconnectionmanager.java:979 comment enlighten help suggest debug would appreci
http 204 content respons result drop connect receiv 204 content respons httpclient alway close connect happen earlier version appear caus recent fix bug 34262
uri.parseurirefer treat string lead absolut uri zero-length scheme uri.parseurirefer treat string lead absolut uri zero-length scheme tri derelativ uri base uri get uri lead ie firefox treat uri string lead relat uri exampl href foo context base uri http //www.example.com/path/pag would derelativ http //www.example.com/path/ foo anoth charact come colon interpret uri scheme 'd desir httpclient uri thing exampl code demonstr import org.apache.commons.httpclient.uri uri base new uri http //www.example.com/path/pag uri rel1 new uri foo/boo system.out.println new uri base rel1 .tostr display foo potenti fix would uri.parseurirefer avoid interpret zero posit indic zero-length scheme atcolon 0 || atslash 0 atslash atcolon atcolon 0 || atslash 0 atslash atcolon length tmp.charat 0 length tmp.charat
cookiespecbase.domainmatch leak cooki 3rd parti domain chang commit 32833 http //issues.apache.org/bugzilla/show_bug.cgi id=32833 buggi doesn't match browser behavior fact leak cooki third parti domain see tri follow cookiespecbas cspec new cookiespecbas cooki cooki new cooki .hotmail.com foo bar integer.max_valu fals cspec.match iwanttostealcookiesfromhotmail.com ,80 fals cooki return true test firefox1.0.4 ie6 show similar leakag similar case inde 'd headline-mak privaci bug browser limit test behav desir filer 32833 cooki domain valu .mydomain.com return exact host mydomain.com howev fix suggest overbroad suggest instead cookiespecbase.domainmatch public boolean domainmatch final string host final string domain buggi match .service.com cooki host like enemyofservice.com return host.endswith domain || domain.startswith host.endswith domain.substr 1 better rfc2109 plus match .service.com cooki exact host service.com return host.equ domain || domain.startswith host.endswith domain || host.equ domain.substr 1
stale connect check work ibm jsse/jr os windows/aix jre ibm jre 1.4.1 jsse ibm 's implement sslite httpclient librari 2.0.2 releas code enabl connect pool featur gain perform improv ssl handshak area code work perfect sun jre 1.4.2 think time 60second request code fail ibm jre ibm jre code fail detech stale connect thus caus stream setsotimeout call fail debug librari code reveal differ way httpconnection.isstal behav method particular inputstream.isavail method return 0 sun jre -1 ibm jre made small code chang httpconnection.isstal method move tri final block outsid inputstream.isavail ==0 check follow code bingo everyth start work ibm jvms break anyth sun jvm code begin protect boolean isstal log.debug subba httpconnection.isstal got call sotimeout= sotimeout boolean isstal true isopen log.debug subba httpconnection.isstal got call isopen= isopen connect open see read assum connect stale isstal fals tri inputstream.avail 0 alway return -1 ibm jvm 0 sun tri subba  move outsid socket.setsotimeout 1 log.debug subba httpconnection.isstal got call setsotimeout 1 inputstream.mark 1 int byteread inputstream.read log.debug subba httpconnection.isstal got call bytesread= byteread byteread -1 log.debug subba httpconnection.isstal got call set isstal true socket report data read probabl stale isstal true els inputstream.reset subba  move outsid final log.debug subba httpconnection.isstal got call final block begin sotimeout socket.setsotimeout sotimeout log.debug subba httpconnection.isstal got call final block done final log.debug subba httpconnection.isstal got call final block begin sotimeout socket.setsotimeout sotimeout log.debug subba httpconnection.isstal got call final block done code end ve attach log captur chang jre 's review ibm log chang jun 10 2005 1:26:55 pm edt debug apache.commons.httpclient.multithreadedhttpconnectionmanager:700 get free connect hostconfig=hostconfigur host=uatservices30.ilab.fnfismd.com protocol=https:443 port=443 jun 10 2005 1:26:55 pm edt debug apache.commons.httpclient.httpconnection:492 subba httpconnection.isstal got call sotimeout=0 jun 10 2005 1:26:55 pm edt debug apache.commons.httpclient.httpconnection:495 subba httpconnection.isstal got call isopen=tru jun 10 2005 1:26:55 pm edt debug apache.commons.httpclient.httpconnection:500 subba httpconnection.isstal got call class java.io.bufferedinputstream .available=-1 jun 10 2005 1:26:55 pm edt debug apache.commons.httpclient.httpconnection:523 subba httpconnection.isstal got call final block begin 0 jun 10 2005 1:26:55 pm edt debug apache.commons.httpclient.httpconnection:532 error occur read socket appear stale java.net.socketexcept socket close java.net.socket.setsotimeout socket.java:927 com.ibm.sslite.bf.setsotimeout unknown sourc com.ibm.jsse.bg.setsotimeout unknown sourc org.apache.commons.httpclient.httpconnection.isstal httpconnection.java:524 org.apache.commons.httpclient.httpconnection.isopen httpconnection.java:436 org.apache.commons.httpclient.multithreadedhttpconnectionmanag httpconnect adapter.isopen multithreadedhttpconnectionmanager.java:1122 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:626 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:497 com.touchpoint.pia.services.transactions.msp.apachehttpclient.invokerequest apachehttpclient.java:69 com.touchpoint.pia.services.transactions.msp.mswsmanager.invokerequest mswsmanager.java:86 com.touchpoint.pia.services.transactions.msp.mswsmanager.invokerequestwithpaylo ad mswsmanager.java:114 com.touchpoint.pia.services.transactions.msp.mswsmanager.main mswsmanager.java:179 jun 10 2005 1:26:55 pm edt debug apache.commons.httpclient.httpconnection:540 subba httpconnection.isstal return=tru jun 10 2005 1:26:55 pm edt debug apache.commons.httpclient.httpconnection:437 connect stale close ibm log chang jun 10 2005 1:07:29 pm edt debug apache.commons.httpclient.multithreadedhttpconnectionmanager:666 enter httpconnectionmanager.connectionpool.gethostpool hostconfigur jun 10 2005 1:07:29 pm edt debug apache.commons.httpclient.multithreadedhttpconnectionmanager:700 get free connect hostconfig=hostconfigur host=uatservices30.ilab.fnfismd.com protocol=https:443 port=443 jun 10 2005 1:07:29 pm edt debug apache.commons.httpclient.httpconnection:492 subba httpconnection.isstal got called. jun 10 2005 1:07:29 pm edt debug apache.commons.httpclient.httpconnection:495 subba httpconnection.isstal got call isopen=tru jun 10 2005 1:07:29 pm edt debug apache.commons.httpclient.httpconnection:500 subba httpconnection.isstal got call class java.io.bufferedinputstream .available=-1 jun 10 2005 1:07:29 pm edt debug apache.commons.httpclient.httpconnection:538 subba httpconnection.isstal return=fals jun 10 2005 1:07:29 pm edt debug apache.commons.httpclient.httpconnection:599 httpconnection.setsotimeout 0 jun 10 2005 1:07:29 pm edt warn apache.commons.httpclient.httpconnection:607 subba socket except java.net.socketexcept socket close java.net.socket.setsotimeout socket.java:927 com.ibm.sslite.bf.setsotimeout unknown sourc com.ibm.jsse.bg.setsotimeout unknown sourc org.apache.commons.httpclient.httpconnection.setsotimeout httpconnection.java:603 org.apache.commons.httpclient.multithreadedhttpconnectionmanag httpconnect adapter.setsotimeout multithreadedhttpconnectionmanager.java:1296 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:633 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:497 com.touchpoint.pia.services.transactions.msp.apachehttpclient.invokerequest apachehttpclient.java:69 com.touchpoint.pia.services.transactions.msp.mswsmanager.invokerequest mswsmanager.java:86 com.touchpoint.pia.services.transactions.msp.mswsmanager.invokerequestwithpaylo ad mswsmanager.java:114 com.touchpoint.pia.services.transactions.msp.mswsmanager.main mswsmanager.java:179 jun 10 2005 1:07:29 pm edt debug apache.commons.httpclient.httpconnection:1151 enter httpconnection.releaseconnect jun 10 2005 1:07:29 pm edt debug apache.commons.httpclient.multithreadedhttpconnectionmanager:513 enter httpconnectionmanager.releaseconnect httpconnect jun 10 2005 1:07:29 pm edt debug apache.commons.httpclient.multithreadedhttpconnectionmanager:791 free connect hostconfig=hostconfigur host=uatservices30.ilab.fnfismd.com protocol=https:443 port=443 jun 10 2005 1:07:29 pm edt debug apache.commons.httpclient.multithreadedhttpconnectionmanager:666 enter httpconnectionmanager.connectionpool.gethostpool hostconfigur jun 10 2005 1:07:29 pm edt debug apache.commons.httpclient.multithreadedhttpconnectionmanager:774 notifi no-on wait thread java.net.socketexcept socket close java.net.socket.setsotimeout socket.java:927 com.ibm.sslite.bf.setsotimeout unknown sourc com.ibm.jsse.bg.setsotimeout unknown sourc org.apache.commons.httpclient.httpconnection.setsotimeout httpconnection.java:603 org.apache.commons.httpclient.multithreadedhttpconnectionmanag httpconnect adapter.setsotimeout multithreadedhttpconnectionmanager.java:1296 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:633 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:497 com.touchpoint.pia.services.transactions.msp.apachehttpclient.invokerequest apachehttpclient.java:69 com.touchpoint.pia.services.transactions.msp.mswsmanager.invokerequest mswsmanager.java:86 com.touchpoint.pia.services.transactions.msp.mswsmanager.invokerequestwithpaylo ad mswsmanager.java:114 com.touchpoint.pia.services.transactions.msp.mswsmanager.main mswsmanager.java:179 java.net.socketexcept socket close java.net.socket.setsotimeout socket.java:927 com.ibm.sslite.bf.setsotimeout unknown sourc com.ibm.jsse.bg.setsotimeout unknown sourc org.apache.commons.httpclient.httpconnection.setsotimeout httpconnection.java:603 org.apache.commons.httpclient.multithreadedhttpconnectionmanag httpconnect adapter.setsotimeout multithreadedhttpconnectionmanager.java:1296 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:633 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:497 com.touchpoint.pia.services.transactions.msp.apachehttpclient.invokerequest apachehttpclient.java:69 com.touchpoint.pia.services.transactions.msp.mswsmanager.invokerequest mswsmanager.java:86 com.touchpoint.pia.services.transactions.msp.mswsmanager.invokerequestwithpaylo ad mswsmanager.java:114 com.touchpoint.pia.services.transactions.msp.mswsmanager.main mswsmanager.java:179 except thread main java.net.socketexcept socket close java.net.socket.setsotimeout socket.java:927 com.ibm.sslite.bf.setsotimeout unknown sourc com.ibm.jsse.bg.setsotimeout unknown sourc org.apache.commons.httpclient.httpconnection.setsotimeout httpconnection.java:603 org.apache.commons.httpclient.multithreadedhttpconnectionmanag httpconnect adapter.setsotimeout multithreadedhttpconnectionmanager.java:1296 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:633 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:497 com.touchpoint.pia.services.transactions.msp.apachehttpclient.invokerequest apachehttpclient.java:69 com.touchpoint.pia.services.transactions.msp.mswsmanager.invokerequest mswsmanager.java:86 com.touchpoint.pia.services.transactions.msp.mswsmanager.invokerequestwithpaylo ad mswsmanager.java:114 com.touchpoint.pia.services.transactions.msp.mswsmanager.main mswsmanager.java:179 **sun log chang chang jun 10 2005 1:25:12 pm edt debug apache.commons.httpclient.multithreadedhttpconnectionmanager:700 get free connect hostconfig=hostconfigur host=uatservices30.ilab.fnfismd.com protocol=https:443 port=443 jun 10 2005 1:25:12 pm edt debug apache.commons.httpclient.httpconnection:492 subba httpconnection.isstal got call sotimeout=0 jun 10 2005 1:25:12 pm edt debug apache.commons.httpclient.httpconnection:495 subba httpconnection.isstal got call isopen=tru jun 10 2005 1:25:12 pm edt debug apache.commons.httpclient.httpconnection:500 subba httpconnection.isstal got call class java.io.bufferedinputstream .available=0 jun 10 2005 1:25:12 pm edt debug apache.commons.httpclient.httpconnection:506 subba httpconnection.isstal got call setsotimeout 1 jun 10 2005 1:25:12 pm edt debug apache.commons.httpclient.httpconnection:510 subba httpconnection.isstal got call bytesread=-1 jun 10 2005 1:25:12 pm edt debug apache.commons.httpclient.httpconnection:513 subba httpconnection.isstal got call set isstal true jun 10 2005 1:25:12 pm edt debug apache.commons.httpclient.httpconnection:523 subba httpconnection.isstal got call final block begin 0 jun 10 2005 1:25:12 pm edt debug apache.commons.httpclient.httpconnection:532 error occur read socket appear stale java.net.socketexcept socket close java.net.plainsocketimpl.setopt plainsocketimpl.java:177 java.net.socket.setsotimeout socket.java:924 com.sun.net.ssl.internal.ssl.sslsocketimpl.setsotimeout dashoa12275 org.apache.commons.httpclient.httpconnection.isstal httpconnection.java:524 org.apache.commons.httpclient.httpconnection.isopen httpconnection.java:436 org.apache.commons.httpclient.multithreadedhttpconnectionmanag httpconnect adapter.isopen multithreadedhttpconnectionmanager.java:1122 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:626 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:497 com.touchpoint.pia.services.transactions.msp.apachehttpclient.invokerequest apachehttpclient.java:69 com.touchpoint.pia.services.transactions.msp.mswsmanager.invokerequest mswsmanager.java:86 com.touchpoint.pia.services.transactions.msp.mswsmanager.invokerequestwithpaylo ad mswsmanager.java:114 com.touchpoint.pia.services.transactions.msp.mswsmanager.main mswsmanager.java:179 jun 10 2005 1:25:12 pm edt debug apache.commons.httpclient.httpconnection:540 subba httpconnection.isstal return=tru
dateutil formatd use default local instead us problem report yannick yannick meudal.net httpclient-us list hello bug report 'm use common httpclient rc2 generat http request put header specif header like if-modified-sinc attribut generat date dateutil.formatd method get local date french exampl if-modified-sinc dim. 10 avr 2005 05:04:08 cest get problem http server pars receiv date rfc 2616 compliant date format if-modified-sinc sun 10 apr 2005 05:04:08 cest patch appli creat new simpledateformat pattern locale.us instead simpledateformat pattern like done pars method line 159 org.apache.commons.httpclient.util.dateutil line 205 public static string formatd date date string pattern date null throw new illegalargumentexcept date null pattern null throw new illegalargumentexcept pattern null simpledateformat formatt new simpledateformat pattern locale.us return formatter.format date regard yannick
equal oper credenti implement trip across scenario want compar credenti could know discard connect state thus associ cooki patch follow short
provid support unconnect socket overview descript proxi set incorrect host repli httpclient.executemethod hang httpmethod.abort stop thus assert entir applic stop immedi demand expect result httpmethod.executemethod httpmethod.abort cancel immedi executemethod actual result httpmethod.executemethod freez proxi bad set respond hostnam fact imposs open socket abort method anyth platform test window xp linux debian httpclient 3.0 rc2 look point problem sourc code night build ident see comment dialogu problem 2 test case solut describ end may impli chang api work sinc java 1.4
way specifi differ auth scheme prioriti host proxi use httpclient 3.0 rc2 authent site use basic autent proxi server use ntlm authent indic preffer use ntlm basic authent authent fail tri authent ntml proxi site indic basic ntlm authent order basic authent fail use proxi sinc basic authent ca n't send domain name fail email thread discuss group past reffer hi tri authent server via proxi also requir authent seem get either proxi authent work site authent work seem work independ set credenti proxi credenti use ntcredenti e.g connect site network use proxi get work authent proxi get 401 authent fail server use proxi read authent tutori ca n't authent use ntlm proxi site 'm tri various combin authent ca n't find document specif cover case feel like 'm take stab dark right anyon point direct light end tunnel 'd realli appreci thank david wed jun 29 2005 09:53:07am -0700 david park wrote hi tri authent server via proxi also requir authent seem get either proxi authent work site authent work seem work independ set credenti proxi credenti use ntcredenti e.g connect site network use proxi get work authent proxi get 401 authent fail server use proxi read authent tutori ca n't authent use ntlm proxi site 'm tri various combin authent ca n't find document specif cover case feel like 'm take stab dark right david _really_ ca n't use ntlm authent proxi target host due natur authent scheme realli joke pleas consid use one follow combin instead 1 basic proxi ntlm host clent proxi within trust network segment 2 ntlm proxi ssl basic host combin provid adequ better latter case secur hope help oleg anyon point direct light end tunnel 'd realli appreci thank david thank repli oleg figur see use differ authent scheme proxi vs. site authent challeng tri ad code suggest authent tutori list authpref new arraylist 2 authprefs.add authpolicy.digest authprefs.add authpolicy.bas authprefs.add authpolicy.ntlm exclud ntlm authent scheme httpclient.getparam .setparamet authpolicy.auth_scheme_prior authpref got messag state attempt basic authent proxi fail probabl domain n't get pass guess thought need ntlm proxi authent basic work site authent question work direct httpclient select order authent method let take ntlm preffer authent method tri authent challeng ntlm sure littl detail 'm miss somewher 's hard find thank lot david david see problem requir patch new paramet luckili prefer api introduc httpclient 3.0 allow add paramet quit easili pleas file featur request bugzilla asap ll best hack patch leav holiday friday juli 1st oleg hi oleg thank ll put request today help lot least know 'm right path attempt devis workaround handl authent manual setdoauthent fals see 401 error process basic authent site credenti see 407 error want process ntlm authent proxi credenti end follow code run httpclient.execut getmethod execut code work perfect basic authent proxi pictur look handshak ntlm authent see problem code sinc handshak includ 2 challeng author step authent succeed 'm clear could manual authent ntlm respons would expect ntlmscheme class contain type 1 type 3 authent method process challeng respons anoth way process ntlm authent receiv initi authent challeng server //check proxi site authent getmethod.getstatuscod 401 //authent site use basic authent basicschem basicschem new basicschem string basic_auth_str basicscheme.authent new ntcredenti cwftp 664a754c getmethod header basic_auth_head new header author basic_auth_str getmethod.addrequesthead basic_auth_head tri httpclient.executemethod getmethod catch except e logger.log level.sever ack e return getmethod els getmethod.getstatuscod 407 //authent site use basic authent ntlmscheme ntlmscheme new ntlmscheme string basic_auth_str ntlmscheme.authent new ntcredenti 00mercbac sammerc2004 simproxi cfc getmethod header basic_auth_head new header author basic_auth_str getmethod.addrequesthead basic_auth_head tri httpclient.executemethod getmethod catch except e logger.log level.sever ack e return getmethod thank david
httpconnectionparams.setconnectiontimeout int effect host unreach modifi multithreadedexample.java ad httpclient.gethttpconnectionmanag .getparam .setconnectiontimeout 5000 order set connect timeout client side ad lan url uristoget array ip url http //192.168.254.1/ assign comput run client get expect messag error org.apache.commons.httpclient.connecttimeoutexcept host accept connect within timeout 5000 ms 20 second use java version 1.5.0_04 jvm bug sinc normal connect procedur time 5 second expect socketaddress addr new inetsocketaddress 192.168.254.1 80 tri socketchannel channel socketchannel.open channel.socket .connect addr 5000 system.out.println connect catch except e e.printstacktrac
fold authsslprotocolsocketfactori httpclient proper includ function authsslprotocolsocketfactori class main distribut httpclient http //svn.apache.org/repos/asf/jakarta/commons/proper/httpclient/trunk/src/contrib/org/apache/commons/httpclient/contrib/ssl/
connect releas back pool runtim except thrown httpmethod releaseconnect method default config leav httpclientparams.connection_manager_timeout zero mean first time connect manag fail immedi get connect applic hang least use multithreadedhttpconnectionmanag zero get pass onto call object.wait long timeout doc timeout zero howev real time taken consider thread simpli wait notified. sinc noth ever notifi thread everyth stop default behaviour client predict n't expect hang entir app ca n't get connect expect timeout throw except give kind feedback would make sens give default say arbitrarili 10 second would save everi singl user class dig around code/document explict set param might decid default valu n't right henc chang 's tweak behaviour correct certain thought bug code mine config fret around best garri
parameterpars pars method authent header appear deal empti valu string hi found issu httpclient due way pars paramet string particular consid follow www-authent header www-authent digest realm= algorithm=md5 qop= auth domain= /content nonce= 0e11dcf146563c3a89e5327f0c5f5bad realm definit specifi equal empti string null valu howev extractparam method authchallengepars turn call parameterpars actual pars valu null  instead empti string due parsequotedtoken gettoken true call essenti return null string result  condit i2 i1 fail string result null i2 i1 result new string char i1 i2 i1 return result processchalleng method digestschem throw except getparamet realm null httpclient abl process digest request empti string realm valu present
request retri preemptiv authent fail hello 'm use premptiv authentif axi client use basic http authentif user n't authenticated/author server case credenti expir httpclient run chaleng produc second request server credenti use preemptiv mode chaleng skip authent scheme n't chang
set proxy-connect header use proxi httpclient refus set proxy-connect header valu close valu convert keep-al final request sent network follow code snippet use replic defect method get method.removerequesthead proxy-connect logger.debug proxy-connect header remov method.addrequesthead proxy-connect close logger.debug proxy-connect header set method.getrequesthead proxy-connect tri int statuscod httpclient.executemethod method look wire log notic actual valu keep-al
nonce-count digest auth quot 3.0rc3 nonce-count nc enclos quot mark accord rfc2617 wrong nonce-count n't enclos quot mark 3.2.2 author request header client expect retri request pass author header line defin accord framework util follow credenti digest digest-respons digest-respons 1 usernam realm nonc digest-uri respons algorithm cnonc opaqu message-qop nonce-count auth-param usernam usernam username-valu username-valu quoted-str digest-uri uri digest-uri-valu digest-uri-valu request-uri specifi http/1.1 message-qop qop qop-valu cnonc cnonc cnonce-valu cnonce-valu nonce-valu nonce-count nc nc-valu nc-valu 8lhex respons respons request-digest request-digest 32lhex lhex 0 1 2 3 4 5 6 7 8 9 b c d e f
invalid redirect correct get made page queri argument contain space mani web server notabl includ tomcat 5 generat redirect space queri argument escap correct browser includ ie firefox compens quot includ space redirect locat http client broken url present subsequ server get command interprt incorrect result usual 505 fix replac space redirect locat 's doesn't entir fix problem job web server develop
defaulthttpmethodretryhandl check whether fail method abort defaulthttpmethodretryhandl check whether fail method abort
logger categori name n't follow common pattern wire class use two logger name unexpect org.apache.common prefix miss ca n't mute debug level statement one-lin log4j.properti exampl log4j.logger.org.apache.commons.httpcli info add log4j.logger.httpcli info pleas prepend org.apache.common name cheer christian code class wire public static wire header_wir new wire logfactory.getlog httpclient.wire.head public static wire content_wir new wire logfactory.getlog httpclient.wire.cont /code http //svn.apache.org/viewcvs.cgi/jakarta/commons/proper/httpclient/trunk/src/java/org/apache/commons/httpclient/wire.java rev=155418 view=markup
depend url broken commons-log http //jakarta.apache.org/commons/httpclient/dependencies.html typo href log depend http //jakarta.apache.org/commons/logging/
minor rfc 2109 2965 violat hi receiv bug report debian commons-httpcli packag debian_bugreport follow bug present upstream 2.0.2 3.0rc3 least far tell test specif grammar cooki cookie2 http header specifi rfc 2109 section 4.3.4 rfc 2965 section 3.3.4 respect requir order pair version name path domain rfc 2965 port domain howev httpclient produc cooki string domain pair appear rather path pair rfcs specif *do not* use either grammar clarifi text occur order occur section defin set-cooki set-cookie2 header 4.2.2 3.2.2 respect sinc section question fact discuss issu pair order set-cookie/set-cookie2 use grammar clear express requir sinc complimentari header explicit permit occur order seem like httpclient client issu server accomod situat fact gone unnot long seem like either 'm bad misread specif major server problem cope /debian_bugreport refer debian bug number http //bugs.debian.org/cgi-bin/bugreport.cgi bug=329245 regard wolfgang
httpconnect isopen flag concurr problem httpconnection.java class contain isopen boolean use track state connect open close problem closesocketandstream flag flip end unsynchron method resourc releas caus concurr issu flushrequestoutputstream flag check first outputstream access 'm provid patch problem
max connect per host set work use multithreadedhttpconnectionmanag default maxim connect per host/port exceed allow maximum 2 default attempt exceed manual set max connect use httpconnectionmanagerparam setmaxconnectionsperhost fail caus bug multithreadedhttpconnectionmanag
cipher
digest auth use wrong uri proxi authent 'm problem get httpclient-rc1 authent use digest ia server ve tri upgrad rc3 without effect also got guy upgrad ia without luck also abl get method work ia connect work coupl proxi server examin ether log common code firefox url notic valu uri set proxy-author header signific differ look rfc 2617 notic section 3.2.2 author request header state digest-uri uri request-uri request-lin duplic proxi allow chang request-lin transit re-examin header show firefox match request-uri digest-uri httpclient reproduc partial header tri modifi rc3 sourc produc hard-cod valu uri demonstr would success authent uri also check authent would fail uri partial httpclient header fail 407 connect gmail.google.com:443 http/1.1 proxy-author digest username= proxytest realm= digest nonce= 503902c343c8c501057a85cea6bad2734378fb44b4cbd1970bf320637871dae85373082cf70ac254 uri= response= 7717d0738332a3d8e83e9102b5ead6b9 qop= auth nc=00000001 cnonce= 583aa0469b31290dc2acd7ec6cfc98f1 algorithm= md5-sess opaque= bb319760fce84856e5648d3536502d81 partial firefox header succeed 200 connect mail1.combrio.local:443 http/1.1 proxy-author digest username= proxytest realm= digest nonce= 0e61fe645ec8c5015aa3afe8cfe5219488ed473e277a8cddf8225ad66e74fd214f97d9d96ac99991 uri= mail1.combrio.local:443 algorithm=md5-sess response= bfac109287273e867531170475172ccf opaque= 70cb2a1533b85882d0f1aa1e2ad1fba qop=auth nc=00000001 cnonce= b41aecd6e527e774
need member multipartrequestent protect instead privat make extend multipart/rel explain mailing-list 1 'd like multipartrequestent move privat visibl protect visibl abl extend multipartrelatedrequestent name attribut part method getmultipartboundari would need thank 1 http //mail-archives.apache.org/mod_mbox/jakarta-httpclient-dev/200510.mbox/ 3c87irw18ndm.fsf meuh.mnc.ch 3e
user-defin protocolsocketfactori secur connect proxi use custom socket implement httpclient problem get secur connect proxi work httpclient requir secureprotocolsocketfactori abl creat secur socket layer exist insecur socket specifi insecur socket creat current secur proxi connect insecur connect alway creat use defaultprotocolsocketfactori httpconnection.java line 702 wish abl overrid behaviour creat insecur socket use custom implement problem default behaviour custom socket implement written c++ use jni ssl implement handl nativ level henc layer exist jdk socket work propos solut add http connect paramet specifi socket factori use perhap http.connection.insecuresocketfactori type class
preemptiv author paramet initi incorrect caus preemptiv auth work preemptiv author defeat incorrect initi patch follow defaulthttpparamsfactory.java 2005-10-10 19:09:10.000000000 -0700 +++ defaulthttpparamsfactory.java.fix 2005-10-17 17:00:10.259174920 -0700 -118,9 +118,9 preemptivedefault null preemptivedefault preemptivedefault.trim .tolowercas preemptivedefault.equ true params.setparamet httpclientparams.preemptive_authent params.setparamet httpclientparams.preemptive_authent boolean.tru els preemptivedefault.equ fals params.setparamet httpclientparams.preemptive_authent params.setparamet httpclientparams.preemptive_authent boolean.fals
usernamepasswordcredentials.equ null throw npe step reproduc 1. new usernamepasswordcredenti .equal null observ nullpointerexcept thrown expect equal return fals
preemptiv auth flag disregard ssl tunnel creation use squid2.4 proxi connect drop tri connect ssl site order connect remain open preemptiv author need proxi preemptiv author flag propag ssl tunnel creat httpmethoddirector executeconnect method new connectmethod object creat tunnel preemptiv flag set paramet set new connectmethod object code would replic problem use squid 2.4 proxi httpclient client new httpclient client.gethostconfigur .setproxyhost new proxyhost someproxi 3128 client.getparam .setauthenticationpreempt true client.getst .setproxycredenti authscope.ani new usernamepasswordcredenti user password getmethod httpget new getmethod https //www.verisign.com/ httpget.getproxyauthst .setpreempt client.executemethod httpget httpget.releaseconnect
javadoc mention expir clarifi valid expir attribut process mention javadoc far tell also public method parseattribut actual handl attribut contain detail would use least backlink pars document 's clear javadoc whether pars automat call valid n't
cooki document clarif javadoc cookiespec mention default polici rfc2109 would nice mention http //jakarta.apache.org/commons/httpclient/cookies.html well likewis 2.0 javadoc getdefaultpolici say use getcookiespec string would better say use getcookiespec default would help mention getdefaultspec cookiepolici javadoc mention ignore_cooki polici header document cookies.html page mention automat manual handl cooki provid link control exampl one turn automat cooki handl
multipartent incorrect comput unknown length part multipartent report unknown length -1 multipartent report erron length valu report unknown length -1 part unknown length would caus post chunk see http //mail-archives.apache.org/mod_mbox/jakarta-httpclient-user/200510.mbox/ajax/ 3ceb3d689c0510250851t2eb78462tbf701135bbf718c9 mail.gmail.com 3e
simplehttpconnectionmanag use incorrect tutori code use pretti well standard tutori code caus simplehttpconnectionmanag print use incorrect warn connect time i/o except occur attach simpl test made demonstr
proxycredenti disclos remot host 'm use httpclient svn-trunk today connect remot ssl-host via proxi proxi requir author basic want use preemptiv author sinc httpclient-514 fix preemptiv author work trace show proxi credenti also transmit remot host connect-tunnel thus disclos sensit inform remot host code look like httpclient client new httpclient httpmethod method new getmethod https //test client.gethostconfigur .setproxi 127.0.0.1 ,3128 client.getst .setproxycredenti new authscop 127.0.0.1 3128 new usernamepasswordcredenti proxi test client.getst .setauthenticationpreempt true client.executemethod method trace 2005/11/03 13:53:13:244 cet debug httpmethoddirector preemptiv send default basic credenti 2005/11/03 13:53:13:261 cet debug httpmethoddirector authent basic realm 127.0.0.1:3128 2005/11/03 13:53:13:262 cet debug httpmethodparam credenti charset configur use http element charset 2005/11/03 13:53:13:266 cet debug httpmethoddirector authent basic realm test:443 2005/11/03 13:53:13:267 cet warn httpmethoddirector requir credenti avail basic realm test:443 2005/11/03 13:53:13:267 cet warn httpmethoddirector preemptiv authent request default credenti avail 2005/11/03 13:53:13:268 cet debug httpconnect open connect 127.0.0.1:3128 2005/11/03 13:53:13:279 cet debug httpmethoddirector preemptiv send default basic credenti 2005/11/03 13:53:13:280 cet debug httpmethoddirector authent basic realm 127.0.0.1:3128 2005/11/03 13:53:13:280 cet debug httpmethodparam credenti charset configur use http element charset 2005/11/03 13:53:13:283 cet debug header connect test:443 http/1.1 2005/11/03 13:53:13:284 cet debug httpmethodbas ad host request header 2005/11/03 13:53:13:284 cet debug header proxy-author basic chjvehk6dgvzda== \r \n 2005/11/03 13:53:13:285 cet debug header user-ag jakarta commons-httpclient/3.0-rc4 \r \n 2005/11/03 13:53:13:285 cet debug header host test \r \n 2005/11/03 13:53:13:286 cet debug header proxy-connect keep-al \r \n 2005/11/03 13:53:13:286 cet debug header \r \n 2005/11/03 13:53:13:311 cet debug header http/1.0 200 connect establish \r \n 2005/11/03 13:53:13:326 cet debug connectmethod connect status code 200 2005/11/03 13:53:13:327 cet debug httpconnect secur tunnel test:443 2005/11/03 13:53:13:418 cet debug header get http/1.1 \r \n 2005/11/03 13:53:13:420 cet debug httpmethodbas ad host request header 2005/11/03 13:53:13:423 cet debug header proxy-author basic chjvehk6dgvzda== \r \n 2005/11/03 13:53:13:424 cet debug header user-ag jakarta commons-httpclient/3.0-rc4 \r \n 2005/11/03 13:53:13:425 cet debug header host test \r \n 2005/11/03 13:53:13:425 cet debug header \r \n 2005/11/03 13:53:14:391 cet debug header http/1.1 200 ok \r \n see proxi credenti also transmit ssl-tunnel remot host secur risk
spnego authent scheme consid integr spnego auth scheme common httpclient contrib packag httpclient 4.0
provid feedback mechan credentialsprovid remot server use basic nt authent pass invalid credenti get stuck infinit loop repeat send authent request server loop executemethod method httpmethoddirector class sampl code import org.apache.commons.httpclient.credenti import org.apache.commons.httpclient.ntcredenti import org.apache.commons.httpclient.usernamepasswordcredenti import org.apache.commons.httpclient.httpcli import org.apache.commons.httpclient.methods.getmethod import org.apache.commons.httpclient.auth import java.io.ioexcept import java.io.bufferedinputstream import java.io.bytearrayoutputstream creat intellij idea user dmartineau date nov 8 2005 time 1:43:21 pm public class showproblem privat string locat privat string user privat string pass privat string domain public showproblem string locat string user string pass string domain this.loc locat this.user=us this.pass=pass this.domain=domain public int getfil int status 500 httpclient client new httpclient client.getparam .setparamet credentialsprovider.provid new cprovid user pass domain getmethod httpget new getmethod locat httpget.setdoauthent true tri execut get status client.executemethod httpget status==200 bufferedinputstream bin new bufferedinputstream httpget.getresponsebodyasstream bytearrayoutputstream bos new bytearrayoutputstream int bytesread 0 byte buff new byte 16384 bytesread bin.read buff -1 bos.writ buff 0 bytesread display result system.out.println new string bos.tobytearray catch throwabl t.printstacktrac final releas connect resourc use method httpget.releaseconnect return status public static void main string arg showproblem showproblem new showproblem arg 0 arg 1 arg 2 arg 3 int respons showproblem.getfil class cprovid implement credentialsprovid privat string user privat string password privat string domain public cprovid string user string password string domain super this.us user this.password password this.domain domain public credenti getcredenti final authschem authschem final string host int port boolean proxi throw credentialsnotavailableexcept authschem null return null tri authschem instanceof ntlmscheme return new ntcredenti user password host domain els authschem instanceof rfc2617scheme return new usernamepasswordcredenti user password els throw new credentialsnotavailableexcept unsupport authent scheme authscheme.getschemenam catch ioexcept e throw new credentialsnotavailableexcept e.getmessag e
warn invalid set-cooki header problem ws server come proxi misconfigur result repons bee receiv httpclient 17:26:36,489 debug header http/1.1 200 ok \r \n 17:26:36,489 debug header set-cooki =f448bb59feedbaaabae path=/ \r \n 17:26:36,489 debug header date tue 15 nov 2005 16:26:36 gmt \r \n 17:26:36,489 debug header server apach \r \n 17:26:36,489 debug header connect close \r \n 17:26:36,489 debug header transfer-encod chunk \r \n 17:26:36,489 debug header content-typ text/xml charset=utf-8 \r \n set-cooki header malform cooki name http head may consid invalid result error build next request 'd expect httpclient warn malform header drop
findbug report fix ran findbug 0.94.rc1 3.0rc4 fix obvious one patch follow made note remaind see //todo marker code also creat findbug target build.xml see appropri patch file
cookiepolicy.registercookiespec cookiepolicy.default cookiespec work document use htmlunit access quot inform cooki shall ignor set default polici cookiepolicy.ignore_cooki nevertheless get error messag start program code read cookiepolicy.registercookiespec cookiepolicy.default ignorecookiesspec.class final webclient webclient new webclient final url url new url http //de.finance.yahoo.com/q s=cb3569.sg final htmlpage page htmlpage webclient.getpag url error messag warnung cooki reject version=0 prf= t=cb3569.sg domain=finance.yahoo.c om path=/ domain attribut finance.yahoo.com violat rfc 2109 domain mus start dot 30.11.2005 10:28:20 org.apache.commons.httpclient.httpmethodbas processrespons header warnung cooki reject version=0 b=7fkoh9l1oqs4h b=3 s=hb domain=.yahoo com path=/ domain attribut .yahoo.com violat rfc 2109 host minus domai n may contain dot
mislead lack javadoc stringrequestent use httpclient2 follow add content-typ header set charset utf-8 method.setrequesthead content-typ text/xml charset=utf-8 given string convert intern post method utf-8 encod byte array method.setrequestbodi xmlstring comment show way use obtain utf-8 encod xml document wrong may origin problem upgrad httpclient3 kill deprec code convert add content-typ header set charset utf-8 method.setrequesthead content-typ text/xml charset=utf-8 given string convert intern post method utf-8 encod byte array method.setrequestent new stringrequestent xmlstring went without problem test machin test product machine.. platform charset utf-8 case product machin think javadoc use stringrequestent constructor strong state use string getbyt content use platform charset also n't notic upgrad 3.x document would help
new postsoap exampl src/exampl slight modifi version postxml invok soap request differ postxml postsoap take soapact extra commndlin arg add header request
userinfo disapear creat uri test use firefox configur proxi server run follow uri ftp //usernam password ftp.mytest.test/testdir/ use sniffer look get commond send proxi server look follow get ftp //usernam password ftp.mytest.test/testdir/ http/1.1 host ftp.mytest.test user-ag mozilla/5.0 window u window nt 5.0 en-us rv:1.7.12 gecko/20050915 firefox/1.0.7 accept text/xml application/xml application/xhtml+xml text/html q=0.9 text/plain q=0.8 image/png q=0.5 accept-languag en-us en q=0.5 accept-encod gzip deflat accept-charset iso-8859-1 utf-8 q=0.7 q=0.7 keep-al 300 proxy-connect keep-al use request get access directori see content display howev tri java use httpclient get follow get request java code includ get ftp //ftp.mytest.test/testdir/ http/1.1 user-ag jakarta commons-httpclient/3.0-rc3 host ftp.mytest.test proxy-connect keep-al final get access deni error seem get request contain user password info url java code packag nl.essent.test.ftp.httptest import java.io.ioexcept import org.apache.commons.httpclient.credenti import org.apache.commons.httpclient.defaulthttpmethodretryhandl import org.apache.commons.httpclient.hostconfigur import org.apache.commons.httpclient.httpcli import org.apache.commons.httpclient.httpexcept import org.apache.commons.httpclient.httpmethod import org.apache.commons.httpclient.httpstatus import org.apache.commons.httpclient.ntcredenti import org.apache.commons.httpclient.usernamepasswordcredenti import org.apache.commons.httpclient.auth.authscop import org.apache.commons.httpclient.methods.getmethod import org.apache.commons.httpclient.params.httpmethodparam import org.apache.commons.httpclient.protocol.defaultprotocolsocketfactori import org.apache.commons.httpclient.protocol.protocol public class testclient public static void main string arg new testclient .testftpviahttp public void testftpviahttp httpclient client new httpclient hostconfigur hostconfig client.gethostconfigur hostconfig.setproxi proxi 8080 client.sethostconfigur hostconfig protocol protol new protocol ftp new defaultprotocolsocketfactori 21 protocol.registerprotocol ftp protol credenti proxycr new ntcredenti xxxx xxxxx xxxx client.getst .setproxycredenti authscope.ani proxycr getmethod gmethod new getmethod ftp //usernam password ftp.mytest.test/testdir/ gmethod.getparam .setparamet httpmethodparams.retry_handl new defaulthttpmethodretryhandl 3 fals tri execut method int statuscod client.executemethod gmethod statuscod httpstatus.sc_ok system.err.println method fail gmethod.getstatuslin read respons bodi byte responsebodi gmethod.getresponsebodi deal respons use caution ensur correct charact encod binari data system.out.println new string responsebodi catch httpexcept e system.err.println fatal protocol violat e.getmessag e.printstacktrac catch ioexcept e system.err.println fatal transport error e.getmessag e.printstacktrac final releas connect gmethod.releaseconnect end java code
typo api_changes_3_0.txt digestshem digestschem also httpclient compon list
redesign virtual host api httpclient ignor explic set host e.g set host like client.gethostconfigur .sethost 127.0.0.1 execut method look say http //google.com program connect google.com rather localhost fix work diff -naur ../../t2/commons-httpclient/src/java/org/apache/commons/httpclient/httpclient.java src/java/org/apache/commons/httpclient/httpclient.java ../../t2/commons-httpclient/src/java/org/apache/commons/httpclient/httpclient.java 2005-12-22 01:06:54.000000000 +1300 +++ src/java/org/apache/commons/httpclient/httpclient.java 2005-12-22 19:13:30.000000000 +1300 -383,7 +383,9 hostconfig defaulthostconfig || uri.isabsoluteuri make deep copi host default hostconfig new hostconfigur hostconfig uri.isabsoluteuri host explic set alreadi e.g ip virtual host execut method leav uri.isabsoluteuri hostconfig.gethost ==null hostconfig.sethost uri note care host specifi use uri author case virtual host run sever servers/ip need make sure request goe specif ip respons come back virtual host test
explicit virtualhost caus issu redirect set explicit virtual host getmethod may get stuck redirect loop maxredirect e.g execut get www.google.com www.google.com virtualhost redirect www.google.co.nz least come nz ip current httpclient behavior connect www.google.co.nz pass request host www.google.com googl repli anoth www.google.co.nz redirect loop continu probabl way work around seem reason drop explic set virtual host event redirect redirect differ uri author follow patch work diff -naur ../../t2/commons-httpclient/src/java/org/apache/commons/httpclient/httpmethoddirector.java src/java/org/apache/commons/httpclient/httpmethoddirector.java ../../t2/commons-httpclient/src/java/org/apache/commons/httpclient/httpmethoddirector.java 2005-12-22 01:06:55.000000000 +1300 +++ src/java/org/apache/commons/httpclient/httpmethoddirector.java 2005-12-22 19:09:51.000000000 +1300 -605,6 +605,27 redirecturi new uri currenturi redirecturi scenario re tri avoid virtual host set e.g google.com request server respond redirect google.co.nz issu request google.co.nz virtual host request google.com code remov set virtual host redirect differ domain redirecturi.isrelativeuri break string vhost hostconfiguration.getparam .getvirtualhost vhost==nul break redirecturi.getauthor =currenturi.getauthor hostconfiguration.getparam .setvirtualhost null fals
digest auth use incorrect uri bug seem strong relat 36918 case n't proxi get method problem get request queri paramet sent server uri count paramet server apach 1.3 respond http/1.1 400 bad request error log server write digest uri mismatch /query.cgi match request-uri /query.cgi format=advanc js=1 rememberjs=1 far tell problem follow line code cut digestscheme.java public string authent credenti credenti httpmethod method getparamet .put uri method.getpath cut inclin quick-hack add method.getquerystr uri make right probabl need refactor esp consid issu 36918
multithreadedhttpconnectionmanag setmaxtotalconnect method n't work deprec setmaxtotalconnect method multithreadedhttpconnectionmanag seem like effect sourc code current version public void setmaxtotalconnect int maxtotalconnect this.params.getmaxtotalconnect n't look like public void setmaxtotalconnect int maxtotalconnect this.params.setmaxtotalconnect maxtotalconnect
provid access port host header use load balanc connect http server http server connect applic server use port translat load balanc e.g client connect 90 load balanc load balanc connect port 100 http server load balanc doesn't chang host request header host request header still origin virtual host name port case port 90 reason virtual host http server applic server configur base extern port number case port 90 test purpos sometim want connect direct http server applic server bypass load balanc need connect port load balanc would exampl port 100 host header request request would go load balanc exampl port 90 http server applic server 's virtual host configur port attach patch add possibl specifi port number virtual host 's code snippet use patch code httpclient httpclient new httpclient httpmethod method new getmethod hostconfigur hostconfigur new hostconfigur hostconfiguration.sethost localhost 80 http hostparam param new hostparam params.setvirtualhost localhost params.setvirtualhostport 100 hostconfiguration.setparam param httpclient.executemethod hostconfigur method system.out.println method.getresponsebodyasstr method.releaseconnect
add shutdown method simplehttpconnectionmanag would use abl close connect simplehttpconnectionmanag could achiev ad shutdown method per multithreadedconnectionmanag ideal would ad httpconnect interfac could break exist implement avoid perhap consid introduc sub-interfac method could also creat abstractconnectionmanag class would make easier add function later
javadoc getconnect method connect manag javadoc getconnect method simpl multithread connect manag taken interfac generic javadoc dogetconnect method multithread manag fine visibl javadoc simpl mangag javadoc could likewis improv hope provid patch short
abstracthttpprocessor hard-wir singl context ca n't use abstracthttpprocessor asynchron process differ request hard-wir use singl context chang async requir differ context request patch follow cheer roland
nullpoint creat uri scheme specif part null fragment org.apache.commons.httpclient.uri class constructor public uri string scheme string schemespecificpart string fragment throw uriexcept _fragment fragment.tochararray _fragment fragment==nul null fragment.tochararray
ssl contrib file use standard javax.net.ssl packag provid jdk 1.4.2 hi tri use ssl aix found file contribut src/contrib/org/apache/commons/httpclient/contrib/ssl make hard refer com.sun.net.ssl packag sinc jdk 1.4.2 one shall use javax.net.ssl packag instead 1/ fix sourc file appropri 2/ updat build.xml also build commons-http-client-contrib.jar attach bug report result unifi diff includ svn
entiti connect handl incomplet 1. entiti explicit disconnect under stream 2. entiti tell whether under stream patch follow cheer roland
entiti return stream getcont basichttpent gzipdecompressingent return stream getcont call multipl time allow httpentiti interfac rather throw illegalstateexcept test entityutil reli getcont return stream multipl call patch follow roland
incorrect copyright statement copyright statement http-core 1999-2004 updat correct year
easyx509trustmanag longer check cert expiri easyx509trustmanag made even easier last commit socket creat talk server expir certif 2 commit ago look like notic return fals line 107 102 tri 103 certificate.checkvalid 104 105 catch certificateexcept e 106 log.error e.tostr 107 return fals 108 look like 102 tri 103 certificate.checkvalid 104 105 catch certificateexcept e 106 log.error e.tostr 107 'm propos 102 certificate.checkvalid re use java 1.4 contrib code ll let certificateexcept fli stack
httpstate.clearcooki synchron httpstate class clearcooki method synchron consid modifi arraylist unsynchron method modifi read arraylist synchron except clearcooki method stumbl upon fact webapp work use httpclient threw illegalargumentexcept indic one cooki array return httpstate.getcooki null n't possibl upon inspect test possibl option threadsafeti hole left unsynchron clearcooki method caus issu
fail connect leav connect inconsist state open https connect authent proxi basic auth scheme fail proxi credenti provid first tri follow exampl code fail httpclient client new httpclient new multithreadedhttpconnectionmanag url url new url https //examplehttpsurl //first tri getmethod get new getmethod url.toexternalform hostconfigur hc new hostconfigur hc.sethost url.gethost 443 https hc.setproxi proxyhost 4711 tri client.executemethod hc get catch except e log.error e final get.releaseconnect //return 407 expect log.debug answer get.getstatuslin .tostr //retri credenti normal request user client.getst .setproxycredenti new authscop proxyhost ,4711 new ntcredenti user pass get new getmethod url.toexternalform tri client.executemethod hc get catch except e e.printstacktrac final get.releaseconnect //should 200 407 log.debug answer get.getstatuslin .tostr see httpmethoddirector.executewithretri final httpmethod method caus connect kept open thus connect never retri this.conn.isopen connect must open use noth open secur tunnel this.conn.open this.conn.isproxi this.conn.issecur method instanceof connectmethod need creat secur tunnel execut real method executeconnect abort connect method fail return add conn.clos return executeconnect code work connect reattempt
disallow use secureprotocolsocketfactori proxycli proxycli work correct secureprotocolsocketfactori socket factori use establish connect target server
subclass write access statuslin httpmethodbas provid readstatuslin method explicit design subclass overrid howev attempt quick encount issu sinc subclass access statuslin member variabl httpmethodbas hold true sever member variabl well recommend access member variabl occur accessor mutat provid set see patch index httpmethodbase.java httpmethodbase.java revis 390815 +++ httpmethodbase.java work copi -563,7 +563,7 return status code associ latest respons public int getstatuscod return statusline.getstatuscod return getstatuslin .getstatuscod -577,6 +577,13 param statuslin statuslin set protect final void setstatuslin statuslin statuslin this.statuslin statuslin check respons data avail return tt true /tt respons data avail tt fals /tt otherwis -798,7 +805,7 return status text public string getstatustext return statusline.getreasonphras return getstatuslin .getreasonphras -920,16 +927,16 log.debug resort protocol version default close connect polici miss invalid connect header default this.effectiveversion.greaterequ httpversion.http_1_1 geteffectivevers .greaterequ httpversion.http_1_1 log.isdebugen log.debug close connect use this.effectiveversion.tostr log.debug close connect use geteffectivevers .tostr els log.isdebugen log.debug close connect use this.effectiveversion.tostr log.debug close connect use geteffectivevers .tostr return this.effectiveversion.lessequ httpversion.http_1_0 return geteffectivevers .lessequ httpversion.http_1_0 -980,14 +987,14 this.responseconnect conn checkexecutecondit state conn this.statuslin null setstatuslin null this.connectioncloseforc fals conn.setlastresponseinputstream null determin effect protocol version this.effectivevers null this.effectivevers this.params.getvers geteffectivevers null seteffectivevers this.params.getvers writerequest state conn -996,7 +1003,7 method success execut use true return statusline.getstatuscod return getstatuscod -1048,8 +1055,8 getrequestheadergroup .clear getresponseheadergroup .clear getresponsetrailerheadergroup .clear statuslin null effectivevers null setstatuslin null seteffectivevers null abort fals use fals param new httpmethodparam -1586,18 +1593,18 enter httpmethodbase.readrespons httpstate httpconnect status line line may alreadi receiv expect continu handshak use this.statuslin null getstatuslin null readstatuslin state conn processstatuslin state conn readresponsehead state conn processresponsehead state conn int status this.statusline.getstatuscod int status getstatuscod status 100 status 200 log.isinfoen log.info discard unexpect respons this.statusline.tostr log.info discard unexpect respons getstatuslin .tostr this.statuslin null setstatuslin null readresponsebodi state conn -1675,7 +1682,7 wire.content_wire.en new wireloginputstream wire.content_wir boolean canhavebodi canresponsehavebodi statusline.getstatuscod boolean canhavebodi canresponsehavebodi getstatuscod inputstream result null header transferencodinghead responseheaders.getfirsthead transfer-encod use transfer-encod present ignor content-length -1714,7 +1721,7 els long expectedlength getresponsecontentlength expectedlength -1 canhavebodi this.effectiveversion.greaterequ httpversion.http_1_1 canhavebodi geteffectivevers .greaterequ httpversion.http_1_1 header connectionhead responseheaders.getfirsthead connect string connectiondirect null connectionhead null -1850,19 +1857,19 true //creat status line status string statuslin new statuslin setstatuslin new statuslin //check valid http-version string versionstr statusline.gethttpvers string versionstr getstatuslin .gethttpvers getparam .isparameterfals httpmethodparams.unambiguous_status_lin versionstr.equ http getparam .setvers httpversion.http_1_0 log.iswarnen log.warn ambigu status line http protocol version miss statusline.tostr getstatuslin .tostr els this.effectivevers httpversion.pars versionstr seteffectivevers httpversion.pars versionstr -1943,9 +1950,9 readresponsehead state conn processresponsehead state conn this.statusline.getstatuscod httpstatus.sc_continu getstatuscod httpstatus.sc_continu discard status line this.statuslin null setstatuslin null log.debug ok continu receiv els return -2087,7 +2094,7 privat string getrequestlin httpconnect conn return httpmethodbase.generaterequestlin conn getnam getpath getquerystr this.effectiveversion.tostr getpath getquerystr geteffectivevers .tostr -2128,6 +2135,13 param effectivevers effectivevers set protect final void seteffectivevers httpversion effectivevers this.effectivevers effectivevers per rfc 2616 section 4.3 respons never contain messag bodi -2358,7 +2372,7 set use respons read this.us true this.statuslin statuslin setstatuslin statuslin this.responsehead responsehead this.responsebodi null this.responsestream responsestream
liter plus charact path compon httpurl preserv liter plus charact includ path compon url encod get decod getpath space reproduc follow httpurl httpurl new httpurl http //localhost/test+test system.out.println httpurl.getpath output test test follow path fix issu patch appear break anyth els patch svn repo url http //svn.apache.org/repos/asf/jakarta/commons/proper/httpclient/trunk repositori uuid 13f79535-47bb-0310-9956-ffa450edef68 revis 405803 index src/java/org/apache/commons/httpclient/uri.java src/java/org/apache/commons/httpclient/uri.java revis 405803 +++ src/java/org/apache/commons/httpclient/uri.java work copi -1552,6 +1552,7 allowed_abs_path.or abs_path allowed_abs_path.set '/ aleadi includ allowed_abs_path.andnot percent allowed_abs_path.clear '+ -1563,6 +1564,7 static allowed_rel_path.or rel_path allowed_rel_path.clear allowed_rel_path.clear '+
allow access regist cooki polici would use jmeter perhap applic access list regist cooki polici name accept let know want provid patch
build.xml add log level definit default log level debug produc quit lot output test patch allow separ definit wire log level assum simplelog use
remov lib directori svn trunk build.xml expect find junit.jar lib directori build run test jar includ svn jar ignor download show unvers file file includ exclud svn note jmeter use lib/opt directori present svn content ignor use extra jar includ svn could use approach junit.jar
derelativ relat uri scheme incorrect uri constructor public uri uri base uri relat throw uriexcept assum given relat uri scheme provid author complet path construct uri howev uri scheme still relat requir author base path base uri demonstr code uri base new uri http //www.example.com/some/pag uri rel new uri http boo uri derel new uri base rel derel.tostr java.lang.str http boo fact derel http //www.example.com/some/boo rfc2396 littl confus section 3.1 state relat uri refer distinguish absolut uri begin scheme name section 5 sever sentenc talk relat uri begin scheme prevent use relat uri lead path segment look like scheme identifi rfc3896 superced rfc2396 remov implic relat uri begin scheme leav text explcit discuss relat uri scheme firefox 1.5 ie 6.0 treat http boo boo purpos derelativ http base uri would give final uri http //www.example.com/some/boo exampl even relat uri like http ../../boo explicit legal
relat uri intern double-slash mispars uri.parseurirefer 's heurist interpret uri part thrown relat uri includ intern result portion suppli relat uri path lost exampl uri rel new uri foo//bar//baz rel.tostr java.lang.str //bar//baz culprit seem line 1961 uri improp conclud two slash later begin tmp still indic uri net_path possibl quick fix might add isstartedfrompath begin line 1961 test make line isstartedfrompath 2 length tmp.charat 1 '/ thus prevent misguid authority-pars happen earlier analysi alreadi identifi current string strict path-ori uri also appear set is_net_path boolean end 's block may wrong code run hier_path uri net_path 2396 syntax exampl uri uri new uri http //www.example.com/some/pag uri.isnetpath boolean true
consum remain respons content connect close work httpclient-bas applic send receiv potenti larg file gigabyt receiv larg file applic allow user cancel download time close respons input stream behind scene input stream current provid httpmethodbase.getresponsebodi un-chunk respons known content length contentlengthinputstream automat read remaind wrap respons instead close straight away behaviour work well larg file data download unnecessarili connect held open long period per http 1.1 spec section 14.10 seem either server client http 1.1 connect use connect close direct signal connect non-persist therefor requir data read connect releas clean contentlengthinputstream perform persist connect http //www.w3.org/protocols/rfc2616/rfc2616-sec14.html sec14.10 could httpmethodbas modifi check direct server client avoid wrap respons input stream contentlengthinputstream present seem straight-forward though may side-effect awar
appli suppli patch set 2 variabl base class protect patch attach main task contain minim chang allow httpmethodbas class overload base class
protocolsocketfactori equal hashcod n't support subclass implemen equal hashcod class org.apache.commons.httpclient.protocol.defaultprotocolsocketfactori org.apache.commons.httpclient.protocol.sslprotocolsocketfactori implement equal hashcod attempt make instanc class equal howev manner method code make necessari subclass implement equal hashcod minor chang method class make possibl subclass factori without re-impl equal hashcod method equal written return obj null obj.getclass .equal getclass rather return obj null obj.getclass .equal defaultprotocolsocketfactory.class similar hashcod method return getclass .hashcod rather return defaultprotocolsocketfactory.class.hashcod
httpmethodbas abort variabl mistaken declar transient instead volatil httpmethodbas abort variabl mistaken declar transient instead volatil quit nasti want cut emerg releas 3.0.2 wait 3.1-beta1 fix attach oleg
fix junit scope maven pom pleas chang junit depend depend groupid junit /groupid artifactid junit /artifactid version 3.8.1 /version url http //www.junit.org/ /url properti scope test /scope /properti /depend better automat convers maven 2
multithreadedconnectionmanag idleconnectiontimeoutthread improv chang multithreadedconnectionmanag idleconnectiontimeoutthread follow suggest balaz szcs forward messag szcs balaz balazs.szuec wave-solutions.com reply-to httpclient user discuss httpclient-us jakarta.apache.org httpclient user discuss httpclient-us jakarta.apache.org subject re multithreadedconnectionmanag pool strategi date mon 15 may 2006 15:26:08 +0200 hello made two chang httpclient code 1 class connectionpool method getfreeconnect chang freeconnections.removefirst freeconnections.removelast contain free connect behav stack rather queue 2 addit chang idleconnectiontimeoutthread run method ad connectionmanager.deleteclosedconnect pool size maintain correct think balaz
contentlengthinputstream implement avail proper contentlengthinputstream either extend filterinputstream deleg avail wrappedstream otherwis avail respons stream instanc autocloseinputstream proper extend filterinputstream therefor deleg contentlengthinputstream alway return 0 issu import client tri improv perform process data read non-block way block network
secureprotocolfactorywrapp class use socket factori creat java web start smartcard ssl becom prevel java web start start becom better equip handl situat run app within webstart access browser 's keystor least case access user smartcard make ssl connect want start use httpclient need way still mainain access browser 's keystor initi test show get default socket factori java.net.httpurlconnect wrap class implement org.apache.commons.httpclient.protocol.secureprotocolsocketfactori suffici
refactor httpclientconnect httpproxyconnect instead tri defin full abstract client connect let 's defin minim interfac httpcore method actual need core particular core need open connect sinc httpcore-11 care whether connect direct proxi abstract client connect defin httpconn origin descript discuss mail list separ respons establish connect connect object could improv design help proxi support
junit depend pom.xml default compil scope depend set defin http //www.ibiblio.org/maven2/commons-httpclient/commons-httpclient/3.0.1/commons-httpclient-3.0.1.pom includ junit scope test /test suppos junit depend test scope could someon fix applic packag includ junit 3.8.1 add 118kib noth
httpmethoddirector fail redirect encod url locat httpmethoddirector handl case redirect incom connect locat specifi header http caller method locat special charset encod extend charset like iso 8859-1 etc redirect fail way dd-mmm-yyyy hh mm ss org.apache.commons.httpclient.httpmethoddirector processredirectrespons warn redirect locat http //www.anycharsetencodedurl.ko malform test use class public class simplehttptestnotwork public static int urlstatus string purl throw org.apache.commons.httpclient.httpexcept java.io.ioexcept org.apache.commons.httpclient.httpcli client new org.apache.commons.httpclient.httpcli org.apache.commons.httpclient.httpmethod method new org.apache.commons.httpclient.methods.getmethod purl return client.executemethod method public static void main string arg tri string url http //www.dipualba.es/municipios/f e9rez //known problemat url system.out.println return code +url+ +simplehttptestworking.urlstatus url catch except e e.printstacktrac ve done solv particular case 1 request side ve modifi call public class simplehttptestwork public static int urlstatus string purl throw org.apache.commons.httpclient.httpexcept java.io.ioexcept org.apache.commons.httpclient.httpcli client new org.apache.commons.httpclient.httpcli org.apache.commons.httpclient.httpmethod method string encod string client.getparam .getparamet http.protocol.content-charset client.getparam .setparamet http.protocol.element-charset encod tri method new org.apache.commons.httpclient.methods.getmethod purl catch illegalargumentexcept iae tri org.apache.commons.httpclient.uri uri new org.apache.commons.httpclient.uri purl true method new org.apache.commons.httpclient.methods.getmethod uri.geturi catch org.apache.commons.httpclient.uriexcept ue org.apache.commons.httpclient.uri uri new org.apache.commons.httpclient.uri purl fals encod method new org.apache.commons.httpclient.methods.getmethod uri.getescapeduri return client.executemethod method public static void main string arg tri string url http //www.dipualba.es/municipios/frez //the problemat url system.out.println return code +url+ +simplehttptestworking.urlstatus url catch except e e.printstacktrac 2 org.apache.commons.httpclient.httpmethoddirector.processredirectrespons httpmethod method ve replac redirecturi new uri locat true follow code 2006-11-14 handl redirect encod uri locat uri connect encod charset proper set tri redirecturi new uri locat true catch uriexcept ue object encod this.conn.getparam .getparamet http.protocol.element-charset encod null redirecturi new uri locat fals string encod els throw ue hope help
use trace log instead debug absolut nitty-gritti basic copi spring improv request spr-2873 http //opensource.atlassian.com/projects/spring/browse/spr-2873 given develop situat much debug inform log httpclient un-interest long work line howev much bigger import other thus turn debug global httpclient n't good either trace debug two developer-centr log level log4j common log rest product level sinc log4j-1.2.12 trace exist clog alway trace releas 1.1 map log.trac log4j 's debug 1.1 releas may 9 2006 map log4j 's trace think httpclient 's log would benefit lot use trace level extens develop could turn httpclient 's log debug still see major develop event like connect open request sent e.g respons 's status line size header bodi keep-al vs. close connect candid trace level includ httpclient.wir org.apache.commons.httpclient.params.defaulthttpparam org.apache.commons.httpclient.httpmethodbas probabl bunch other n't bring develop standard good flow mode high interest inform pleas note view line worthless howev _normal_ develop circumst valuabl inform would eas develop possibl turn ultra-verbos loglin easili thing n't work excit rest-bas queri n't work charset encod n't give re expect 'd turn trace realli get hard core 'd find problem fix set debug addit line left debug level obvious inform possibl thus mayb somewhat verbos tri aggreg piec inform output sever debug lines.. realiz could achiv lot rather extens log configur also includ raw text filter believ affect develop ps would n't hurt either httpclient 's log-lin came common root e.g httpclient org.apache.commons.httpcli instead sever root would howev somewhat backward incompat chang sinc least two root
httpmethodbase.getresponsebodyasstr long limit current httpmethodbase.getresponsebodyasstr print warn log suggest use getresponsestream howev getresponsebodyasstr extrem use easi use wish method getresponsebodyasstr long limit throw httpexcept respons size exceed specifi limit thing getresponsebodi long limit origin method deprec danger explain javadoc
filerequestent svn close input file filerequestentity.java svn close input file howev version web page http //jakarta.apache.org/commons/httpclient/performance.html final claus close file perhap sourc code
https check cn x509 cert https check cn x509 cert sinc re essenti roll httpsurlconnect check provid javax.net.ssl.hostnameverifi longer place patch 'm attach caus createsocket method o.a.h.conn.ssl.sslsocketfactori blowup test1 javax.net.ssl.sslexcept hostnam certif n't match vancity.com www.vancity.com test2 javax.net.ssl.sslexcept hostnam certif n't match vancity.com www.vancity.com hope peopl agre desir
allow differ strategi check cn x509 cert re decent job check cn x509 cert https http //issues.apache.org/jira/browse/httpclient-613 think patch httpclient-613 cover 99.9 user esoter possibl think oleg right need let user chang strategi provid strategi want addit thing think http //wiki.cacert.org/wiki/vhosttaskforc cn depreci abl find popular websit https n't use cn *.example.com match subdomain a.b.example.com firefox ie6 patch httpclient-613 allow subdomain support multipl cn 's subject support subjectaltname=dn www.example.com support lot singl cert support mix cn subjectaltnam creat altern strategi peopl tri 'd probabl lean toward someth like x509namecheckingstrategy.sun_java_6 default x509namecheckingstrategy.firefox2 x509namecheckingstrategy.ie7 x509namecheckingstrategy.first_cn_and_no_wildcard aka strict
consid make hostconfigur immut hostconfigur class immut also allow method class non-synchron oleg
httpmethoddirector.executewithretri method fail close under connect runtimeexcept thrown follow code snippet end httpmethoddirector.executewithretri method catch ioexcept e this.conn.isopen log.debug close connect this.conn.clos releaseconnect true throw e catch runtimeexcept e this.conn.isopen bad log.debug close connect this.conn.clos releaseconnect true throw e ioexcept caught see open status connect accur check call isopen method runtimeexcept caught howev code mistaken check isopen member field case conn exampl multithreadedhttpconnectionmanag isopen method overridden check wrap connect return isopen status connect case like check isopen member field obvious wrong end call close connect clean caus issu later call difficult bug diagnos step soapbox one could easili avoid make member variabl privat step thank
hostnam verif turn wildcard cn ip address hostnam verif turn wildcard cn ip address improv httpclient-613 httpclient-614 exampl n't allow cn=*.114.102.2 'm think grab substr follow final dot run integer.parseint numberformatexcept n't thrown integer.parseint actual work ll turn wildcard match notic wo n't problem ip6 address sinc n't use dot 's problem ip4 mean dot clash dot domain name note turn wildcard match still attempt exact match hostnam weird mechan client actual abl use hostnam https //*.114.102.2/ okay 's certif server contain
elimin class hostconfigur remov target host attribut hostconfigur class allow one hostconfigur object use differ target problem current multithreadedhttpconnectionmanag use hostconfigur object cach key need chang followup httpclient-615 cheer roland
leak multithreadedhttpconnectionmanager.connectionpool.maphost entri ad multithreadedhttpconnectionmanager.connectionpool.maphost never clean unless multithreadedhttpconnectionmanag shutdown
shutdown multithreadedhttpconnectionmanag declar shutdown attribut volatil interrupt cleanup thread avoid poll n't use iter weakhashmap concurrentmodificationexcept might trigger garbag collect patch follow
overhaul connect manag associ connect interfac multithreadedhttpconnectionmanager/httphostconnect need overhaul provid layer top operatedclientconnect preliminari work name threadsafeclientconnmanager/managedclientconnect impli work former httpmethoddirector httpclient verifi complet new connect manag api
autocloseinputstream.avail throw ioexcept auto-clos aci auto-clos soon eof detect lead ioexcept throw respons call valid stream reach eof aci instead close _underlying_ stream switch eof mode throw except close explicit report tom lipki develop mail list http //mail-archives.apache.org/mod_mbox/jakarta-httpcomponents-dev/200702.mbox/ 3c200702101905.l1aj5mek027997 fw3.pss.com 3e
uri.java readobject /writeobject must privat class org.apache.commons.httpclient.uri readobject/writeobject method current protect need privat java invok
string constant final rfc2109spec set_cookie_key rfc2965spec set_cookie2_key final
possibl npe httphost httphost line 167 say this.port this.protocol.getdefaultport howev line protocol check null line 167 probabl read this.protocol null this.port this.protocol.getdefaultport
multithreadedhttpconnectionmanag proper respond thread interrupt multithreadedhttpconnectionmanag use interrupt notifi wait thread connect readi issu aris thread interrupt someon els still wait thread dogetconnect remov thread queue wait thread interrupt connectionpool.wait timetowait interrupt need remov wait queue hostpool.waitingthreads.remov waitingthread connectionpool.waitingthreads.remov waitingthread catch interruptedexcept e noth final usetimeout endwait system.currenttimemilli timetowait -= endwait startwait ordinari circumst queue mainten done notifywaitingthread method howev thread interrupt part system 1 actual releas sinc loop dogetconnect forc back wait 2 ad wait thread queue repeat basic mean thread eventu receiv interrupt notifywaitingthread later point longer actual wait connect code could probabl re-architect make less error-pron fundament issu seem use interrupt signal wait thread oppos someth like notifi
hostconfigur socketfactori ignor hostconfigur n't use host.protocol execut httpmethod absolut url protocol 's scheme method 's url scheme bug make difficult integr special ssl connect algorithm secureprotocolsocketfactori modul implement top httpclient latter modul must execut method absolut url cours difficult one n't control modul exampl recent tri integr ssl certificate-bas client authent xfire xfire provid reason api replac httpclient one must hack sourc code prevent execut method absolut url protocol.registerprotocol possibl answer ca n't support two ssl connect algorithm one https host port
port fix httpclient-633 4.0 fix multithreadedhttpconnectionmanag httpclient-633 port threadsafeclientconnmanag 4.0
revis intern data structur threadsafeclientconnmanag threadsafeclientconnmanag intern data structur improv keep track issu connect weak refer use class deriv weakrefer instead lookup tabl callback referencethread drop referencethread favor occasion poll issu connect leak
unit test httpconn httpconn need test coverag start 0
add osgi bundl metadata manifest see discuss felix mail list http //www.mail-archive.com/felix-dev incubator.apache.org/msg04041.html easi way generat inform requir osgi bundl manifest distribut jar runtim api affect modif build process ll follow inform requir tool cheer roland
contrib.ssl.hostconfigurationwithhostfactori 'd like contribut exampl special hostconfigur replac one contribut httpclient-634
resourc leakag load keystor authsslprotocolsocketfactori open stream close keystor load result resourc leakag privat static keystor createkeystor final url url final string password throw keystoreexcept nosuchalgorithmexcept certificateexcept ioexcept url null throw new illegalargumentexcept keystor url may null log.debug initi key store keystor keystor keystore.getinst jks keystore.load url.openstream password null password.tochararray null return keystor chang someth like privat static keystor createkeystor final url url final string password throw keystoreexcept nosuchalgorithmexcept certificateexcept ioexcept url null throw new illegalargumentexcept keystor url may null log.debug initi key store keystor keystor keystore.getinst jks inputstream ulr.openstream tri keystore.load password null password.tochararray null final is.clos return keystor
provid fail-ov multi-hom remot server one server farm goe http client provid automat fail-ov multi-hom remot server web-farm one server farm goe
bad request vulner httpparser.readrawlin method guard code post without end-of-lin larg post data without \n read bytearray post larg enough deplet system free memori dos attack could easili play submit sever post readrawlin decid read charact data basic charact data never show someth like megabyt line report error return byte array unchunk input stream stop read tt \n /tt termin encount stream end line termin found last part string still return input data avail code null /code return param inputstream stream read throw ioexcept i/o problem occur return byte array stream public static byte readrawlin inputstream inputstream throw ioexcept log.trac enter httpparser.readrawlin bytearrayoutputstream buf new bytearrayoutputstream int ch ch inputstream.read 0 buf.writ ch ch \n toler rfc-2616 section 19.3 break buf.siz 0 return null return buf.tobytearray
cookie.compar use singl instanc string_col block compar use multithreadedhttpconnectionmanag singl httpclient instanc multipl getmethod object 500 thread max recent notic 500 thread place seem block stack trace dug cookie.compar method saw use string_collartor.compar c1.getpath c2.getpath string_col defin singl instanc object privat static final rulebasedcol string_col rulebasedcol rulebasedcollator.getinst new local en us also saw rulebasedcollator.compar synchron mean everi thread tri make request get block tri add cooki request method see workaround static final object everi cooki instanc thread synchron comparison time fetch url site go code lot need much faster current thread get eaten call backlog system differ rulebasedcol use compar use rulebasedcollator.getinst everi compar think would solv thing name pool-1-thread-1443 72.21.206.5 state block java.text.rulebasedcol 190330a own pool-1-thread-1867 72.21.206.5 total block 9,598 total wait 381 stack trace java.text.rulebasedcollator.compar rulebasedcollator.java:396 org.apache.commons.httpclient.cookie.compar cookie.java:484 org.apache.commons.httpclient.cookie.cookiespecbase.addinpathord cookiespecbase.java:578 org.apache.commons.httpclient.cookie.cookiespecbase.match cookiespecbase.java:557 org.apache.commons.httpclient.httpmethodbase.addcookierequesthead httpmethodbase.java:1179 org.apache.commons.httpclient.httpmethodbase.addrequesthead httpmethodbase.java:1305 org.apache.commons.httpclient.httpmethodbase.writerequesthead httpmethodbase.java:2036 org.apache.commons.httpclient.httpmethodbase.writerequest httpmethodbase.java:1919 org.apache.commons.httpclient.httpmethodbase.execut httpmethodbase.java:993 org.apache.commons.httpclient.httpmethoddirector.executewithretri httpmethoddirector.java:397 org.apache.commons.httpclient.httpmethoddirector.executemethod httpmethoddirector.java:170 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:396 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:324
support multipl proxi httpclient support one proxi current requir suppport one proxi may need connect one proxi connect target resourc found httpmethoddirector creat tunnel socket easi way plugin custom httpmethoddirector class httpclient extend httpclient overrid public int executemethod hostconfigur hostconfig final httpmethod method final httpstate state method
wire log incomplet httpparser detect error httpparser detect error header throw protocolexcept although fail header includ except detail header lead failur log make hard debug quit confus pe appear relat data receiv wire-log done caller httpmethoddirector log header pars succeed perhap wire log done point httpparser read line
inconsist order depend behaviour httpmethodbase.getresponse* getreponsebodyasstr store bodi may therefor provid valid result code request bodi stream afterward switch order first call getresponsebodyasstream afterward tri getreponsebodyasstr result null wrote unittest hope describ imho confus behaviour public void testhttpclientbodyvsstream throw httpexcept ioexcept final httpclient httpclient new httpclient final getmethod getmethod new getmethod http //www.heise.de/ final string bodyfromstream final string bodi tri httpclient.executemethod getmethod bodi getmethod.getresponsebodyasstr bodyfromstream ioutils.tostr getmethod .getresponsebodyasstream final getmethod.releaseconnect assertequ bodi bodyfromstream public void testhttpclientstreamvsbodi throw httpexcept ioexcept final httpclient httpclient new httpclient final getmethod getmethod new getmethod http //www.heise.de/ final string bodyfromstream final string bodi tri httpclient.executemethod getmethod bodyfromstream ioutils.tostr getmethod .getresponsebodyasstream bodi getmethod.getresponsebodyasstr final getmethod.releaseconnect fail assertequ bodi bodyfromstream search http //svn.apache.org/repos/asf/jakarta/commons/proper/httpclient/trunk/src/java/org/apache/commons/httpclient/httpmethodbase.java understand outcom confus would expect bodi data gone call one getresponse*-method call return null even throw illegalstateexcept would store bodi method
add option state attribut manag client connect provid option state attribut manag client connect connect state repres user identifi case connect base authent scheme ntlm ssl thus allow connect re-us per user ident basi
connect wrapper prevent gc tsccm even connect releas back threadsafeclientconnmanag hard refer connect wrapper prevent gc tsccm make sure connect wrapper proper detach releas updat testtsccmwithserver.testconnectionmanagergc accord
cooki class handl ipv6 liter perform request use ipv6 liter cookie.setdomain attempt trim port number cut domain string first colon lead malformedcookieexcept thrown cookiespecbas later
user-ag string violat rfc user-ag say jakarta commons-httpclient/3.1-rc1 space reserv charact separ individu *products* comment accord rfc 2616 section 14.43 jakarta product time may want drop jakarta name altogeth chang someth standard like apache-httpclient/3.1-rc1 system.getproperti os.nam system.getproperti os.arch java/ system.getproperti java.vm.vers system.getproperti java.vm.vendor render apache-httpclient/3.1-rc1 window xp 5.1 x86 java/1.5.0_08 sun microsystem inc. sun 's intern http client use someth like java/1.5.0_08 complet ignor fact real-world user agent use almost arbitrari string fine exampl misbehaviour privat log jakmpq dihurxf wfyiupsc appar somebodi hide someth missigua locat 1.9 poodl predictor 1.0 shelob v1.0 isc system irc search 2.1 ping.blogug.ch aggreg 1.0 http //www.uni-koblenz.de/~flocke/robot-info.txt sigh tempt write user-ag string valid prevent misus field httpclient
ip address server httpconnect afaik 's possibl get ip address server httpconnect propos add getserveraddress method httpconnect class return ip address server connect open either return null throw except ip address avail i.e connect open workaround get ip address current version packag org.apache.commons.httpcli import java.io.ioexcept import java.net.inetaddress public class inetaddressfetch privat httpconnect hc public inetaddressfetch httpconnect hc this.hc hc public inetaddress getinetaddress throw ioexcept hc.isopen hc.open return hc.getsocket .getinetaddress
testbasiccookieattribhandl fail non-english local system test check written date format cooki unfortun includ two charact abbrevi day differ local dateformat construct locale.us dateutil
dateutil cach simpledateformat dateutil creat simpledateformat invoc formatd parsed optim simpledateformat instanc cach sinc simpledateformat threadsaf cach must threadloc
disentangl commons-httpcli common gump current gump project httpclient 3.x defin one common project move separ definit either new group httpcompon gump project
new gump project httpcompon 4.0 creat new gump definit 4.0 code base core client maven-bas project gump learn exampl apollo excalibur
chang access intern map httpstate protect abl serial convers state http session access intern map httpstate requir current privat subclass access chang access protect allow subclass access map
replac httpstate credentialsprovi cookiestor interfac replac httpstate concret class credentialsprovi cookiestor interfac provid default impl interfac
provid bestmatch cooki polici present httpclient use singl cooki polici target host suboptim two reason 1 user need know beforehand kind http cooki support target host provid 2 work well multipl site differ level http cooki support introduc new cooki polici dynam pick cookiespec browser compat netscap draft rfc2109 rfc2965 base properti respons receiv target host
make sure static logger use review logger use compon make sure store non-stat attribut http //wiki.apache.org/jakarta-commons/logging/staticlog
introduc httprouteplann interfac defin interfac determin rout given target host creat default implement replac defaulthttpclient.determinerout implement need access param and/or request interfac fit httpconn dhc.dr use client paramet either move paramet httpconn keep default implement httpclient altern implement could evalu java system properti relat proxi set
add interfac plugabl dns client current httpclient implicit use inetaddress.getbynam dns resolut drawback one dns cach java per default cach entri forev 'd like abl replac inetaddress.getbynam anoth dns client implement
re-sync client chang core alpha6 snapshot api chang core sinc 's alpha5 releas client need adapt 's alpha2 snapshot build run current core api
revis max-per-host configur max-per-host set threadsafeclientconnmanag current store httpparam paramet valu map httprout former hostconfigur integ sever drawback 1 maintain map valu httpparam n't match understand param use 2 maximum base httprout realli specif tsccm implement generic parameter option revis defin generic parameter approach b revis implement specif parameter approach c defin implement tsccm specif configur interfac default implement keep map run-tim data cheer roland
use versioninfo core core alpha5 version detect scheme introduc replac preliminari version detect client alpha1 core mean new version.properti file least one per jar mayb one per potenti jar
thread starv multithreadedhttpconnectionmanag hi folk might found bug mthcm remov hostconnectionpool instanc connect fix memori leak previous two case pool get delet one handlelostconnect excerpt hostpool.numconnect 0 maphosts.remov config notifywaitingthread config could delet pool still thread wait get connect thread would remain global pool even interrupt would still use old hostconnectionpool connect ever becom avail suggest chang remov check case hostpool.numconnect 1 hostpool.waitingthreads.isempti think
memori leak multithreadedhttpconnectionmanag multithreadedhttpconnectionmanager.getconnectionsinpool hostconfigur creat hostconnectionpool entri clean unless later use communic chang creat pool method rather return 0 non-exist pool
connect pool use thread.interrupt connect pool tsccm use thread.interrupt wake wait thread interfer applic interrupt expos interruptedexcept interfac chang pool implement use wait/notifi
uri absolut follow browser behavior encount use heritrix crawl promin websit uri result httpclient uri constructor base relat follow browser behavior uri newurl new uri new uri http //www.theirwebsite.com/browse/result type=brows att=1 sort=0 offset=11 pagesize=10 result newurl http //www.theirwebsite.com/browse/ sort=0 offset=11 pagesize=10 desir behavior base firefox ie http //www.theirwebsite.com/browse/result sort=0 offset=11 pagesize=10 browser treat question mark similar directori separ requir file specifi queri httpclient 's current behavior correspond current browser behavior lead inabl crawl certain websit httpclient 's uri class use
web site download 3.1 fail load version 3 possibl document 4. match 3
maven 2 pom includ junit default compil scope rather test scope pom url declar depend junit default scope rather test scope
defaultredirecthandl access correct httpparam getlocationuri httprespons httpcontext method httpparam determin reject_relative_redirect allow_circular_redirect retriev httpparam param response.getparam respons httpparam contain valu howev request httpparam correct implement httprequest request httprequest context.getattribut httpexecutioncontext.http_request httpparam param request.getparam
httpoptions.getallowedmethod expect singl allow header client.methods.httpoptions.getallowmethod singl allow header pars obtain result sinc valu comma-separ list server option return valu multipl header httpmethod.gethead name use instead .getfirsthead name
stackabl paramet implement stackabl paramet allow paramet hierarchi without link param instanc
provid access sslsession managedclientconnect provid access wrappedconnect org.apache.http.impl.conn.abstractclientconnadapt via interfac order access socket within httpprocessor current org.apache.http.conn.operatedclientconnect getsocket method connect implement return context.getattribut executioncontext.http_connect org.apache.http.impl.conn.tsccm.basicpooledconnadapt provid access wrappedconnect
clientconnectionmanag throw interruptedexcept histor reason threadsafeclientconnectionmanag throw illegalthreadstateexcept instead interruptedexcept wait thread interrupt outsid design chosen sinc ad interruptedexcept httpconnectionmanag 3.x would broken api concern httpclient 4.0
default_head ad subsequ request default_head ad origin request subsequ request redirect authent
broken link releas note http //jakarta.apache.org/httpcomponents/httpclient-3.x/downloads.html link releas note broken
java.util.log configur exampl work intend java.util.log configur exampl work intend found http //jakarta.apache.org/httpcomponents/httpclient-3.x/logging.html step reproduc 1 creat simpl project use httpclient see list jdk 1.6 suppos jdk 1.4 higher test anyth 1.6 without log4j classpath without commons-log system properti set java.util.log automat select commons-log 2 creat logging.properti file shown java.util.log exampl 3 run program pass -djava.util.logging.config.file=logging.properti argument jvm expect result quit log messag sent system.err actual result unless i/o error encount log messag sent system.err problem far see caus default log level java.util.logging.consolehandl set info order log messag go log hadler log level need lower log messag log level ad follow line java.util.log exampl fix problem java.util.logging.consolehandler.level get.java import java.io.ioexcept import java.io.inputstreamread import java.io.read import org.apache.commons.httpclient.hostconfigur import org.apache.commons.httpclient.httpcli import org.apache.commons.httpclient.httpexcept import org.apache.commons.httpclient.httpmethodbas import org.apache.commons.httpclient.methods.getmethod public class get param arg public static void main string arg httpclient client new httpclient httpmethodbas get new getmethod http //www.apache.org tri int code client.executemethod get system.out.println status code code string csn get.getresponsecharset system.out.println charset csn long len get.getresponsecontentlength system.out.println length len len len 0 200 len stringbuild buf new stringbuild int len reader r new inputstreamread get.getresponsebodyasstream csn int c r.read c 0 c r.read buf.append char c system.out.println bodi system.out.println buf.tostr catch httpexcept e e.printstacktrac catch ioexcept e e.printstacktrac final get.releaseconnect logging.properti exampl .level=info handlers=java.util.logging.consolehandl java.util.logging.consolehandler.formatt java.util.logging.simpleformatt httpclient.wire.header.level=finest org.apache.commons.httpclient.level=finest
http client give sme messag proxy/http endpoint whether http sever endpoint proxi server get stack trace java.net.connectexcept connect refus java.net.plainsocketimpl.socketconnect nativ method java.net.plainsocketimpl.doconnect plainsocketimpl.java:333 java.net.plainsocketimpl.connecttoaddress plainsocketimpl.java:195 java.net.plainsocketimpl.connect plainsocketimpl.java:182 java.net.sockssocketimpl.connect sockssocketimpl.java:366 java.net.socket.connect socket.java:518 sun.reflect.nativemethodaccessorimpl.invoke0 nativ method sun.reflect.nativemethodaccessorimpl.invok nativemethodaccessorimpl.java:39 sun.reflect.delegatingmethodaccessorimpl.invok delegatingmethodaccessorimpl.java:25 java.lang.reflect.method.invok method.java:597 org.apache.commons.httpclient.protocol.reflectionsocketfactory.createsocket reflectionsocketfactory.java:139 org.apache.commons.httpclient.protocol.defaultprotocolsocketfactory.createsocket defaultprotocolsocketfactory.java:124 org.apache.commons.httpclient.httpconnection.open httpconnection.java:706 org.apache.commons.httpclient.multithreadedhttpconnectionmanag httpconnectionadapter.open multithreadedhttpconnectionmanager.java:1321 org.apache.commons.httpclient.httpmethoddirector.executewithretri httpmethoddirector.java:386 org.apache.commons.httpclient.httpmethoddirector.executemethod httpmethoddirector.java:170 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:396 com.approuter.module.http.protocol.httptransportsender.perform httptransportsender.java:214 good get inform whether proxi http endpoint
defaultredirecthandl resolv relat locat uri wrt request uri adjust relat uri locat header valu take request uri account may want replac tri uri new uri target.getschemenam null target.gethostnam target.getport uri.getpath uri.getqueri uri.getfrag httprequest request httprequest context.getattribut executioncontext.http_request tri uri requesturi new uri request.getrequestlin .geturi uri absoluterequesturi new uri target.getschemenam null target.gethostnam target.getport requesturi.getpath requesturi.getqueri requesturi.getfrag uri absoluterequesturi.resolv uri get request uri somewher els
perform tune
cooki guid list rfc 2965 unsupport httpclient 3.1 ad support rfc 2965 port-sensit cooki cooki guid 3.x websit still list unsupport http //jakarta.apache.org/httpcomponents/httpclient-3.x/cookies.html cheer roland
except caugh defaultresponsepars method hasprotocolvers o.a.h.message.baselinepars httpcore-alpha6 throw indexoutofboundsexcept caught parsehead method o.a.h.impl.conn.defaultresponsepars
handl uri path compon null httpclient handl uri path compon null e.g http //google.com path compon '/ result e.g protocolexcept server fail respond valid http respons
bad rout comput redirect request basicroutedirector appear miscalcul complex rout exampl follow
improv httprout api constructor httprout three boolean paramet use enumer reduc potenti confus flag tunnel layer independ sinc layer impli tunnel combin 3-valu enum
remov routedrequest clientrequestdirector interfac remov routedrequest clientrequestdirector.execut pass request route/target separ
move rout comput client director comput rout done clientrequestdirector client director need comput rout redirect comput rout
remov routedrequest api remov routedrequest client api move impl drop altogeth httpclient could accept separ request target argument instead routedrequest rout pass api
application-defin rout allow applic specifiy rout request paramet context function replac routedrequest remov httpclient-715
npe simplehttpconnectionmanager.shutdown simplehttpconnectionmanager.shutdown caus npe connect creat wherea multithreadedhttpconnectionmanager.shutdown simpl test case multithreadedhttpconnectionmanag cm new multithreadedhttpconnectionmanag cm.shutdown ok simplehttpconnectionmanag sm new simplehttpconnectionmanag sm.shutdown npe came across jmeter sampl use post autoredirect correct caus illegalargumentexcept connect creat jmeter code could tri keep track would tedious seem simplehttpconnectionmanag ignor shutdown connect null problem aris use closeidleconnect timeout unless one use special valu closeidleconnect system.currenttimemilli long.max_valu would probabl sensibl protect well
ssl verif occur setsotimeout lead hang partial thread dump java.net.socketinputstream.socketread0 nativ method java.net.socketinputstream.read socketinputstream.java:129 com.sun.net.ssl.internal.ssl.inputrecord.read inputrecord.java:293 com.sun.net.ssl.internal.ssl.inputrecord.read inputrecord.java:331 com.sun.net.ssl.internal.ssl.sslsocketimpl.readrecord sslsocketimpl.java:723 lock 0x00002aaab87d9de0 java.lang.object com.sun.net.ssl.internal.ssl.sslsocketimpl.performinitialhandshak sslsocketimpl.java:1030 lock 0x00002aaab87d9dc0 java.lang.object com.sun.net.ssl.internal.ssl.sslsocketimpl.starthandshak sslsocketimpl.java:1057 com.sun.net.ssl.internal.ssl.sslsocketimpl.getsess sslsocketimpl.java:1757 org.apache.http.conn.ssl.abstractverifier.verifi abstractverifier.java:87 org.apache.http.conn.ssl.sslsocketfactory.connectsocket sslsocketfactory.java:295 org.apache.http.impl.conn.defaultclientconnectionoperator.openconnect defaultclientconnectionoperator.java:131 org.apache.http.impl.conn.abstractpoolentry.open abstractpoolentry.java:143 org.apache.http.impl.conn.abstractpooledconnadapter.open abstractpooledconnadapter.java:120 org.apache.http.impl.client.defaultclientrequestdirector.execut defaultclientrequestdirector.java:286 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:452 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:406 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:365 defaultclientconnectionoper preparesocket set configur timeout n't call socketfactory.connectsocket use sslsocketfactori default behavior verifi hostnam open connect block indefinit simpl workaround use allowallhostnameverifi n't verif
clone support would nice clone method class n't getter setter expos field relev clone method could interfac n't matter implement class use main interfac would like clone httprequest cooki know httprequest technic part httpcore primari implement httpclient thought would post thank david byrn
httprouteplann base proxyselector sinc requir java 5 rout planner use standard java proxyselector would allow us automat pick proxi set system properti browser run applet
tsccm code cleanup threadsafeclientconnectionmanag rather 's connpoolbyrout need plenti cleanup use long timeunit timeout interv java 5 style comput timeout end date instead remain interv review method acquir pool lock expect caller done use factori method instanti helper object
review tsccm spurious wakeup review code tsccm/connpoolbyrout place spurious wakeup may happen verifi case dealt correct unit test give invalid wakeup signal
move httprout relat class separ packag route-rel stuff o.a.h.conn detach rest connect manag api move httprout routetrack httproutedirector httprouteplann o.a.h.conn.rout rout implement class depend scheme schemeregistri o.a.h.conn introduc recurs depend packag
use multi-arg uri caus uri-rewrit improp unescap charact see http //www.nabble.com/unable-to-encode-reserved-characters-using-java.net.uri-multi-arg-constructors-td14954679.html inform httpclient-dev thread basic idea uri 's multi-arg constructor break thing
implement delet method http request method delet implement need creat httpdelet class model httpget
request.abort interrupt thread wait connect call httprequestbase.abort unblock thread still wait connect therefor connectionreleasetrigg yet
allow unset default_proxi forced_rout paramet client stack sinc n't want delay client alpha3 httpcore-139 solv beta2 need paramet specif solut unset client paramet request level
depend rout planner implement implement httprouteplann depend connectionmanag use look schemeregistri consid depend schemeregistri
echohandler:104 possibl npe line 104 echohandl bae.setcontenttyp entity.getcontenttyp line previous entiti check null appear entiti null
hostnameverifi n't shadow simpl name implement interfac public interfac hostnameverifi extend javax.net.ssl.hostnameverifi findbug say class name n't shadow simpl name implement interfac class/interfac simpl name ident implemented/extend interfac except interfac differ packag e.g. alpha.foo extend beta.foo except confus creat lot situat look import statement resolv refer creat mani opportun accid defin method overrid method superclass
cookieidentitycompar cookiepathcompar could/should implement serializ cookieidentitycompar cookiepathcompar could/should implement serializ findbug suggest compar n't implement serializ class implement compar interfac consid whether also implement serializ interfac compar use construct order collect treemap treemap serializ compar also serializ compar littl state make serializ general easi good defens programming. neither class state implement serializ would trivial
abstractconnpool constructor call thread.start abstractconnpool constructor call thread.start findbug say constructor invok thread.start constructor start thread like wrong class ever extended/subclass sinc thread start subclass constructor start class final constructor protect suggest class intend extend
abstractclientconnadapt prone concurr issu abstractclientconnadapt current prone sort concurr issu 1 access intern state properri synchron make class prone race condit present none instanc variabl even declar volatil 2 abstractclientconnadapt treat abort connect one illeg state quit right oleg
common interfac httprout routetrack class httprout routetrack mani ident getter common interfac exampl routeinfo defin getter torout method return unmodifi represent portion api may accept interfac instead specif class httprout
duplic log http header http header line http/1.1 200 ok \r \n duplic wire log seem line log httpparser line 131 readlin inputstream string httpmethodbas line 1980 readstatuslin httpstate httpconnect look like latter log remov
class default visibl class default packag visibl caus problem class use extend class either public nest protect visibl use nest privat visibl may accept certain case exampl final class
substitut urlutils.java would like contribut substitut exist urlutils.java urlencodedutils.java offer util method deal urlencod data main differ exist class paramet map string list string instead namevalu pair lack third parti depend 's partial cover test extend cover method util class
entri creat pool followup https //issues.apache.org/jira/browse/httpclient-741 report sam berlin java.lang.illegalstateexcept entri creat pool httprout http //74.160.66.42:14561 org.apache.http.impl.conn.tsccm.routespecificpool.freeentri routespecificpool.java:137 org.apache.http.impl.conn.tsccm.connpoolbyroute.freeentri connpoolbyroute.java:337 org.apache.http.impl.conn.tsccm.threadsafeclientconnmanager.releaseconnect threadsafeclientconnmanager.java:230 org.apache.http.impl.client.defaultclientrequestdirector.execut defaultclientrequestdirector.java:427 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:500 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:455 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:421 com.limegroup.gnutella.http.defaulthttpexecutor.performrequest defaulthttpexecutor.java:97 com.limegroup.gnutella.http.defaulthttpexecutor.access 000 defaulthttpexecutor.java:26 com.limegroup.gnutella.http.defaulthttpexecutor multirequestor.run defaulthttpexecutor.java:139 org.limewire.concurrent.threadpoolexecutor.runwork threadpoolexecutor.java:1006 org.limewire.concurrent.threadpoolexecutor worker.run threadpoolexecutor.java:549 java.lang.thread.run thread.java:613 defaulthttpexecutor multirequestor basic runnabl cancel expos cancel method cancel thread cancel call abort current abortablehttprequest call thread one 's client.execut request last one common except seem happen regular two ve seen may memori quirk ve seen crazi bug includ recurs npes construct npe
make schemeregistri friendlier di framework scheme 's schemeregistri regist via regist method way pass set scheme regist one step way extern configur spring/guic friend someth like suffici public void setschem final set scheme scheme final scheme scheme scheme regist scheme
httpclient parambean easier configur core would like contribut client part parambean easier extern configur comment improv welcom
version.properti re go split one version.properti module-cli module-httpmim current miss version.properti file
move class scheme friend separ packag current recurs depend packag o.a.h.conn o.a.h.conn.rout rout depend scheme/schemeregistri class use throughout connect manag code realli part connect manag would therefor fit nice separ packag preliminari list class interfac move scheme schemeregistri socketfactori layeredsocketfactori plainsocketfactori suggest packag name o.a.h.conn.schem packag o.a.h.conn.ssl stay chang depend conn new packag cheer roland
basicclientcookie.tostr contain name instead valu write cooki valu noformat buffer.append name buffer.append this.valu noformat noformat buffer.append valu buffer.append this.valu noformat provid patch soon
use java.net.uri.resolv buggi use java.net.uri.resolv buggi see http //bugs.sun.com/bugdatabase/view_bug.do bug_id=4708535 affect class org.apache.http.impl.client.defaultredirecthandl propos solut creat resolv uri string method o.a.h.client.utils.urlutil
default proxi set client level effect default proxi set client level effect client paramet correct propag httprouteplann
wrong method signatur abstracthttpcli method signatur removerequestinterceptorbyclass removeresponseinterceptorbyclass abstracthttpcli wrong must public void removerequestinterceptorbyclass class extend httprequestinterceptor clazz public void removeresponseinterceptorbyclass class extend httprequestinterceptor clazz
defaultclientrequestdirector n't releas connect back clientconnectionmanag except see httpclient-747 info basic deal entri alway alloc current 's releas execut complet normal
abort execut various time fail svn commit 639506 scenario becom testabl fix abort httpclient.execut call abort set connect request abort set connect releas trigger abort redirect rout use new connect request r639506 three scenario fail abort correct
abstractclientconnadapt abortconnect releas connect call main execut thread block i/o oper abortconnect usual expect call helper thread order unblock main execut thread block i/o oper may unsaf call releaseconnect helper thread reli ioexcept thrown close socket main thread trigger releas connect back connect manag howev method call main execut thread safe releas connect immedi besid also help ensur connect get releas back manag abortconnect call main execut thread block i/o oper
httpclient javadoc need improv patch come
string.tolowercas touppercas specifi locale.english quit instanc string.tolowercas touppercas method call n't specifi local probabl mostly/al use locale.english otherwis may problem local e.g turkey .touppercas equal vice-versa isspecialdomain method netscapedomainhandl one instanc code wo n't alway work turkey
static variabl need final access synchronis static variabl need final access synchronis index module-client/src/main/java/org/apache/http/conn/params/httpconnectionmanagerparams.java module-client/src/main/java/org/apache/http/conn/params/httpconnectionmanagerparams.java revis 652021 +++ module-client/src/main/java/org/apache/http/conn/params/httpconnectionmanagerparams.java work copi -53,7 +53,7 public static final int default_max_total_connect 20 default maximum number connect allow per host privat static connperrout default_conn_per_rout new connperrout privat static final connperrout default_conn_per_rout new connperrout public int getmaxforrout httprout rout return connperroutebean.default_max_connections_per_rout
publish source/javadoc jar file maven repositori would realli nice httpcompon core client publish jar file maven repositori bytecod also sourc javadoc done defin classifi attribut javadoc sourc jar publish maven maven repo allow ide like eclips auto-download attach source/javadoc httpcompon jar file mean develop see api document automat ide also great aid debug one need step httpcompon code place sourc hand develop also mean might see patch come back
java.lang.illegalstateexcept connect alreadi open see mani problem note httpclient-741 use latest build maven repo java.lang.illegalstateexcept connect alreadi open org.apache.http.impl.conn.abstractpoolentry.open abstractpoolentry.java:150 org.apache.http.impl.conn.abstractpooledconnadapter.open abstractpooledconnadapter.java:119 org.apache.http.impl.client.defaultclientrequestdirector.execut defaultclientrequestdirector.java:308 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:501 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:456 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:422 com.hi5.os.hi5remotecontentfetcher.fetch hi5remotecontentfetcher.java:279
code cleanup java 1.5 ca n't resist give code good cleans start hack 's simpl thing use charact constant instead string contstant use java 1.5 style loop use stringbuild appropri fix javadoc switch somestring.equ .length 0 simplifi boolean express elimin redund initi fix html nit remov final keyword static method
concurrentmodificationexcept thrown multithread code see error default cooki set happen rare howev web site re talk use cooki much java.util.concurrentmodificationexcept java.util.abstractlist itr.checkforcomodif abstractlist.java:372 java.util.abstractlist itr.next abstractlist.java:343 java.util.collect unmodifiablecollect 1.next collections.java:1010 org.apache.http.client.protocol.requestaddcookies.process requestaddcookies.java:152 org.apache.http.protocol.basichttpprocessor.process basichttpprocessor.java:290 org.apache.http.protocol.httprequestexecutor.preprocess httprequestexecutor.java:160 org.apache.http.impl.client.defaultclientrequestdirector.execut defaultclientrequestdirector.java:355 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:501 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:456 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:422 com.hi5.os.hi5remotecontentfetcher.fetch hi5remotecontentfetcher.java:279
typo rfc refer web site quot http //hc.apache.org/httpcomponents-client/index.html standard complianc httpclient strive conform follow specif endors internet engin task forc ietf internet larg rfc 1945 hypertext transfer protocol http/1.0 rfc 2116 hypertext transfer protocol http/1.1 rfc2617 http authent basic digest access authent rfc2109 http state manag mechan cooki rfc2965 http state manag mechan cooki v2 note typo refer http/1.1
pars expir see often invalid cooki header set-cooki _asid=011e7014f5e7718e02d893335aa5a16 path=/ expires=w 16 may 2018 17:13:32 gmt unabl pars expir attribut wed 16 may 2018 17:13:32 gmt
download section websit mayb know http //hc.apache.org/downloads.cgi download httpcompon httpclient broken 500 intern server error
npe w/ abstractpoolentry.open java.lang.nullpointerexcept org.apache.http.impl.conn.abstractpoolentry.open abstractpoolentry.java:171 org.apache.http.impl.conn.abstractpooledconnadapter.open abstractpooledconnadapter.java:119 org.apache.http.impl.client.defaultclientrequestdirector.execut defaultclientrequestdirector.java:309 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:501 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:456 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:422 com.limegroup.gnutella.http.defaulthttpexecutor.performrequest defaulthttpexecutor.java:97 com.limegroup.gnutella.http.defaulthttpexecutor.access 000 defaulthttpexecutor.java:26 com.limegroup.gnutella.http.defaulthttpexecutor multirequestor.run defaulthttpexecutor.java:135 org.limewire.concurrent.threadpoolexecutor.runwork threadpoolexecutor.java:1006 org.limewire.concurrent.threadpoolexecutor worker.run threadpoolexecutor.java:549 java.lang.thread.run unknown sourc see lot alpha4 also see still occassion illegalstateexcept java.lang.illegalstateexcept connect alreadi open org.apache.http.impl.conn.abstractpoolentry.open abstractpoolentry.java:150 org.apache.http.impl.conn.abstractpooledconnadapter.open abstractpooledconnadapter.java:119 org.apache.http.impl.client.defaultclientrequestdirector.execut defaultclientrequestdirector.java:309 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:501 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:456 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:422 com.limegroup.gnutella.http.defaulthttpexecutor.performrequest defaulthttpexecutor.java:97 com.limegroup.gnutella.http.defaulthttpexecutor.access 000 defaulthttpexecutor.java:26 com.limegroup.gnutella.http.defaulthttpexecutor multirequestor.run defaulthttpexecutor.java:135 org.limewire.concurrent.threadpoolexecutor.runwork threadpoolexecutor.java:1006 org.limewire.concurrent.threadpoolexecutor worker.run threadpoolexecutor.java:549 java.lang.thread.run unknown sourc
singleclientconnectionmanag need recreat uniquepoolentri due chang yesterday ad state defaultclientconnect rememb shutdown call abort next open singeclientconnectionmanag break subsequ request perform first one encount except abort attach patch fix testcas previous fail
toplevel except cleanup httpclient.execut throw one except easier general use httpmethod constructor httpget httpput etc.. throw illegalargumentexcept string constructor impli string pre-check peopl want see uriexcept use new httpget new uri uri trigger except explicit uri creation
proxyhost/httphost check null javadoc document null ok constructor javadoc proxyhost httphost state null allow valu 's check httphost constructor throw illegalargumentexcept actual allow null document would also allow spring wire remain use proxi steer valu propertyfil
respect keep-al header httpclient current respect keep-al header token timeout max etc.. continu use persist connect beyond limit server request lead failur fall back httprequestretryhandl instead use new connect explicit
multipart post broken tri httppost request multipartent request encod wire 3 line separ header process correct http server multipartentri add 1 extra line separ write wire 'm sure standard least browser compat
variabl access getter attent place class share variabl direct oppos getter sometim ok subclass rare good class use object 's small number class non-priv variabl especi impl.conn impl.conn.tsccm packag see httpclient-745
public suffix list hi found use list http //publicsuffix.org/ thought would nice valid cooki domain basic serv black list domain never set cooki think attach patch download/pars list cours part implement ortwin
support pass sslcontext sslsocketfactori httpclient would possibl use exist instanc sslcontext initialis sslsocketfactori would allow use sslcontext configur option crls follow thread httpclient-commons-dev list http //marc.info/ l=httpclient-commons-dev m=121737017814116 w=2
protocol interceptor call execut connect method defaultrequestdirector tri establish rout via proxi https target regist protocol interceptor n't call createtunneltotarget method
default retri count three even document say 's five except handl document http //hc.apache.org/httpclient-3.x/exception-handling.html say httpclient automat retri 5 time method defaulthttpmethodretryhandl e.g trunk http //svn.apache.org/viewvc/httpcomponents/oac.hc3x/trunk/src/java/org/apache/commons/httpclient/defaulthttpmethodretryhandler.java revision=608014 view=markup see retri count three public defaulthttpmethodretryhandl int retrycount boolean requestsentretryen super this.retrycount retrycount this.requestsentretryen requestsentretryen creat new defaulthttpmethodretryhandl retri 3 time retri method success sent request public defaulthttpmethodretryhandl 3 fals
15 second httpclient.execut call use multipartent protocolexcept thrown complain content-length header alreadi present sure time-rel behaviour intent use librari week even timeout expect except thrown ought indic time compon involv org.apache.http.protocolexcept content-length header alreadi present incred mislead simple-ish compil program reproduc bug follow import java.nio.charset.charset import org.apache.http.httprespons import org.apache.http.client.methods.httppost import org.apache.http.client.params.clientpnam import org.apache.http.client.params.cookiepolici import org.apache.http.entity.mime.multipartent import org.apache.http.entity.mime.content.stringbodi import org.apache.http.impl.client.defaulthttpcli public class simpl static public void main string arg tri defaulthttpcli client new defaulthttpcli client.getparam .setparamet clientpnames.cookie_polici cookiepolicy.browser_compat multipartent entiti stringbodi stringbodi httppost post httprespons respons entiti new multipartent stringbodi new stringbodi field content charset.fornam iso-8859-1 entity.addpart field stringbodi post new httppost http //localhost/simple.php post.setent entiti respons client.execut post //the except occur content consum response.getent .consumecont system.out.println first post done //the except occur time interv request short thread.sleep 15000 //the except natur n't occur new httpclient creat //client new defaulthttpcli entiti new multipartent stringbodi new stringbodi field content charset.fornam iso-8859-1 entity.addpart field stringbodi post new httppost http //localhost/simple.php post.setent entiti respons client.execut post //will throw follow org.apache.http.protocolexcept content-length header alreadi present org.apache.http.protocol.requestcontent.process requestcontent.java:70 org.apache.http.protocol.basichttpprocessor.process basichttpprocessor.java:290 org.apache.http.protocol.httprequestexecutor.preprocess httprequestexecutor.java:160 org.apache.http.impl.client.defaultclientrequestdirector.execut defaultclientrequestdirector.java:356 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:501 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:456 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:422 test.simple.main simple.java:57 system.out.println second post done catch except e system.out.println e e.printstacktrac
o.a.h.conn.scheme.plainsocketfactori true singleton class org.apache.http.conn.scheme.plainsocketfactori factori method getsocketfactori clear indic javadoc expect singleton howev presenc public constructor make quit possibl case protect singleton status class constructor privat least default packag access forc access singl instanc factori method
ssl connect establish use ip address httpclient 4.x introduc regress establish ssl connect remot peer abstractverifi class check match cn subjectalternative- dnsname ip instead hostnam use check done cn subjectalternative- ipaddress
pass clientconnectionmanag defaulthttpcli constructor copi mail list post oleg suggest post jira 4.1 fix 'm tri find least verbos way configur defaulthttpcli threadsafeclientconnmanag exampl code given goe manual process configur httpparam schemeregistri object less copi defaulthttpclient.createhttpparam createclientconnectionmanag method 's bit chicken egg situat defaulthttpcli creat httpparam schemeregistri fine construct constructor requir threadsafeclientconnmanag turn requir httpparam schemeregistri object way manual construct httpparam schemeregistri wast seem defaulthttpcli 's constructor take clientconnectionmanagerfactori instead clientconnectionmanag way createclientconnectionmanag method alreadi factori refer n't grub around httpparam object find code would becom new defaulthttpcli new threadsafeclientconnmanagerfactori null threadsafeclientconnmanagerfactory.newinst construct threadsafeclientconnmanag 's manual construct httpparam schemeregistri leav defaulthttpcli
connectexcept handl defaulthttpmethodretryhandl copi mail list post oleg suggest post jira 4.0 fix use commons-httpclient.3.0.1 send request https protocol problem long creation connect ip address remot servic exist think problem situat https connect creat connectexcept thrown connect timeout except catch httpmethoddirector.java method executewithretri defaulthttpmethodretryhandl call recogn whether connect creation repeat think special handl connectexcept miss retrymethod defaulthttpmethodretryhandl except recogn connet creat hand connecttimeoutexcept thrown connect timeout http except handl defaulthttpmethodretryhandl call stop line code handl connecttimeoutexcept retrymethod defaulthttpmethodretryhandl except instanceof interruptedioexcept timeout return fals probabl miss connectexcept except instanceof interruptedioexcept || except instanceof connectexcept timeout return fals
contentbodi n't current setmimetyp method contentbodi therefor filebodi stringbodi inputstreambodi setmimetyp method ca n't set mime type alway default current workaround subclass overrid getmimetyp
httpclient throw npe invalid port use multithreadedhttpconnectionmanag httpclient throw nullpointerexcept main thread invalid port like 80001 use url illegalargumentexcept thrown timeoutguard thread except thread timeout guard java.lang.illegalargumentexcept port range:80001 java.net.inetsocketaddress. init inetsocketaddress.java:118 java.net.socket. init socket.java:240 org.apache.commons.httpclient.protocol.defaultprotocolsocketfactory.createsocket defaultprotocolsocketfactory.java:80 org.apache.commons.httpclient.protocol.controllerthreadsocketfactori 1.doit controllerthreadsocketfactory.java:91 org.apache.commons.httpclient.protocol.controllerthreadsocketfactori sockettask.run controllerthreadsocketfactory.java:158 java.lang.thread.run thread.java:613 except thread main java.lang.nullpointerexcept org.apache.commons.httpclient.httpconnection.open httpconnection.java:721 org.apache.commons.httpclient.multithreadedhttpconnectionmanag httpconnectionadapter.open multithreadedhttpconnectionmanager.java:1361 org.apache.commons.httpclient.httpmethoddirector.executewithretri httpmethoddirector.java:387 org.apache.commons.httpclient.httpmethoddirector.executemethod httpmethoddirector.java:171 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:397 org.apache.commons.httpclient.httpclient.executemethod httpclient.java:323 com.aol.test.httptest poolinghttpconnector.doget httptest.java:47 com.aol.test.httptest.main httptest.java:17 throw check except main thread caller handl error condit grace test program attach caus race condit 's alway reproduc run debugg show differ behavior packag com.aol.test import java.io.ioexcept import org.apache.commons.httpclient.httpcli import org.apache.commons.httpclient.httpstatus import org.apache.commons.httpclient.multithreadedhttpconnectionmanag import org.apache.commons.httpclient.methods.getmethod import org.apache.commons.httpclient.params.httpconnectionmanagerparam public class httptest public static void main string arg poolinghttpconnector conn new poolinghttpconnector tri string respons conn.doget http //www.aol.com:80001 system.out.println response= respons catch ioexcept e e.printstacktrac static class poolinghttpconnector public static final int max_total_connect 16 public static final int max_connections_per_host 8 public static final int connect_timeout 5000 public static final int socket_timeout 5000 public static final boolean tcp_no_delay true privat static multithreadedhttpconnectionmanag poolmanag privat static httpconnectionmanagerparam httpparam privat static httpclient httpclient privat static boolean initi fals public poolinghttpconnector initi public string doget string url throw ioexcept getmethod method new getmethod url tri int status httpclient.executemethod method string respons new string method.getresponsebodi status httpstatus.sc_ok throw new ioexcept http error respons return respons final method.releaseconnect privat synchron void initi initi return poolmanag new multithreadedhttpconnectionmanag httpparam new httpconnectionmanagerparam httpparams.setmaxtotalconnect max_total_connect httpparams.setdefaultmaxconnectionsperhost max_connections_per_host httpparams.settcpnodelay tcp_no_delay httpparams.setsotimeout socket_timeout httpparams.setconnectiontimeout connect_timeout poolmanager.setparam httpparam httpclient new httpclient poolmanag initi true
quick start guid httpclient 4.0 determin requir jar file compil samples/ file exampl org.apache.http.examples.client.clientformlogin use set classpath=p \j\samples\httpclient\exampl j \j\j5\h p \j\e\mysql.jar p \j\e\commons-logging-api-1.1.1.jar p \j\e\commons-logging-1.1.1.jar p \j\e\4\httpmime-4.0-beta2.jar p \j\e\4\httpclient-4.0-beta2.jar p \j\e\4\h\e\4\httpcore-4.0-beta3.jar p \j\e\4\httpcore-nio-4.0-beta3.jar still need org.apache.http jar quick start guid link jar one version would help known workaround go back old version 3.1
document use cookiespec none http //hc.apache.org/httpcomponents-client/httpclient/apidocs/org/apache/http/cookie/cookiespec.html http //hc.apache.org/httpcomponents-client/httpclient/apidocs/org/apache/http/cookie/cookiespecfactory.html http //hc.apache.org/httpcomponents-client/httpclient/apidocs/org/apache/http/cookie/cookiespecregistry.html http //hc.apache.org/httpcomponents-client/httpclient/apidocs/org/apache/http/impl/client/defaulthttpclient.html explain set cookiespec httpclient actual use look like cookiespecregistri might n't document name mean n't know pick make factori actual get use
httpparam n't document key valu http //hc.apache.org/httpcomponents-core/httpcore/apidocs/org/apache/http/params/httpparams.html either list meaning paramet name mean valu link class like httpclientparam authparam make usabl probabl class use httpparam also describ meaning valu human reader find descript howev look
abstracthttpclient.addrequestinterceptor document order interceptor run http //hc.apache.org/httpcomponents-client/httpclient/apidocs/org/apache/http/impl/client/abstracthttpclient.html addrequestinterceptor org.apache.http.httprequestinterceptor document least say order new interceptor run presum run order index lowest highest index run first class defaulthttpcli also say interceptor ad default would get rid call clearresponseinterceptor
httpclient throw java.net.socketexcept instead org.apache.http.conn.connectiontimeoutexcept connect timeout occur send http request connect timeout occur httpclient.execut method throw java.net.socketexcept instead org.apache.http.conn.connectiontimeoutexcept java.net.sockettimeoutexcept connect time java.net.plainsocketimpl.socketconnect nativ method java.net.plainsocketimpl.doconnect plainsocketimpl.java:333 java.net.plainsocketimpl.connecttoaddress plainsocketimpl.java:195 java.net.plainsocketimpl.connect plainsocketimpl.java:182 java.net.sockssocketimpl.connect sockssocketimpl.java:366 java.net.socket.connect socket.java:519 org.apache.http.conn.scheme.plainsocketfactory.connectsocket plainsocketfactory.java:119 org.apache.http.impl.conn.defaultclientconnectionoperator.openconnect defaultclientconnectionoperator.java:129 org.apache.http.impl.conn.abstractpoolentry.open abstractpoolentry.java:164 org.apache.http.impl.conn.abstractpooledconnadapter.open abstractpooledconnadapter.java:119 org.apache.http.impl.client.defaultrequestdirector.execut defaultrequestdirector.java:349 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:555 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:487 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:465
make possibl adjust maxtotalconnect paramet dynamicali make possibl adjust maxtotalconnect paramet run time document behaviour maxtotalconnect maxconnectionsperrout behaviour latter chang alloc pool oleg
review use baischttpparam httpprotocolprocessor httpclient review use baischttpparam httpprotocolprocessor httpclient replac thread-saf implement necessari oleg
set sourc output encod pom modif pom file explicit set sourc report encod ve set everyth utf-8 may appropri howev encod properti set ensur sourc file compil correct resourc filter appropri report use consist encod relat info http //docs.codehaus.org/display/mavenuser/pom+element+for+source+file+encod http //docs.codehaus.org/display/maven/reporting+encoding+configur
servertestbas localtestserv redistribut servertestbas localtestserv redistribut benefit wonder class without copi past instanc current creat rest client web servic would total benefit class check borderlin case 404 500 etc.. simplest possibl way achiev would add maven-jar-plugin entri pom execut test-jar goal regard sami dalouch
malformedcookieexcept distinguish cooki syntax error cross-domain error malformedcookieexcept use cooki syntax error cooki invalid particular context e.g cross-domain cooki think would help abl distinguish without need examin messag text
sslsocketfactory.connectsocket possibl npe use wrong variabl sslsocketfactory.connectsocket possibl npe line 324 sock.connect remoteaddress conntimeout perhap realli sslsock.connect remoteaddress conntimeout
transpar content code support would like see httpclient featur brought pariti librari java languag c.f python 's httplib2 yet standard librari mani would like see librari transpar handl gzip compress content code issu captur possibl solut provid sort innat function httpclient user n't requir know rfc2616 intim httpclient librari right thing use network effici manner possibl
thread safeti visibl improv abstractauthenticationhandler.default_scheme_prior protect extern chang although field privat subclass obtain refer may abl chang consid make list read-on return copi instead
wire produc invalid log skip zero byte certain case wireloginputstream class line 82 check byte return -1 mean end stream condit wrong case byte 0 look like l -1
potenti memori leak use threadsafeclientconnmanag use threadsafeclientconnmanag develop jetti use auto-redeploy featur eventu run permgen memori except investig yourkit 8.0.6 found class loader circular refer refqueuework realli sure made refqueuehandl non-fin null shutdown method redqueuework n't seem problem longer circular class loader refer diff 4.0-beta2 httpclient/src/main/java/org/apache/http/impl/conn/tsccm/refqueueworker.jav revis 763223 +++ httpclient/src/main/java/org/apache/http/impl/conn/tsccm/refqueueworker.jav work copi -50,7 +50,7 protect final referencequeu refqueu handler refer found protect final refqueuehandl refhandl protect refqueuehandl refhandl -112,6 +112,8 this.workerthread null indic shutdown wt.interrupt refhandl null
link javadoc httpclient httpcore httpmime present javadoc httpcore httpclient httpmime isol new user creat great deal confus appear limit function httpclient pleas set javadoc creation task link javadoc three project togeth
httpclient connect releas ssl tunnel fail tri use https ssl tunnel fail expect host accept squid proxi squid proxi return 403 problem see ever happen connect releas pool trace code appear httpmethiddirector.java executewithretri executeconnect return fals retri connect releas expect someth wrong
circularredirectexcept encount use proxi reach target direct circularredirectexcept encount use proxi tinyproxi remot machin wherea everyth fine use proxi target url http //www.seoconsultants.com/w3c/status-codes/301.asp 301 redirect issu fix use allow_circular_redirect set true client param ca n't consid real fix snippet code exemplifi problem use proxi string proxyhost xyz.webfactional.com int proxyport 7295 defaulthttpcli httpclient new defaulthttpcli without proxi 's ok httpclient.getparam .setparamet connroutepnames.default_proxi new httphost proxyhost proxyport http httpparam param httpclient.getparam httpclientparams.setredirect param true httpprotocolparams.setuserag param mozilla/5.0 macintosh u intel mac os x 10.5 en-us rv:1.9.0.10 gecko/2009042315 firefox/3.0.10 ok fix problem cost problem //httpclient.getparam .setparamet clientpnames.allow_circular_redirect true string url http //www.seoconsultants.com/w3c/status-codes/301.asp httpurirequest request httprespons respons request new httpget url system.out.println request request.getrequestlin respons httpclient.execut request system.out.println status response.getstatuslin system.out.println header arrays.aslist response.getallhead
wrong cooki match port number report use proxi follow exampl given https //issues.apache.org/jira/browse/httpclient-852 rout httprout http //xyz.webfactional.com:7295- http //www.seoconsultants.com one new cooki report ad java 2009/05/28 19:58:23:398 cest debug requestaddcooki cooki version 0 name aspsessionidcsarbqba valu mampamkcbdjjfknaapkpmdaa domain www.seoconsultants.com path expiri null match www.seoconsultants.com:7295/ wherea java 2009/05/28 19:57:46:667 cest debug requestaddcooki cooki version 0 name aspsessionidcsarbqba valu aampamkcmbinhnehpfebfada domain www.seoconsultants.com path expiri null match www.seoconsultants.com:80/ i.e without use proxi 7295 port number use access proxi target domain www.seoconsultants.com access regular http port number 80 thus cooki match also refer port 80 proxi 's port
proxi ntlm authent redirect differ address fail say proxi auth requir issu discuss http //www.nabble.com/redirect-fails-when-ntlm-authentication-is-used-for-proxy-tt23867531.html found http client 3.1 releas ntlm proxi authent must server ask redirect new url case redirect earlier proxi auth status clear proxi authent new url henc fail target host authenticaiton ntlm authent redirect also problem fix said http //issues.apache.org/jira/browse/httpclient-211 proxi authent redirect fix wire log releas https //repository.apache.org/content/repositories/snapshots/org/apache/httpcomponents/httpclient/4.0-beta3-snapshot/ given debug wire get http //verisign.com http/1.1 eol debug wire host verisign.com eol debug wire proxy-connect keep-al eol debug wire user-ag apache-httpclient/unavail java 1.5 eol debug wire eol debug wire http/1.1 407 proxi authent requir isa server requir author fulfil request access web proxi filter deni eol debug wire via 1.1 lab1 eol debug wire proxy-authent negoti eol debug wire proxy-authent kerbero eol debug wire proxy-authent ntlm eol debug wire proxy-authent basic realm= lab1 eol debug wire connect keep-al eol debug wire proxy-connect keep-al eol debug wire pragma no-cach eol debug wire cache-control no-cach eol debug wire content-typ text/html eol debug wire content-length 4107 eol debug wire eol debug wire doctyp html public -//w3c//dtd html 4.0 transitional//en \r \n debug wire html head titl error messag /titl \r \n debug wire meta http-equiv=content-typ content= text/html charset=utf-8 \r \n debug wire style id=l_default_1 \r \n debug wire 0x9 font-weight bold font-siz 10pt color 005a80 font-famili tahoma \r \n debug wire \r \n debug wire hover \r \n debug wire 0x9 font-weight bold font-siz 10pt color 0d3372 font-famili tahoma \r \n debug wire \r \n debug wire td \r \n debug wire 0x9 font-siz 8pt font-famili tahoma \r \n debug wire \r \n debug wire td.titlebord \r \n debug wire 0x9 border-right 955319 1px solid border-top 955319 1px solid padding-left 8px font-weight bold font-siz 12pt vertical-align middl border-left 955319 0px solid color 955319 border-bottom 955319 1px solid font-famili tahoma height 35px background-color d2b87a text-align left \r \n debug wire \r \n debug wire td.titleborder_x \r \n debug wire 0x9 border-right 955319 0px solid border-top 955319 1px solid padding-left 8px font-weight bold font-siz 12pt vertical-align middl border-left 955319 1px solid color 978c79 border-bottom 955319 1px solid font-famili tahoma height 35px background-color d2b87a text-align left \r \n debug wire \r \n debug wire .titledescript \r \n debug wire 0x9 font-weight bold font-siz 12pt color black font-famili tahoma \r \n debug wire \r \n debug wire span.explain \r \n debug wire 0x9 font-weight normal font-siz 10pt color 934225 \r \n debug wire \r \n debug wire span.tryth \r \n debug wire 0x9 font-weight normal font-siz 10pt color 934225 \r \n debug wire \r \n debug wire .trylist \r \n debug wire 0x9 margin-top 5px font-weight normal font-siz 8pt color black font-famili tahoma \r \n debug wire \r \n debug wire .x \r \n debug wire 0x9 border-right 955319 1px solid border-top 955319 1px solid font-weight normal font-siz 12pt border-left 955319 1px solid color 7b3807 border-bottom 955319 1px solid font-famili verdana background-color d1c2b4 \r \n debug wire \r \n debug wire .adminlist \r \n debug wire 0x9 margin-top 2px \r \n debug wire \r \n debug wire /style \r \n debug wire meta content= mshtml 6.00.2800.1170 name=gener /head \r \n debug wire bodi bgcolor= f3f3ed \r \n debug wire tabl cellspacing=0 cellpadding=0 width= 100 \r \n debug wire tbodi \r \n debug wire tr \r \n debug wire td class=titleborder_x width=30 \r \n debug wire tabl height=25 cellspacing=2 cellpadding=0 width=25 bgcolor=black \r \n debug wire tbodi \r \n debug wire tr \r \n debug wire td class=x valign=cent alig debug wire n=middl x /td \r \n debug wire /tr \r \n debug wire /tbodi \r \n debug wire /tabl \r \n debug wire /td \r \n debug wire td class=titlebord id=l_default_2 network access messag span class=titledescript page display /span /td \r \n debug wire /tr \r \n debug wire /tbodi \r \n debug wire /tabl \r \n debug wire \r \n debug wire tabl id=spac \r \n debug wire tbodi \r \n debug wire tr \r \n debug wire td height=10 /td /tr /tbodi /tabl \r \n debug wire tabl width=400 \r \n debug wire tbodi \r \n debug wire tr \r \n debug wire td nowrap width=25 /td \r \n debug wire td width=400 span class=explain id id=l_default_3 b explan /b /id /span id id=l_default_4 problem page tri reach display /id br br \r \n debug wire b span class=tryth id id=l_default_5 b tri follow /b /id /span /b \r \n debug wire ul class=trylist \r \n debug wire li id=l_default_6 b refresh page /b search page click refresh button timeout may occur due internet congest \r \n debug wire li id=l_default_7 b check spell /b check type web page address correct address may mistyp \r \n debug wire li id=l_default_8 b access link /b link page look tri access page link \r \n debug wire \r \n debug wire /ul \r \n debug wire id id=l_default_9 still abl view request page tri contact administr helpdesk. /id br br \r \n debug wire /td \r \n debug wire /tr \r \n debug wire /tbodi \r \n debug wire /tabl \r \n debug wire \r \n debug wire tabl id=spac tbodi tr td height=15 /td /tr /tbodi /tabl \r \n debug wire \r \n debug wire tabl width=400 \r \n debug wire tbodi \r \n debug wire tr \r \n debug wire td nowrap width=25 /td \r \n debug wire td width=400 id=l_default_10 b technic inform support personnel /b \r \n debug wire ul class=adminlist \r \n debug wire li id=l_default_11 error code 407 proxi authent requir isa server requir author fulfil request access web proxi filter deni 12209 \r \n debug wire li id=l_default_12 ip address x.x.x.x \r \n debug wire li id=l_default_13 date 6/29/2009 11:15:15 gmt \r \n debug wire li id=l_default_14 server lab1 \r \n debug wire li id=l_default_15 sourc proxi \r \n debug wire \r \n debug wire /ul \r \n debug wire /td \r \n debug wire /tr \r \n debug wire /tbodi \r \n debug wire /tabl \r \n debug wire \r \n debug wire /bodi \r \n debug wire /html \r \n debug wire \r \n debug wire get http //verisign.com http/1.1 eol debug wire host verisign.com eol debug wire proxy-connect keep-al eol debug wire user-ag apache-httpclient/unavail java 1.5 eol debug wire proxy-author ntlm tlrmtvntuaabaaaaatiaaagacaagaaaadgaoacgaaabnwurptufjtkpdsuztmjmwxzg2xzkx eol debug wire eol debug wire http/1.1 407 proxi authent requir access deni eol debug wire via 1.1 lab1 eol debug wire proxy-authent ntlm tlrmtvntuaacaaaaaaaaadgaaaabagacqbxriwnz3i4aaaaaaaaaaaaaaaa4aaaabqlodgaaaa8= eol debug wire connect keep-al eol debug wire proxy-connect keep-al eol debug wire pragma no-cach eol debug wire cache-control no-cach eol debug wire content-typ text/html eol debug wire content-length 0 eol debug wire eol debug wire get http //verisign.com http/1.1 eol debug wire host verisign.com eol debug wire proxy-connect keep-al eol debug wire user-ag apache-httpclient/unavail java 1.5 eol debug wire proxy-author ntlm tlrmtvntuaadaaaagaayaeaaaaawadaawaaaabaaeaciaaaaggaaajgaaaacabwasgaaaaaaaaaaaaaaaqiaaaxlpw40q7jqh7e6fgfnjqy9529anaslqftiwjyf2brup9f8obyoyysbaqaaaaaaacdgxrg9+skbrt4muoffcs0aaaaaaaaaae0awqbeae8atqbbaekatgbbagqabqbpag4aaqbzahqacgbhahqabwbyaeoaqwbjaeyauwayadmamabfadgangbfadkamqa= eol debug wire eol debug wire http/1.1 301 unknown reason eol debug wire via 1.1 lab1 eol debug wire connect keep-al eol debug wire proxy-connect keep-al eol debug wire content-length 0 eol debug wire date mon 29 jun 2009 11:16:50 gmt eol debug wire locat http //www.verisign.com/ eol debug wire content-typ text/html eol debug wire server netscape-enterprise/4.1 eol debug wire eol error requestproxyauthent proxi authent error unexpect state msg_type3_gener debug wire get http //www.verisign.com/ http/1.1 eol debug wire host www.verisign.com eol debug wire proxy-connect keep-al eol debug wire user-ag apache-httpclient/unavail java 1.5 eol debug wire eol debug wire http/1.1 407 proxi authent requir isa server requir author fulfil request access web proxi filter deni eol debug wire via 1.1 lab1 eol debug wire proxy-authent negoti eol debug wire proxy-authent kerbero eol debug wire proxy-authent ntlm eol debug wire proxy-authent basic realm= lab1 eol debug wire connect keep-al eol debug wire proxy-connect keep-al eol debug wire pragma no-cach eol debug wire cache-control no-cach eol debug wire content-typ text/html eol debug wire content-length 4107 eol debug wire eol http/1.1 407 proxi authent requir isa server requir author fulfil request access web proxi filter deni thank raj
basiccookiestor treat cooki name host duplic even differ path defaulthttpcli handl cooki correct singl host return multipl cooki name separ path exampl singl instanc client use access two differ webapp server may receiv two differ jsessionid cooki cooki version 0 name jsessionid valu f832c01d23f501ce5eeb296b602700c1 domain lglom139.example.com path /msa-adrenalina expiri null cooki version 0 name jsessionid valu 0fc660347391b93267168f84f2b520f5 domain lglom139.example.com path /map expiri null cookieidentitycompar class test cooki path determin equal new jsessionid receiv replac previous one instead ad new cooki store result disconnect client session prior webapp ve confirm ad path test cookieidentitycompar resolv problem
defaultrequestdirector convert redirect put/post get status code 301 302 307 defaultrequestdirector treat redirect request creat redirect status code httpstatus.sc_moved_temporarili httpstatus.sc_moved_perman httpstatus.sc_see_oth httpstatus.sc_temporary_redirect convert put/post method get httpclient tutori even document accord specif n't believ 's true per rfc http //www.w3.org/protocols/rfc2616/rfc2616-sec10.html convers put/post get appropri 303 see other suggest behavior fact follow note attach call incorrect 301 move perman note note automat redirect post request receiv 301 status code exist http/1.0 user agent erron chang get request 302 found say note rfc 1945 rfc 2068 specifi client allow chang method redirect request howev exist user agent implement treat 302 303 respons perform get locat field-valu regardless origin request method status code 303 307 ad server wish make unambigu clear kind reaction expect client current implement behavior caus problem interact central authent servic protect resourc among thing
uri refer resolut fail exampl rfc 3986 org.apache.http.client.utils.uriutils.resolv final uri baseuri uri refer fail resolv exampl rfc 3986 section 5.3 correct see testcas
extend client 's redirect handl interfac allow control content redirect exist redirecthandl interfac provid abil influenc situat caus redirect give control content redirect exampl want client follow redirect post request post request new locat ca n't defaultrequestdirector decid method use redirect request recent patch 's alway either head get one option resolv might extend redirecthandl interfac factori creat redirect request object defaultrequestdirector could chang ask redirecthandl creat appropri request situat thank ben
httpclient osgi export-packag n't specifi version export-packag manifest entri n't specifi version packag export mean packag import ca n't specifi version import
httpclient depend jcip-annotations.jar use java 5 compil code use httpclient jcip-annotations.jar must classpath els get compil error javac /path/to/src/somefile.java:129 access net.jcip.annotations.guardedbi javac file net/jcip/annotations/guardedby.class found javac defaulthttpcli httpclient new defaulthttpcli javac java 6 get bunch warn instead javac org/apache/http/impl/client/abstracthttpclient.class org/apache/http/impl/cli abstracthttpclient.class warn find annot method valu type net.jcip.annotations.guardedbi class file net.jcip.annotations.guardedbi found requir n't seem document anywher jcip-annotations.jar includ httpcomponents-client-4.0-bin-with-depend packag
log document refer nonexist level error java.util.log section page log practic section java.util.log exampl http //hc.apache.org/httpcomponents-client/logging.html say org.apache.http.level finest org.apache.http.wire.level error howev thing java.util.logging.level.error mean sever logger.getlogg org.apache.http.wir .setlevel level.sever thank
add name= anchor document section doc section miss name anchor see xdoc stylesheet repositori suppos generat yet site miss moment see https //svn.apache.org/repos/asf/jakarta/site/xdocs/stylesheets/site.xsl templat match= section
incorrect/incomplet product name meta-inf/notic file notic file httpclient jar incorrect state httpclient copyright 1999-2009 apach softwar foundat snip/ lead blank line delet httpclient apach httpcompon client httpclient similar case sourc archiv similar httpmime
incorrect specification-titl header manifest.mf specification-titl header manifest.mf includ full project name i.e apach httpcompon httpcompon qualifi miss present entri specification-titl apach httpclient specification-titl apach httpmime present implementation-titl follow convent
add filebodi constructor explicit filenam filebodi allow filenam field content-disposit header overriden filenam taken file object softwar creat temporari file need assign implicit logic filenam
add preemptiv authent wishlist request preemptiv authent includ api like httpclient 3.x exampl clientpreemptivebasicauthentication.java use httprequestinterceptor adapt applic work fine
overrid method multipartentity.addpart applic may use formbodypart formbodypart similar part httpclient 3.x coupl form name valu applic may find use realli util object sinc multipartentity.addpart string name contentbodi formbodypart getcont method entity.addpart part.getnam part.getcont almost getcont method overrid addpart take formbodypart object entity.addpart part
defaultclientconnectionoper n't updat socket call connectsocket defaultclientconnectionoper function openconnect call socketfactory.connectsocket document connectsocket say return connect socket return object may differ sock argument factori support layer protocol. quick peek sourc show org.apache.http.impl.conn.defaultclientconnectionoper 117 final socketfactori sf schm.getsocketfactori 118 119 socket sock sf.createsocket 120 conn.open sock target 121 122 tri 123 sock sf.connectsocket sock target.gethostnam 124 schm.resolveport target.getport 125 local 0 param 126 catch connectexcept ex 127 throw new httphostconnectexcept target ex 128 129 preparesocket sock context param 130 conn.opencomplet sf.issecur sock param defaultclientconnectionoper never updat conn new version sock may return connectsocket ad 130 conn.opencomplet sf.issecur sock param +++ 131 conn.upd sock target sf.issecur sock param appear fix issu
check correct content-typ urlencodedutil work encoding-suffix dear dev-team develop applic httpclient today found small problem relat urlencodedutil tomcat-serv deliver server-request http-header content-type=application/x-www-form-urlencod charset=utf-8 httpclient check content-type=application/x-www-form-urlencod fail check result empti result call method urlencodedutils.pars entiti follow source-cod caus prob public class urlencodedutil return true entiti 's content-typ header code application/x-www-form-urlencod /code public static boolean isencod final httpentiti entiti final header contenttyp entity.getcontenttyp return contenttyp null contenttype.getvalu .equalsignorecas content_typ imo method chang public class urlencodedutil return true entiti 's content-typ header code application/x-www-form-urlencod /code public static boolean isencod final httpentiti entiti final header contenttyp entity.getcontenttyp return contenttyp null contenttype.getvalu .startswith content_typ best regard
abstractclientconnadapt n't ensur one connectionreleasetrigger.abortconnect .releaseconnect effect httpurirequest.abort call time request complet 's possibl abort connect return pool next time connect use httpclient.execut fail without retri throw except java.io.ioexcept connect alreadi shutdown org.apache.http.impl.conn.defaultclientconnection.open defaultclientconnection.java:112 org.apache.http.impl.conn.defaultclientconnectionoperator.openconnect defaultclientconnectionoperator.java:120 org.apache.http.impl.conn.abstractpoolentry.open abstractpoolentry.java:147 org.apache.http.impl.conn.abstractpooledconnadapter.open abstractpooledconnadapter.java:101 org.apache.http.impl.client.defaultrequestdirector.execut defaultrequestdirector.java:381 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:641 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:576 step reproduc 1 set breakpoint threadsafeclientconnmanager.releaseconnect reusabl set found true 2 run breakpoint releaseconnect 3 call httpurirequest.abort 4 let releaseconnect complet connect next use except thrown snippet threadsafeclientconnmanag public void releaseconnect managedclientconnect conn long validdur timeunit timeunit boolean reusabl hca.ismarkedreus log.isdebugen breakpoint reusabl log.debug releas connect reusabl els log.debug releas connect reusabl hca.detach entri null connectionpool.freeentri entri reusabl validdur timeunit think abstractclientconnadapt modifi follow 1 add releas flag true connect releas privat boolean releas 2 modifi abortconnect public void abortconnect synchron abort || releas return abort true unmarkreus line follow unchang 3 modifi releaseconnect public void releaseconnect synchron abort || releas return releas true connmanag null connmanager.releaseconnect durat timeunit.millisecond
auth state correct maintain success ntlm authent result redirect httpclient fail updat auth state correct success ntlm authent result redirect respons report valentin popov valentin.po gmail.com
so_timeout set request level scenario follow 'm two consecut request host use multi-thread thread safe connect pool manag first invoc timeout 10s second timeout 30s version 3.1 httpclient work well 4.0 get timeout except second request ~10 second mean first timeout use look code see version 3.1 httpmethoddirector.executewithretri method invok method name applyconnectionparam took care set timeout taken request socket version 4.0 place see timeout set socket defaultrequestdirector.execut httphost httprequest httpcontext open connect use managedconn.open method sinc connect reus request second request use socket timeout first request
charset omit urlencodedforment content-typ header urlencodedforment set content-typ header application/x-www-form-urlencod set header application/x-www-form-urlencod charset= charset result content misinterpret recipi e.g entiti content includ multibyt unicod charact encod utf-8 charset correct exampl specifi charset content-typ header see stringentity.java 's fix public urlencodedforment final list extend namevaluepair paramet final string encod throw unsupportedencodingexcept super urlencodedutils.format paramet encod encod setcontenttyp urlencodedutils.content_typ setcontenttyp urlencodedutils.content_typ http.charset_param encod null encod http.default_content_charset public urlencodedforment final list extend namevaluepair paramet throw unsupportedencodingexcept super urlencodedutils.format paramet http.default_content_charset http.default_content_charset setcontenttyp urlencodedutils.content_typ paramet http.default_content_charset
urlencodedutil fail pars form-url-encod entiti specifi charset form-url-encod http entiti specifi charset content-typ header urlencodedutils.pars httpentiti fail pars entiti content type application/x-www-form-urlencod charset=utf-8 detect form-url-encod pars honor specifi charact set current code requir exact case-insensit match application/x-www-form-urlencod entiti detect form-url-encod appear author urlencodedutils.pars httpentiti tri take charact set account expect find content-encod header instead paramet content-length header http 1.1 spec make clear content-encod header specifi transform like gzip compress ident transform specifi entiti 's charact set help link http //www.w3.org/protocols/rfc2616/rfc2616-sec3.html sec3.4 http //www.w3.org/protocols/rfc2616/rfc2616-sec3.html sec3.5 http //www.w3.org/protocols/rfc2616/rfc2616-sec14.html sec14.11 relat https //issues.apache.org/jira/browse/httpclient-884
use_expect_continu fals default seem point use_expect_continu improv perform post larg data http //www.w3.org/protocols/rfc2616/rfc2616-sec8.html say purpos 100 continu status see section 10.1.1 allow client send request messag request bodi determin origin server will accept request base request header client send request bodi case might either inappropri high ineffici client send bodi server reject messag without look bodi 's noth wrong httpclient perform well default howev everi http client librari ve use behav like php curl perl lwp default alway one request includ bodi mayb dumb simpl seem httpclient 's default behavior simplest compat http-speak servic 100 continu somewhat advanc may correct implement servic 's cours found server n't implement use_expect_continu use perform reason seem like would simpler therefor mayb correct default enabl need good reason thought wish thank
link section exampl code broken step reproduc go http //hc.apache.org/user-docs.html click one link section exampl code
log creation impair perform run jprofil program use httpclient threadsafeclientconnmanag reveal 5 time spent construct log instanc class clientparamsstack oleg investig found defaultrequestdirector also problem simpl solut would make log static member variabl class consist howev might best solut interoper framework see http //wiki.apache.org/jakarta-commons/logging/staticlog anoth solut would simpli remov log affect class although presum reason
improv multihom support multihomeplainsocketfactori basic broken deprec multihom logic need move defaultclientconnectionoper
add contextawareauthschem access httpcontext authent method interfac ad would interfac repres extend authent scheme requir access link httpcontext order generat author string sinc 4.1 public interfac contextawareauthschem extend authschem produc author string given set link credenti param credenti set credenti use athent param request request authent param context http context throw authenticationexcept author string generat due authent failur return author string header authent credenti credenti httprequest request httpcontext context throw authenticationexcept binari compat maintain instanceof check locat authscheme.authent call moment call context awar version avail interfac necessari negotiateschem authent scheme servic name authent ticket base hostnam target host proxi host depend whether 's normal proxi authent inform avail httpcontext without httpcontext workaround work time look like string host isproxi fixm actual taken httpcontext httphost proxi connrouteparams.getdefaultproxi request.getparam host proxy.gethostnam els host request.getlasthead host .getvalu
case connecttimeoutexcept httprequestretryhandl use
use concurrenthashmap instead hashmap wherev thread-saf access need consid use concurrenthashmap instead hashmap map use multipl thread exampl schemeregistri authschemeregistri
httpmime stringbodi constructor throw specif unnecessarili declar unsupportedencodingexcept string bodi constructor take charset unnecessarili throw unsupportedencodingexcept charset encod definit support public stringbodi final string text final string mimetyp charset charset throw unsupportedencodingexcept super mimetyp text null throw new illegalargumentexcept text may null charset null charset charset.defaultcharset this.cont text.getbyt charset.nam this.charset charset public stringbodi final string text charset charset throw unsupportedencodingexcept text text/plain charset suggest chang public stringbodi final string text final string mimetyp charset charset super mimetyp text null throw new illegalargumentexcept text may null charset null charset charset.defaultcharset this.cont text.getbyt charset this.charset charset public stringbodi final string text charset charset text text/plain charset import chang chang this.cont text.getbyt charset.nam this.cont text.getbyt charset throw henc throw specif remov
minor perform improv idleconnectionhandl attach patch follow chang idleconnectionhandl iter map connect use linkedhashmap faster rather use iter keyset subsequ get valu iter entri set use instead effici least accord findbug note patch contain chang make variabl final possibl done automat eclips remov desir howev see harm affect code intend patch
upgrad default socket factori use so_reuseaddr paramet see httpcore-209
support underscor domain name provid better except call httpclient.execut url contain underscor get nullpointerexcept trace show java.net.uri complain illeg name true accord rfc seem browser allow compani support think httpclient either support underscor atleast provid better except
use apach codec 1.4 1.4 fix mani bug ad nice featur http //commons.apache.org/codec/changes-report.html took whiel find main reason test fail methodnotfoundexcept
provid clean mechan attatch user defin attribut connect would nice way attach user defin attribut connect ideal 'd nice support could ad httpclientconnect understand may possibl due back-compat issu could someth like httpconnectioncontext perhap similar httpconnectioncontext setattribut string name object valu object httpconnectioncontext getattribut string name would made avail httpcontext request like connect today httpconnectioncontext connectioncontext httpconnectioncontext httpcontext.getattribut executioncontext.http_connection_context would make thing much cleaner implement today obvious current use case want connect isol cooki current achiev goal need provid custom client connect connect oper connect manag implement clean way current obtain actual connect instanc creat custom oper httpcontext 's wrap connect pool getwrappedconnect protect need resort reflect interceptor provid clean mechan attach user defin attribut connect instanc describ would make implement far far simpler
rfe make credenti serializ ve work upgrad htmlunit librari use httpclient 4 ve realiz could elimin hackish intern code credenti instanc serializ n't realli see downsid would huge conveni us chang would involv make org.apache.http.auth.credenti interfac extend serializ org.apache.http.auth.basicuserprincip org.apache.http.auth.ntuserprincip implement serializ plus serialversionuid appropri guess
authent invalid redirect proxi authent also invalid discov use lucen connector framework 3.1 document fetch proxi authent ntlm document redirect 301 302 httpclient fail proper use right proxi credenti subsequ document fetch lead 407 error kind document ve attach propos patch
ntlm implement lack support ntlmv1 ntlmv2 ntlm2 session form ntlm current httpclient implement lack support enhanc ntlm window 95 includ ntlmv1 ntlmv2 ntlm2 session respons varieti protocol serious impact usabl httpclient enterpris situat requir lucen connector framework team extend httpclient address issu ve attach patch contain implement use lcf
netscapedraftspec strict cooki expir date format netscap draft specif http //curl.haxx.se/rfc/cookie_spec.html specifi clear date format set-cooki expir wdi dd-mon-yyyy hh mm ss gmt hand exampl section document exampl header contain expir follow set-cooki customer=wile_e_coyot path=/ expires=wednesday 09-nov-99 23:12:40 gmt note weekday fulli spell year written two digit would say specif therefor make 2 4 digit year option think netscapedraftspec reflect exampl product use 2 digit version jetti 6 7 use httpclient 4 talk jetti server set-cooki header persist cooki interpret 4 digit year date cooki immedi disregard expir 2,000 year httpclient 3 hand problem understand persist cooki jetti file bug report https //bugs.eclipse.org/bugs/show_bug.cgi id=304698 jetti chang date format hand also think httpclient 4 strict date format even origin specif use two altern workaround easi set cookiespecpnames.date_pattern realli think project like jetti httpclient compat default also sinc date format use jetti parsabl misinterpret disregard httpclient make especi hard detect first time encount problem
add amazon s3 authent support add support amazon s3 authent scheme defin onlin document http //docs.amazonwebservices.com/amazons3/latest/index.html restauthentication.html
request two forward slash path fail follow code demonstr problem defaulthttpcli client new defaulthttpcli client.execut new httpget http //www.google.com// request made defaultrequestdirector invok rewriterequesturi n't fulli understand method non-proxi request attempt render uri relat uri tri creat relat uri whose content per rfc 2396 section 5 relat uri refer relat uri begin network-path refer must immedi follow author therefor http //www.google.com// valid absolut uri valid relat one result except caus org.apache.http.protocolexcept invalid uri http //www.google.com// org.apache.http.impl.client.defaultrequestdirector.rewriterequesturi defaultrequestdirector.java:339 org.apache.http.impl.client.defaultrequestdirector.execut defaultrequestdirector.java:434 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:641 31 caus java.net.urisyntaxexcept expect author index 2 java.net.uri parser.fail uri.java:2809 java.net.uri parser.failexpect uri.java:2815 java.net.uri parser.parsehierarch uri.java:3063 java.net.uri parser.pars uri.java:3024 java.net.uri. init uri.java:578 org.apache.http.client.utils.uriutils.createuri uriutils.java:106 org.apache.http.client.utils.uriutils.rewriteuri uriutils.java:141 org.apache.http.client.utils.uriutils.rewriteuri uriutils.java:159 org.apache.http.impl.client.defaultrequestdirector.rewriterequesturi defaultrequestdirector.java:333 33
unencod redirect uri caus except follow redirect httpclient set follow redirect defaultredirecthandl get redirect locat appropri request header attempt creat new java.net.uri locat contain invalid uri charact creat uri fail exampl redirect locat /foo bar= baz/ would fail legal uri 'm sure actual consid bug httpclient sinc websit question probabl respons encod uri appropri howev browser handl situat grace would nice excel librari would well
chang valu expect header org.apache.http.client.methods.httppost see origin report http //code.google.com/p/android/issues/detail id=7208 'm go appli obvious patch android diff git a/src/org/apache/http/params/coreprotocolpnames.java b/src/org/apache/http/params/coreprotocolpnames.java index a42c5de..a0a726d 100644 a/src/org/apache/http/params/coreprotocolpnames.java +++ b/src/org/apache/http/params/coreprotocolpnames.java -94,8 +94,8 public interfac coreprotocolpnam p activ expect 100-continu handshak entiti enclos method purpos expect 100-continu activ expect 100-continu handshak entiti enclos method purpos expect 100-continu handshak allow client send request messag request bodi determin origin server will accept request base request header client diff git a/src/org/apache/http/protocol/http.java b/src/org/apache/http/protocol/http.java index de76ca6..9223955 100644 a/src/org/apache/http/protocol/http.java +++ b/src/org/apache/http/protocol/http.java -60,7 +60,7 public final class http public static final string server_head server http expect public static final string expect_continu 100-continu public static final string expect_continu 100-continu http connect control public static final string conn_clos close
sslsocketfactory.connectsocket possibl npe public socket connectsocket final socket sock final inetsocketaddress remoteaddress final inetsocketaddress localaddress final httpparam param throw ioexcept unknownhostexcept connecttimeoutexcept sslsocket sslsock sslsocket sock null sock createsocket sock may null localaddress null sock.setreuseaddress httpconnectionparams.getsoreuseaddr param npe sock null sslsock.bind localaddress sock.setreuseaddress sslsock.setreuseaddress
implement schemesocketfactory.createsocket httpparam param ignor param testtsccmwithserver.stallingsocketfactory.createsocket httpparam param ever use httpparam paramet non-test implement method ignor paramet sure version method exist paramet never use parameterless method socketfactori could use instead
nullpointerexcept negotiateschem server configur allow client authent kerbero princip foobar client use httpclient regist authschem spnego set negotiateschemefactori client authent correct princip foobar work client authent wrong princip fooba fail npe except thread main java.lang.nullpointerexcept org.apache.commons.codec.binary.base64.encodebase64 base64.java:233 org.apache.commons.codec.binary.base64.encod base64.java:521 org.apache.http.impl.auth.negotiatescheme.authent negotiatescheme.java:240 org.apache.http.client.protocol.requesttargetauthentication.process requesttargetauthentication.java:99 org.apache.http.protocol.immutablehttpprocessor.process immutablehttpprocessor.java:108 org.apache.http.protocol.httprequestexecutor.preprocess httprequestexecutor.java:167 org.apache.http.impl.client.defaultrequestdirector.execut defaultrequestdirector.java:460 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:689 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:624 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:602
make cacheentri use immut object repres cach content make cacheentri use immut object repres cach content similar httpentiti
302 respons without locat header throw except hi accord http 1.1 spec http //www.w3.org/protocols/rfc2616/rfc2616-sec10.html sec10.3.3 temporari uri given locat field respons unless request method head entiti respons contain short hypertext note hyperlink new uri defaultredirectstrategy.getlocationuri 's protocolexcept thrown locat header null locationhead null got redirect respons locat header throw new protocolexcept receiv redirect respons response.getstatuslin locat header spec say must protocolexcept signal http protocol violat occur exact true
impl.conn.wir use string.getbyt depend default charset impl.conn.wir use string.getbyt depend default charset method public void output final string public void input final string could probabl recod avoid problem output routin use stringbuild
standard common mock framework either easymock mockito current use easymock cach modul mockito main modul mockito appear somewhat nicer api sheer number test case base easymock cach modul make much simpler replac mockito easymock way around
clientconnectionreleas exampl incorrect http //svn.apache.org/repos/asf/httpcomponents/httpclient/tags/4.0.1/httpclient/src/examples/org/apache/http/examples/client/clientconnectionrelease.java incorrect 1. error happen bufferedread constructor outofmemoryerror stackoverflowerror reader.clos call connect releas 2. error happen reader.readlin reader.clos call httpget.abort
cachecli javadoc constant usag cleanup cachecli empti public java doc method get/set bodi also headerconst class overlap exist http class header valu need clean
case sockettimeoutexcept use httprequestretryhandl execut alway +1 request encount sockettimeoutexcept httprequestretryhandl retryrequest call executioncount valu +1
idleconnectionhandl leav close connect inconsist state idleconnectionhandl shut stale connect updat state abstractpoolentri thus caus inconsist state connect close pool entri still assum open problem mitig fact pool manag usual evict close connect almost immedi small window time threadsafeclientconnmanag closeidleconnect method connect close idleconnectionhandl immedi leas pool anoth thread inconsist state main thread get chanc re-acquir pool lock clean close connect 4.0.x problem work around retain pool lock entir span closeidleconnect 4.1 branch better solut devis probabl mean complet rewrit deprec idleconnectionhandl
incorrect handl inputstream connect server requir authent 'm tri upload file webdav server mod_dav apach web server 2.2.14 basic digest result authent enabl 'm use follow code string url http //myserver/dir/test2.gif file file new file d /test2.gif defaulthttpcli httpclient new defaulthttpcli httpput put new httpput url put.setent new inputstreament new fileinputstream file file.length uri uri put.geturi httpclient.getcredentialsprovid .setcredenti new authscop uri.gethost uri.getport getcredenti put.getparam .setbooleanparamet coreprotocolpnames.use_expect_continu true httprespons respons httpclient.execut put system.out.println response.getstatuslin run code 'm get org.apache.http.client.nonrepeatablerequestexcept retri request non-repeat request entiti test latest alpha svn head thing httpclient 3.1 work expect could normal 'm use inputstream inde repeat 'm also use expect 100-continu stream n't consum first connect one get code 401 webdav server second one credenti provid problem defaultrequestdirector.execut n't take account assum request tri associ entiti consum 's fix came chang defaultrequestdirector.execut wrapper entityenclosingrequestwrapp check entiti actual consum throw nonrepeatablerequestexcept 'm use method isstream httpentiti 's closest thing look read javadoc could lead situat entiti start stream yet finish state use howev n't think 's problem javadoc httpentity.getcont state ca n't call two time non-repeat entiti 's matter request fail lead also modifi inputstreament httpcore project n't compli javadoc two modif file upload complet success also modifi testinputstreamentity.testbas httpcore project test compli getcont 's javadoc testdefaultclientrequestdirector.faultyhttprequestexecutor n't consum entiti 's content test httpcore httpclient pass test inputstreament basichttpent pleas keep mind mean httpclient http matter expert modif may unexpect side-effect forese contain plain dumb code whatev would great someon could review chang give opinion
sslsocketfactory.createsslcontext process trust store org.apache.http.conn.ssl.sslsocketfactory.createsslcontext process provid trust store default cacert process addit provid trust store ignor ad trust certif keystor peer authent eventu tmfactory.init keystor need tmfactory.init truststor
connpoolbyrout drive routespecificpool illegalst hi encount issu connpoolbyrout routespecificpool httpclient 4.0.1 akin httpclient-747 also lead java.lang.illegalstateexcept entri creat pool httprout xxx concurr issu race condit logic error understood correct understand error lie connpoolbyrout getentryblock quot code line 309-314 routespecificpool rospl getroutepool rout true els hascapac freeconnections.isempti deleteleastusedentri entri createentri rospl oper els short version issu certain circumst deleteleastusedentri remov rospl map known rootspecificpool code still hold rospl instanc modifi state way pool never recov later way access instanc connect get releas step step guid 's go wrong 0 condit lead execut said code extract i.e free entri current rout rout alreadi regist global pool current rout capac max connect reach global pool free connect destroy 2 arriv deleteleastusedentri get last entri queue entri bound hashcod wise rout one get connect i.e rospl instanc held getentryblock context 3 entri last pool thus point rospl.isunus true 4 consequ deleteentri remov rospl routetopool map 5 back getentryblock method entri createentri rospl oper createdentri locally-scop rospl instanc remov routetopool 6 connexion new entri releas point futur rospl instanc got createdentri exist anymor new one get freeentri call 7 app break newli creat routespecificpool throw illegalstateexcept step 0 though rare condit reach stress test ssl client-auth server condit know httpclient keep-al connect routespecificpool reus state set x500 princip client cert pool request possibl fix understand rospl instanc variabl context getentryblock protect consequ deleteleastusedentri confort issu hand code base simplest thing think would preemptiv reset rospl variabl deleteleastusedentri thus write previous code extract els hascapac freeconnections.isempti deleteleastusedentri delet may made deprec routespecificpool instanc rospl getroutepool rout true entri createentri rospl oper els test case attach issu asap simpl exampl trigger condit 3 httpget call serial fashion state previsouli call need noth particular except one call must go https server client-sid certif authent guess ntlm would ok anyth place non null state along rout basicentrypool hope code self-explainatori get 100 failur setup configur 2 url configur classpath set keystor system properti launch workaround best workaround found get step 0 robust way found i.e way involv thing like set max pool size gigant number never reach activ set clientcontext.user_token attribut exec context submit request client step 0 trigger idl connect wait idl connect reus happen request 's user_token match basicpoolentri getstat ssl case state ssl cert 's x500principalnam know advanc 's easi set front way taught never could benefit connect reus strategi ssl case connect would alway get pool user_token request never n't know 's mention somewher document noteworthi fact pleas feel free comment correct mistak
client cach current allow incomplet respons pass client per http/1.1 spec cach receiv incomplet respons exampl fewer byte data specifi content-length header may store respons howev cach must treat partial respons partial respons may combin describ section 13.5.4 result might full respons might still partial cach must return partial respons client without explicit mark use 206 partial content status code cach must return partial respons use status code 200 ok http //www.w3.org/protocols/rfc2616/rfc2616-sec13.html sec13.8 exampl 200 respons show 128 byte bodi content-length header 256 cach must pass unchang
httpmultipart n't generat content-typ part header mode browser_compat browser test firefox 3.6 ie6 send content-typ header file part org.apache.http.entity.mime.httpmultipart n't browser_compat mode exampl -142889018617181602061216500409 content-disposit form-data name= myfilefieldname2 filename= webtest.png content-typ image/png htmlunit wil subclass httpentiti multipartent fix problem
applic uri invalid put/post/delet pass client cach http method must caus cach invalid entiti either entiti refer request-uri locat content-loc header present method put delet post http //www.w3.org/protocols/rfc2616/rfc2616-sec13.html sec13.10 current cach implement invalid request uri present locat content-loc header request patch fix upload momentarili
client cach may share cach cach respons request author header share cach see section 13.7 receiv request contain author field must return correspond respons repli request unless one follow specif except hold 1 respons includ s-maxag cache-control direct cach may use respons repli subsequ request specifi maximum age pass proxi cach must first revalid origin server use request-head new request allow origin server authent new request defin behavior s-maxag respons includ s- maxage=0 proxi must alway revalid re-us 2 respons includ must-revalid cache-control direct cach may use respons repli subsequ request respons stale cach must first revalid origin server use request-head new request allow origin server authent new request 3 respons includ public cache-control direct may return repli subsequ request http //www.w3.org/protocols/rfc2616/rfc2616-sec14.html sec14.8 n't clear whether cachinghttpcli share cach depend get use conserv compliant behavior assum share cach current implement cach respons regardless whether origin request author header patch discuss forthcom
client cach respect cache-control no-stor request purpos no-stor direct prevent inadvert releas retent sensit inform exampl backup tape no-stor direct appli entir messag may sent either respons request sent request cach must store part either request respons http //www.w3.org/protocols/rfc2616/rfc2616-sec14.html sec14.9.2 current implement incorrect cach respons request contain cache-control no-stor
no-cach direct field name transmit downstream field name must includ no-cach direct request http //www.w3.org/protocols/rfc2616/rfc2616-sec14.html sec14.9.4 current cach implement allow request contain someth like cache-control no-cache= content-loc pass downstream toward origin anoth one tricki situat client pass us non-compli request
cach honor must-revalid proxy-revalid cache-control direct http //www.w3.org/protocols/rfc2616/rfc2616-sec14.html sec14.9.4 coupl miss requir regard must-revalid proxy-revalid appli share cach 1 cach entri direct revalid must end-to-end revalid mean must includ max-age=0 request 2 revalid origin fail cach must return stale entri must return 504 respons
allow cach configur non-shar privat cach current cachinghttpcli behav share cach safe conserv assumpt howev set would appropri abl configur cachinghttpcli non-shar cach would make respons cacheabl includ respons request author header respons cache-control privat abil serv stale respons invalid fail cache-control proxy-revalid
basiccookiestore.getcooki return non-threadsaf collect basiccookiestore.getcooki simpl method 's synchron return unmodifi wrapper around under cooki list caller iter anoth thread manipul cooki list via basiccookiestor would creat thread un-saf situat thread n't reading/writ lock reader n't even lock suggest fix use copyonwritearraylist make defens copi getcooki issu might appli basic implement interfac n't check
cach modul use httpparams-styl configur constructor cachinghttpcli current accept combin httpcach httpclient integ max object size byte start look abl configur behav non-shar cach realiz actual want replac last int httpparam argument track various option style patch updat upload short
requestwrapp use header request wrap requestwrapp use header request wrap therefor wrapper appear header wrap request may work-around behavior call resethead wrapper creat method follow public void resethead headergroup.clear sethead original.getallhead suggest call sethead direct constructor least highlight javadoc call resethead
add support cach modul rfc 5861 stale-on-error stale-while-revalid cache-control extens allow origin server specifi addit behavior stale cach entri stale-on-error configur allow cach continu serv stale content certain period time revalid fail stale-while-revalid similar allow revalid occur asynchron revers proxi squid configur understand header mean origin server probabl send likewis take advantag
provid memcach implement httpcach featur would implement httpcach interfac store cach entri memcach
provid ehcach implement httpcach provid implement httpcach interfac store cach entri ehcach
cach entri resourc manag extract cachinghttpcli built support stream-bas manag cach respons bodi cachinghttpcli class finger mani pie involv resourc manag storag actual httpcacheentri patch forthcom
cachinghttpcli return 503 respons backend httpclient produc ioexcept cachinghttpcli return http 503 respons backend httpclient throw ioexcept happen instanc backend defaulthttpcli abstracthttpcli issu request server listen target port well sound tricki make httpclient consist behaviour implement use cach regular client 503 realli return case suggest abstracthttpcli return cachinghttpcli propag except thrown backend
cachinghttpcli return 411 respon execut post httppost request cachinghttpcli valid request prior execut call requestprotocolcompliance.requestisfatallynoncompli execut httppost method consid request invalid contain yet content-length header inde observ header generat time defaulthttpcli fire request nb 'm use cach 4.1-alpha2 plug httpclient 4.0.1-final ca n't use latest version need reli stabl version 's would curious know get behaviour 4.1 anyway would see two fix issu make httppost set content-length time entiti set remov valid step cachinghttpcli side
could get way know respons serv cach way know respons serv cach 's inform might use monitor activ cach 's current way mayb flag could ad request context whenev respons come cach
addit condit complianc test cach modul content-encod content-loc date expir server transfer-encod vari header patch forthcom
cach modul popul via header captur upstream downstream protocol cach modul current implement decor behav like transpar cach proxi need correct popul via header preserv record protocol version use upstream downstream cach modul must per rfc http //www.w3.org/protocols/rfc2616/rfc2616-sec14.html sec14.45
cach modul complet handl upstream warn header correct coupl must requir rfc warn header n't correct handl current implement http //www.w3.org/protocols/rfc2616/rfc2616-sec14.html sec14.46 1 howev cach success valid cach entri remov warn header previous attach entri except specifi specif warn code must add warn header receiv valid respons 2 implement receiv messag warning-valu includ warn-dat warn-dat differ date valu respons warning-valu must delet messag store forward use prevent bad consequ naiv cach warn header field warning-valu delet reason warn header must delet well
cach modul recogn equival uri http //www.w3.org/protocols/rfc2616/rfc2616-sec3.html sec3.2.3 compar two uri decid match client use case-sensit octet-by-octet comparison entir uri except port empti given equival default port uri-refer comparison host name must case-insensit comparison scheme name must case-insensit empti abs_path equival abs_path charact reserv unsaf set see rfc 2396 42 equival hex hex encod exampl follow three uri equival http //abc.com:80/~smith/home.html http //abc.com/ 7esmith/home.html http //abc.com 7esmith/home.html current implement canonic uri use cach key miss potenti cach hit import though requir invalid due put/post/delet uri well mention locat content-loc header may occur proper due bug
cach modul strip content-encod ident respons per rfc ident content code use content-encod header http //www.w3.org/protocols/rfc2616/rfc2616-sec3.html sec3.5 current implement pass content-encod ident unchang although would simpl enough filter
defaulthttprequestretryhandl must retri non-idempot http method violat rfc 2616 defaulthttprequestretryhandl case nohttpresponseexcept request retri without take account whether http method idempot violat rfc 2616 section 8.1.4 state quot mean client server proxi must abl recov asynchron close event client softwar reopen transport connect retransmit abort sequenc request without user interact long request sequenc idempot see section 9.1.2 non-idempot method sequenc must automat retri although user agent may offer human oper choic retri request quot fix simpl line 94 remov except instanceof nohttpresponseexcept block way idempot method taken account bit method
allow heurist fresh cach notic cachinghttpcli behav strang receiv respons public cache-control direct e.g http/1.0 200 ok server test server cache-control public content-length 1 1 use debugg could see respons cach respons queri cach consid fresh accord http rfc respons may cach understand case 's reason put respons cach n't use later one fresh respons analys respons queri cach thank cachedresponsesuitabilitycheck cancachedresponsebeus call cacheentri isresponsefresh return true respons date getcurrentagesec lower use-bi date getfreshnesslifetimesec issu getfreshnesslifetimesec return 0 max-ag direct could fix replac code cacheentri isresponsefresh public boolean isresponsefresh final long freshnesslifetim getfreshnesslifetimesec freshnesslifetim 0 return true return getcurrentagesec getfreshnesslifetimesec 'm 100 confid produc bad side-effect
cach modul produc improp format warn header revalid fail warn header current attach stale respons cach modul valid origin server fail properly-format warn header http //www.w3.org/protocols/rfc2616/rfc2616-sec14.html sec14.46
cach generat stale respons request explicit request first-hand fresh one current implement serv stale respons case stale cach entri revalid origin fail howev rfc say client explicit request first-hand fresh respons via no-cach max-ag max-stal min-fresh
cach allow client overrid origin-specifi fresh use max-stal accord rfc default fresh lifetim suppos least restrict specifi origin client cach right client ca n't use max-stal relax fresh constraint get cach hit without valid occur first
cach return cach respons even valid consist condit header must-level requir rfc etag last-modifi date use valid condit request cach return cach respons unless consist condit header request unit test alreadi incorrect use if-unmodified-sinc instead if-modified-sinc test case
ssl seem work whenev tri request content via https get except except thread main javax.net.ssl.sslexcept hostnam certif n't match 140.211.11.131 *.apache.org org.apache.http.conn.ssl.abstractverifier.verifi abstractverifier.java:220 org.apache.http.conn.ssl.browsercompathostnameverifier.verifi browsercompathostnameverifier.java:54 org.apache.http.conn.ssl.abstractverifier.verifi abstractverifier.java:149 org.apache.http.conn.ssl.abstractverifier.verifi abstractverifier.java:130 org.apache.http.conn.ssl.sslsocketfactory.createsocket sslsocketfactory.java:399 org.apache.http.impl.conn.defaultclientconnectionoperator.openconnect defaultclientconnectionoperator.java:143 org.apache.http.impl.conn.abstractpoolentry.open abstractpoolentry.java:149 org.apache.http.impl.conn.abstractpooledconnadapter.open abstractpooledconnadapter.java:108 org.apache.http.impl.client.defaultrequestdirector.execut defaultrequestdirector.java:415 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:641 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:576 org.apache.http.impl.client.abstracthttpclient.execut abstracthttpclient.java:554 httpstest.fail httpstest.java:25 httpstest.main httpstest.java:12 reproduc whith follow code import org.apache.http.client.httpcli import org.apache.http.client.methods.httpget import org.apache.http.impl.client.defaulthttpcli public class httpstest public static void main final string arg throw except final httpclient client new defaulthttpcli final httpget req new httpget https //www.apache.org client.execut req
cach modul handl out-of-ord valid proper uncondit refresh protocol recommend attempt revalid cach entri receiv respons date header 's actual *older* current entri revalid uncondit either max-age=0 no-cach sinc upstream cach would appear out-of-d http //www.w3.org/protocols/rfc2616/rfc2616-sec13.html sec13.2.6
cach use last-modifi etag valid avail protocol recommend http/1.1 client entiti tag last-modifi valu provid origin server use valid cache-condit request allow http/1.0 http/1.1 cach respond appropri http //www.w3.org/protocols/rfc2616/rfc2616-sec13.html sec13.3.4 current implement use etag condit valid entri http/1.0 cach ca n't current repli us 304 modifi even would appropri
need test guarante transpar cach modul end-to-end header transpar proxi modifi end-to-end header unless definit header requir specif allow http //www.w3.org/protocols/rfc2616/rfc2616-sec13.html sec13.5.2 alreadi true implement test preserv behavior
configur maximum connect lifetim provid mean configur maximum lifetim httpclient connect current would appear long connect use may persist indefinit would use situat httpclient need react dns chang follow situat may occur use dns load balanc httpclient maintain connect example.com resolv ip machin ip fail example.com resolv backup machin ip b sinc ip fail connect destroy new connect made ip b machin ip recov httpclient maintain connect ip b sinc connect still healthi desir behavior would connect ip b reach connect lifetim new connect could creat back ip accord updat dns set
cacheentryupdat proper updat cach entri resourc cacheentryupdat updatecacheentri copi old cach entri 's resourc though believ respons 304 otherwis take respons server updat entri method get call valid cach entri server return 200 304
stale connect never detect wirelog.isdebugen true wirelog.isdebugen true sessioninputbuff wrap loggingsessioninputbuff n't implement eofsensor abstracthttpclientconnection.isstal reli caus stale connect never detect attempt use
handl condit request cach return 304 incom request if-none-match if-modified-sinc header serv cach current return 200 correct optim
api surfac cach modul reduc cach modul current consid function use folk as-i sever near-term enhanc plan could chang expos binari api cach modul although yet clear whether would effort allow 4.1 ga releas go forward hedg bet futur develop consid drastic reduc expos binari api cach modul expos extens point someon explicit ask
url redirect easi way encod new url hc tri execut it/ implement custom redirecthandl easi way encod new url redirect public method access locat string prior uri generat would use
send variant etag variant miss section 13.6 rfc 2616 entiti tag assign cach represent forward request condit includ entiti tag if-none-match header field cach entri resourc convey server set entiti current held cach one entiti match request entiti server use etag header field 304 modifi respons tell cach entri appropri entity-tag new respons match exist entri new respons use updat header field exist entri result must return client present simpli forward request request without condit improv would consist ad condit request proper handl respons exampl would follow request resourc accept-encod gzip respons etag etag1 vari accept-encod request resourc accept-encod deflat request forward if-none-match etag1 ad respons 200 etag etag2 request resourc accept-encod gzip deflat request forward if-none-match etag1 etag2 ad respons 304 etag etag1 indic use first respons request
http client cach sizelimitedresponseread set content type inputstreament constructrespons newli creat inputstreament popul content-encod content-typ
cachinghttpclient.execut catch ioexcept thrown httpcache.getcacheentri ioexcept caus httpcach caught thus whole http request fail would expect respons retriev backend cach fail reason
websit 404 sever document page sever 404 found page link hc.apache.org pleas fix 's import document httpclient specif link http //hc.apache.org/user-docs.html found http //hc.apache.org/httpcomponents-client/primer.html http //hc.apache.org/httpcomponents-client-4.0.1/httpclient/apidocs/index.html http //hc.apache.org/httpcomponents-client-4.0.1/httpmime/apidocs/index.html
bytearraybodi altern inputstreambodi inputstreambodi determin content length turn caus request sent content length 0 even though content .net server troubl deal bytearraybodi provid altern allivi limit sourc import java.io.ioexcept import java.io.outputstream import org.apache.http.entity.mime.mim import org.apache.http.entity.mime.content.abstractcontentbodi bodi part built use byte array contain file author axel fontain public class bytearraybodi extend abstractcontentbodi content file contain part privat byte data name file contain part privat string filenam creat new bytearraybodi param data content file contain part param mimetyp mime type file contain part param filenam name file contain part public bytearraybodi final byte data final string mimetyp final string filenam super mimetyp data null throw new illegalargumentexcept byte may null this.data data this.filenam filenam creat new bytearraybodi param data content file contain part param filenam name file contain part public bytearraybodi final byte data final string filenam data application/octet-stream filenam overrid public string getfilenam return filenam overrid public void writeto outputstream throw ioexcept out.writ data overrid public string getcharset return null overrid public string gettransferencod return mime.enc_binari overrid public long getcontentlength return data.length
support only-if-cach direct add support only-if-cach cache-control directive- request servabl cach return 504 gateway timeout see http //www.w3.org/protocols/rfc2616/rfc2616-sec14.html sec14.9.4
ad custom locat header extractor method redirectstrategi sometim web server respond http request non-standard locat respons header server side redirect 302 ad conveni method come
checksum wrong httpcompon project pom v4.1 central evidenc log http //vmgump.apache.org/gump/public/httpcomponents/httpcomponents-core/gump_work/build_httpcomponents_httpcomponents-core.html checksum central httpcomponents-project-4.1.pom incorrect maven central -8 download http //localhost:8192/maven2/org/apache/httpcomponents/project/4.1/project-4.1.pom warn checksum fail checksum fail download local b63ff67e6ffc1940041319e0e06d7c6b1d671fd2 remot 8edff11652ca51b9d110ebfb321daac24f031c07 retri download http //localhost:8192/maven2/org/apache/httpcomponents/project/4.1/project-4.1.pom warn checksum fail checksum fail download local b63ff67e6ffc1940041319e0e06d7c6b1d671fd2 remot 8edff11652ca51b9d110ebfb321daac24f031c07 ignor pom appear depend httpcompon 4.0.3 -8 checksum failur caus configur reject artifact mani maven proxi configur result build failur due unsatisfi depend
pleas add maven-notice-plugin gump-trunk hi httpclient build current fail gump find maven-notice-plugin could grab http //svn.apache.org/repos/asf/httpcomponents/maven-notice-plugin/trunk/ sinc directori extern gump would lot easier ad extern well thank stefan
cach valid multipl cach variant bug cachinghttpcli attempt collect etag exist cach variant send condit request origin accident n't find send uncondit request instead
proper close resourc java except resourc must alway close final claus
typo english manual section 2.8.4 per default implement creat 2 concurr connect per given rout 20 connect total 2 statement section 3.1 netscap engin use refer magic cooki name stuck also 2 sentenc section 5.2 http.protocol.handle-redirect paramet httpclient handl redirect automat set put section 6.1 certain situat may necessari custom way http messag get transmit across wire beyond possibl possibl use http paramet order abl deal nonstandard non-compli behaviour 2 possibl
httpclient manual simplifi chines nov 2010 chines user nanlei translat apach httpclient manual chines contribut httpclient project freeli futur chines translat httpcore manual finish contribut httpcore project freeli
updat 3.x legaci homepag end life notif pointer httpcompon googl http client httpclient apach http client first result alway legaci commons-httpcli page follow link 's indic whatsoev legaci page latest version 's end-of-lif unless re alreadi awar httpcompon 's obvious way find legaci page refer httpcompon actual histori section sourc legaci page updat indic commons-httpcli end-of-lif project provid pointer new httpcompon page promin locat
implement ignorecooki cookiespec would use implement ignorecooki cookiespec done common hc 3.1 regist defaulthttpclient.createcookiespecregistri patch follow
clone basicclientcookie2 without specifi port clone method return null pointer except call basicclientcookie2 use port properti word imposs clone basicclientcookie2 instanc without port specif clone method two main instruct call clone method super call clone method port integ array null may good idea check whether array null
cach revalid variant updat origin variant entri cach stori multipl variant entri due vari header respons cach correct send condit request contain etag exist variant variant miss incom request match request variant alreadi cach addit receiv 304 respons correct return indic variant request caus variant miss howev updat pre-exist variant cach entri recommend rfc 2616 exampl request 1 user-ag agent1 result 200 ok etag etag1 vari user-ag request 2 user-ag agent2 caus if-none-match origin return 304 modifi etag etag1 request 3 user-ag agent1 result 200 ok get outdat entri result request 1 word origin respons request 2 updat variant agent1 caus incorrect behavior miss cach opportun
httproute.equ object o quit ineffici take full advantag shortcut logic httproute.equ object o quit ineffici take full advantag shortcut logic return soon first fals detect patch follow implement short-circuit check
add link benchmark httpclient cach modul articl comcast interact media 'd like add link httpclient doc detail benchmark httpclient cach modul